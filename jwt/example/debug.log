2023-05-11 11:58:38,431 root DEBUG Configured logging using dictionary
2023-05-11 11:58:38,506 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-05-11 11:58:38,506 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-05-11 11:58:38,507 werkzeug INFO  * Restarting with stat
2023-05-11 11:58:38,690 root DEBUG Configured logging using dictionary
2023-05-11 11:58:38,728 werkzeug WARNING  * Debugger is active!
2023-05-11 11:58:38,728 werkzeug INFO  * Debugger PIN: 131-965-940
2023-05-11 11:58:56,257 werkzeug INFO 127.0.0.1 - - [11/May/2023 11:58:56] "GET / HTTP/1.1" 200 -
2023-05-11 11:58:56,296 werkzeug INFO 127.0.0.1 - - [11/May/2023 11:58:56] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2023-05-11 11:59:01,297 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-05-11 11:59:01,298 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-05-11 11:59:01,298 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-05-11 11:59:01,298 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-05-11 11:59:01,346 oidcrp.rp_handler DEBUG Get provider info
2023-05-11 11:59:01,346 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-05-11 11:59:01,346 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://localhost:10000/.well-known/openid-configuration', 'method': 'GET'}
2023-05-11 11:59:01,346 oidcrp.oauth2 DEBUG Doing request with: URL:https://localhost:10000/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-05-11 11:59:01,347 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): localhost:10000
2023-05-11 11:59:01,348 oidcrp.http ERROR http_request failed: HTTPSConnectionPool(host='localhost', port=10000): Max retries exceeded with url: /.well-known/openid-configuration (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f619a8f9a80>: Failed to establish a new connection: [Errno 111] Connection refused')), url: https://localhost:10000/.well-known/openid-configuration, htargs: {'allow_redirects': False, 'verify': False, 'data': None, 'headers': {}}, method: GET
2023-05-11 11:59:01,348 oidcrp.oauth2 ERROR Exception on request: HTTPSConnectionPool(host='localhost', port=10000): Max retries exceeded with url: /.well-known/openid-configuration (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7f619a8f9a80>: Failed to establish a new connection: [Errno 111] Connection refused'))
2023-05-11 11:59:01,348 werkzeug INFO 127.0.0.1 - - [11/May/2023 11:59:01] "[31m[1mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 400 -
2023-05-11 11:59:48,841 root DEBUG Configured logging using dictionary
2023-05-11 11:59:48,879 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-05-11 11:59:48,879 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-05-11 11:59:48,880 werkzeug INFO  * Restarting with stat
2023-05-11 11:59:49,063 root DEBUG Configured logging using dictionary
2023-05-11 11:59:49,099 werkzeug WARNING  * Debugger is active!
2023-05-11 11:59:49,099 werkzeug INFO  * Debugger PIN: 131-965-940
2023-05-11 11:59:50,768 werkzeug INFO 127.0.0.1 - - [11/May/2023 11:59:50] "GET / HTTP/1.1" 200 -
2023-05-11 11:59:54,317 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-05-11 11:59:54,317 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-05-11 11:59:54,317 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-05-11 11:59:54,317 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-05-11 11:59:54,351 oidcrp.rp_handler DEBUG Get provider info
2023-05-11 11:59:54,351 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-05-11 11:59:54,351 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://sso.isprambiente.it/.well-known/openid-configuration', 'method': 'GET'}
2023-05-11 11:59:54,352 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-05-11 11:59:54,353 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-05-11 11:59:54,424 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-05-11 11:59:54,425 oidcrp.http DEBUG RECEIVED COOKIE
2023-05-11 11:59:54,425 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-05-11 11:59:54,425 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.24.0', 'Date': 'Thu, 11 May 2023 09:59:54 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'ISPRA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACGdCWNx-qvdstWGJ0lSiSYa1gG1JGqDohf7JTw-t3QGLPFID5AljB4q7WHPA_5twxZiVCjWhOHINyEWcbfjKRuWrNdkENqJMIWQ5FXt9Q6Fu4F9MvbJvCcgKvVXaWYjIxoLDasu7qZoO88n_j3zgRuSmRwJDfQQt_QNTVOzb2n273kITe-e47-EcQIbUYKpQcUA5UdQMwTq-Fg3ayhyAeddmCyon8FLXfSDAHC_k9-u49_mschbVQAA3rF6aH6sjI8AAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; HttpOnly; Max-Age=600; Path=/; SameSite=None; Secure', 'Strict-Transport-Security': 'max-age=63072000; ', 'X-Frame-Options': 'DENY'}
2023-05-11 11:59:54,425 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_post", "client_secret_basic", "client_secret_jwt", "private_key_jwt"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": true, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "subject_types_supported": ["public", "pairwise"], "scopes_supported": ["openid", "email", "profile", "offline_access"], "claims_supported": ["spidcode", "name", "familyname", "fiscalnumber", "email"], "response_types_supported": ["code"], "response_modes_supported": ["query", "fragment", "form_post"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512"], "request_object_encryption_alg_values_supported": ["RSA-OAEP", "RSA-OAEP-256", "A192KW", "A256KW", "ECDH-ES", "ECDH-ES+A128KW", "ECDH-ES+A192KW", "ECDH-ES+A256KW"], "request_object_encryption_enc_values_supported": ["A128CBC-HS256", "A192CBC-HS384", "A256CBC-HS512", "A128GCM", "A192GCM", "A256GCM"], "claim_types_supported": ["normal", "aggregated", "distributed"], "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint_auth_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512"], "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_signing_alg_values_supported": ["RS256", "RS512", "ES256", "ES512", "PS256", "PS512"], "userinfo_encryption_alg_values_supported": ["RSA-OAEP", "RSA-OAEP-256", "A192KW", "A256KW", "ECDH-ES", "ECDH-ES+A128KW", "ECDH-ES+A192KW", "ECDH-ES+A256KW"], "userinfo_encryption_enc_values_supported": ["A128CBC-HS256", "A192CBC-HS384", "A256CBC-HS512", "A128GCM", "A192GCM", "A256GCM"], "client_authn_method": ["bearer_header", "bearer_body"], "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection", "registration_endpoint": "https://sso.isprambiente.it/OIDC/registration", "issuer": "https://sso.isprambiente.it", "acr_values_supported": ["urn:oasis:names:tc:SAML:2.0:ac:classes:InternetProtocolPassword"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "id_token_signing_alg_values_supported": ["RS256", "RS512", "ES256", "ES512", "PS256", "PS512"], "id_token_encryption_alg_values_supported": ["RSA-OAEP", "RSA-OAEP-256", "A192KW", "A256KW", "ECDH-ES", "ECDH-ES+A128KW", "ECDH-ES+A192KW", "ECDH-ES+A256KW"], "id_token_encryption_enc_values_supported": ["A128CBC-HS256", "A192CBC-HS384", "A256CBC-HS512", "A128GCM", "A192GCM", "A256GCM"]}
2023-05-11 11:59:54,426 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_post", "client_secret_basic", "client_secret_jwt", "private_key_jwt"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": true, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "subject_types_supported": ["public", "pairwise"], "scopes_supported": ["openid", "email", "profile", "offline_access"], "claims_supported": ["spidcode", "name", "familyname", "fiscalnumber", "email"], "response_types_supported": ["code"], "response_modes_supported": ["query", "fragment", "form_post"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512"], "request_object_encryption_alg_values_supported": ["RSA-OAEP", "RSA-OAEP-256", "A192KW", "A256KW", "ECDH-ES", "ECDH-ES+A128KW", "ECDH-ES+A192KW", "ECDH-ES+A256KW"], "request_object_encryption_enc_values_supported": ["A128CBC-HS256", "A192CBC-HS384", "A256CBC-HS512", "A128GCM", "A192GCM", "A256GCM"], "claim_types_supported": ["normal", "aggregated", "distributed"], "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint_auth_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512"], "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_signing_alg_values_supported": ["RS256", "RS512", "ES256", "ES512", "PS256", "PS512"], "userinfo_encryption_alg_values_supported": ["RSA-OAEP", "RSA-OAEP-256", "A192KW", "A256KW", "ECDH-ES", "ECDH-ES+A128KW", "ECDH-ES+A192KW", "ECDH-ES+A256KW"], "userinfo_encryption_enc_values_supported": ["A128CBC-HS256", "A192CBC-HS384", "A256CBC-HS512", "A128GCM", "A192GCM", "A256GCM"], "client_authn_method": ["bearer_header", "bearer_body"], "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection", "registration_endpoint": "https://sso.isprambiente.it/OIDC/registration", "issuer": "https://sso.isprambiente.it", "acr_values_supported": ["urn:oasis:names:tc:SAML:2.0:ac:classes:InternetProtocolPassword"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "id_token_signing_alg_values_supported": ["RS256", "RS512", "ES256", "ES512", "PS256", "PS512"], "id_token_encryption_alg_values_supported": ["RSA-OAEP", "RSA-OAEP-256", "A192KW", "A256KW", "ECDH-ES", "ECDH-ES+A128KW", "ECDH-ES+A192KW", "ECDH-ES+A256KW"], "id_token_encryption_enc_values_supported": ["A128CBC-HS256", "A192CBC-HS384", "A256CBC-HS512", "A128GCM", "A192GCM", "A256GCM"]}
2023-05-11 11:59:54,426 oidcrp.service DEBUG response format: json
2023-05-11 11:59:54,426 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-05-11 11:59:54,426 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_post', 'client_secret_basic', 'client_secret_jwt', 'private_key_jwt'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': True, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'subject_types_supported': ['public', 'pairwise'], 'scopes_supported': ['openid', 'email', 'profile', 'offline_access'], 'claims_supported': ['spidcode', 'name', 'familyname', 'fiscalnumber', 'email'], 'response_types_supported': ['code'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512'], 'request_object_encryption_alg_values_supported': ['RSA-OAEP', 'RSA-OAEP-256', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'request_object_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'claim_types_supported': ['normal', 'aggregated', 'distributed'], 'authorization_endpoint': 'https://sso.isprambiente.it/OIDC/authorization', 'token_endpoint_auth_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'PS256', 'PS384', 'PS512'], 'token_endpoint': 'https://sso.isprambiente.it/OIDC/token', 'userinfo_signing_alg_values_supported': ['RS256', 'RS512', 'ES256', 'ES512', 'PS256', 'PS512'], 'userinfo_encryption_alg_values_supported': ['RSA-OAEP', 'RSA-OAEP-256', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'userinfo_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM'], 'client_authn_method': ['bearer_header', 'bearer_body'], 'userinfo_endpoint': 'https://sso.isprambiente.it/OIDC/userinfo', 'introspection_endpoint': 'https://sso.isprambiente.it/OIDC/introspection', 'registration_endpoint': 'https://sso.isprambiente.it/OIDC/registration', 'issuer': 'https://sso.isprambiente.it', 'acr_values_supported': ['urn:oasis:names:tc:SAML:2.0:ac:classes:InternetProtocolPassword'], 'jwks_uri': 'https://sso.isprambiente.it/OIDC/jwks.json', 'id_token_signing_alg_values_supported': ['RS256', 'RS512', 'ES256', 'ES512', 'PS256', 'PS512'], 'id_token_encryption_alg_values_supported': ['RSA-OAEP', 'RSA-OAEP-256', 'A192KW', 'A256KW', 'ECDH-ES', 'ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'], 'id_token_encryption_enc_values_supported': ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512', 'A128GCM', 'A192GCM', 'A256GCM']}"
2023-05-11 11:59:54,427 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'provadiinserimento'}
2023-05-11 11:59:54,428 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://sso.isprambiente.it
2023-05-11 11:59:54,429 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-05-11 11:59:54,429 cryptojwt.key_bundle INFO Reading remote JWKS from https://sso.isprambiente.it/OIDC/jwks.json
2023-05-11 11:59:54,429 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://sso.isprambiente.it/OIDC/jwks.json
2023-05-11 11:59:54,431 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-05-11 11:59:54,509 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-05-11 11:59:54,510 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "emgzTm1XakQwd29IdGhJZVBYQ2dsWTZvZXhFX3c2U2lFNUMxSVFqRjloZw", "n": "pzCu9JwscHQvt3shAMInZEKwORbGCkfqn0W41cMt8J-cT4Vy0zf5c5-KrsX-EmIkakXajk7b0uj7z42KDjP-I_ytnO9oRSuzJs0JULSifZDCtVxzs6JfXw6Zis0PnWM5An4KQ1gRwjk1SJgXjDEhQ1sc8QDiwohdzEqwzko-A8vghqX7AtazSR39V26nrC36OgM2DoXmPLTnjBPnuHsfyja8wEoEO9rzAk6jZQqSSX06_VIF8n4MdowB8TtDYa-52XZNrdYlM_cbYZ-ODct85gij_RY5ZsGk0HgigWM6d6UKSIq3Qfg_G8eGuRlI7EJKWk8YHEq3P828iMpymCryeQ", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "dUs0dzNZdExKM1hJTi1Xa1hhQTVlRExjcTRvYmFkTGhoVEVtYWxYYmpkdw", "crv": "P-256", "x": "-fRJST6dD4vxWvZBVVEiTcCxb_79Db4y-UzFwv1zNRE", "y": "koa0mfFXZwk5hZLCqHos0kz7EE-MgVwGyYAn45FqgxY"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-05-11 11:59:54,510 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "emgzTm1XakQwd29IdGhJZVBYQ2dsWTZvZXhFX3c2U2lFNUMxSVFqRjloZw", "n": "pzCu9JwscHQvt3shAMInZEKwORbGCkfqn0W41cMt8J-cT4Vy0zf5c5-KrsX-EmIkakXajk7b0uj7z42KDjP-I_ytnO9oRSuzJs0JULSifZDCtVxzs6JfXw6Zis0PnWM5An4KQ1gRwjk1SJgXjDEhQ1sc8QDiwohdzEqwzko-A8vghqX7AtazSR39V26nrC36OgM2DoXmPLTnjBPnuHsfyja8wEoEO9rzAk6jZQqSSX06_VIF8n4MdowB8TtDYa-52XZNrdYlM_cbYZ-ODct85gij_RY5ZsGk0HgigWM6d6UKSIq3Qfg_G8eGuRlI7EJKWk8YHEq3P828iMpymCryeQ", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "dUs0dzNZdExKM1hJTi1Xa1hhQTVlRExjcTRvYmFkTGhoVEVtYWxYYmpkdw", "crv": "P-256", "x": "-fRJST6dD4vxWvZBVVEiTcCxb_79Db4y-UzFwv1zNRE", "y": "koa0mfFXZwk5hZLCqHos0kz7EE-MgVwGyYAn45FqgxY"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-05-11 11:59:54,512 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'email', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'prompt': 'consent'}
2023-05-11 11:59:54,513 oidcrp.rp_handler DEBUG Do client registration
2023-05-11 11:59:54,513 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-05-11 11:59:54,513 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-05-11 11:59:54,514 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'email', 'offline_access'], 'response_type': 'code', 'nonce': '0IHMA625uAwvvCwMY2w2evk2', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'eLvYHNxPj664Xcg1JEGKRVgfSOu7PxvR'}
2023-05-11 11:59:54,515 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile email offline_access', 'response_type': 'code', 'nonce': '0IHMA625uAwvvCwMY2w2evk2', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'eLvYHNxPj664Xcg1JEGKRVgfSOu7PxvR', 'code_challenge': 'PbSSaeNVgSQxN09oJ-ta4wJg50p6z61z-XiChgUkgaw', 'code_challenge_method': 'S256', 'client_id': 'provadiinserimento', 'prompt': 'consent'}
2023-05-11 11:59:54,515 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7fa01c7ab130>, 'url': 'https://sso.isprambiente.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+email+offline_access&response_type=code&nonce=0IHMA625uAwvvCwMY2w2evk2&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=eLvYHNxPj664Xcg1JEGKRVgfSOu7PxvR&code_challenge=PbSSaeNVgSQxN09oJ-ta4wJg50p6z61z-XiChgUkgaw&code_challenge_method=S256&client_id=provadiinserimento&prompt=consent'}
2023-05-11 11:59:54,517 werkzeug INFO 127.0.0.1 - - [11/May/2023 11:59:54] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-05-11 12:00:21,631 flask_rp.views DEBUG Issuer: https://sso.isprambiente.it
2023-05-11 12:00:21,631 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-05-11 12:00:21,631 oidcrp.service DEBUG response format: dict
2023-05-11 12:00:21,631 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-05-11 12:00:21,631 oidcrp.service DEBUG Initial response parsing => "{'state': 'eLvYHNxPj664Xcg1JEGKRVgfSOu7PxvR', 'scope': 'openid profile email offline_access', 'code': 'Z0FBQUFBQmtYTHkxYzU0bXlQa1NfY0ZPZ3ozTDRjVHNrUnpkckxKV3BhRnVBVDRHdC1fYk5BbWZLRjJlTmV2QUY4RzRjRHRBTjNtR0RCQ1l6eFpJQW1famJ6TmJDWmtZQXMxTnRqQVYzQ3NRb0k2NjJmcFZyRmxZSExRZVRZWkh4MmxjRlVhU0FvaXhGb2Z1bzNZQ2pzV1BaNWFveDl5Q0ZmcXM1ZlpuNmktRzc1TldGa0FVOUJpTDd1VW0zckxHdmhrQ3d5SnNTdWE5bUlNN3VsZGtKU21tUHFOcnY4NU8xaUdlZnNic01BOWxRcEhncG84cVE1OWQzVHJwcXJDdm8yaUdIQk4yTWJHU2JCcmNFSjdHcFo5Zy0xSng4V0ZOZUU2QmZvYzNlOWZIaWFKemstVUYzMGF2OENnUlZIal81NWRGTGlrTjNCZDNaVXRTa3U0aTQ4UTJnYjd3Q1RLTkNheXZpel9GanZDQVJFM043cnNyMUkyWS1UWm1vTUhVXy1nQ2xpeEZkeFZ5Vmc0RjRpSEtQQjFFTEhMaERPOVpOb3IwMm4xOXVjWERwRXg1akxjdVkteGYxYkRMMUwyRzN3TEVuOVY4bVBQRG9oUU5Oc25aUkgxVnE5eWtDRU1SOGlJZmlPbVJvbDR4WUVycDRUUUNfaFFaWEF3NHBPTEVCRkdPV2EyWVdnRHJZQ3VoUWFZNGN5NXE3aVJwNHVnNkRoSFBkV0VZQ3lQTkk0NWdpeEVlWHBfWkZHQnhaeEpER3hjU0pJc3BpMGtIUzY5bkZDbDNPT2VJSk5najRJRHdEbHRtTGNJWTVrSDQta3ZsV2x4eV84MHpRUlllNWoxMGJ0X3k5OWhReHBHYVhDbGJ1ZWkzZWYtM0JJMGpWNjlwWmxMbkVQSEFYUHhZbXZ2YjgzZVdJTW89', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}"
2023-05-11 12:00:21,631 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15, 'client_id': 'provadiinserimento'}
2023-05-11 12:00:21,632 oidcrp.rp_handler DEBUG Authz response: {'state': 'eLvYHNxPj664Xcg1JEGKRVgfSOu7PxvR', 'scope': 'openid profile email offline_access', 'code': 'Z0FBQUFBQmtYTHkxYzU0bXlQa1NfY0ZPZ3ozTDRjVHNrUnpkckxKV3BhRnVBVDRHdC1fYk5BbWZLRjJlTmV2QUY4RzRjRHRBTjNtR0RCQ1l6eFpJQW1famJ6TmJDWmtZQXMxTnRqQVYzQ3NRb0k2NjJmcFZyRmxZSExRZVRZWkh4MmxjRlVhU0FvaXhGb2Z1bzNZQ2pzV1BaNWFveDl5Q0ZmcXM1ZlpuNmktRzc1TldGa0FVOUJpTDd1VW0zckxHdmhrQ3d5SnNTdWE5bUlNN3VsZGtKU21tUHFOcnY4NU8xaUdlZnNic01BOWxRcEhncG84cVE1OWQzVHJwcXJDdm8yaUdIQk4yTWJHU2JCcmNFSjdHcFo5Zy0xSng4V0ZOZUU2QmZvYzNlOWZIaWFKemstVUYzMGF2OENnUlZIal81NWRGTGlrTjNCZDNaVXRTa3U0aTQ4UTJnYjd3Q1RLTkNheXZpel9GanZDQVJFM043cnNyMUkyWS1UWm1vTUhVXy1nQ2xpeEZkeFZ5Vmc0RjRpSEtQQjFFTEhMaERPOVpOb3IwMm4xOXVjWERwRXg1akxjdVkteGYxYkRMMUwyRzN3TEVuOVY4bVBQRG9oUU5Oc25aUkgxVnE5eWtDRU1SOGlJZmlPbVJvbDR4WUVycDRUUUNfaFFaWEF3NHBPTEVCRkdPV2EyWVdnRHJZQ3VoUWFZNGN5NXE3aVJwNHVnNkRoSFBkV0VZQ3lQTkk0NWdpeEVlWHBfWkZHQnhaeEpER3hjU0pJc3BpMGtIUzY5bkZDbDNPT2VJSk5najRJRHdEbHRtTGNJWTVrSDQta3ZsV2x4eV84MHpRUlllNWoxMGJ0X3k5OWhReHBHYVhDbGJ1ZWkzZWYtM0JJMGpWNjlwWmxMbkVQSEFYUHhZbXZ2YjgzZVdJTW89', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}
2023-05-11 12:00:21,632 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-05-11 12:00:21,633 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-05-11 12:00:21,633 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmtYTHkxYzU0bXlQa1NfY0ZPZ3ozTDRjVHNrUnpkckxKV3BhRnVBVDRHdC1fYk5BbWZLRjJlTmV2QUY4RzRjRHRBTjNtR0RCQ1l6eFpJQW1famJ6TmJDWmtZQXMxTnRqQVYzQ3NRb0k2NjJmcFZyRmxZSExRZVRZWkh4MmxjRlVhU0FvaXhGb2Z1bzNZQ2pzV1BaNWFveDl5Q0ZmcXM1ZlpuNmktRzc1TldGa0FVOUJpTDd1VW0zckxHdmhrQ3d5SnNTdWE5bUlNN3VsZGtKU21tUHFOcnY4NU8xaUdlZnNic01BOWxRcEhncG84cVE1OWQzVHJwcXJDdm8yaUdIQk4yTWJHU2JCcmNFSjdHcFo5Zy0xSng4V0ZOZUU2QmZvYzNlOWZIaWFKemstVUYzMGF2OENnUlZIal81NWRGTGlrTjNCZDNaVXRTa3U0aTQ4UTJnYjd3Q1RLTkNheXZpel9GanZDQVJFM043cnNyMUkyWS1UWm1vTUhVXy1nQ2xpeEZkeFZ5Vmc0RjRpSEtQQjFFTEhMaERPOVpOb3IwMm4xOXVjWERwRXg1akxjdVkteGYxYkRMMUwyRzN3TEVuOVY4bVBQRG9oUU5Oc25aUkgxVnE5eWtDRU1SOGlJZmlPbVJvbDR4WUVycDRUUUNfaFFaWEF3NHBPTEVCRkdPV2EyWVdnRHJZQ3VoUWFZNGN5NXE3aVJwNHVnNkRoSFBkV0VZQ3lQTkk0NWdpeEVlWHBfWkZHQnhaeEpER3hjU0pJc3BpMGtIUzY5bkZDbDNPT2VJSk5najRJRHdEbHRtTGNJWTVrSDQta3ZsV2x4eV84MHpRUlllNWoxMGJ0X3k5OWhReHBHYVhDbGJ1ZWkzZWYtM0JJMGpWNjlwWmxMbkVQSEFYUHhZbXZ2YjgzZVdJTW89', 'state': 'eLvYHNxPj664Xcg1JEGKRVgfSOu7PxvR', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'provadiinserimento', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-05-11 12:00:21,633 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'provadiinserimento', 'state': 'eLvYHNxPj664Xcg1JEGKRVgfSOu7PxvR', 'code': 'Z0FBQUFBQmtYTHkxYzU0bXlQa1NfY0ZPZ3ozTDRjVHNrUnpkckxKV3BhRnVBVDRHdC1fYk5BbWZLRjJlTmV2QUY4RzRjRHRBTjNtR0RCQ1l6eFpJQW1famJ6TmJDWmtZQXMxTnRqQVYzQ3NRb0k2NjJmcFZyRmxZSExRZVRZWkh4MmxjRlVhU0FvaXhGb2Z1bzNZQ2pzV1BaNWFveDl5Q0ZmcXM1ZlpuNmktRzc1TldGa0FVOUJpTDd1VW0zckxHdmhrQ3d5SnNTdWE5bUlNN3VsZGtKU21tUHFOcnY4NU8xaUdlZnNic01BOWxRcEhncG84cVE1OWQzVHJwcXJDdm8yaUdIQk4yTWJHU2JCcmNFSjdHcFo5Zy0xSng4V0ZOZUU2QmZvYzNlOWZIaWFKemstVUYzMGF2OENnUlZIal81NWRGTGlrTjNCZDNaVXRTa3U0aTQ4UTJnYjd3Q1RLTkNheXZpel9GanZDQVJFM043cnNyMUkyWS1UWm1vTUhVXy1nQ2xpeEZkeFZ5Vmc0RjRpSEtQQjFFTEhMaERPOVpOb3IwMm4xOXVjWERwRXg1akxjdVkteGYxYkRMMUwyRzN3TEVuOVY4bVBQRG9oUU5Oc25aUkgxVnE5eWtDRU1SOGlJZmlPbVJvbDR4WUVycDRUUUNfaFFaWEF3NHBPTEVCRkdPV2EyWVdnRHJZQ3VoUWFZNGN5NXE3aVJwNHVnNkRoSFBkV0VZQ3lQTkk0NWdpeEVlWHBfWkZHQnhaeEpER3hjU0pJc3BpMGtIUzY5bkZDbDNPT2VJSk5najRJRHdEbHRtTGNJWTVrSDQta3ZsV2x4eV84MHpRUlllNWoxMGJ0X3k5OWhReHBHYVhDbGJ1ZWkzZWYtM0JJMGpWNjlwWmxMbkVQSEFYUHhZbXZ2YjgzZVdJTW89', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'b6EO38TBntMOwSTDIAI3a6Lx8NckDYQcU6bfCmxIiOi3tL58VD1rmj7rkPWg1Dw5'}
2023-05-11 12:00:21,634 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-05-11 12:00:21,634 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7fa01c69c700>, 'url': 'https://sso.isprambiente.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=eLvYHNxPj664Xcg1JEGKRVgfSOu7PxvR&code=Z0FBQUFBQmtYTHkxYzU0bXlQa1NfY0ZPZ3ozTDRjVHNrUnpkckxKV3BhRnVBVDRHdC1fYk5BbWZLRjJlTmV2QUY4RzRjRHRBTjNtR0RCQ1l6eFpJQW1famJ6TmJDWmtZQXMxTnRqQVYzQ3NRb0k2NjJmcFZyRmxZSExRZVRZWkh4MmxjRlVhU0FvaXhGb2Z1bzNZQ2pzV1BaNWFveDl5Q0ZmcXM1ZlpuNmktRzc1TldGa0FVOUJpTDd1VW0zckxHdmhrQ3d5SnNTdWE5bUlNN3VsZGtKU21tUHFOcnY4NU8xaUdlZnNic01BOWxRcEhncG84cVE1OWQzVHJwcXJDdm8yaUdIQk4yTWJHU2JCcmNFSjdHcFo5Zy0xSng4V0ZOZUU2QmZvYzNlOWZIaWFKemstVUYzMGF2OENnUlZIal81NWRGTGlrTjNCZDNaVXRTa3U0aTQ4UTJnYjd3Q1RLTkNheXZpel9GanZDQVJFM043cnNyMUkyWS1UWm1vTUhVXy1nQ2xpeEZkeFZ5Vmc0RjRpSEtQQjFFTEhMaERPOVpOb3IwMm4xOXVjWERwRXg1akxjdVkteGYxYkRMMUwyRzN3TEVuOVY4bVBQRG9oUU5Oc25aUkgxVnE5eWtDRU1SOGlJZmlPbVJvbDR4WUVycDRUUUNfaFFaWEF3NHBPTEVCRkdPV2EyWVdnRHJZQ3VoUWFZNGN5NXE3aVJwNHVnNkRoSFBkV0VZQ3lQTkk0NWdpeEVlWHBfWkZHQnhaeEpER3hjU0pJc3BpMGtIUzY5bkZDbDNPT2VJSk5najRJRHdEbHRtTGNJWTVrSDQta3ZsV2x4eV84MHpRUlllNWoxMGJ0X3k5OWhReHBHYVhDbGJ1ZWkzZWYtM0JJMGpWNjlwWmxMbkVQSEFYUHhZbXZ2YjgzZVdJTW89&code_verifier=b6EO38TBntMOwSTDIAI3a6Lx8NckDYQcU6bfCmxIiOi3tL58VD1rmj7rkPWg1Dw5', 'headers': {'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-05-11 12:00:21,634 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=eLvYHNxPj664Xcg1JEGKRVgfSOu7PxvR&code=Z0FBQUFBQmtYTHkxYzU0bXlQa1NfY0ZPZ3ozTDRjVHNrUnpkckxKV3BhRnVBVDRHdC1fYk5BbWZLRjJlTmV2QUY4RzRjRHRBTjNtR0RCQ1l6eFpJQW1famJ6TmJDWmtZQXMxTnRqQVYzQ3NRb0k2NjJmcFZyRmxZSExRZVRZWkh4MmxjRlVhU0FvaXhGb2Z1bzNZQ2pzV1BaNWFveDl5Q0ZmcXM1ZlpuNmktRzc1TldGa0FVOUJpTDd1VW0zckxHdmhrQ3d5SnNTdWE5bUlNN3VsZGtKU21tUHFOcnY4NU8xaUdlZnNic01BOWxRcEhncG84cVE1OWQzVHJwcXJDdm8yaUdIQk4yTWJHU2JCcmNFSjdHcFo5Zy0xSng4V0ZOZUU2QmZvYzNlOWZIaWFKemstVUYzMGF2OENnUlZIal81NWRGTGlrTjNCZDNaVXRTa3U0aTQ4UTJnYjd3Q1RLTkNheXZpel9GanZDQVJFM043cnNyMUkyWS1UWm1vTUhVXy1nQ2xpeEZkeFZ5Vmc0RjRpSEtQQjFFTEhMaERPOVpOb3IwMm4xOXVjWERwRXg1akxjdVkteGYxYkRMMUwyRzN3TEVuOVY4bVBQRG9oUU5Oc25aUkgxVnE5eWtDRU1SOGlJZmlPbVJvbDR4WUVycDRUUUNfaFFaWEF3NHBPTEVCRkdPV2EyWVdnRHJZQ3VoUWFZNGN5NXE3aVJwNHVnNkRoSFBkV0VZQ3lQTkk0NWdpeEVlWHBfWkZHQnhaeEpER3hjU0pJc3BpMGtIUzY5bkZDbDNPT2VJSk5najRJRHdEbHRtTGNJWTVrSDQta3ZsV2x4eV84MHpRUlllNWoxMGJ0X3k5OWhReHBHYVhDbGJ1ZWkzZWYtM0JJMGpWNjlwWmxMbkVQSEFYUHhZbXZ2YjgzZVdJTW89&code_verifier=b6EO38TBntMOwSTDIAI3a6Lx8NckDYQcU6bfCmxIiOi3tL58VD1rmj7rkPWg1Dw5, https_args:{'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-05-11 12:00:21,634 oidcrp.http DEBUG SENT 1 COOKIES
2023-05-11 12:00:21,636 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-05-11 12:00:21,777 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-05-11 12:00:21,778 oidcrp.http DEBUG RECEIVED COOKIE
2023-05-11 12:00:21,779 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-05-11 12:00:21,779 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.24.0', 'Date': 'Thu, 11 May 2023 10:00:21 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'ISPRA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddADMQSMb6bjUC5s9gPfeR_JaU0rwIRuGRwl57OpmF_uTQTsDUi4UHUGW-cRHpAbjPnfo-pA913WvNLVYmGfraXb3ZtymrcGrqxgbMDUrCDirUud2oOybNyOO6scQnev1W8Fs9iQn-A5L7OEaaCPyexBFEY2iyEvADPfS2MlN05NtgnACBxprcYCs_L7GERTWTnoqU1oVJsuieIgh5fulw4NgDy0kaJF3TBu_30f4kEuW9cyWfE5lcgAAAjTUYRmhRBLEAAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; HttpOnly; Max-Age=600; Path=/; SameSite=None; Secure', 'Strict-Transport-Security': 'max-age=63072000; ', 'X-Frame-Options': 'DENY'}
2023-05-11 12:00:21,779 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile email offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6ImRVczBkek5aZEV4S00xaEpUaTFYYTFoaFFUVmxSRXhqY1RSdlltRmtUR2hvVkVWdFlXeFlZbXBrZHcifQ.eyJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAiZW1haWwiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImF1ZCI6IFsicHJvdmFkaWluc2VyaW1lbnRvIl0sICJqdGkiOiAiYTQ1NGE0MzdlZmUyMTFlZGFiYTNjMTYwOGM3YTRmYWIiLCAiY2xpZW50X2lkIjogInByb3ZhZGlpbnNlcmltZW50byIsICJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXRZVEhreE5WZEJRM056UjNGVVpFUXhhV052VDNwNVNXOXliMlZzUjNCMWJVaG5VV3REVjB0YU1rUnJTVEpWWm05MmIyOXFhRjlyTUdsMVl6QmhXRjlNVjFSa05IUkdTVmg0VDA1TlRGVk5XbFV4ZWpOcFRHRmlTR1J2UVZCRlgzWkNjbEZIU2pOM1FscG9TemR0VVVOUlRYZFlPREpOUkc5cFVYZFViVFo0U0hveVdGZEdjSFZ2TTBOdk5sUnljbEUyVkROdVVXazFTbmt0VWtka1ZVNVFOVzlxYUdaSFNtTkpkMEpNYjJNMk0zaHNUMU5uVjBob2RWWXlVbEJ4Wm5kUVdXNHllRE4zVG5jdE1tRjVhbWczTVc5TVRYVlFVWGN0U0d3M2F5MXVhVE5RUkVKcFZFTm9USFpsTVZwYVlUWnJWRjh4Wm0wemNsSkRSbkp4WmpSMFkydzRPQT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9zc28uaXNwcmFtYmllbnRlLml0IiwgImlhdCI6IDE2ODM3OTkyMjEsICJleHAiOiAxNjgzODAyODIxfQ.njYXIU2KycEpxW8TvpzQPVjSnd2u7yYNb7xYygp3AcOjt82aPC8PHcq_9HA1oW79S5yjfBjVX9Vlf2dwsGgtRg", "expires_in": 1800, "refresh_token": "Z0FBQUFBQmtYTHkxS1lINlpvUXRNRzd1LV9pdkRUSTZWbHpSWGtfYmxfNjBxVnl1amI4TFVsXzdjdHdDLXp6ZUZ3dXAzY2FRRV9seTFzY3lQc1BpNG5sWGtMZm1mYTJiRXBZRzhjdnV5c0djV0ZzWF9YSHdLZlAxQkVrUHYzUk81ZUxDU0Q5ZFNOQUhWLUVFaFp3UXZGcks2eWNCVllncjBVZkVDY1hWYVRoY1p2Tm8ybTRUOTN1b2NjMmM4YTVSQ1gwdW5FRHBUT0NtaWNRVHUyMWthTmVnU3RIMmRlcUFrM2lfaDdxMGgteWdhbmxGNnBsTkZtd1dHalpVMWl3dVQ5VlRzbjBFU3NPb2pIZ2x2SERLc3FKTy02VzdiNGIyaTNNNzBZN2dwdnZUa3ZJNl9FNTlaY19KUXIyY1FIVkxaVHBDRG9fT0xHOEtLTnFjdG9XLVhNQl90X1BqLUJPYzBORzNVUmNvVjlSTTR5OS1nTjBGQ0VFemx5OVprY1JkVXZMa2s2cDB5VjRYczkwZk1ReGFoR0ptR1JWZjJaUE11NmgyeUoyeFdaQnA1aHNWMlBPd1o0S3lzX2o2STJlbVNhY0F4NnRtTUhEbDB2RW5GMXk1dGRuRzlhTnhMOThTZ2lVNzRFMVpucjNfSU9iZjZVbVRQa21rOXIwNTkwY3NWQ1FleDNuczhVZTJWNGZPeXhFaFpsTDEzUzV4VVRUY3NkWllRM3NHOGVlZkF0T3NBYjN3c2sycUlaNngzZW03N09FeU00RXpkeUZKVjJZOFpHSUYwZ01DU2RGcXNOLUt0d3B2c0FXaVFwNjliMlEtLVdqVTlvbXZ4UktjRnJfMksyb3FtMXNVVEdGSk04MTZURU1zYkhaNnBwNXR5SjdERGlPeG9VYWxUdm9FOVZSNXZiTzFudUE9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImVtZ3pUbTFYYWtRd2QyOUlkR2hKWlZCWVEyZHNXVFp2WlhoRlgzYzJVMmxGTlVNeFNWRnFSamxvWncifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXRZVEhreE5WZEJRM056UjNGVVpFUXhhV052VDNwNVNXOXliMlZzUjNCMWJVaG5VV3REVjB0YU1rUnJTVEpWWm05MmIyOXFhRjlyTUdsMVl6QmhXRjlNVjFSa05IUkdTVmg0VDA1TlRGVk5XbFV4ZWpOcFRHRmlTR1J2UVZCRlgzWkNjbEZIU2pOM1FscG9TemR0VVVOUlRYZFlPREpOUkc5cFVYZFViVFo0U0hveVdGZEdjSFZ2TTBOdk5sUnljbEUyVkROdVVXazFTbmt0VWtka1ZVNVFOVzlxYUdaSFNtTkpkMEpNYjJNMk0zaHNUMU5uVjBob2RWWXlVbEJ4Wm5kUVdXNHllRE4zVG5jdE1tRjVhbWczTVc5TVRYVlFVWGN0U0d3M2F5MXVhVE5RUkVKcFZFTm9USFpsTVZwYVlUWnJWRjh4Wm0wemNsSkRSbkp4WmpSMFkydzRPQT09IiwgImF1dGhfdGltZSI6IDE2ODM3OTkyMjEsICJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAiZW1haWwiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImp0aSI6ICJhNDU0YTQzYmVmZTIxMWVkYWJhM2MxNjA4YzdhNGZhYiIsICJjbGllbnRfaWQiOiAicHJvdmFkaWluc2VyaW1lbnRvIiwgIm5vbmNlIjogIjBJSE1BNjI1dUF3dnZDd01ZMncyZXZrMiIsICJpc3MiOiAiaHR0cHM6Ly9zc28uaXNwcmFtYmllbnRlLml0IiwgImlhdCI6IDE2ODM3OTkyMjEsICJleHAiOiAxNjgzNzk5NTIxLCAiYXVkIjogWyJwcm92YWRpaW5zZXJpbWVudG8iXX0.n-x9caAqW8dow4yZtHVPWNOqZNcHF7rifSXk_TUQ5wzHtrRLQTFi4EPe0v5wYrFFexSW10QKYeIWwMTRTiQ1gQOD2t0maLnx2c1kMsvGYWIvCftPyZquMVAoVDTIerUVYQVzrxuoXn3LpGsL5w7WM-FNFtXRMtINQu3bJGyT3bwZfAB9OpD4fOHu9-WCf7XV-86CSRnR4CzpRaL8jupUH-MTfPPbN6CuCn_rKSeKOHJJNad8MvWbcZpuWvDUx-kYA6dqZuK1voGG0X0h6Dm3d3Jl_5XLIOL4SffNr4jvbqJIbzSaplvMDqaoW6V28Z-DmhPbXtx88UFBp2DsP3JJhw"}
2023-05-11 12:00:21,779 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile email offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6ImRVczBkek5aZEV4S00xaEpUaTFYYTFoaFFUVmxSRXhqY1RSdlltRmtUR2hvVkVWdFlXeFlZbXBrZHcifQ.eyJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAiZW1haWwiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImF1ZCI6IFsicHJvdmFkaWluc2VyaW1lbnRvIl0sICJqdGkiOiAiYTQ1NGE0MzdlZmUyMTFlZGFiYTNjMTYwOGM3YTRmYWIiLCAiY2xpZW50X2lkIjogInByb3ZhZGlpbnNlcmltZW50byIsICJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXRZVEhreE5WZEJRM056UjNGVVpFUXhhV052VDNwNVNXOXliMlZzUjNCMWJVaG5VV3REVjB0YU1rUnJTVEpWWm05MmIyOXFhRjlyTUdsMVl6QmhXRjlNVjFSa05IUkdTVmg0VDA1TlRGVk5XbFV4ZWpOcFRHRmlTR1J2UVZCRlgzWkNjbEZIU2pOM1FscG9TemR0VVVOUlRYZFlPREpOUkc5cFVYZFViVFo0U0hveVdGZEdjSFZ2TTBOdk5sUnljbEUyVkROdVVXazFTbmt0VWtka1ZVNVFOVzlxYUdaSFNtTkpkMEpNYjJNMk0zaHNUMU5uVjBob2RWWXlVbEJ4Wm5kUVdXNHllRE4zVG5jdE1tRjVhbWczTVc5TVRYVlFVWGN0U0d3M2F5MXVhVE5RUkVKcFZFTm9USFpsTVZwYVlUWnJWRjh4Wm0wemNsSkRSbkp4WmpSMFkydzRPQT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9zc28uaXNwcmFtYmllbnRlLml0IiwgImlhdCI6IDE2ODM3OTkyMjEsICJleHAiOiAxNjgzODAyODIxfQ.njYXIU2KycEpxW8TvpzQPVjSnd2u7yYNb7xYygp3AcOjt82aPC8PHcq_9HA1oW79S5yjfBjVX9Vlf2dwsGgtRg", "expires_in": 1800, "refresh_token": "Z0FBQUFBQmtYTHkxS1lINlpvUXRNRzd1LV9pdkRUSTZWbHpSWGtfYmxfNjBxVnl1amI4TFVsXzdjdHdDLXp6ZUZ3dXAzY2FRRV9seTFzY3lQc1BpNG5sWGtMZm1mYTJiRXBZRzhjdnV5c0djV0ZzWF9YSHdLZlAxQkVrUHYzUk81ZUxDU0Q5ZFNOQUhWLUVFaFp3UXZGcks2eWNCVllncjBVZkVDY1hWYVRoY1p2Tm8ybTRUOTN1b2NjMmM4YTVSQ1gwdW5FRHBUT0NtaWNRVHUyMWthTmVnU3RIMmRlcUFrM2lfaDdxMGgteWdhbmxGNnBsTkZtd1dHalpVMWl3dVQ5VlRzbjBFU3NPb2pIZ2x2SERLc3FKTy02VzdiNGIyaTNNNzBZN2dwdnZUa3ZJNl9FNTlaY19KUXIyY1FIVkxaVHBDRG9fT0xHOEtLTnFjdG9XLVhNQl90X1BqLUJPYzBORzNVUmNvVjlSTTR5OS1nTjBGQ0VFemx5OVprY1JkVXZMa2s2cDB5VjRYczkwZk1ReGFoR0ptR1JWZjJaUE11NmgyeUoyeFdaQnA1aHNWMlBPd1o0S3lzX2o2STJlbVNhY0F4NnRtTUhEbDB2RW5GMXk1dGRuRzlhTnhMOThTZ2lVNzRFMVpucjNfSU9iZjZVbVRQa21rOXIwNTkwY3NWQ1FleDNuczhVZTJWNGZPeXhFaFpsTDEzUzV4VVRUY3NkWllRM3NHOGVlZkF0T3NBYjN3c2sycUlaNngzZW03N09FeU00RXpkeUZKVjJZOFpHSUYwZ01DU2RGcXNOLUt0d3B2c0FXaVFwNjliMlEtLVdqVTlvbXZ4UktjRnJfMksyb3FtMXNVVEdGSk04MTZURU1zYkhaNnBwNXR5SjdERGlPeG9VYWxUdm9FOVZSNXZiTzFudUE9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImVtZ3pUbTFYYWtRd2QyOUlkR2hKWlZCWVEyZHNXVFp2WlhoRlgzYzJVMmxGTlVNeFNWRnFSamxvWncifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXRZVEhreE5WZEJRM056UjNGVVpFUXhhV052VDNwNVNXOXliMlZzUjNCMWJVaG5VV3REVjB0YU1rUnJTVEpWWm05MmIyOXFhRjlyTUdsMVl6QmhXRjlNVjFSa05IUkdTVmg0VDA1TlRGVk5XbFV4ZWpOcFRHRmlTR1J2UVZCRlgzWkNjbEZIU2pOM1FscG9TemR0VVVOUlRYZFlPREpOUkc5cFVYZFViVFo0U0hveVdGZEdjSFZ2TTBOdk5sUnljbEUyVkROdVVXazFTbmt0VWtka1ZVNVFOVzlxYUdaSFNtTkpkMEpNYjJNMk0zaHNUMU5uVjBob2RWWXlVbEJ4Wm5kUVdXNHllRE4zVG5jdE1tRjVhbWczTVc5TVRYVlFVWGN0U0d3M2F5MXVhVE5RUkVKcFZFTm9USFpsTVZwYVlUWnJWRjh4Wm0wemNsSkRSbkp4WmpSMFkydzRPQT09IiwgImF1dGhfdGltZSI6IDE2ODM3OTkyMjEsICJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAiZW1haWwiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImp0aSI6ICJhNDU0YTQzYmVmZTIxMWVkYWJhM2MxNjA4YzdhNGZhYiIsICJjbGllbnRfaWQiOiAicHJvdmFkaWluc2VyaW1lbnRvIiwgIm5vbmNlIjogIjBJSE1BNjI1dUF3dnZDd01ZMncyZXZrMiIsICJpc3MiOiAiaHR0cHM6Ly9zc28uaXNwcmFtYmllbnRlLml0IiwgImlhdCI6IDE2ODM3OTkyMjEsICJleHAiOiAxNjgzNzk5NTIxLCAiYXVkIjogWyJwcm92YWRpaW5zZXJpbWVudG8iXX0.n-x9caAqW8dow4yZtHVPWNOqZNcHF7rifSXk_TUQ5wzHtrRLQTFi4EPe0v5wYrFFexSW10QKYeIWwMTRTiQ1gQOD2t0maLnx2c1kMsvGYWIvCftPyZquMVAoVDTIerUVYQVzrxuoXn3LpGsL5w7WM-FNFtXRMtINQu3bJGyT3bwZfAB9OpD4fOHu9-WCf7XV-86CSRnR4CzpRaL8jupUH-MTfPPbN6CuCn_rKSeKOHJJNad8MvWbcZpuWvDUx-kYA6dqZuK1voGG0X0h6Dm3d3Jl_5XLIOL4SffNr4jvbqJIbzSaplvMDqaoW6V28Z-DmhPbXtx88UFBp2DsP3JJhw"}
2023-05-11 12:00:21,779 oidcrp.service DEBUG response format: json
2023-05-11 12:00:21,779 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-05-11 12:00:21,780 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile email offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6ImRVczBkek5aZEV4S00xaEpUaTFYYTFoaFFUVmxSRXhqY1RSdlltRmtUR2hvVkVWdFlXeFlZbXBrZHcifQ.eyJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAiZW1haWwiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImF1ZCI6IFsicHJvdmFkaWluc2VyaW1lbnRvIl0sICJqdGkiOiAiYTQ1NGE0MzdlZmUyMTFlZGFiYTNjMTYwOGM3YTRmYWIiLCAiY2xpZW50X2lkIjogInByb3ZhZGlpbnNlcmltZW50byIsICJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXRZVEhreE5WZEJRM056UjNGVVpFUXhhV052VDNwNVNXOXliMlZzUjNCMWJVaG5VV3REVjB0YU1rUnJTVEpWWm05MmIyOXFhRjlyTUdsMVl6QmhXRjlNVjFSa05IUkdTVmg0VDA1TlRGVk5XbFV4ZWpOcFRHRmlTR1J2UVZCRlgzWkNjbEZIU2pOM1FscG9TemR0VVVOUlRYZFlPREpOUkc5cFVYZFViVFo0U0hveVdGZEdjSFZ2TTBOdk5sUnljbEUyVkROdVVXazFTbmt0VWtka1ZVNVFOVzlxYUdaSFNtTkpkMEpNYjJNMk0zaHNUMU5uVjBob2RWWXlVbEJ4Wm5kUVdXNHllRE4zVG5jdE1tRjVhbWczTVc5TVRYVlFVWGN0U0d3M2F5MXVhVE5RUkVKcFZFTm9USFpsTVZwYVlUWnJWRjh4Wm0wemNsSkRSbkp4WmpSMFkydzRPQT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9zc28uaXNwcmFtYmllbnRlLml0IiwgImlhdCI6IDE2ODM3OTkyMjEsICJleHAiOiAxNjgzODAyODIxfQ.njYXIU2KycEpxW8TvpzQPVjSnd2u7yYNb7xYygp3AcOjt82aPC8PHcq_9HA1oW79S5yjfBjVX9Vlf2dwsGgtRg', 'expires_in': 1800, 'refresh_token': 'Z0FBQUFBQmtYTHkxS1lINlpvUXRNRzd1LV9pdkRUSTZWbHpSWGtfYmxfNjBxVnl1amI4TFVsXzdjdHdDLXp6ZUZ3dXAzY2FRRV9seTFzY3lQc1BpNG5sWGtMZm1mYTJiRXBZRzhjdnV5c0djV0ZzWF9YSHdLZlAxQkVrUHYzUk81ZUxDU0Q5ZFNOQUhWLUVFaFp3UXZGcks2eWNCVllncjBVZkVDY1hWYVRoY1p2Tm8ybTRUOTN1b2NjMmM4YTVSQ1gwdW5FRHBUT0NtaWNRVHUyMWthTmVnU3RIMmRlcUFrM2lfaDdxMGgteWdhbmxGNnBsTkZtd1dHalpVMWl3dVQ5VlRzbjBFU3NPb2pIZ2x2SERLc3FKTy02VzdiNGIyaTNNNzBZN2dwdnZUa3ZJNl9FNTlaY19KUXIyY1FIVkxaVHBDRG9fT0xHOEtLTnFjdG9XLVhNQl90X1BqLUJPYzBORzNVUmNvVjlSTTR5OS1nTjBGQ0VFemx5OVprY1JkVXZMa2s2cDB5VjRYczkwZk1ReGFoR0ptR1JWZjJaUE11NmgyeUoyeFdaQnA1aHNWMlBPd1o0S3lzX2o2STJlbVNhY0F4NnRtTUhEbDB2RW5GMXk1dGRuRzlhTnhMOThTZ2lVNzRFMVpucjNfSU9iZjZVbVRQa21rOXIwNTkwY3NWQ1FleDNuczhVZTJWNGZPeXhFaFpsTDEzUzV4VVRUY3NkWllRM3NHOGVlZkF0T3NBYjN3c2sycUlaNngzZW03N09FeU00RXpkeUZKVjJZOFpHSUYwZ01DU2RGcXNOLUt0d3B2c0FXaVFwNjliMlEtLVdqVTlvbXZ4UktjRnJfMksyb3FtMXNVVEdGSk04MTZURU1zYkhaNnBwNXR5SjdERGlPeG9VYWxUdm9FOVZSNXZiTzFudUE9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6ImVtZ3pUbTFYYWtRd2QyOUlkR2hKWlZCWVEyZHNXVFp2WlhoRlgzYzJVMmxGTlVNeFNWRnFSamxvWncifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXRZVEhreE5WZEJRM056UjNGVVpFUXhhV052VDNwNVNXOXliMlZzUjNCMWJVaG5VV3REVjB0YU1rUnJTVEpWWm05MmIyOXFhRjlyTUdsMVl6QmhXRjlNVjFSa05IUkdTVmg0VDA1TlRGVk5XbFV4ZWpOcFRHRmlTR1J2UVZCRlgzWkNjbEZIU2pOM1FscG9TemR0VVVOUlRYZFlPREpOUkc5cFVYZFViVFo0U0hveVdGZEdjSFZ2TTBOdk5sUnljbEUyVkROdVVXazFTbmt0VWtka1ZVNVFOVzlxYUdaSFNtTkpkMEpNYjJNMk0zaHNUMU5uVjBob2RWWXlVbEJ4Wm5kUVdXNHllRE4zVG5jdE1tRjVhbWczTVc5TVRYVlFVWGN0U0d3M2F5MXVhVE5RUkVKcFZFTm9USFpsTVZwYVlUWnJWRjh4Wm0wemNsSkRSbkp4WmpSMFkydzRPQT09IiwgImF1dGhfdGltZSI6IDE2ODM3OTkyMjEsICJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAiZW1haWwiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImp0aSI6ICJhNDU0YTQzYmVmZTIxMWVkYWJhM2MxNjA4YzdhNGZhYiIsICJjbGllbnRfaWQiOiAicHJvdmFkaWluc2VyaW1lbnRvIiwgIm5vbmNlIjogIjBJSE1BNjI1dUF3dnZDd01ZMncyZXZrMiIsICJpc3MiOiAiaHR0cHM6Ly9zc28uaXNwcmFtYmllbnRlLml0IiwgImlhdCI6IDE2ODM3OTkyMjEsICJleHAiOiAxNjgzNzk5NTIxLCAiYXVkIjogWyJwcm92YWRpaW5zZXJpbWVudG8iXX0.n-x9caAqW8dow4yZtHVPWNOqZNcHF7rifSXk_TUQ5wzHtrRLQTFi4EPe0v5wYrFFexSW10QKYeIWwMTRTiQ1gQOD2t0maLnx2c1kMsvGYWIvCftPyZquMVAoVDTIerUVYQVzrxuoXn3LpGsL5w7WM-FNFtXRMtINQu3bJGyT3bwZfAB9OpD4fOHu9-WCf7XV-86CSRnR4CzpRaL8jupUH-MTfPPbN6CuCn_rKSeKOHJJNad8MvWbcZpuWvDUx-kYA6dqZuK1voGG0X0h6Dm3d3Jl_5XLIOL4SffNr4jvbqJIbzSaplvMDqaoW6V28Z-DmhPbXtx88UFBp2DsP3JJhw'}"
2023-05-11 12:00:21,780 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15}
2023-05-11 12:00:21,781 oidcmsg.message DEBUG Raw JSON: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmtYTHkxNVdBQ3NzR3FUZEQxaWNvT3p5SW9yb2VsR3B1bUhnUWtDV0taMkRrSTJVZm92b29qaF9rMGl1YzBhWF9MV1RkNHRGSVh4T05NTFVNWlUxejNpTGFiSGRvQVBFX3ZCclFHSjN3QlpoSzdtUUNRTXdYODJNRG9pUXdUbTZ4SHoyWFdGcHVvM0NvNlRyclE2VDNuUWk1SnktUkdkVU5QNW9qaGZHSmNJd0JMb2M2M3hsT1NnV0hodVYyUlBxZndQWW4yeDN3TnctMmF5amg3MW9MTXVQUXctSGw3ay1uaTNQREJpVENoTHZlMVpaYTZrVF8xZm0zclJDRnJxZjR0Y2w4OA==', 'auth_time': 1683799221, 'scope': ['openid', 'profile', 'email', 'offline_access'], 'jti': 'a454a43befe211edaba3c1608c7a4fab', 'client_id': 'provadiinserimento', 'nonce': '0IHMA625uAwvvCwMY2w2evk2', 'iss': 'https://sso.isprambiente.it', 'iat': 1683799221, 'exp': 1683799521, 'aud': ['provadiinserimento']}
2023-05-11 12:00:21,781 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'emgzTm1XakQwd29IdGhJZVBYQ2dsWTZvZXhFX3c2U2lFNUMxSVFqRjloZw'}
2023-05-11 12:00:21,781 cryptojwt.key_jar DEBUG Key summary for https://sso.isprambiente.it: RSA:sig:emgzTm1XakQwd29IdGhJZVBYQ2dsWTZvZXhFX3c2U2lFNUMxSVFqRjloZw, EC:sig:dUs0dzNZdExKM1hJTi1Xa1hhQTVlRExjcTRvYmFkTGhoVEVtYWxYYmpkdw
2023-05-11 12:00:21,781 oidcmsg.message DEBUG Found signing key.
2023-05-11 12:00:21,782 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-05-11 12:00:21,782 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=emgzTm1XakQwd29IdGhJZVBYQ2dsWTZvZXhFX3c2U2lFNUMxSVFqRjloZw and use=
2023-05-11 12:00:21,782 cryptojwt.jwx DEBUG Picked: kid:emgzTm1XakQwd29IdGhJZVBYQ2dsWTZvZXhFX3c2U2lFNUMxSVFqRjloZw, use:sig, kty:RSA
2023-05-11 12:00:21,783 cryptojwt.jws.jws DEBUG Verified message using key with kid=emgzTm1XakQwd29IdGhJZVBYQ2dsWTZvZXhFX3c2U2lFNUMxSVFqRjloZw
2023-05-11 12:00:21,783 oidcmsg.oidc INFO Verified id_token: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmtYTHkxNVdBQ3NzR3FUZEQxaWNvT3p5SW9yb2VsR3B1bUhnUWtDV0taMkRrSTJVZm92b29qaF9rMGl1YzBhWF9MV1RkNHRGSVh4T05NTFVNWlUxejNpTGFiSGRvQVBFX3ZCclFHSjN3QlpoSzdtUUNRTXdYODJNRG9pUXdUbTZ4SHoyWFdGcHVvM0NvNlRyclE2VDNuUWk1SnktUkdkVU5QNW9qaGZHSmNJd0JMb2M2M3hsT1NnV0hodVYyUlBxZndQWW4yeDN3TnctMmF5amg3MW9MTXVQUXctSGw3ay1uaTNQREJpVENoTHZlMVpaYTZrVF8xZm0zclJDRnJxZjR0Y2w4OA==', 'auth_time': 1683799221, 'scope': ['openid', 'profile', 'email', 'offline_access'], 'jti': 'a454a43befe211edaba3c1608c7a4fab', 'client_id': 'provadiinserimento', 'nonce': '0IHMA625uAwvvCwMY2w2evk2', 'iss': 'https://sso.isprambiente.it', 'iat': 1683799221, 'exp': 1683799521, 'aud': ['provadiinserimento']}
2023-05-11 12:00:21,786 oidcrp.rp_handler DEBUG ID Token: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmtYTHkxNVdBQ3NzR3FUZEQxaWNvT3p5SW9yb2VsR3B1bUhnUWtDV0taMkRrSTJVZm92b29qaF9rMGl1YzBhWF9MV1RkNHRGSVh4T05NTFVNWlUxejNpTGFiSGRvQVBFX3ZCclFHSjN3QlpoSzdtUUNRTXdYODJNRG9pUXdUbTZ4SHoyWFdGcHVvM0NvNlRyclE2VDNuUWk1SnktUkdkVU5QNW9qaGZHSmNJd0JMb2M2M3hsT1NnV0hodVYyUlBxZndQWW4yeDN3TnctMmF5amg3MW9MTXVQUXctSGw3ay1uaTNQREJpVENoTHZlMVpaYTZrVF8xZm0zclJDRnJxZjR0Y2w4OA==', 'auth_time': 1683799221, 'scope': ['openid', 'profile', 'email', 'offline_access'], 'jti': 'a454a43befe211edaba3c1608c7a4fab', 'client_id': 'provadiinserimento', 'nonce': '0IHMA625uAwvvCwMY2w2evk2', 'iss': 'https://sso.isprambiente.it', 'iat': 1683799221, 'exp': 1683799521, 'aud': ['provadiinserimento']}
2023-05-11 12:00:21,786 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-05-11 12:00:21,786 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6ImRVczBkek5aZEV4S00xaEpUaTFYYTFoaFFUVmxSRXhqY1RSdlltRmtUR2hvVkVWdFlXeFlZbXBrZHcifQ.eyJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAiZW1haWwiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImF1ZCI6IFsicHJvdmFkaWluc2VyaW1lbnRvIl0sICJqdGkiOiAiYTQ1NGE0MzdlZmUyMTFlZGFiYTNjMTYwOGM3YTRmYWIiLCAiY2xpZW50X2lkIjogInByb3ZhZGlpbnNlcmltZW50byIsICJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXRZVEhreE5WZEJRM056UjNGVVpFUXhhV052VDNwNVNXOXliMlZzUjNCMWJVaG5VV3REVjB0YU1rUnJTVEpWWm05MmIyOXFhRjlyTUdsMVl6QmhXRjlNVjFSa05IUkdTVmg0VDA1TlRGVk5XbFV4ZWpOcFRHRmlTR1J2UVZCRlgzWkNjbEZIU2pOM1FscG9TemR0VVVOUlRYZFlPREpOUkc5cFVYZFViVFo0U0hveVdGZEdjSFZ2TTBOdk5sUnljbEUyVkROdVVXazFTbmt0VWtka1ZVNVFOVzlxYUdaSFNtTkpkMEpNYjJNMk0zaHNUMU5uVjBob2RWWXlVbEJ4Wm5kUVdXNHllRE4zVG5jdE1tRjVhbWczTVc5TVRYVlFVWGN0U0d3M2F5MXVhVE5RUkVKcFZFTm9USFpsTVZwYVlUWnJWRjh4Wm0wemNsSkRSbkp4WmpSMFkydzRPQT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9zc28uaXNwcmFtYmllbnRlLml0IiwgImlhdCI6IDE2ODM3OTkyMjEsICJleHAiOiAxNjgzODAyODIxfQ.njYXIU2KycEpxW8TvpzQPVjSnd2u7yYNb7xYygp3AcOjt82aPC8PHcq_9HA1oW79S5yjfBjVX9Vlf2dwsGgtRg'}
2023-05-11 12:00:21,786 oidcrp.service DEBUG Client authn method: bearer_header
2023-05-11 12:00:21,786 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7fa01c7ab2b0>, 'url': 'https://sso.isprambiente.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6ImRVczBkek5aZEV4S00xaEpUaTFYYTFoaFFUVmxSRXhqY1RSdlltRmtUR2hvVkVWdFlXeFlZbXBrZHcifQ.eyJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAiZW1haWwiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImF1ZCI6IFsicHJvdmFkaWluc2VyaW1lbnRvIl0sICJqdGkiOiAiYTQ1NGE0MzdlZmUyMTFlZGFiYTNjMTYwOGM3YTRmYWIiLCAiY2xpZW50X2lkIjogInByb3ZhZGlpbnNlcmltZW50byIsICJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXRZVEhreE5WZEJRM056UjNGVVpFUXhhV052VDNwNVNXOXliMlZzUjNCMWJVaG5VV3REVjB0YU1rUnJTVEpWWm05MmIyOXFhRjlyTUdsMVl6QmhXRjlNVjFSa05IUkdTVmg0VDA1TlRGVk5XbFV4ZWpOcFRHRmlTR1J2UVZCRlgzWkNjbEZIU2pOM1FscG9TemR0VVVOUlRYZFlPREpOUkc5cFVYZFViVFo0U0hveVdGZEdjSFZ2TTBOdk5sUnljbEUyVkROdVVXazFTbmt0VWtka1ZVNVFOVzlxYUdaSFNtTkpkMEpNYjJNMk0zaHNUMU5uVjBob2RWWXlVbEJ4Wm5kUVdXNHllRE4zVG5jdE1tRjVhbWczTVc5TVRYVlFVWGN0U0d3M2F5MXVhVE5RUkVKcFZFTm9USFpsTVZwYVlUWnJWRjh4Wm0wemNsSkRSbkp4WmpSMFkydzRPQT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9zc28uaXNwcmFtYmllbnRlLml0IiwgImlhdCI6IDE2ODM3OTkyMjEsICJleHAiOiAxNjgzODAyODIxfQ.njYXIU2KycEpxW8TvpzQPVjSnd2u7yYNb7xYygp3AcOjt82aPC8PHcq_9HA1oW79S5yjfBjVX9Vlf2dwsGgtRg'}}
2023-05-11 12:00:21,786 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6ImRVczBkek5aZEV4S00xaEpUaTFYYTFoaFFUVmxSRXhqY1RSdlltRmtUR2hvVkVWdFlXeFlZbXBrZHcifQ.eyJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAiZW1haWwiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImF1ZCI6IFsicHJvdmFkaWluc2VyaW1lbnRvIl0sICJqdGkiOiAiYTQ1NGE0MzdlZmUyMTFlZGFiYTNjMTYwOGM3YTRmYWIiLCAiY2xpZW50X2lkIjogInByb3ZhZGlpbnNlcmltZW50byIsICJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXRZVEhreE5WZEJRM056UjNGVVpFUXhhV052VDNwNVNXOXliMlZzUjNCMWJVaG5VV3REVjB0YU1rUnJTVEpWWm05MmIyOXFhRjlyTUdsMVl6QmhXRjlNVjFSa05IUkdTVmg0VDA1TlRGVk5XbFV4ZWpOcFRHRmlTR1J2UVZCRlgzWkNjbEZIU2pOM1FscG9TemR0VVVOUlRYZFlPREpOUkc5cFVYZFViVFo0U0hveVdGZEdjSFZ2TTBOdk5sUnljbEUyVkROdVVXazFTbmt0VWtka1ZVNVFOVzlxYUdaSFNtTkpkMEpNYjJNMk0zaHNUMU5uVjBob2RWWXlVbEJ4Wm5kUVdXNHllRE4zVG5jdE1tRjVhbWczTVc5TVRYVlFVWGN0U0d3M2F5MXVhVE5RUkVKcFZFTm9USFpsTVZwYVlUWnJWRjh4Wm0wemNsSkRSbkp4WmpSMFkydzRPQT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9zc28uaXNwcmFtYmllbnRlLml0IiwgImlhdCI6IDE2ODM3OTkyMjEsICJleHAiOiAxNjgzODAyODIxfQ.njYXIU2KycEpxW8TvpzQPVjSnd2u7yYNb7xYygp3AcOjt82aPC8PHcq_9HA1oW79S5yjfBjVX9Vlf2dwsGgtRg'}
2023-05-11 12:00:21,787 oidcrp.http DEBUG SENT 1 COOKIES
2023-05-11 12:00:21,788 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-05-11 12:00:21,932 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-05-11 12:00:21,933 oidcrp.http DEBUG RECEIVED COOKIE
2023-05-11 12:00:21,933 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-05-11 12:00:21,933 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.24.0', 'Date': 'Thu, 11 May 2023 10:00:21 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'ISPRA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACoYyWdll0v44R3ZJpHokhS8gsizgKfcMaq5C-5md-1_ysLCI-2uphp_PEyhuUe24dkhIW63tiUg7CmYDNWmNmP9PMVqGr6he3Dap-KuE7v-Wl3g2iI4_vVltHa87tT-Bm7ur52YbZU6ZMH0mxi5NFGNRN2H4uvgAu3URUJwEh60mxt3hVVzMY8BbJkW-u0EP-AGp_k8uvEpiJQlFgdSr7wF5el63_yw31LBI5yxteEvz0kjDczuc8hIAAAAAN2mkBkoIQocAAHVAcABAADA9EnLscRn-wIAAAAABFla; HttpOnly; Max-Age=600; Path=/; SameSite=None; Secure', 'Strict-Transport-Security': 'max-age=63072000; ', 'X-Frame-Options': 'DENY'}
2023-05-11 12:00:21,934 oidcrp.util DEBUG resp.txt: {"sub": "5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619", "name": "ANDREA", "given_name": "ANDREA", "family_name": "RANALDI", "nickname": "RANALDI", "email": "andrea.ranaldi@gmail.com"}
2023-05-11 12:00:21,934 oidcrp.oauth2 DEBUG Successful response: {"sub": "5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619", "name": "ANDREA", "given_name": "ANDREA", "family_name": "RANALDI", "nickname": "RANALDI", "email": "andrea.ranaldi@gmail.com"}
2023-05-11 12:00:21,934 oidcrp.service DEBUG response format: json
2023-05-11 12:00:21,934 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-05-11 12:00:21,934 oidcrp.service DEBUG Initial response parsing => "{'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'name': 'ANDREA', 'given_name': 'ANDREA', 'family_name': 'RANALDI', 'nickname': 'RANALDI', 'email': 'andrea.ranaldi@gmail.com'}"
2023-05-11 12:00:21,934 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15}
2023-05-11 12:00:21,936 oidcrp.rp_handler DEBUG UserInfo: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'name': 'ANDREA', 'given_name': 'ANDREA', 'family_name': 'RANALDI', 'nickname': 'RANALDI', 'email': 'andrea.ranaldi@gmail.com'}
2023-05-11 12:00:21,945 werkzeug INFO 127.0.0.1 - - [11/May/2023 12:00:21] "GET /authz_cb/satosa?state=eLvYHNxPj664Xcg1JEGKRVgfSOu7PxvR&scope=openid+profile+email+offline_access&code=Z0FBQUFBQmtYTHkxYzU0bXlQa1NfY0ZPZ3ozTDRjVHNrUnpkckxKV3BhRnVBVDRHdC1fYk5BbWZLRjJlTmV2QUY4RzRjRHRBTjNtR0RCQ1l6eFpJQW1famJ6TmJDWmtZQXMxTnRqQVYzQ3NRb0k2NjJmcFZyRmxZSExRZVRZWkh4MmxjRlVhU0FvaXhGb2Z1bzNZQ2pzV1BaNWFveDl5Q0ZmcXM1ZlpuNmktRzc1TldGa0FVOUJpTDd1VW0zckxHdmhrQ3d5SnNTdWE5bUlNN3VsZGtKU21tUHFOcnY4NU8xaUdlZnNic01BOWxRcEhncG84cVE1OWQzVHJwcXJDdm8yaUdIQk4yTWJHU2JCcmNFSjdHcFo5Zy0xSng4V0ZOZUU2QmZvYzNlOWZIaWFKemstVUYzMGF2OENnUlZIal81NWRGTGlrTjNCZDNaVXRTa3U0aTQ4UTJnYjd3Q1RLTkNheXZpel9GanZDQVJFM043cnNyMUkyWS1UWm1vTUhVXy1nQ2xpeEZkeFZ5Vmc0RjRpSEtQQjFFTEhMaERPOVpOb3IwMm4xOXVjWERwRXg1akxjdVkteGYxYkRMMUwyRzN3TEVuOVY4bVBQRG9oUU5Oc25aUkgxVnE5eWtDRU1SOGlJZmlPbVJvbDR4WUVycDRUUUNfaFFaWEF3NHBPTEVCRkdPV2EyWVdnRHJZQ3VoUWFZNGN5NXE3aVJwNHVnNkRoSFBkV0VZQ3lQTkk0NWdpeEVlWHBfWkZHQnhaeEpER3hjU0pJc3BpMGtIUzY5bkZDbDNPT2VJSk5najRJRHdEbHRtTGNJWTVrSDQta3ZsV2x4eV84MHpRUlllNWoxMGJ0X3k5OWhReHBHYVhDbGJ1ZWkzZWYtM0JJMGpWNjlwWmxMbkVQSEFYUHhZbXZ2YjgzZVdJTW89&iss=https://sso.isprambiente.it&client_id=provadiinserimento HTTP/1.1" 200 -
2023-10-13 14:28:59,928 root DEBUG Configured logging using dictionary
2023-10-13 14:28:59,968 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-13 14:28:59,968 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-13 14:28:59,969 werkzeug INFO  * Restarting with stat
2023-10-13 14:29:00,147 root DEBUG Configured logging using dictionary
2023-10-13 14:29:00,184 werkzeug WARNING  * Debugger is active!
2023-10-13 14:29:00,184 werkzeug INFO  * Debugger PIN: 221-170-319
2023-10-13 14:29:19,611 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 14:29:19] "GET / HTTP/1.1" 200 -
2023-10-13 14:29:22,739 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-13 14:29:22,739 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-13 14:29:22,739 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-13 14:29:22,740 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-13 14:29:22,779 oidcrp.rp_handler DEBUG Get provider info
2023-10-13 14:29:22,780 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-13 14:29:22,780 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://sso.isprambiente.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-13 14:29:22,780 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-13 14:29:22,781 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 14:29:23,018 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-13 14:29:23,019 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 14:29:23,019 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 14:29:23,019 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 12:29:22 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACEZycfbox3loyp-VcOLkFuMTdIdctNohw3TfYzYUNNH4efxIGXTM7QThN9_LS7nCm59FBFW-A18DV1jIPva7jwrNvm_o2w2AoGMDvhORcp0yj_8kMEwi7ID8nBD_4GG9X8fAM8ETtV_UFp51pKQ-3x5a70-36yUkr39iBx6dXGz0iy7GLvmFBQQXLZTuyF-VAzioKzy29Ft_-tkVC-sjOoWEh_328o3WC98J-_4FQIZJX-KK0-Zp022AAAAAI04v0puCHTmAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACEZycfbox3loyp-VcOLkFuMTdIdctNohw3TfYzYUNNH4efxIGXTM7QThN9_LS7nCm59FBFW-A18DV1jIPva7jwrNvm_o2w2AoGMDvhORcp0yj_8kMEwi7ID8nBD_4GG9X8fAM8ETtV_UFp51pKQ-3x5a70-36yUkr39iBx6dXGz0iy7GLvmFBQQXLZTuyF-VAzioKzy29Ft_-tkVC-sjOoWEh_328o3WC98J-_4FQIZJX-KK0-Zp022AAAAAI04v0puCHTmAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 14:29:23,019 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://sso.isprambiente.it", "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection"}
2023-10-13 14:29:23,019 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://sso.isprambiente.it", "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection"}
2023-10-13 14:29:23,019 oidcrp.service DEBUG response format: json
2023-10-13 14:29:23,019 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-13 14:29:23,019 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['implicit', 'authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://sso.isprambiente.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://sso.isprambiente.it', 'authorization_endpoint': 'https://sso.isprambiente.it/OIDC/authorization', 'token_endpoint': 'https://sso.isprambiente.it/OIDC/token', 'userinfo_endpoint': 'https://sso.isprambiente.it/OIDC/userinfo', 'introspection_endpoint': 'https://sso.isprambiente.it/OIDC/introspection'}"
2023-10-13 14:29:23,019 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'provadiinserimento'}
2023-10-13 14:29:23,020 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://sso.isprambiente.it
2023-10-13 14:29:23,020 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-13 14:29:23,020 cryptojwt.key_bundle INFO Reading remote JWKS from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 14:29:23,020 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 14:29:23,020 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 14:29:23,201 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-13 14:29:23,202 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "aUFFS1NlcEJ0WkhhTGpYb0lJelhxS0Rzck9MM0tGZHNESkwyVmZfN3llZw", "e": "AQAB", "n": "vmI3X85sKoytGcckMx4AF7XkX7iIElRFGAJRVRulzvvaUud_n1WtpRVdmpvYIZKfdUeJKnAGkOwOvgF05TrfNaKA4WG9SJyUMN-6OmFF0BOo2HH-IpwliT2iJLJMu-Mse2wux1dmfrPPfDIg5uwab6Jllsn01FuwhFYjTNA_AaxGJTSqCnBpwQ_NYyOKe_Thgsx_DK58VAUKpeyzrUDNnY8jW0P14MBiU9esKhNu40KTKlGFfKCwA0yfjDz0O_gAVAhXHM4dQvp7KsKsyk3jZJ6G3YqYXjjVXGo8Ps5aHaRdcG9pjOom6G7uYah5ODjoMwLd9OO12F9WSHcLuz-3rQ"}, {"kty": "EC", "use": "sig", "kid": "OXBFU1BjTXRoRTlNaTBFdHl3NUFVUmJpSXF5bUZ0aGh4R2lpaWZHQlptZw", "crv": "P-256", "x": "NZqgmWOsp1e07kmG-1ZCDml4kR8gerPPFm3TzO26R40", "y": "-DfcOnKnoHkzv8pf-Mykq4PFgLU-yAvAGjKqA2pYzl4"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 14:29:23,203 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "aUFFS1NlcEJ0WkhhTGpYb0lJelhxS0Rzck9MM0tGZHNESkwyVmZfN3llZw", "e": "AQAB", "n": "vmI3X85sKoytGcckMx4AF7XkX7iIElRFGAJRVRulzvvaUud_n1WtpRVdmpvYIZKfdUeJKnAGkOwOvgF05TrfNaKA4WG9SJyUMN-6OmFF0BOo2HH-IpwliT2iJLJMu-Mse2wux1dmfrPPfDIg5uwab6Jllsn01FuwhFYjTNA_AaxGJTSqCnBpwQ_NYyOKe_Thgsx_DK58VAUKpeyzrUDNnY8jW0P14MBiU9esKhNu40KTKlGFfKCwA0yfjDz0O_gAVAhXHM4dQvp7KsKsyk3jZJ6G3YqYXjjVXGo8Ps5aHaRdcG9pjOom6G7uYah5ODjoMwLd9OO12F9WSHcLuz-3rQ"}, {"kty": "EC", "use": "sig", "kid": "OXBFU1BjTXRoRTlNaTBFdHl3NUFVUmJpSXF5bUZ0aGh4R2lpaWZHQlptZw", "crv": "P-256", "x": "NZqgmWOsp1e07kmG-1ZCDml4kR8gerPPFm3TzO26R40", "y": "-DfcOnKnoHkzv8pf-Mykq4PFgLU-yAvAGjKqA2pYzl4"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 14:29:23,205 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'prompt': 'consent'}
2023-10-13 14:29:23,206 oidcrp.rp_handler DEBUG Do client registration
2023-10-13 14:29:23,206 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-13 14:29:23,206 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-13 14:29:23,206 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'vgBA7HSZKcLneCgQYur0099G', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'n4L7euPD119GvIhZvKcCKV40zSMuSzym'}
2023-10-13 14:29:23,207 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'vgBA7HSZKcLneCgQYur0099G', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'n4L7euPD119GvIhZvKcCKV40zSMuSzym', 'code_challenge': 'GxVdE2T-ZQIc1XXa_MHY-6rI-vLH2AMruTxm4vd5Jig', 'code_challenge_method': 'S256', 'client_id': 'provadiinserimento', 'prompt': 'consent'}
2023-10-13 14:29:23,208 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f154ece8910>, 'url': 'https://sso.isprambiente.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=vgBA7HSZKcLneCgQYur0099G&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=n4L7euPD119GvIhZvKcCKV40zSMuSzym&code_challenge=GxVdE2T-ZQIc1XXa_MHY-6rI-vLH2AMruTxm4vd5Jig&code_challenge_method=S256&client_id=provadiinserimento&prompt=consent'}
2023-10-13 14:29:23,209 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 14:29:23] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-13 14:30:05,145 flask_rp.views DEBUG Issuer: https://sso.isprambiente.it
2023-10-13 14:30:05,145 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-13 14:30:05,145 oidcrp.service DEBUG response format: dict
2023-10-13 14:30:05,145 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-13 14:30:05,145 oidcrp.service DEBUG Initial response parsing => "{'state': 'n4L7euPD119GvIhZvKcCKV40zSMuSzym', 'scope': 'offline_access profile openid', 'code': 'Z0FBQUFBQmxLVGhNN1QyMHFNR0x3eEZDWmFvRlZRcWo0eHNCM3o0cTNiVG1xNHZHY1JfOC0tazNYdFppOUZzN19mMU9zS3VUYTRXYmNQa09IMW1sMWhxNEJNem50S0dQVURCRkhTanFFUmQxT2lOMGplYkNwTUNrbXpzSDBXbXRnQkVUN0JKLTc5dGNqb0V5QXhFakVBbXoxSEZIQzN2cHdWSUtUY0ZwTWFmZndoY2JvZ0pSeWpQOUpXc3VzMjVSdzVWVnp2RXNiUWY0dXFCZGNZaFBYNkloTHBDZHdHYUV0TlBjUG9RV0M5REZaNm0xeUJlRG8xZmZLZHQzdXVCNkRzRmVfWE9QbU5NOEMzcFVsTHhSTmVfR2V5TU1uQnlWbFpPZXhRdEgxR21YQWZPZTc4enRFZE82U1BzYnBZdk1uNy1PZnNaRDhzMEowWlVHODhtSWhkVlJQbmE2SGc1b29hdnRyYzE5TlJtLXg1ZUFYaUR5UkVsTXQtXzZMc2ZCMjY3T1Z0czVIUkpFLW4wSHVQazVyTUtfd3VULWF2V0YwcHl1Tjc4Wkc2eWotMjhTOWdPQ19aM2t6Vkd2TktLdnZMd3hRMzNTLWl3djFFNUdGdnlfV2hDRW1QMjZDR2lZMEo1M19Zb2g4Q3o3UHUxSVI0endjaUlrYWtyZGdXVVBMYmo0Z1AwSlQ1VnREUy1zUUZ3YzFOaVhDQWdRWEgxRWFTWF9yejJtWEsxTmFmWmY0Z2pGMzQ2blZmUnhwSmx0YThHYzd1ZkdYY1BwVlpNdGYzWGM4SFJIdlJ1ZjBsQkx3dWdJM2tnTEcya2JRY0ZGSHdqMUczNW9lRkJNbU5Nd0hFeDJuMkQ3YVphZTRiOGJ2eEZWTkVfVy1uNVk4QW0xZlcxQmVFN19VOWNfYlFzMFZXTFRnSmc9', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}"
2023-10-13 14:30:05,145 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15, 'client_id': 'provadiinserimento'}
2023-10-13 14:30:05,146 oidcrp.rp_handler DEBUG Authz response: {'state': 'n4L7euPD119GvIhZvKcCKV40zSMuSzym', 'scope': 'offline_access profile openid', 'code': 'Z0FBQUFBQmxLVGhNN1QyMHFNR0x3eEZDWmFvRlZRcWo0eHNCM3o0cTNiVG1xNHZHY1JfOC0tazNYdFppOUZzN19mMU9zS3VUYTRXYmNQa09IMW1sMWhxNEJNem50S0dQVURCRkhTanFFUmQxT2lOMGplYkNwTUNrbXpzSDBXbXRnQkVUN0JKLTc5dGNqb0V5QXhFakVBbXoxSEZIQzN2cHdWSUtUY0ZwTWFmZndoY2JvZ0pSeWpQOUpXc3VzMjVSdzVWVnp2RXNiUWY0dXFCZGNZaFBYNkloTHBDZHdHYUV0TlBjUG9RV0M5REZaNm0xeUJlRG8xZmZLZHQzdXVCNkRzRmVfWE9QbU5NOEMzcFVsTHhSTmVfR2V5TU1uQnlWbFpPZXhRdEgxR21YQWZPZTc4enRFZE82U1BzYnBZdk1uNy1PZnNaRDhzMEowWlVHODhtSWhkVlJQbmE2SGc1b29hdnRyYzE5TlJtLXg1ZUFYaUR5UkVsTXQtXzZMc2ZCMjY3T1Z0czVIUkpFLW4wSHVQazVyTUtfd3VULWF2V0YwcHl1Tjc4Wkc2eWotMjhTOWdPQ19aM2t6Vkd2TktLdnZMd3hRMzNTLWl3djFFNUdGdnlfV2hDRW1QMjZDR2lZMEo1M19Zb2g4Q3o3UHUxSVI0endjaUlrYWtyZGdXVVBMYmo0Z1AwSlQ1VnREUy1zUUZ3YzFOaVhDQWdRWEgxRWFTWF9yejJtWEsxTmFmWmY0Z2pGMzQ2blZmUnhwSmx0YThHYzd1ZkdYY1BwVlpNdGYzWGM4SFJIdlJ1ZjBsQkx3dWdJM2tnTEcya2JRY0ZGSHdqMUczNW9lRkJNbU5Nd0hFeDJuMkQ3YVphZTRiOGJ2eEZWTkVfVy1uNVk4QW0xZlcxQmVFN19VOWNfYlFzMFZXTFRnSmc9', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}
2023-10-13 14:30:05,146 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-13 14:30:05,146 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-13 14:30:05,147 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxLVGhNN1QyMHFNR0x3eEZDWmFvRlZRcWo0eHNCM3o0cTNiVG1xNHZHY1JfOC0tazNYdFppOUZzN19mMU9zS3VUYTRXYmNQa09IMW1sMWhxNEJNem50S0dQVURCRkhTanFFUmQxT2lOMGplYkNwTUNrbXpzSDBXbXRnQkVUN0JKLTc5dGNqb0V5QXhFakVBbXoxSEZIQzN2cHdWSUtUY0ZwTWFmZndoY2JvZ0pSeWpQOUpXc3VzMjVSdzVWVnp2RXNiUWY0dXFCZGNZaFBYNkloTHBDZHdHYUV0TlBjUG9RV0M5REZaNm0xeUJlRG8xZmZLZHQzdXVCNkRzRmVfWE9QbU5NOEMzcFVsTHhSTmVfR2V5TU1uQnlWbFpPZXhRdEgxR21YQWZPZTc4enRFZE82U1BzYnBZdk1uNy1PZnNaRDhzMEowWlVHODhtSWhkVlJQbmE2SGc1b29hdnRyYzE5TlJtLXg1ZUFYaUR5UkVsTXQtXzZMc2ZCMjY3T1Z0czVIUkpFLW4wSHVQazVyTUtfd3VULWF2V0YwcHl1Tjc4Wkc2eWotMjhTOWdPQ19aM2t6Vkd2TktLdnZMd3hRMzNTLWl3djFFNUdGdnlfV2hDRW1QMjZDR2lZMEo1M19Zb2g4Q3o3UHUxSVI0endjaUlrYWtyZGdXVVBMYmo0Z1AwSlQ1VnREUy1zUUZ3YzFOaVhDQWdRWEgxRWFTWF9yejJtWEsxTmFmWmY0Z2pGMzQ2blZmUnhwSmx0YThHYzd1ZkdYY1BwVlpNdGYzWGM4SFJIdlJ1ZjBsQkx3dWdJM2tnTEcya2JRY0ZGSHdqMUczNW9lRkJNbU5Nd0hFeDJuMkQ3YVphZTRiOGJ2eEZWTkVfVy1uNVk4QW0xZlcxQmVFN19VOWNfYlFzMFZXTFRnSmc9', 'state': 'n4L7euPD119GvIhZvKcCKV40zSMuSzym', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'provadiinserimento', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-13 14:30:05,147 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'provadiinserimento', 'state': 'n4L7euPD119GvIhZvKcCKV40zSMuSzym', 'code': 'Z0FBQUFBQmxLVGhNN1QyMHFNR0x3eEZDWmFvRlZRcWo0eHNCM3o0cTNiVG1xNHZHY1JfOC0tazNYdFppOUZzN19mMU9zS3VUYTRXYmNQa09IMW1sMWhxNEJNem50S0dQVURCRkhTanFFUmQxT2lOMGplYkNwTUNrbXpzSDBXbXRnQkVUN0JKLTc5dGNqb0V5QXhFakVBbXoxSEZIQzN2cHdWSUtUY0ZwTWFmZndoY2JvZ0pSeWpQOUpXc3VzMjVSdzVWVnp2RXNiUWY0dXFCZGNZaFBYNkloTHBDZHdHYUV0TlBjUG9RV0M5REZaNm0xeUJlRG8xZmZLZHQzdXVCNkRzRmVfWE9QbU5NOEMzcFVsTHhSTmVfR2V5TU1uQnlWbFpPZXhRdEgxR21YQWZPZTc4enRFZE82U1BzYnBZdk1uNy1PZnNaRDhzMEowWlVHODhtSWhkVlJQbmE2SGc1b29hdnRyYzE5TlJtLXg1ZUFYaUR5UkVsTXQtXzZMc2ZCMjY3T1Z0czVIUkpFLW4wSHVQazVyTUtfd3VULWF2V0YwcHl1Tjc4Wkc2eWotMjhTOWdPQ19aM2t6Vkd2TktLdnZMd3hRMzNTLWl3djFFNUdGdnlfV2hDRW1QMjZDR2lZMEo1M19Zb2g4Q3o3UHUxSVI0endjaUlrYWtyZGdXVVBMYmo0Z1AwSlQ1VnREUy1zUUZ3YzFOaVhDQWdRWEgxRWFTWF9yejJtWEsxTmFmWmY0Z2pGMzQ2blZmUnhwSmx0YThHYzd1ZkdYY1BwVlpNdGYzWGM4SFJIdlJ1ZjBsQkx3dWdJM2tnTEcya2JRY0ZGSHdqMUczNW9lRkJNbU5Nd0hFeDJuMkQ3YVphZTRiOGJ2eEZWTkVfVy1uNVk4QW0xZlcxQmVFN19VOWNfYlFzMFZXTFRnSmc9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'rIqKvWEBjoCqli5yykGV2RXyQYBDvacLF1oX7bUxccnzDjL6SYK9BkQ3P2Gu9gyj'}
2023-10-13 14:30:05,147 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-13 14:30:05,147 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f154ed3fad0>, 'url': 'https://sso.isprambiente.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=n4L7euPD119GvIhZvKcCKV40zSMuSzym&code=Z0FBQUFBQmxLVGhNN1QyMHFNR0x3eEZDWmFvRlZRcWo0eHNCM3o0cTNiVG1xNHZHY1JfOC0tazNYdFppOUZzN19mMU9zS3VUYTRXYmNQa09IMW1sMWhxNEJNem50S0dQVURCRkhTanFFUmQxT2lOMGplYkNwTUNrbXpzSDBXbXRnQkVUN0JKLTc5dGNqb0V5QXhFakVBbXoxSEZIQzN2cHdWSUtUY0ZwTWFmZndoY2JvZ0pSeWpQOUpXc3VzMjVSdzVWVnp2RXNiUWY0dXFCZGNZaFBYNkloTHBDZHdHYUV0TlBjUG9RV0M5REZaNm0xeUJlRG8xZmZLZHQzdXVCNkRzRmVfWE9QbU5NOEMzcFVsTHhSTmVfR2V5TU1uQnlWbFpPZXhRdEgxR21YQWZPZTc4enRFZE82U1BzYnBZdk1uNy1PZnNaRDhzMEowWlVHODhtSWhkVlJQbmE2SGc1b29hdnRyYzE5TlJtLXg1ZUFYaUR5UkVsTXQtXzZMc2ZCMjY3T1Z0czVIUkpFLW4wSHVQazVyTUtfd3VULWF2V0YwcHl1Tjc4Wkc2eWotMjhTOWdPQ19aM2t6Vkd2TktLdnZMd3hRMzNTLWl3djFFNUdGdnlfV2hDRW1QMjZDR2lZMEo1M19Zb2g4Q3o3UHUxSVI0endjaUlrYWtyZGdXVVBMYmo0Z1AwSlQ1VnREUy1zUUZ3YzFOaVhDQWdRWEgxRWFTWF9yejJtWEsxTmFmWmY0Z2pGMzQ2blZmUnhwSmx0YThHYzd1ZkdYY1BwVlpNdGYzWGM4SFJIdlJ1ZjBsQkx3dWdJM2tnTEcya2JRY0ZGSHdqMUczNW9lRkJNbU5Nd0hFeDJuMkQ3YVphZTRiOGJ2eEZWTkVfVy1uNVk4QW0xZlcxQmVFN19VOWNfYlFzMFZXTFRnSmc9&code_verifier=rIqKvWEBjoCqli5yykGV2RXyQYBDvacLF1oX7bUxccnzDjL6SYK9BkQ3P2Gu9gyj', 'headers': {'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-13 14:30:05,148 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=n4L7euPD119GvIhZvKcCKV40zSMuSzym&code=Z0FBQUFBQmxLVGhNN1QyMHFNR0x3eEZDWmFvRlZRcWo0eHNCM3o0cTNiVG1xNHZHY1JfOC0tazNYdFppOUZzN19mMU9zS3VUYTRXYmNQa09IMW1sMWhxNEJNem50S0dQVURCRkhTanFFUmQxT2lOMGplYkNwTUNrbXpzSDBXbXRnQkVUN0JKLTc5dGNqb0V5QXhFakVBbXoxSEZIQzN2cHdWSUtUY0ZwTWFmZndoY2JvZ0pSeWpQOUpXc3VzMjVSdzVWVnp2RXNiUWY0dXFCZGNZaFBYNkloTHBDZHdHYUV0TlBjUG9RV0M5REZaNm0xeUJlRG8xZmZLZHQzdXVCNkRzRmVfWE9QbU5NOEMzcFVsTHhSTmVfR2V5TU1uQnlWbFpPZXhRdEgxR21YQWZPZTc4enRFZE82U1BzYnBZdk1uNy1PZnNaRDhzMEowWlVHODhtSWhkVlJQbmE2SGc1b29hdnRyYzE5TlJtLXg1ZUFYaUR5UkVsTXQtXzZMc2ZCMjY3T1Z0czVIUkpFLW4wSHVQazVyTUtfd3VULWF2V0YwcHl1Tjc4Wkc2eWotMjhTOWdPQ19aM2t6Vkd2TktLdnZMd3hRMzNTLWl3djFFNUdGdnlfV2hDRW1QMjZDR2lZMEo1M19Zb2g4Q3o3UHUxSVI0endjaUlrYWtyZGdXVVBMYmo0Z1AwSlQ1VnREUy1zUUZ3YzFOaVhDQWdRWEgxRWFTWF9yejJtWEsxTmFmWmY0Z2pGMzQ2blZmUnhwSmx0YThHYzd1ZkdYY1BwVlpNdGYzWGM4SFJIdlJ1ZjBsQkx3dWdJM2tnTEcya2JRY0ZGSHdqMUczNW9lRkJNbU5Nd0hFeDJuMkQ3YVphZTRiOGJ2eEZWTkVfVy1uNVk4QW0xZlcxQmVFN19VOWNfYlFzMFZXTFRnSmc9&code_verifier=rIqKvWEBjoCqli5yykGV2RXyQYBDvacLF1oX7bUxccnzDjL6SYK9BkQ3P2Gu9gyj, https_args:{'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-13 14:30:05,149 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 14:30:05,736 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "POST /OIDC/token HTTP/1.1" 403 None
2023-10-13 14:30:05,737 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 14:30:05,738 oidcrp.oauth2 ERROR Error response (403): {"error": "invalid_grant", "error_description": "Unknown code"}
2023-10-13 14:30:05,738 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 12:30:05 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdABaRQuS7k7YLnJVnUci0lwL5Zxau9WjVxxIsy-oZfpzMbFWVWRR80qa-jpPFOZtZlJwac9lug2ADESoC4t6jwlMfxsKJsi60RF38lV46yI9mfpzNBGltBAczjdHXTvOabhwFqBTgTri2c8YBjcPYhccisop5xZ-VVQWzr3ro0lfz0q_DV6ZqpTvivatek8KcxaMJpkoVqzFQIb1hHyhYc0VaDQe1nIeY7XQGz-RLtRGXmFW6YzgHNAAAAMrXoBj1UTMAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdABaRQuS7k7YLnJVnUci0lwL5Zxau9WjVxxIsy-oZfpzMbFWVWRR80qa-jpPFOZtZlJwac9lug2ADESoC4t6jwlMfxsKJsi60RF38lV46yI9mfpzNBGltBAczjdHXTvOabhwFqBTgTri2c8YBjcPYhccisop5xZ-VVQWzr3ro0lfz0q_DV6ZqpTvivatek8KcxaMJpkoVqzFQIb1hHyhYc0VaDQe1nIeY7XQGz-RLtRGXmFW6YzgHNAAAAMrXoBj1UTMAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure'}
2023-10-13 14:30:05,738 oidcrp.util DEBUG resp.txt: {"error": "invalid_grant", "error_description": "Unknown code"}
2023-10-13 14:30:05,738 oidcrp.service DEBUG response format: json
2023-10-13 14:30:05,738 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-13 14:30:05,738 oidcrp.service DEBUG Initial response parsing => "{'error': 'invalid_grant', 'error_description': 'Unknown code'}"
2023-10-13 14:30:05,738 oidcrp.service DEBUG Error response: {'error': 'invalid_grant', 'error_description': 'Unknown code'}
2023-10-13 14:30:05,742 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 14:30:05] "[31m[1mGET /authz_cb/satosa?state=n4L7euPD119GvIhZvKcCKV40zSMuSzym&scope=offline_access+profile+openid&code=Z0FBQUFBQmxLVGhNN1QyMHFNR0x3eEZDWmFvRlZRcWo0eHNCM3o0cTNiVG1xNHZHY1JfOC0tazNYdFppOUZzN19mMU9zS3VUYTRXYmNQa09IMW1sMWhxNEJNem50S0dQVURCRkhTanFFUmQxT2lOMGplYkNwTUNrbXpzSDBXbXRnQkVUN0JKLTc5dGNqb0V5QXhFakVBbXoxSEZIQzN2cHdWSUtUY0ZwTWFmZndoY2JvZ0pSeWpQOUpXc3VzMjVSdzVWVnp2RXNiUWY0dXFCZGNZaFBYNkloTHBDZHdHYUV0TlBjUG9RV0M5REZaNm0xeUJlRG8xZmZLZHQzdXVCNkRzRmVfWE9QbU5NOEMzcFVsTHhSTmVfR2V5TU1uQnlWbFpPZXhRdEgxR21YQWZPZTc4enRFZE82U1BzYnBZdk1uNy1PZnNaRDhzMEowWlVHODhtSWhkVlJQbmE2SGc1b29hdnRyYzE5TlJtLXg1ZUFYaUR5UkVsTXQtXzZMc2ZCMjY3T1Z0czVIUkpFLW4wSHVQazVyTUtfd3VULWF2V0YwcHl1Tjc4Wkc2eWotMjhTOWdPQ19aM2t6Vkd2TktLdnZMd3hRMzNTLWl3djFFNUdGdnlfV2hDRW1QMjZDR2lZMEo1M19Zb2g4Q3o3UHUxSVI0endjaUlrYWtyZGdXVVBMYmo0Z1AwSlQ1VnREUy1zUUZ3YzFOaVhDQWdRWEgxRWFTWF9yejJtWEsxTmFmWmY0Z2pGMzQ2blZmUnhwSmx0YThHYzd1ZkdYY1BwVlpNdGYzWGM4SFJIdlJ1ZjBsQkx3dWdJM2tnTEcya2JRY0ZGSHdqMUczNW9lRkJNbU5Nd0hFeDJuMkQ3YVphZTRiOGJ2eEZWTkVfVy1uNVk4QW0xZlcxQmVFN19VOWNfYlFzMFZXTFRnSmc9&iss=https://sso.isprambiente.it&client_id=provadiinserimento HTTP/1.1[0m" 403 -
2023-10-13 14:39:49,718 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 14:39:49] "GET / HTTP/1.1" 200 -
2023-10-13 14:39:52,705 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-13 14:39:52,705 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-13 14:39:52,705 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-13 14:39:52,705 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-13 14:39:52,736 oidcrp.rp_handler DEBUG Get provider info
2023-10-13 14:39:52,736 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-13 14:39:52,736 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://sso.isprambiente.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-13 14:39:52,736 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-13 14:39:52,736 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 14:39:53,016 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-13 14:39:53,017 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 14:39:53,018 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 14:39:53,018 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 12:39:52 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdADCahSow2pPBpSg03Xqw-QQWBnJz082hhkFXLXPALazv8rh-hNKIAsjHRtxdOuJrdtMqkuaz4t2xR-MGL7L8xZ1eqBTrB3Ab5BpQDhkxTzVn9GwHi4Qz2fQHioVv3GBFiWRa8OFB7ZtvLaOHi4MEZI7tKbFiI7MnDMKouLkiuVNM2JF0INbiOvhrrDgAAJ3WVt5Sz2EL6xazuG5Wu8zflL0ufGY6yISt7hj1zxXgoSxz0BI8LV2JmfoA0Km1hyMnh3kAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdADCahSow2pPBpSg03Xqw-QQWBnJz082hhkFXLXPALazv8rh-hNKIAsjHRtxdOuJrdtMqkuaz4t2xR-MGL7L8xZ1eqBTrB3Ab5BpQDhkxTzVn9GwHi4Qz2fQHioVv3GBFiWRa8OFB7ZtvLaOHi4MEZI7tKbFiI7MnDMKouLkiuVNM2JF0INbiOvhrrDgAAJ3WVt5Sz2EL6xazuG5Wu8zflL0ufGY6yISt7hj1zxXgoSxz0BI8LV2JmfoA0Km1hyMnh3kAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 14:39:53,018 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://sso.isprambiente.it", "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection"}
2023-10-13 14:39:53,018 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://sso.isprambiente.it", "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection"}
2023-10-13 14:39:53,018 oidcrp.service DEBUG response format: json
2023-10-13 14:39:53,018 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-13 14:39:53,019 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['implicit', 'authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://sso.isprambiente.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://sso.isprambiente.it', 'authorization_endpoint': 'https://sso.isprambiente.it/OIDC/authorization', 'token_endpoint': 'https://sso.isprambiente.it/OIDC/token', 'userinfo_endpoint': 'https://sso.isprambiente.it/OIDC/userinfo', 'introspection_endpoint': 'https://sso.isprambiente.it/OIDC/introspection'}"
2023-10-13 14:39:53,019 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'provadiinserimento'}
2023-10-13 14:39:53,021 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://sso.isprambiente.it
2023-10-13 14:39:53,021 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-13 14:39:53,021 cryptojwt.key_bundle INFO Reading remote JWKS from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 14:39:53,021 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 14:39:53,023 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 14:39:53,208 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-13 14:39:53,209 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "endPaEZNa0JFaFpHcFNaTzJMd0MtWmdkaFZveVlmTi1qNFp4TmFVcXl5VQ", "e": "AQAB", "n": "j2xsVPUBp0ihvsnMEVRymqmW7X8KX9lxbXqbYfWqwJeBXJ6MDznayxw8DNcitEsE4TzbrZIGE5XPVybvwpq9xVt3gZflgUnAPWnL_zVCQFl8z9QD3zOvfp-fddkjGsGTV5OB8MaF51mGU1y1xqLF1y-n8LFQITY-YoLvr-6vu-oGguBxipTDBIx7yAAYCDZHryS6n0jX9KDE6c6uqXOyFwpT8DoZURqsJhQL2bsDTRbuUuDyipotEJBk6mvdJZadcagEU72io2aMCv5LfgxpnQQcOg_nm1Mm6R-zmFVcRtmdb6tukGtT1v-nUF-rIWk8Hsvjlb5aGVXlQZis6Nn3Lw"}, {"kty": "EC", "use": "sig", "kid": "ejY0alFFY2ZaTmt4VUFQYVVpZWJFTWlOY2x2TFc4aVREOG54SThrcHRWbw", "crv": "P-256", "x": "wW5R0oZRqUDyub9MHXnIQ5IIo_L63MpCupCHOwVzelc", "y": "77m3qOMyfMbUQC4teR_2A8RqbFEDQrYwzcxF3z3HKEM"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 14:39:53,209 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "endPaEZNa0JFaFpHcFNaTzJMd0MtWmdkaFZveVlmTi1qNFp4TmFVcXl5VQ", "e": "AQAB", "n": "j2xsVPUBp0ihvsnMEVRymqmW7X8KX9lxbXqbYfWqwJeBXJ6MDznayxw8DNcitEsE4TzbrZIGE5XPVybvwpq9xVt3gZflgUnAPWnL_zVCQFl8z9QD3zOvfp-fddkjGsGTV5OB8MaF51mGU1y1xqLF1y-n8LFQITY-YoLvr-6vu-oGguBxipTDBIx7yAAYCDZHryS6n0jX9KDE6c6uqXOyFwpT8DoZURqsJhQL2bsDTRbuUuDyipotEJBk6mvdJZadcagEU72io2aMCv5LfgxpnQQcOg_nm1Mm6R-zmFVcRtmdb6tukGtT1v-nUF-rIWk8Hsvjlb5aGVXlQZis6Nn3Lw"}, {"kty": "EC", "use": "sig", "kid": "ejY0alFFY2ZaTmt4VUFQYVVpZWJFTWlOY2x2TFc4aVREOG54SThrcHRWbw", "crv": "P-256", "x": "wW5R0oZRqUDyub9MHXnIQ5IIo_L63MpCupCHOwVzelc", "y": "77m3qOMyfMbUQC4teR_2A8RqbFEDQrYwzcxF3z3HKEM"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 14:39:53,212 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'prompt': 'consent'}
2023-10-13 14:39:53,213 oidcrp.rp_handler DEBUG Do client registration
2023-10-13 14:39:53,213 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-13 14:39:53,213 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-13 14:39:53,213 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': '1yJQ5gnUcwE1olmq6QwJ9Zm8', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'XmadL1J1TeZ6DkBGxr4OrO4sIKNDxNOI'}
2023-10-13 14:39:53,214 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': '1yJQ5gnUcwE1olmq6QwJ9Zm8', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'XmadL1J1TeZ6DkBGxr4OrO4sIKNDxNOI', 'code_challenge': 'iNIr5SJPnJK0d_Yn8hpiRJpgi7ByOMoQsB9AXPLknNM', 'code_challenge_method': 'S256', 'client_id': 'provadiinserimento', 'prompt': 'consent'}
2023-10-13 14:39:53,215 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f154daa0f10>, 'url': 'https://sso.isprambiente.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=1yJQ5gnUcwE1olmq6QwJ9Zm8&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=XmadL1J1TeZ6DkBGxr4OrO4sIKNDxNOI&code_challenge=iNIr5SJPnJK0d_Yn8hpiRJpgi7ByOMoQsB9AXPLknNM&code_challenge_method=S256&client_id=provadiinserimento&prompt=consent'}
2023-10-13 14:39:53,216 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 14:39:53] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-13 14:40:13,347 flask_rp.views DEBUG Issuer: https://sso.isprambiente.it
2023-10-13 14:40:13,347 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-13 14:40:13,347 oidcrp.service DEBUG response format: dict
2023-10-13 14:40:13,347 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-13 14:40:13,347 oidcrp.service DEBUG Initial response parsing => "{'state': 'XmadL1J1TeZ6DkBGxr4OrO4sIKNDxNOI', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxLVHF0eWRvSGV0Z3M3SEhVUU1JblNlSENxMXJQbUpXX1JtZVJmTF9KSS1waDJkakJScWJDVlRUTWswb05Ea1ZQS1FSaGtWRUViMXViZ2ZzcE9IS0YtWUFkc0tZVy1RNlFGY3lyQi1nNkZSRGtGYlhOTkFuN2doYlIwWHV4RUU3X0NMVUU5OV9lSEFLeTVLTE11NllJMXlJTUVtcV92V3RhVEQzc2RoLVl1MVhSNXgzY3U2dFlfdW12VjJfYkNFWjB5YmdIcEtTUnhvNTFoUkZFVXZLWDhqdWJFbmNGblgzVkRvUzBZenlHai02TjIwSTZKRGlPY1VUa2xibDVMQ2R2Q0pfNVRLRW1qNWd3am5DNzBkVmh6TEY0QlZWSWQ1VGtINXRMVW1PV1J0VTJlVW56aEFGazlNQVpLenRKaERBcGdudWVRNU81VFpMUUZBMDFEY1NtRGVXWENkNnllcDdHNWRtVzFIWGVFZzQwYzRwVE5fa1VVU1ppRjAzY01oa2Y4anVBS19sc29mQ2s3T0NhYmhnZUVnY3dYdDlmS3VmS19iaU9BcXRGN05hU0FHenlDWUZoRW52bjNsYThNTzdsaDByT3BScUpfZTllanJsQWRSM3NIcDJuU1VPU1VMaU9rR2s1dUdRRkszUTlJVWNERDZIZGh0TmlacGNlTnR6Q1pkUk5Lcmx0c2JsajBfU2lIcVlnbEdtRFlWOEFsWXV3N3V4Vk8xdnhjcnVralR5cjd6XzZYU0RkREpJbGJGcmxiR2ljV1JvV2JuYThsRk9DVFR1Wnp5T3Q3Vm5mQ2lTQTI1a1FfV1dGVF8yemh3dmVRaWJlTEIxY2dCZFF3VTVaT2l1RnhZLVdNR3NYME1WalVnMGZfRnFEZDlhUlR3VFlIMzNSWk8zOWZ5YVdFOG89', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}"
2023-10-13 14:40:13,347 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15, 'client_id': 'provadiinserimento'}
2023-10-13 14:40:13,348 oidcrp.rp_handler DEBUG Authz response: {'state': 'XmadL1J1TeZ6DkBGxr4OrO4sIKNDxNOI', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxLVHF0eWRvSGV0Z3M3SEhVUU1JblNlSENxMXJQbUpXX1JtZVJmTF9KSS1waDJkakJScWJDVlRUTWswb05Ea1ZQS1FSaGtWRUViMXViZ2ZzcE9IS0YtWUFkc0tZVy1RNlFGY3lyQi1nNkZSRGtGYlhOTkFuN2doYlIwWHV4RUU3X0NMVUU5OV9lSEFLeTVLTE11NllJMXlJTUVtcV92V3RhVEQzc2RoLVl1MVhSNXgzY3U2dFlfdW12VjJfYkNFWjB5YmdIcEtTUnhvNTFoUkZFVXZLWDhqdWJFbmNGblgzVkRvUzBZenlHai02TjIwSTZKRGlPY1VUa2xibDVMQ2R2Q0pfNVRLRW1qNWd3am5DNzBkVmh6TEY0QlZWSWQ1VGtINXRMVW1PV1J0VTJlVW56aEFGazlNQVpLenRKaERBcGdudWVRNU81VFpMUUZBMDFEY1NtRGVXWENkNnllcDdHNWRtVzFIWGVFZzQwYzRwVE5fa1VVU1ppRjAzY01oa2Y4anVBS19sc29mQ2s3T0NhYmhnZUVnY3dYdDlmS3VmS19iaU9BcXRGN05hU0FHenlDWUZoRW52bjNsYThNTzdsaDByT3BScUpfZTllanJsQWRSM3NIcDJuU1VPU1VMaU9rR2s1dUdRRkszUTlJVWNERDZIZGh0TmlacGNlTnR6Q1pkUk5Lcmx0c2JsajBfU2lIcVlnbEdtRFlWOEFsWXV3N3V4Vk8xdnhjcnVralR5cjd6XzZYU0RkREpJbGJGcmxiR2ljV1JvV2JuYThsRk9DVFR1Wnp5T3Q3Vm5mQ2lTQTI1a1FfV1dGVF8yemh3dmVRaWJlTEIxY2dCZFF3VTVaT2l1RnhZLVdNR3NYME1WalVnMGZfRnFEZDlhUlR3VFlIMzNSWk8zOWZ5YVdFOG89', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}
2023-10-13 14:40:13,348 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-13 14:40:13,348 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-13 14:40:13,349 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxLVHF0eWRvSGV0Z3M3SEhVUU1JblNlSENxMXJQbUpXX1JtZVJmTF9KSS1waDJkakJScWJDVlRUTWswb05Ea1ZQS1FSaGtWRUViMXViZ2ZzcE9IS0YtWUFkc0tZVy1RNlFGY3lyQi1nNkZSRGtGYlhOTkFuN2doYlIwWHV4RUU3X0NMVUU5OV9lSEFLeTVLTE11NllJMXlJTUVtcV92V3RhVEQzc2RoLVl1MVhSNXgzY3U2dFlfdW12VjJfYkNFWjB5YmdIcEtTUnhvNTFoUkZFVXZLWDhqdWJFbmNGblgzVkRvUzBZenlHai02TjIwSTZKRGlPY1VUa2xibDVMQ2R2Q0pfNVRLRW1qNWd3am5DNzBkVmh6TEY0QlZWSWQ1VGtINXRMVW1PV1J0VTJlVW56aEFGazlNQVpLenRKaERBcGdudWVRNU81VFpMUUZBMDFEY1NtRGVXWENkNnllcDdHNWRtVzFIWGVFZzQwYzRwVE5fa1VVU1ppRjAzY01oa2Y4anVBS19sc29mQ2s3T0NhYmhnZUVnY3dYdDlmS3VmS19iaU9BcXRGN05hU0FHenlDWUZoRW52bjNsYThNTzdsaDByT3BScUpfZTllanJsQWRSM3NIcDJuU1VPU1VMaU9rR2s1dUdRRkszUTlJVWNERDZIZGh0TmlacGNlTnR6Q1pkUk5Lcmx0c2JsajBfU2lIcVlnbEdtRFlWOEFsWXV3N3V4Vk8xdnhjcnVralR5cjd6XzZYU0RkREpJbGJGcmxiR2ljV1JvV2JuYThsRk9DVFR1Wnp5T3Q3Vm5mQ2lTQTI1a1FfV1dGVF8yemh3dmVRaWJlTEIxY2dCZFF3VTVaT2l1RnhZLVdNR3NYME1WalVnMGZfRnFEZDlhUlR3VFlIMzNSWk8zOWZ5YVdFOG89', 'state': 'XmadL1J1TeZ6DkBGxr4OrO4sIKNDxNOI', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'provadiinserimento', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-13 14:40:13,349 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'provadiinserimento', 'state': 'XmadL1J1TeZ6DkBGxr4OrO4sIKNDxNOI', 'code': 'Z0FBQUFBQmxLVHF0eWRvSGV0Z3M3SEhVUU1JblNlSENxMXJQbUpXX1JtZVJmTF9KSS1waDJkakJScWJDVlRUTWswb05Ea1ZQS1FSaGtWRUViMXViZ2ZzcE9IS0YtWUFkc0tZVy1RNlFGY3lyQi1nNkZSRGtGYlhOTkFuN2doYlIwWHV4RUU3X0NMVUU5OV9lSEFLeTVLTE11NllJMXlJTUVtcV92V3RhVEQzc2RoLVl1MVhSNXgzY3U2dFlfdW12VjJfYkNFWjB5YmdIcEtTUnhvNTFoUkZFVXZLWDhqdWJFbmNGblgzVkRvUzBZenlHai02TjIwSTZKRGlPY1VUa2xibDVMQ2R2Q0pfNVRLRW1qNWd3am5DNzBkVmh6TEY0QlZWSWQ1VGtINXRMVW1PV1J0VTJlVW56aEFGazlNQVpLenRKaERBcGdudWVRNU81VFpMUUZBMDFEY1NtRGVXWENkNnllcDdHNWRtVzFIWGVFZzQwYzRwVE5fa1VVU1ppRjAzY01oa2Y4anVBS19sc29mQ2s3T0NhYmhnZUVnY3dYdDlmS3VmS19iaU9BcXRGN05hU0FHenlDWUZoRW52bjNsYThNTzdsaDByT3BScUpfZTllanJsQWRSM3NIcDJuU1VPU1VMaU9rR2s1dUdRRkszUTlJVWNERDZIZGh0TmlacGNlTnR6Q1pkUk5Lcmx0c2JsajBfU2lIcVlnbEdtRFlWOEFsWXV3N3V4Vk8xdnhjcnVralR5cjd6XzZYU0RkREpJbGJGcmxiR2ljV1JvV2JuYThsRk9DVFR1Wnp5T3Q3Vm5mQ2lTQTI1a1FfV1dGVF8yemh3dmVRaWJlTEIxY2dCZFF3VTVaT2l1RnhZLVdNR3NYME1WalVnMGZfRnFEZDlhUlR3VFlIMzNSWk8zOWZ5YVdFOG89', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'j69K6jn4kMOdWVVdOhSRyDRcN9WFrhlp5Yos41VekrcS1Waho1M9l3y62vvhwd7t'}
2023-10-13 14:40:13,349 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-13 14:40:13,350 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f154daa0f10>, 'url': 'https://sso.isprambiente.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=XmadL1J1TeZ6DkBGxr4OrO4sIKNDxNOI&code=Z0FBQUFBQmxLVHF0eWRvSGV0Z3M3SEhVUU1JblNlSENxMXJQbUpXX1JtZVJmTF9KSS1waDJkakJScWJDVlRUTWswb05Ea1ZQS1FSaGtWRUViMXViZ2ZzcE9IS0YtWUFkc0tZVy1RNlFGY3lyQi1nNkZSRGtGYlhOTkFuN2doYlIwWHV4RUU3X0NMVUU5OV9lSEFLeTVLTE11NllJMXlJTUVtcV92V3RhVEQzc2RoLVl1MVhSNXgzY3U2dFlfdW12VjJfYkNFWjB5YmdIcEtTUnhvNTFoUkZFVXZLWDhqdWJFbmNGblgzVkRvUzBZenlHai02TjIwSTZKRGlPY1VUa2xibDVMQ2R2Q0pfNVRLRW1qNWd3am5DNzBkVmh6TEY0QlZWSWQ1VGtINXRMVW1PV1J0VTJlVW56aEFGazlNQVpLenRKaERBcGdudWVRNU81VFpMUUZBMDFEY1NtRGVXWENkNnllcDdHNWRtVzFIWGVFZzQwYzRwVE5fa1VVU1ppRjAzY01oa2Y4anVBS19sc29mQ2s3T0NhYmhnZUVnY3dYdDlmS3VmS19iaU9BcXRGN05hU0FHenlDWUZoRW52bjNsYThNTzdsaDByT3BScUpfZTllanJsQWRSM3NIcDJuU1VPU1VMaU9rR2s1dUdRRkszUTlJVWNERDZIZGh0TmlacGNlTnR6Q1pkUk5Lcmx0c2JsajBfU2lIcVlnbEdtRFlWOEFsWXV3N3V4Vk8xdnhjcnVralR5cjd6XzZYU0RkREpJbGJGcmxiR2ljV1JvV2JuYThsRk9DVFR1Wnp5T3Q3Vm5mQ2lTQTI1a1FfV1dGVF8yemh3dmVRaWJlTEIxY2dCZFF3VTVaT2l1RnhZLVdNR3NYME1WalVnMGZfRnFEZDlhUlR3VFlIMzNSWk8zOWZ5YVdFOG89&code_verifier=j69K6jn4kMOdWVVdOhSRyDRcN9WFrhlp5Yos41VekrcS1Waho1M9l3y62vvhwd7t', 'headers': {'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-13 14:40:13,350 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=XmadL1J1TeZ6DkBGxr4OrO4sIKNDxNOI&code=Z0FBQUFBQmxLVHF0eWRvSGV0Z3M3SEhVUU1JblNlSENxMXJQbUpXX1JtZVJmTF9KSS1waDJkakJScWJDVlRUTWswb05Ea1ZQS1FSaGtWRUViMXViZ2ZzcE9IS0YtWUFkc0tZVy1RNlFGY3lyQi1nNkZSRGtGYlhOTkFuN2doYlIwWHV4RUU3X0NMVUU5OV9lSEFLeTVLTE11NllJMXlJTUVtcV92V3RhVEQzc2RoLVl1MVhSNXgzY3U2dFlfdW12VjJfYkNFWjB5YmdIcEtTUnhvNTFoUkZFVXZLWDhqdWJFbmNGblgzVkRvUzBZenlHai02TjIwSTZKRGlPY1VUa2xibDVMQ2R2Q0pfNVRLRW1qNWd3am5DNzBkVmh6TEY0QlZWSWQ1VGtINXRMVW1PV1J0VTJlVW56aEFGazlNQVpLenRKaERBcGdudWVRNU81VFpMUUZBMDFEY1NtRGVXWENkNnllcDdHNWRtVzFIWGVFZzQwYzRwVE5fa1VVU1ppRjAzY01oa2Y4anVBS19sc29mQ2s3T0NhYmhnZUVnY3dYdDlmS3VmS19iaU9BcXRGN05hU0FHenlDWUZoRW52bjNsYThNTzdsaDByT3BScUpfZTllanJsQWRSM3NIcDJuU1VPU1VMaU9rR2s1dUdRRkszUTlJVWNERDZIZGh0TmlacGNlTnR6Q1pkUk5Lcmx0c2JsajBfU2lIcVlnbEdtRFlWOEFsWXV3N3V4Vk8xdnhjcnVralR5cjd6XzZYU0RkREpJbGJGcmxiR2ljV1JvV2JuYThsRk9DVFR1Wnp5T3Q3Vm5mQ2lTQTI1a1FfV1dGVF8yemh3dmVRaWJlTEIxY2dCZFF3VTVaT2l1RnhZLVdNR3NYME1WalVnMGZfRnFEZDlhUlR3VFlIMzNSWk8zOWZ5YVdFOG89&code_verifier=j69K6jn4kMOdWVVdOhSRyDRcN9WFrhlp5Yos41VekrcS1Waho1M9l3y62vvhwd7t, https_args:{'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-13 14:40:13,351 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 14:40:13,956 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-13 14:40:13,957 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 14:40:13,958 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 14:40:13,958 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 12:40:13 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdADGTxYe_EMTZD1XPoYw9P56HkXCOtRjppXTv6eE7DH9D2gmHQew8UiupTeVampAm2AxvaRXd3Lb38Kry-Z8CbdjS3IVPpclhzKBOHNYI7icDZlQED3QM4CJhoZLudeq9OAAX70vpS2HT-q5Yoaz9JbrXNpmGgWFKPDQRpmnKh4bX-9p0OyBAnBwzg1w1hyNtuKYxd7G-CY8acNaNT1aKcpdCrJdiNsFYoXkfGuSixnOwtk24Zj03MwAAwZu1jKze87gAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdADGTxYe_EMTZD1XPoYw9P56HkXCOtRjppXTv6eE7DH9D2gmHQew8UiupTeVampAm2AxvaRXd3Lb38Kry-Z8CbdjS3IVPpclhzKBOHNYI7icDZlQED3QM4CJhoZLudeq9OAAX70vpS2HT-q5Yoaz9JbrXNpmGgWFKPDQRpmnKh4bX-9p0OyBAnBwzg1w1hyNtuKYxd7G-CY8acNaNT1aKcpdCrJdiNsFYoXkfGuSixnOwtk24Zj03MwAAwZu1jKze87gAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 14:40:13,958 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6ImVqWTBhbEZGWTJaYVRtdDRWVUZRWVZWcFpXSkZUV2xPWTJ4MlRGYzRhVlJFT0c1NFNUaHJjSFJXYncifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjljYjhjNGI0YWFmYzQ3NjViNTY3NjgzN2NlZWU5ZTk5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZIRjBjWGd4WHpRelgwOURMVXN3TjBwdmFXWmxPVUZxZG1WclNWOXZlbFpTWVZkWk1rczVTWGMzUkcxb1ZtaDVNMHczTlVwVE5UQkROakpIU1dkYU9FMXBhSE5FV1hodldYQjNjMkZ3UzNkdlIyTmhNVFJQYkhsd1VGSmFPRzR6UzJwdFdGaEdYMGhuUmw5TWJsTktabWREUVdSRmJIRnplVXBTVUZoMlkzQTVVR3hKTldGalIxTmxaVlZuUjJJMk0wdGlRWFpHTXpNM04ycFJRVlZmYUdkQk9EbHhaV1JqYWxCNFJHWkVZamR3TFRkelRVUlRlV3cyWlZKeFdFb3hPV1JwVURoV2JGVXlibXhNUVVob1VYUklZVlJ3TmpKS1ZtbzRaVjl0TkZGTk5YcDBNVEk1ZEZCa1YwNXBRbGxMVG5oZmJVSkhWRGd0VUdsTlEzTnBORVZMYnc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjAwODEzLCAiZXhwIjogMTY5NzIwNDQxM30.hVgQCVUp8wagpOmKmxMeXDlAK1eF4BTgE15yfqaP12S0n836wX3pzAEDPl4Ya-Ek-cuGAfDOQxBHXOJz9D3bhg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLVHF0TU4yTGlzWFQ1REFmOE1CSmRIcEM3NENfYVZONndRaTlPWnZlcE9vTWZBVjlMWVlpUnczOHZsbVhWcXZqM29jamprNm0zUnZaREZ2dkZId2hWcko2bXZzQVdPeVVYNGpFdGtnd0JCeW1DSHgwZHZsMzlzbFJJY2g5V1NXMGw3bXAxRDNQWG1lb3ZxOVZIelBSc0pneU9LMEJZTVUzdVF3UnhQMTRkbVkteFRWcTJ1VFlEZFlhVkd6ai15c1J0UDZFUVhQSWNyUzFZNFZRbjRQaC11ck95MF9pUXRpS3VkdHlibnVTaGVXcHRHUENyM1JLejVaVzRvaC1QbnRNbHo3dDN5bVNLZlowWWtPRmFIWXBHcUdBVnJzNjF6cEU5algxMkwyQXptaG5lYnZkSHdRREtWZEttLVNULUZHMWQ3a3RiMXd5d0d1OFpYNUtkdVhaeHh3ZFlvQ1FZendiN0daejZWUWxxMnEwTXBJT2Z4WkV5dm9qQkdTNENXcC1yZmdQd0pqTWZQd3NWWUJsQTh4ckdHNnNEaHhWdlplaFA0dE83S1lJXzFDTFhsdUJ6TVFOUGJXblpkek9XMVhCQW1MZDV5blFVV0MtUU1JUGR1SDdMZ2JIMFZwYnhRLWpjOGVzY3dHSF9OOUVFZmdUNGlMaXhmbHVVWWlmcTRHUGVUdVNkUWltczA5WF9oRjNoR0NpanVtdlJ1Ymh4R2V6aXZHelNkTV9rQ1Rna1pYbXo2dUMyQVkxMURSMlFJaXI2WDBTVWhvRVZJQ1VsbVRuSVU5Y09IRjZxU3NzYm1TMVhVdE9pMGNfdmhFdG9PY0R1ZXJURmN1MFRIYjB6czdZYkJfUnpwUlZwQ0xyWllkWXQxSWQyQkFFRUZNZDNjeEFOOXU0a2ZRQTUyN19wZzg9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImVuZFBhRVpOYTBKRmFGcEhjRk5hVHpKTWQwTXRXbWRrYUZadmVWbG1UaTFxTkZwNFRtRlZjWGw1VlEifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVkhGMGNYZ3hYelF6WDA5RExVc3dOMHB2YVdabE9VRnFkbVZyU1Y5dmVsWlNZVmRaTWtzNVNYYzNSRzFvVm1oNU0wdzNOVXBUTlRCRE5qSkhTV2RhT0UxcGFITkVXWGh2V1hCM2MyRndTM2R2UjJOaE1UUlBiSGx3VUZKYU9HNHpTMnB0V0ZoR1gwaG5SbDlNYmxOS1ptZERRV1JGYkhGemVVcFNVRmgyWTNBNVVHeEpOV0ZqUjFObFpWVm5SMkkyTTB0aVFYWkdNek0zTjJwUlFWVmZhR2RCT0RseFpXUmphbEI0UkdaRVlqZHdMVGR6VFVSVGVXdzJaVkp4V0VveE9XUnBVRGhXYkZVeWJteE1RVWhvVVhSSVlWUndOakpLVm1vNFpWOXRORkZOTlhwME1USTVkRkJrVjA1cFFsbExUbmhmYlVKSFZEZ3RVR2xOUTNOcE5FVkxidz09IiwgImF1dGhfdGltZSI6IDE2OTcyMDA4MTMsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogImE3YjA3ZjE4NjljNTExZWVhYThkMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAiMXlKUTVnblVjd0Uxb2xtcTZRd0o5Wm04IiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIwMDgxMywgImV4cCI6IDE2OTcyMDExMTMsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.AjWSKX6Y83xfvPklmM_KCrSXPvzvHx68qCsLsInyn2y05evvrLRR2IUYo2j8Scb_c4SUCtgUo4MTr9m7crbYgkejFngjY_Gm8TxnbLC_aHeknXW_61n09r2__PrzLAiv13c73BR_VneEwuNMa3eMZdasNyEbFsUp17lFffMFpwsz1Dyr0AtDiOI0voB7Rtwa2v5WFc7gPX2dwLXcLHuF1GHGXCxWTf6ipPLgYZ0Vfp1cYp_86gNa_5rlytG_TscA4KVYkX5gSI8zzdKQKaQXMUFWsx2l0QfEDu5OjdiGnimWQAeXMiJ1SPnxe9qDmWUCyCb9URM-gs6twaJAZjhEkA"}
2023-10-13 14:40:13,958 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6ImVqWTBhbEZGWTJaYVRtdDRWVUZRWVZWcFpXSkZUV2xPWTJ4MlRGYzRhVlJFT0c1NFNUaHJjSFJXYncifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjljYjhjNGI0YWFmYzQ3NjViNTY3NjgzN2NlZWU5ZTk5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZIRjBjWGd4WHpRelgwOURMVXN3TjBwdmFXWmxPVUZxZG1WclNWOXZlbFpTWVZkWk1rczVTWGMzUkcxb1ZtaDVNMHczTlVwVE5UQkROakpIU1dkYU9FMXBhSE5FV1hodldYQjNjMkZ3UzNkdlIyTmhNVFJQYkhsd1VGSmFPRzR6UzJwdFdGaEdYMGhuUmw5TWJsTktabWREUVdSRmJIRnplVXBTVUZoMlkzQTVVR3hKTldGalIxTmxaVlZuUjJJMk0wdGlRWFpHTXpNM04ycFJRVlZmYUdkQk9EbHhaV1JqYWxCNFJHWkVZamR3TFRkelRVUlRlV3cyWlZKeFdFb3hPV1JwVURoV2JGVXlibXhNUVVob1VYUklZVlJ3TmpKS1ZtbzRaVjl0TkZGTk5YcDBNVEk1ZEZCa1YwNXBRbGxMVG5oZmJVSkhWRGd0VUdsTlEzTnBORVZMYnc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjAwODEzLCAiZXhwIjogMTY5NzIwNDQxM30.hVgQCVUp8wagpOmKmxMeXDlAK1eF4BTgE15yfqaP12S0n836wX3pzAEDPl4Ya-Ek-cuGAfDOQxBHXOJz9D3bhg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLVHF0TU4yTGlzWFQ1REFmOE1CSmRIcEM3NENfYVZONndRaTlPWnZlcE9vTWZBVjlMWVlpUnczOHZsbVhWcXZqM29jamprNm0zUnZaREZ2dkZId2hWcko2bXZzQVdPeVVYNGpFdGtnd0JCeW1DSHgwZHZsMzlzbFJJY2g5V1NXMGw3bXAxRDNQWG1lb3ZxOVZIelBSc0pneU9LMEJZTVUzdVF3UnhQMTRkbVkteFRWcTJ1VFlEZFlhVkd6ai15c1J0UDZFUVhQSWNyUzFZNFZRbjRQaC11ck95MF9pUXRpS3VkdHlibnVTaGVXcHRHUENyM1JLejVaVzRvaC1QbnRNbHo3dDN5bVNLZlowWWtPRmFIWXBHcUdBVnJzNjF6cEU5algxMkwyQXptaG5lYnZkSHdRREtWZEttLVNULUZHMWQ3a3RiMXd5d0d1OFpYNUtkdVhaeHh3ZFlvQ1FZendiN0daejZWUWxxMnEwTXBJT2Z4WkV5dm9qQkdTNENXcC1yZmdQd0pqTWZQd3NWWUJsQTh4ckdHNnNEaHhWdlplaFA0dE83S1lJXzFDTFhsdUJ6TVFOUGJXblpkek9XMVhCQW1MZDV5blFVV0MtUU1JUGR1SDdMZ2JIMFZwYnhRLWpjOGVzY3dHSF9OOUVFZmdUNGlMaXhmbHVVWWlmcTRHUGVUdVNkUWltczA5WF9oRjNoR0NpanVtdlJ1Ymh4R2V6aXZHelNkTV9rQ1Rna1pYbXo2dUMyQVkxMURSMlFJaXI2WDBTVWhvRVZJQ1VsbVRuSVU5Y09IRjZxU3NzYm1TMVhVdE9pMGNfdmhFdG9PY0R1ZXJURmN1MFRIYjB6czdZYkJfUnpwUlZwQ0xyWllkWXQxSWQyQkFFRUZNZDNjeEFOOXU0a2ZRQTUyN19wZzg9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImVuZFBhRVpOYTBKRmFGcEhjRk5hVHpKTWQwTXRXbWRrYUZadmVWbG1UaTFxTkZwNFRtRlZjWGw1VlEifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVkhGMGNYZ3hYelF6WDA5RExVc3dOMHB2YVdabE9VRnFkbVZyU1Y5dmVsWlNZVmRaTWtzNVNYYzNSRzFvVm1oNU0wdzNOVXBUTlRCRE5qSkhTV2RhT0UxcGFITkVXWGh2V1hCM2MyRndTM2R2UjJOaE1UUlBiSGx3VUZKYU9HNHpTMnB0V0ZoR1gwaG5SbDlNYmxOS1ptZERRV1JGYkhGemVVcFNVRmgyWTNBNVVHeEpOV0ZqUjFObFpWVm5SMkkyTTB0aVFYWkdNek0zTjJwUlFWVmZhR2RCT0RseFpXUmphbEI0UkdaRVlqZHdMVGR6VFVSVGVXdzJaVkp4V0VveE9XUnBVRGhXYkZVeWJteE1RVWhvVVhSSVlWUndOakpLVm1vNFpWOXRORkZOTlhwME1USTVkRkJrVjA1cFFsbExUbmhmYlVKSFZEZ3RVR2xOUTNOcE5FVkxidz09IiwgImF1dGhfdGltZSI6IDE2OTcyMDA4MTMsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogImE3YjA3ZjE4NjljNTExZWVhYThkMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAiMXlKUTVnblVjd0Uxb2xtcTZRd0o5Wm04IiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIwMDgxMywgImV4cCI6IDE2OTcyMDExMTMsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.AjWSKX6Y83xfvPklmM_KCrSXPvzvHx68qCsLsInyn2y05evvrLRR2IUYo2j8Scb_c4SUCtgUo4MTr9m7crbYgkejFngjY_Gm8TxnbLC_aHeknXW_61n09r2__PrzLAiv13c73BR_VneEwuNMa3eMZdasNyEbFsUp17lFffMFpwsz1Dyr0AtDiOI0voB7Rtwa2v5WFc7gPX2dwLXcLHuF1GHGXCxWTf6ipPLgYZ0Vfp1cYp_86gNa_5rlytG_TscA4KVYkX5gSI8zzdKQKaQXMUFWsx2l0QfEDu5OjdiGnimWQAeXMiJ1SPnxe9qDmWUCyCb9URM-gs6twaJAZjhEkA"}
2023-10-13 14:40:13,958 oidcrp.service DEBUG response format: json
2023-10-13 14:40:13,958 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-13 14:40:13,959 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6ImVqWTBhbEZGWTJaYVRtdDRWVUZRWVZWcFpXSkZUV2xPWTJ4MlRGYzRhVlJFT0c1NFNUaHJjSFJXYncifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjljYjhjNGI0YWFmYzQ3NjViNTY3NjgzN2NlZWU5ZTk5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZIRjBjWGd4WHpRelgwOURMVXN3TjBwdmFXWmxPVUZxZG1WclNWOXZlbFpTWVZkWk1rczVTWGMzUkcxb1ZtaDVNMHczTlVwVE5UQkROakpIU1dkYU9FMXBhSE5FV1hodldYQjNjMkZ3UzNkdlIyTmhNVFJQYkhsd1VGSmFPRzR6UzJwdFdGaEdYMGhuUmw5TWJsTktabWREUVdSRmJIRnplVXBTVUZoMlkzQTVVR3hKTldGalIxTmxaVlZuUjJJMk0wdGlRWFpHTXpNM04ycFJRVlZmYUdkQk9EbHhaV1JqYWxCNFJHWkVZamR3TFRkelRVUlRlV3cyWlZKeFdFb3hPV1JwVURoV2JGVXlibXhNUVVob1VYUklZVlJ3TmpKS1ZtbzRaVjl0TkZGTk5YcDBNVEk1ZEZCa1YwNXBRbGxMVG5oZmJVSkhWRGd0VUdsTlEzTnBORVZMYnc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjAwODEzLCAiZXhwIjogMTY5NzIwNDQxM30.hVgQCVUp8wagpOmKmxMeXDlAK1eF4BTgE15yfqaP12S0n836wX3pzAEDPl4Ya-Ek-cuGAfDOQxBHXOJz9D3bhg', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxLVHF0TU4yTGlzWFQ1REFmOE1CSmRIcEM3NENfYVZONndRaTlPWnZlcE9vTWZBVjlMWVlpUnczOHZsbVhWcXZqM29jamprNm0zUnZaREZ2dkZId2hWcko2bXZzQVdPeVVYNGpFdGtnd0JCeW1DSHgwZHZsMzlzbFJJY2g5V1NXMGw3bXAxRDNQWG1lb3ZxOVZIelBSc0pneU9LMEJZTVUzdVF3UnhQMTRkbVkteFRWcTJ1VFlEZFlhVkd6ai15c1J0UDZFUVhQSWNyUzFZNFZRbjRQaC11ck95MF9pUXRpS3VkdHlibnVTaGVXcHRHUENyM1JLejVaVzRvaC1QbnRNbHo3dDN5bVNLZlowWWtPRmFIWXBHcUdBVnJzNjF6cEU5algxMkwyQXptaG5lYnZkSHdRREtWZEttLVNULUZHMWQ3a3RiMXd5d0d1OFpYNUtkdVhaeHh3ZFlvQ1FZendiN0daejZWUWxxMnEwTXBJT2Z4WkV5dm9qQkdTNENXcC1yZmdQd0pqTWZQd3NWWUJsQTh4ckdHNnNEaHhWdlplaFA0dE83S1lJXzFDTFhsdUJ6TVFOUGJXblpkek9XMVhCQW1MZDV5blFVV0MtUU1JUGR1SDdMZ2JIMFZwYnhRLWpjOGVzY3dHSF9OOUVFZmdUNGlMaXhmbHVVWWlmcTRHUGVUdVNkUWltczA5WF9oRjNoR0NpanVtdlJ1Ymh4R2V6aXZHelNkTV9rQ1Rna1pYbXo2dUMyQVkxMURSMlFJaXI2WDBTVWhvRVZJQ1VsbVRuSVU5Y09IRjZxU3NzYm1TMVhVdE9pMGNfdmhFdG9PY0R1ZXJURmN1MFRIYjB6czdZYkJfUnpwUlZwQ0xyWllkWXQxSWQyQkFFRUZNZDNjeEFOOXU0a2ZRQTUyN19wZzg9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6ImVuZFBhRVpOYTBKRmFGcEhjRk5hVHpKTWQwTXRXbWRrYUZadmVWbG1UaTFxTkZwNFRtRlZjWGw1VlEifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVkhGMGNYZ3hYelF6WDA5RExVc3dOMHB2YVdabE9VRnFkbVZyU1Y5dmVsWlNZVmRaTWtzNVNYYzNSRzFvVm1oNU0wdzNOVXBUTlRCRE5qSkhTV2RhT0UxcGFITkVXWGh2V1hCM2MyRndTM2R2UjJOaE1UUlBiSGx3VUZKYU9HNHpTMnB0V0ZoR1gwaG5SbDlNYmxOS1ptZERRV1JGYkhGemVVcFNVRmgyWTNBNVVHeEpOV0ZqUjFObFpWVm5SMkkyTTB0aVFYWkdNek0zTjJwUlFWVmZhR2RCT0RseFpXUmphbEI0UkdaRVlqZHdMVGR6VFVSVGVXdzJaVkp4V0VveE9XUnBVRGhXYkZVeWJteE1RVWhvVVhSSVlWUndOakpLVm1vNFpWOXRORkZOTlhwME1USTVkRkJrVjA1cFFsbExUbmhmYlVKSFZEZ3RVR2xOUTNOcE5FVkxidz09IiwgImF1dGhfdGltZSI6IDE2OTcyMDA4MTMsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogImE3YjA3ZjE4NjljNTExZWVhYThkMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAiMXlKUTVnblVjd0Uxb2xtcTZRd0o5Wm04IiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIwMDgxMywgImV4cCI6IDE2OTcyMDExMTMsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.AjWSKX6Y83xfvPklmM_KCrSXPvzvHx68qCsLsInyn2y05evvrLRR2IUYo2j8Scb_c4SUCtgUo4MTr9m7crbYgkejFngjY_Gm8TxnbLC_aHeknXW_61n09r2__PrzLAiv13c73BR_VneEwuNMa3eMZdasNyEbFsUp17lFffMFpwsz1Dyr0AtDiOI0voB7Rtwa2v5WFc7gPX2dwLXcLHuF1GHGXCxWTf6ipPLgYZ0Vfp1cYp_86gNa_5rlytG_TscA4KVYkX5gSI8zzdKQKaQXMUFWsx2l0QfEDu5OjdiGnimWQAeXMiJ1SPnxe9qDmWUCyCb9URM-gs6twaJAZjhEkA'}"
2023-10-13 14:40:13,959 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15}
2023-10-13 14:40:13,961 oidcmsg.message DEBUG Raw JSON: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLVHF0cXgxXzQzX09DLUswN0pvaWZlOUFqdmVrSV9velZSYVdZMks5SXc3RG1oVmh5M0w3NUpTNTBDNjJHSWdaOE1paHNEWXhvWXB3c2FwS3dvR2NhMTRPbHlwUFJaOG4zS2ptWFhGX0hnRl9MblNKZmdDQWRFbHFzeUpSUFh2Y3A5UGxJNWFjR1NlZVVnR2I2M0tiQXZGMzM3N2pRQVVfaGdBODlxZWRjalB4RGZEYjdwLTdzTURTeWw2ZVJxWEoxOWRpUDhWbFUybmxMQUhoUXRIYVRwNjJKVmo4ZV9tNFFNNXp0MTI5dFBkV05pQllLTnhfbUJHVDgtUGlNQ3NpNEVLbw==', 'auth_time': 1697200813, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'a7b07f1869c511eeaa8d0242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': '1yJQ5gnUcwE1olmq6QwJ9Zm8', 'iss': 'https://sso.isprambiente.it', 'iat': 1697200813, 'exp': 1697201113, 'aud': ['provadiinserimento']}
2023-10-13 14:40:13,961 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'endPaEZNa0JFaFpHcFNaTzJMd0MtWmdkaFZveVlmTi1qNFp4TmFVcXl5VQ'}
2023-10-13 14:40:13,961 cryptojwt.key_jar DEBUG Key summary for https://sso.isprambiente.it: RSA:sig:endPaEZNa0JFaFpHcFNaTzJMd0MtWmdkaFZveVlmTi1qNFp4TmFVcXl5VQ, EC:sig:ejY0alFFY2ZaTmt4VUFQYVVpZWJFTWlOY2x2TFc4aVREOG54SThrcHRWbw
2023-10-13 14:40:13,961 oidcmsg.message DEBUG Found signing key.
2023-10-13 14:40:13,961 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-13 14:40:13,961 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=endPaEZNa0JFaFpHcFNaTzJMd0MtWmdkaFZveVlmTi1qNFp4TmFVcXl5VQ and use=
2023-10-13 14:40:13,962 cryptojwt.jwx DEBUG Picked: kid:endPaEZNa0JFaFpHcFNaTzJMd0MtWmdkaFZveVlmTi1qNFp4TmFVcXl5VQ, use:sig, kty:RSA
2023-10-13 14:40:13,963 cryptojwt.jws.jws DEBUG Verified message using key with kid=endPaEZNa0JFaFpHcFNaTzJMd0MtWmdkaFZveVlmTi1qNFp4TmFVcXl5VQ
2023-10-13 14:40:13,963 oidcmsg.oidc INFO Verified id_token: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLVHF0cXgxXzQzX09DLUswN0pvaWZlOUFqdmVrSV9velZSYVdZMks5SXc3RG1oVmh5M0w3NUpTNTBDNjJHSWdaOE1paHNEWXhvWXB3c2FwS3dvR2NhMTRPbHlwUFJaOG4zS2ptWFhGX0hnRl9MblNKZmdDQWRFbHFzeUpSUFh2Y3A5UGxJNWFjR1NlZVVnR2I2M0tiQXZGMzM3N2pRQVVfaGdBODlxZWRjalB4RGZEYjdwLTdzTURTeWw2ZVJxWEoxOWRpUDhWbFUybmxMQUhoUXRIYVRwNjJKVmo4ZV9tNFFNNXp0MTI5dFBkV05pQllLTnhfbUJHVDgtUGlNQ3NpNEVLbw==', 'auth_time': 1697200813, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'a7b07f1869c511eeaa8d0242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': '1yJQ5gnUcwE1olmq6QwJ9Zm8', 'iss': 'https://sso.isprambiente.it', 'iat': 1697200813, 'exp': 1697201113, 'aud': ['provadiinserimento']}
2023-10-13 14:40:13,966 oidcrp.rp_handler DEBUG ID Token: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLVHF0cXgxXzQzX09DLUswN0pvaWZlOUFqdmVrSV9velZSYVdZMks5SXc3RG1oVmh5M0w3NUpTNTBDNjJHSWdaOE1paHNEWXhvWXB3c2FwS3dvR2NhMTRPbHlwUFJaOG4zS2ptWFhGX0hnRl9MblNKZmdDQWRFbHFzeUpSUFh2Y3A5UGxJNWFjR1NlZVVnR2I2M0tiQXZGMzM3N2pRQVVfaGdBODlxZWRjalB4RGZEYjdwLTdzTURTeWw2ZVJxWEoxOWRpUDhWbFUybmxMQUhoUXRIYVRwNjJKVmo4ZV9tNFFNNXp0MTI5dFBkV05pQllLTnhfbUJHVDgtUGlNQ3NpNEVLbw==', 'auth_time': 1697200813, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'a7b07f1869c511eeaa8d0242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': '1yJQ5gnUcwE1olmq6QwJ9Zm8', 'iss': 'https://sso.isprambiente.it', 'iat': 1697200813, 'exp': 1697201113, 'aud': ['provadiinserimento']}
2023-10-13 14:40:13,966 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-13 14:40:13,966 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6ImVqWTBhbEZGWTJaYVRtdDRWVUZRWVZWcFpXSkZUV2xPWTJ4MlRGYzRhVlJFT0c1NFNUaHJjSFJXYncifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjljYjhjNGI0YWFmYzQ3NjViNTY3NjgzN2NlZWU5ZTk5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZIRjBjWGd4WHpRelgwOURMVXN3TjBwdmFXWmxPVUZxZG1WclNWOXZlbFpTWVZkWk1rczVTWGMzUkcxb1ZtaDVNMHczTlVwVE5UQkROakpIU1dkYU9FMXBhSE5FV1hodldYQjNjMkZ3UzNkdlIyTmhNVFJQYkhsd1VGSmFPRzR6UzJwdFdGaEdYMGhuUmw5TWJsTktabWREUVdSRmJIRnplVXBTVUZoMlkzQTVVR3hKTldGalIxTmxaVlZuUjJJMk0wdGlRWFpHTXpNM04ycFJRVlZmYUdkQk9EbHhaV1JqYWxCNFJHWkVZamR3TFRkelRVUlRlV3cyWlZKeFdFb3hPV1JwVURoV2JGVXlibXhNUVVob1VYUklZVlJ3TmpKS1ZtbzRaVjl0TkZGTk5YcDBNVEk1ZEZCa1YwNXBRbGxMVG5oZmJVSkhWRGd0VUdsTlEzTnBORVZMYnc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjAwODEzLCAiZXhwIjogMTY5NzIwNDQxM30.hVgQCVUp8wagpOmKmxMeXDlAK1eF4BTgE15yfqaP12S0n836wX3pzAEDPl4Ya-Ek-cuGAfDOQxBHXOJz9D3bhg'}
2023-10-13 14:40:13,966 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-13 14:40:13,966 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f154dad9e10>, 'url': 'https://sso.isprambiente.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6ImVqWTBhbEZGWTJaYVRtdDRWVUZRWVZWcFpXSkZUV2xPWTJ4MlRGYzRhVlJFT0c1NFNUaHJjSFJXYncifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjljYjhjNGI0YWFmYzQ3NjViNTY3NjgzN2NlZWU5ZTk5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZIRjBjWGd4WHpRelgwOURMVXN3TjBwdmFXWmxPVUZxZG1WclNWOXZlbFpTWVZkWk1rczVTWGMzUkcxb1ZtaDVNMHczTlVwVE5UQkROakpIU1dkYU9FMXBhSE5FV1hodldYQjNjMkZ3UzNkdlIyTmhNVFJQYkhsd1VGSmFPRzR6UzJwdFdGaEdYMGhuUmw5TWJsTktabWREUVdSRmJIRnplVXBTVUZoMlkzQTVVR3hKTldGalIxTmxaVlZuUjJJMk0wdGlRWFpHTXpNM04ycFJRVlZmYUdkQk9EbHhaV1JqYWxCNFJHWkVZamR3TFRkelRVUlRlV3cyWlZKeFdFb3hPV1JwVURoV2JGVXlibXhNUVVob1VYUklZVlJ3TmpKS1ZtbzRaVjl0TkZGTk5YcDBNVEk1ZEZCa1YwNXBRbGxMVG5oZmJVSkhWRGd0VUdsTlEzTnBORVZMYnc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjAwODEzLCAiZXhwIjogMTY5NzIwNDQxM30.hVgQCVUp8wagpOmKmxMeXDlAK1eF4BTgE15yfqaP12S0n836wX3pzAEDPl4Ya-Ek-cuGAfDOQxBHXOJz9D3bhg'}}
2023-10-13 14:40:13,966 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6ImVqWTBhbEZGWTJaYVRtdDRWVUZRWVZWcFpXSkZUV2xPWTJ4MlRGYzRhVlJFT0c1NFNUaHJjSFJXYncifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjljYjhjNGI0YWFmYzQ3NjViNTY3NjgzN2NlZWU5ZTk5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZIRjBjWGd4WHpRelgwOURMVXN3TjBwdmFXWmxPVUZxZG1WclNWOXZlbFpTWVZkWk1rczVTWGMzUkcxb1ZtaDVNMHczTlVwVE5UQkROakpIU1dkYU9FMXBhSE5FV1hodldYQjNjMkZ3UzNkdlIyTmhNVFJQYkhsd1VGSmFPRzR6UzJwdFdGaEdYMGhuUmw5TWJsTktabWREUVdSRmJIRnplVXBTVUZoMlkzQTVVR3hKTldGalIxTmxaVlZuUjJJMk0wdGlRWFpHTXpNM04ycFJRVlZmYUdkQk9EbHhaV1JqYWxCNFJHWkVZamR3TFRkelRVUlRlV3cyWlZKeFdFb3hPV1JwVURoV2JGVXlibXhNUVVob1VYUklZVlJ3TmpKS1ZtbzRaVjl0TkZGTk5YcDBNVEk1ZEZCa1YwNXBRbGxMVG5oZmJVSkhWRGd0VUdsTlEzTnBORVZMYnc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjAwODEzLCAiZXhwIjogMTY5NzIwNDQxM30.hVgQCVUp8wagpOmKmxMeXDlAK1eF4BTgE15yfqaP12S0n836wX3pzAEDPl4Ya-Ek-cuGAfDOQxBHXOJz9D3bhg'}
2023-10-13 14:40:13,968 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 14:40:14,531 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-13 14:40:14,531 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 14:40:14,532 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 14:40:14,532 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 12:40:14 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACiVhb-7N96EBHqy0QtcfUXzohd1iGC8S7srWn18hrfckDQVYJ57OXO1tR8jIyn7wWLZ-7V0Nw_TmJf9-lrp_xRRlaP6EGUoR0eFpzWgxob6VXqu-by_n66DWmkGKP-GZ6aKmgZoUlEXzsBICBKM9fxMeCJb9lBYupZmwV0N6PIJ3WbxzqE3puySw5UQ2pafcIqBO3DemSShcQ8WF2Ones-359e-LopXo88Of0eB9DppUAxfmmJo3cIAAAAAAKLLqpPBJbHLAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACiVhb-7N96EBHqy0QtcfUXzohd1iGC8S7srWn18hrfckDQVYJ57OXO1tR8jIyn7wWLZ-7V0Nw_TmJf9-lrp_xRRlaP6EGUoR0eFpzWgxob6VXqu-by_n66DWmkGKP-GZ6aKmgZoUlEXzsBICBKM9fxMeCJb9lBYupZmwV0N6PIJ3WbxzqE3puySw5UQ2pafcIqBO3DemSShcQ8WF2Ones-359e-LopXo88Of0eB9DppUAxfmmJo3cIAAAAAAKLLqpPBJbHLAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 14:40:14,532 oidcrp.util DEBUG resp.txt: {"sub": "5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619", "name": "ANDREA", "given_name": "ANDREA", "family_name": "RANALDI", "nickname": "RANALDI", "acr": "https://www.spid.gov.it/SpidL2"}
2023-10-13 14:40:14,532 oidcrp.oauth2 DEBUG Successful response: {"sub": "5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619", "name": "ANDREA", "given_name": "ANDREA", "family_name": "RANALDI", "nickname": "RANALDI", "acr": "https://www.spid.gov.it/SpidL2"}
2023-10-13 14:40:14,532 oidcrp.service DEBUG response format: json
2023-10-13 14:40:14,532 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-13 14:40:14,532 oidcrp.service DEBUG Initial response parsing => "{'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'name': 'ANDREA', 'given_name': 'ANDREA', 'family_name': 'RANALDI', 'nickname': 'RANALDI', 'acr': 'https://www.spid.gov.it/SpidL2'}"
2023-10-13 14:40:14,532 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15}
2023-10-13 14:40:14,533 oidcrp.rp_handler DEBUG UserInfo: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'name': 'ANDREA', 'given_name': 'ANDREA', 'family_name': 'RANALDI', 'nickname': 'RANALDI', 'acr': 'https://www.spid.gov.it/SpidL2'}
2023-10-13 14:40:14,535 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 14:40:14] "GET /authz_cb/satosa?state=XmadL1J1TeZ6DkBGxr4OrO4sIKNDxNOI&scope=openid+offline_access+profile&code=Z0FBQUFBQmxLVHF0eWRvSGV0Z3M3SEhVUU1JblNlSENxMXJQbUpXX1JtZVJmTF9KSS1waDJkakJScWJDVlRUTWswb05Ea1ZQS1FSaGtWRUViMXViZ2ZzcE9IS0YtWUFkc0tZVy1RNlFGY3lyQi1nNkZSRGtGYlhOTkFuN2doYlIwWHV4RUU3X0NMVUU5OV9lSEFLeTVLTE11NllJMXlJTUVtcV92V3RhVEQzc2RoLVl1MVhSNXgzY3U2dFlfdW12VjJfYkNFWjB5YmdIcEtTUnhvNTFoUkZFVXZLWDhqdWJFbmNGblgzVkRvUzBZenlHai02TjIwSTZKRGlPY1VUa2xibDVMQ2R2Q0pfNVRLRW1qNWd3am5DNzBkVmh6TEY0QlZWSWQ1VGtINXRMVW1PV1J0VTJlVW56aEFGazlNQVpLenRKaERBcGdudWVRNU81VFpMUUZBMDFEY1NtRGVXWENkNnllcDdHNWRtVzFIWGVFZzQwYzRwVE5fa1VVU1ppRjAzY01oa2Y4anVBS19sc29mQ2s3T0NhYmhnZUVnY3dYdDlmS3VmS19iaU9BcXRGN05hU0FHenlDWUZoRW52bjNsYThNTzdsaDByT3BScUpfZTllanJsQWRSM3NIcDJuU1VPU1VMaU9rR2s1dUdRRkszUTlJVWNERDZIZGh0TmlacGNlTnR6Q1pkUk5Lcmx0c2JsajBfU2lIcVlnbEdtRFlWOEFsWXV3N3V4Vk8xdnhjcnVralR5cjd6XzZYU0RkREpJbGJGcmxiR2ljV1JvV2JuYThsRk9DVFR1Wnp5T3Q3Vm5mQ2lTQTI1a1FfV1dGVF8yemh3dmVRaWJlTEIxY2dCZFF3VTVaT2l1RnhZLVdNR3NYME1WalVnMGZfRnFEZDlhUlR3VFlIMzNSWk8zOWZ5YVdFOG89&iss=https://sso.isprambiente.it&client_id=provadiinserimento HTTP/1.1" 200 -
2023-10-13 16:04:11,202 root DEBUG Configured logging using dictionary
2023-10-13 16:04:11,240 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-13 16:04:11,240 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-13 16:04:11,240 werkzeug INFO  * Restarting with stat
2023-10-13 16:04:11,419 root DEBUG Configured logging using dictionary
2023-10-13 16:04:11,456 werkzeug WARNING  * Debugger is active!
2023-10-13 16:04:11,456 werkzeug INFO  * Debugger PIN: 221-170-319
2023-10-13 16:05:18,299 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:05:18] "GET / HTTP/1.1" 200 -
2023-10-13 16:05:23,156 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-13 16:05:23,156 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-13 16:05:23,157 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-13 16:05:23,157 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-13 16:05:23,198 oidcrp.rp_handler DEBUG Get provider info
2023-10-13 16:05:23,199 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-13 16:05:23,199 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://oidc.unimi.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-13 16:05:23,199 oidcrp.oauth2 DEBUG Doing request with: URL:https://oidc.unimi.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-13 16:05:23,200 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): oidc.unimi.it:443
2023-10-13 16:05:23,482 urllib3.connectionpool DEBUG https://oidc.unimi.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-13 16:05:23,484 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:05:23,484 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:05:23,484 oidcrp.util DEBUG resp.headers: {'Date': 'Fri, 13 Oct 2023 14:05:20 GMT', 'Server': 'Apache/2.4.37 (Red Hat Enterprise Linux) OpenSSL/1.1.1g', 'Strict-Transport-Security': 'max-age=63072000;includeSubDomains;preload', 'Content-Type': 'application/json', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADyUiIdc8FaXnKJlWrFmhdkhFlBI7ZPPTeq9ZgeQ-MmnZuQMzQK8t02cKI_y2kr70sSKlORQw08AMqEEpHaC5wj643IQMGsUIjndzQDiInTOcvafoAumYghLUG2mKTThCV_sklXVcV19KmrC48VsxuBTdrEhoXvzqw7MCej1SCpSPm-EejApacmZrWaApWRz5wDNfbtBweKJkaN6bXeAhentOYbKTAmUZOLYX7dWVk5pi-1FqIZAlYsOAAAAAD5CxUjxFc07AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADyUiIdc8FaXnKJlWrFmhdkhFlBI7ZPPTeq9ZgeQ-MmnZuQMzQK8t02cKI_y2kr70sSKlORQw08AMqEEpHaC5wj643IQMGsUIjndzQDiInTOcvafoAumYghLUG2mKTThCV_sklXVcV19KmrC48VsxuBTdrEhoXvzqw7MCej1SCpSPm-EejApacmZrWaApWRz5wDNfbtBweKJkaN6bXeAhentOYbKTAmUZOLYX7dWVk5pi-1FqIZAlYsOAAAAAD5CxUjxFc07AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'Keep-Alive': 'timeout=3, max=500', 'Connection': 'Keep-Alive', 'Transfer-Encoding': 'chunked'}
2023-10-13 16:05:23,484 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token", "implicit"], "jwks_uri": "https://oidc.unimi.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://oidc.unimi.it", "authorization_endpoint": "https://oidc.unimi.it/OIDC/authorization", "token_endpoint": "https://oidc.unimi.it/OIDC/token", "userinfo_endpoint": "https://oidc.unimi.it/OIDC/userinfo", "introspection_endpoint": "https://oidc.unimi.it/OIDC/introspection"}
2023-10-13 16:05:23,484 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token", "implicit"], "jwks_uri": "https://oidc.unimi.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://oidc.unimi.it", "authorization_endpoint": "https://oidc.unimi.it/OIDC/authorization", "token_endpoint": "https://oidc.unimi.it/OIDC/token", "userinfo_endpoint": "https://oidc.unimi.it/OIDC/userinfo", "introspection_endpoint": "https://oidc.unimi.it/OIDC/introspection"}
2023-10-13 16:05:23,485 oidcrp.service DEBUG response format: json
2023-10-13 16:05:23,485 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-13 16:05:23,485 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token', 'implicit'], 'jwks_uri': 'https://oidc.unimi.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://oidc.unimi.it', 'authorization_endpoint': 'https://oidc.unimi.it/OIDC/authorization', 'token_endpoint': 'https://oidc.unimi.it/OIDC/token', 'userinfo_endpoint': 'https://oidc.unimi.it/OIDC/userinfo', 'introspection_endpoint': 'https://oidc.unimi.it/OIDC/introspection'}"
2023-10-13 16:05:23,485 oidcrp.service DEBUG Verify response with {'iss': 'https://oidc.unimi.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'provadiinserimento'}
2023-10-13 16:05:23,487 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://oidc.unimi.it
2023-10-13 16:05:23,488 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-13 16:05:23,488 cryptojwt.key_bundle INFO Reading remote JWKS from https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:05:23,488 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:05:23,490 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): oidc.unimi.it:443
2023-10-13 16:05:23,684 urllib3.connectionpool DEBUG https://oidc.unimi.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-13 16:05:23,685 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ", "n": "tQKOGIUZUwAGf0ZcWcjx_1qODgb2JilM3NUutnJDMr6Pi4zFtoCRnr4wUVsC9cGPxoMzRgnpIp20w5cyjxk6G7UGg73biNVxVJeBxvNTy60B8CZv0Kc_JWqHK_bynHDoboI9-Mzp2eKDKb2INOlT7VFl-hj4NrTbVMN6FF3h1w2dFqxwraL2ySXow7RBE8OebcmqRkOyhEAfM03Ft6pq9HZYoiPr0qZoS-5wyJhty8moQq0u7QcuufCNwCh6kCWDs07T3CkZ5oFdbb-5htNy78UdntLGbzB7u6vzqhws-mT6hVvaygNSEqLGasWqeE7CrL7VIazzno3d0oO-C1SNoQ", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "Y0JpcWJHX1A4Y1NXV1RUdFlwUGRVb2hYazNlbDJVR3lnMEVtS1hyNjhsMA", "crv": "P-256", "x": "VKEzvdiATNL2xRGv98WuKOVgq5EnTLJbF4md-aUHjSU", "y": "u7sOk-_FzyzKeM0s3fqC54-pDWTCBC8cuZ0lyhuqBfI"}]} from https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:05:23,685 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ", "n": "tQKOGIUZUwAGf0ZcWcjx_1qODgb2JilM3NUutnJDMr6Pi4zFtoCRnr4wUVsC9cGPxoMzRgnpIp20w5cyjxk6G7UGg73biNVxVJeBxvNTy60B8CZv0Kc_JWqHK_bynHDoboI9-Mzp2eKDKb2INOlT7VFl-hj4NrTbVMN6FF3h1w2dFqxwraL2ySXow7RBE8OebcmqRkOyhEAfM03Ft6pq9HZYoiPr0qZoS-5wyJhty8moQq0u7QcuufCNwCh6kCWDs07T3CkZ5oFdbb-5htNy78UdntLGbzB7u6vzqhws-mT6hVvaygNSEqLGasWqeE7CrL7VIazzno3d0oO-C1SNoQ", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "Y0JpcWJHX1A4Y1NXV1RUdFlwUGRVb2hYazNlbDJVR3lnMEVtS1hyNjhsMA", "crv": "P-256", "x": "VKEzvdiATNL2xRGv98WuKOVgq5EnTLJbF4md-aUHjSU", "y": "u7sOk-_FzyzKeM0s3fqC54-pDWTCBC8cuZ0lyhuqBfI"}]} from https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:05:23,688 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'prompt': 'consent'}
2023-10-13 16:05:23,688 oidcrp.rp_handler DEBUG Do client registration
2023-10-13 16:05:23,689 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-13 16:05:23,689 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-13 16:05:23,689 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'QvqDv2uDGMBhgt1ken6iQRGv', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR'}
2023-10-13 16:05:23,690 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'QvqDv2uDGMBhgt1ken6iQRGv', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR', 'code_challenge': 'XessRqcwsRhxknjkcT0VQpGFPJJdTOfVjey1Q43THO4', 'code_challenge_method': 'S256', 'client_id': 'provadiinserimento', 'prompt': 'consent'}
2023-10-13 16:05:23,691 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7fafab936290>, 'url': 'https://oidc.unimi.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=QvqDv2uDGMBhgt1ken6iQRGv&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR&code_challenge=XessRqcwsRhxknjkcT0VQpGFPJJdTOfVjey1Q43THO4&code_challenge_method=S256&client_id=provadiinserimento&prompt=consent'}
2023-10-13 16:05:23,692 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:05:23] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-13 16:05:41,512 flask_rp.views DEBUG Issuer: https://oidc.unimi.it
2023-10-13 16:05:41,512 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-13 16:05:41,513 oidcrp.service DEBUG response format: dict
2023-10-13 16:05:41,513 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-13 16:05:41,513 oidcrp.service DEBUG Initial response parsing => "{'state': 'SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxLVTYxeXpkUm45T0ljdG9rLVRSRU9pazFIT2s0ZlFKbmZBdEZuTG1yVmZNT181UEI5RDN6NFlKeFZHMjhqZFc0ZENPZlJjd3NydzY0OFF2QzAxNXZNOEJCSUR3N0VsdjgyTlZHSjExQ01aRk1LWk1yQVFUN3AzU0w0My1XbGk3VlBOVjEyYlBHczBwMGg2T0FaR08wQnFDTFZ6aDQ1akJSVHpkRi1aREVvZjA4Y2hvR3czQTZVSFRfX0ZNSzl3UExycDVsTGpQTHYxWHgxbS0zRDZIWDhGMHBpcUs3WU5iTkJ1SXo0Vk8zWjh4RThoSG9OczFqX0diY2V1WThUYjlFOTFNQ21zNTRhVU9Ta0tFREprU0E1SmZGLVlwZzVWdHVSTDBOWDYxOHUtbHhGZG9NZi1ZM1d0M2s3Y1hFQmgtc0FUSFNjWGYtaDV2TkVCRmIyajlKbUZnZmhkWjhTeThzOVNWNjFDdy1KUHB1aG9oMTBmOTRjTTdXMWFIX1c0cGN5SndsVEtLRVJqUGFWdUpkZ2RQYlc4YnRWZnJfV25JalJsbVp4ZTg5UU04YlBqVE9jN09DVlBKaEZ0d2JzNXpzYTktb2dzS2JmdllIb3YwQmpSVkg4SGlKaTNoYzJZbkFYSXlYWW9tN0tNOWRzVDhIYldmQmk0WFZLWllvdUw0MkVVNnJjR2sxRm5zX29oNm9RQmNTZ0NkTFhuZmdaTnVTRWw3d2RFMEdfblJaUUJwWFlIei1WVTFnZ0k0RVd0Qm5fVy1HVFBrX2xjVy0tS2NmWHQ0YjBtUjc1UGtwb3gwNzJXbjNGZl9VOUJFR1VGMlZ3a3ZNX0dzMTdfNjRObHp1VjhEZXhkYnRqaTVwRzVnQXlOZXJsaWVZUm02bWVmcURoejBQLXNwQno1eVdUYWt1TEhtTEZTT244N1BmZ1BZeTBXVkRPUkxSVmZvRElSQ3l3dkZzYklNRE1RPT0=', 'iss': 'https://oidc.unimi.it', 'client_id': 'provadiinserimento'}"
2023-10-13 16:05:41,513 oidcrp.service DEBUG Verify response with {'iss': 'https://oidc.unimi.it', 'keyjar': <KeyJar(issuers=['', 'https://oidc.unimi.it'])>, 'verify': True, 'skew': 15, 'client_id': 'provadiinserimento'}
2023-10-13 16:05:41,513 oidcrp.rp_handler DEBUG Authz response: {'state': 'SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxLVTYxeXpkUm45T0ljdG9rLVRSRU9pazFIT2s0ZlFKbmZBdEZuTG1yVmZNT181UEI5RDN6NFlKeFZHMjhqZFc0ZENPZlJjd3NydzY0OFF2QzAxNXZNOEJCSUR3N0VsdjgyTlZHSjExQ01aRk1LWk1yQVFUN3AzU0w0My1XbGk3VlBOVjEyYlBHczBwMGg2T0FaR08wQnFDTFZ6aDQ1akJSVHpkRi1aREVvZjA4Y2hvR3czQTZVSFRfX0ZNSzl3UExycDVsTGpQTHYxWHgxbS0zRDZIWDhGMHBpcUs3WU5iTkJ1SXo0Vk8zWjh4RThoSG9OczFqX0diY2V1WThUYjlFOTFNQ21zNTRhVU9Ta0tFREprU0E1SmZGLVlwZzVWdHVSTDBOWDYxOHUtbHhGZG9NZi1ZM1d0M2s3Y1hFQmgtc0FUSFNjWGYtaDV2TkVCRmIyajlKbUZnZmhkWjhTeThzOVNWNjFDdy1KUHB1aG9oMTBmOTRjTTdXMWFIX1c0cGN5SndsVEtLRVJqUGFWdUpkZ2RQYlc4YnRWZnJfV25JalJsbVp4ZTg5UU04YlBqVE9jN09DVlBKaEZ0d2JzNXpzYTktb2dzS2JmdllIb3YwQmpSVkg4SGlKaTNoYzJZbkFYSXlYWW9tN0tNOWRzVDhIYldmQmk0WFZLWllvdUw0MkVVNnJjR2sxRm5zX29oNm9RQmNTZ0NkTFhuZmdaTnVTRWw3d2RFMEdfblJaUUJwWFlIei1WVTFnZ0k0RVd0Qm5fVy1HVFBrX2xjVy0tS2NmWHQ0YjBtUjc1UGtwb3gwNzJXbjNGZl9VOUJFR1VGMlZ3a3ZNX0dzMTdfNjRObHp1VjhEZXhkYnRqaTVwRzVnQXlOZXJsaWVZUm02bWVmcURoejBQLXNwQno1eVdUYWt1TEhtTEZTT244N1BmZ1BZeTBXVkRPUkxSVmZvRElSQ3l3dkZzYklNRE1RPT0=', 'iss': 'https://oidc.unimi.it', 'client_id': 'provadiinserimento'}
2023-10-13 16:05:41,514 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-13 16:05:41,514 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-13 16:05:41,514 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxLVTYxeXpkUm45T0ljdG9rLVRSRU9pazFIT2s0ZlFKbmZBdEZuTG1yVmZNT181UEI5RDN6NFlKeFZHMjhqZFc0ZENPZlJjd3NydzY0OFF2QzAxNXZNOEJCSUR3N0VsdjgyTlZHSjExQ01aRk1LWk1yQVFUN3AzU0w0My1XbGk3VlBOVjEyYlBHczBwMGg2T0FaR08wQnFDTFZ6aDQ1akJSVHpkRi1aREVvZjA4Y2hvR3czQTZVSFRfX0ZNSzl3UExycDVsTGpQTHYxWHgxbS0zRDZIWDhGMHBpcUs3WU5iTkJ1SXo0Vk8zWjh4RThoSG9OczFqX0diY2V1WThUYjlFOTFNQ21zNTRhVU9Ta0tFREprU0E1SmZGLVlwZzVWdHVSTDBOWDYxOHUtbHhGZG9NZi1ZM1d0M2s3Y1hFQmgtc0FUSFNjWGYtaDV2TkVCRmIyajlKbUZnZmhkWjhTeThzOVNWNjFDdy1KUHB1aG9oMTBmOTRjTTdXMWFIX1c0cGN5SndsVEtLRVJqUGFWdUpkZ2RQYlc4YnRWZnJfV25JalJsbVp4ZTg5UU04YlBqVE9jN09DVlBKaEZ0d2JzNXpzYTktb2dzS2JmdllIb3YwQmpSVkg4SGlKaTNoYzJZbkFYSXlYWW9tN0tNOWRzVDhIYldmQmk0WFZLWllvdUw0MkVVNnJjR2sxRm5zX29oNm9RQmNTZ0NkTFhuZmdaTnVTRWw3d2RFMEdfblJaUUJwWFlIei1WVTFnZ0k0RVd0Qm5fVy1HVFBrX2xjVy0tS2NmWHQ0YjBtUjc1UGtwb3gwNzJXbjNGZl9VOUJFR1VGMlZ3a3ZNX0dzMTdfNjRObHp1VjhEZXhkYnRqaTVwRzVnQXlOZXJsaWVZUm02bWVmcURoejBQLXNwQno1eVdUYWt1TEhtTEZTT244N1BmZ1BZeTBXVkRPUkxSVmZvRElSQ3l3dkZzYklNRE1RPT0=', 'state': 'SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'provadiinserimento', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-13 16:05:41,515 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'provadiinserimento', 'state': 'SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR', 'code': 'Z0FBQUFBQmxLVTYxeXpkUm45T0ljdG9rLVRSRU9pazFIT2s0ZlFKbmZBdEZuTG1yVmZNT181UEI5RDN6NFlKeFZHMjhqZFc0ZENPZlJjd3NydzY0OFF2QzAxNXZNOEJCSUR3N0VsdjgyTlZHSjExQ01aRk1LWk1yQVFUN3AzU0w0My1XbGk3VlBOVjEyYlBHczBwMGg2T0FaR08wQnFDTFZ6aDQ1akJSVHpkRi1aREVvZjA4Y2hvR3czQTZVSFRfX0ZNSzl3UExycDVsTGpQTHYxWHgxbS0zRDZIWDhGMHBpcUs3WU5iTkJ1SXo0Vk8zWjh4RThoSG9OczFqX0diY2V1WThUYjlFOTFNQ21zNTRhVU9Ta0tFREprU0E1SmZGLVlwZzVWdHVSTDBOWDYxOHUtbHhGZG9NZi1ZM1d0M2s3Y1hFQmgtc0FUSFNjWGYtaDV2TkVCRmIyajlKbUZnZmhkWjhTeThzOVNWNjFDdy1KUHB1aG9oMTBmOTRjTTdXMWFIX1c0cGN5SndsVEtLRVJqUGFWdUpkZ2RQYlc4YnRWZnJfV25JalJsbVp4ZTg5UU04YlBqVE9jN09DVlBKaEZ0d2JzNXpzYTktb2dzS2JmdllIb3YwQmpSVkg4SGlKaTNoYzJZbkFYSXlYWW9tN0tNOWRzVDhIYldmQmk0WFZLWllvdUw0MkVVNnJjR2sxRm5zX29oNm9RQmNTZ0NkTFhuZmdaTnVTRWw3d2RFMEdfblJaUUJwWFlIei1WVTFnZ0k0RVd0Qm5fVy1HVFBrX2xjVy0tS2NmWHQ0YjBtUjc1UGtwb3gwNzJXbjNGZl9VOUJFR1VGMlZ3a3ZNX0dzMTdfNjRObHp1VjhEZXhkYnRqaTVwRzVnQXlOZXJsaWVZUm02bWVmcURoejBQLXNwQno1eVdUYWt1TEhtTEZTT244N1BmZ1BZeTBXVkRPUkxSVmZvRElSQ3l3dkZzYklNRE1RPT0=', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'TNEU7cQPbEYdPPHWFwOB9pYeIvKIbpJJg7tpHcAlAPXzrwb1RF1KVpeiHMdmHrkU'}
2023-10-13 16:05:41,515 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-13 16:05:41,516 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7fafacff3110>, 'url': 'https://oidc.unimi.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR&code=Z0FBQUFBQmxLVTYxeXpkUm45T0ljdG9rLVRSRU9pazFIT2s0ZlFKbmZBdEZuTG1yVmZNT181UEI5RDN6NFlKeFZHMjhqZFc0ZENPZlJjd3NydzY0OFF2QzAxNXZNOEJCSUR3N0VsdjgyTlZHSjExQ01aRk1LWk1yQVFUN3AzU0w0My1XbGk3VlBOVjEyYlBHczBwMGg2T0FaR08wQnFDTFZ6aDQ1akJSVHpkRi1aREVvZjA4Y2hvR3czQTZVSFRfX0ZNSzl3UExycDVsTGpQTHYxWHgxbS0zRDZIWDhGMHBpcUs3WU5iTkJ1SXo0Vk8zWjh4RThoSG9OczFqX0diY2V1WThUYjlFOTFNQ21zNTRhVU9Ta0tFREprU0E1SmZGLVlwZzVWdHVSTDBOWDYxOHUtbHhGZG9NZi1ZM1d0M2s3Y1hFQmgtc0FUSFNjWGYtaDV2TkVCRmIyajlKbUZnZmhkWjhTeThzOVNWNjFDdy1KUHB1aG9oMTBmOTRjTTdXMWFIX1c0cGN5SndsVEtLRVJqUGFWdUpkZ2RQYlc4YnRWZnJfV25JalJsbVp4ZTg5UU04YlBqVE9jN09DVlBKaEZ0d2JzNXpzYTktb2dzS2JmdllIb3YwQmpSVkg4SGlKaTNoYzJZbkFYSXlYWW9tN0tNOWRzVDhIYldmQmk0WFZLWllvdUw0MkVVNnJjR2sxRm5zX29oNm9RQmNTZ0NkTFhuZmdaTnVTRWw3d2RFMEdfblJaUUJwWFlIei1WVTFnZ0k0RVd0Qm5fVy1HVFBrX2xjVy0tS2NmWHQ0YjBtUjc1UGtwb3gwNzJXbjNGZl9VOUJFR1VGMlZ3a3ZNX0dzMTdfNjRObHp1VjhEZXhkYnRqaTVwRzVnQXlOZXJsaWVZUm02bWVmcURoejBQLXNwQno1eVdUYWt1TEhtTEZTT244N1BmZ1BZeTBXVkRPUkxSVmZvRElSQ3l3dkZzYklNRE1RPT0%3D&code_verifier=TNEU7cQPbEYdPPHWFwOB9pYeIvKIbpJJg7tpHcAlAPXzrwb1RF1KVpeiHMdmHrkU', 'headers': {'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-13 16:05:41,516 oidcrp.oauth2 DEBUG Doing request with: URL:https://oidc.unimi.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR&code=Z0FBQUFBQmxLVTYxeXpkUm45T0ljdG9rLVRSRU9pazFIT2s0ZlFKbmZBdEZuTG1yVmZNT181UEI5RDN6NFlKeFZHMjhqZFc0ZENPZlJjd3NydzY0OFF2QzAxNXZNOEJCSUR3N0VsdjgyTlZHSjExQ01aRk1LWk1yQVFUN3AzU0w0My1XbGk3VlBOVjEyYlBHczBwMGg2T0FaR08wQnFDTFZ6aDQ1akJSVHpkRi1aREVvZjA4Y2hvR3czQTZVSFRfX0ZNSzl3UExycDVsTGpQTHYxWHgxbS0zRDZIWDhGMHBpcUs3WU5iTkJ1SXo0Vk8zWjh4RThoSG9OczFqX0diY2V1WThUYjlFOTFNQ21zNTRhVU9Ta0tFREprU0E1SmZGLVlwZzVWdHVSTDBOWDYxOHUtbHhGZG9NZi1ZM1d0M2s3Y1hFQmgtc0FUSFNjWGYtaDV2TkVCRmIyajlKbUZnZmhkWjhTeThzOVNWNjFDdy1KUHB1aG9oMTBmOTRjTTdXMWFIX1c0cGN5SndsVEtLRVJqUGFWdUpkZ2RQYlc4YnRWZnJfV25JalJsbVp4ZTg5UU04YlBqVE9jN09DVlBKaEZ0d2JzNXpzYTktb2dzS2JmdllIb3YwQmpSVkg4SGlKaTNoYzJZbkFYSXlYWW9tN0tNOWRzVDhIYldmQmk0WFZLWllvdUw0MkVVNnJjR2sxRm5zX29oNm9RQmNTZ0NkTFhuZmdaTnVTRWw3d2RFMEdfblJaUUJwWFlIei1WVTFnZ0k0RVd0Qm5fVy1HVFBrX2xjVy0tS2NmWHQ0YjBtUjc1UGtwb3gwNzJXbjNGZl9VOUJFR1VGMlZ3a3ZNX0dzMTdfNjRObHp1VjhEZXhkYnRqaTVwRzVnQXlOZXJsaWVZUm02bWVmcURoejBQLXNwQno1eVdUYWt1TEhtTEZTT244N1BmZ1BZeTBXVkRPUkxSVmZvRElSQ3l3dkZzYklNRE1RPT0%3D&code_verifier=TNEU7cQPbEYdPPHWFwOB9pYeIvKIbpJJg7tpHcAlAPXzrwb1RF1KVpeiHMdmHrkU, https_args:{'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-13 16:05:41,518 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): oidc.unimi.it:443
2023-10-13 16:05:42,345 urllib3.connectionpool DEBUG https://oidc.unimi.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-13 16:05:42,346 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:05:42,346 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:05:42,346 oidcrp.util DEBUG resp.headers: {'Date': 'Fri, 13 Oct 2023 14:05:38 GMT', 'Server': 'Apache/2.4.37 (Red Hat Enterprise Linux) OpenSSL/1.1.1g', 'Strict-Transport-Security': 'max-age=63072000;includeSubDomains;preload', 'Content-Type': 'application/json', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdADiai1S6MakgKjefRF7LHRY6N8izTpQJngy0Xn8EBAcUq_tEP-U86koFZTp6cnGOphtdVLQICZ7weOh8FNkp527cpw7a1ykVM7fwYOP8TckCMVMn9uQEvgN1gsfH1lcQbxNacEyQtFi2MgMuYUaZJYkqeux_EZqc-T6FXcBpHs3e0C7ac14uxVBFuZyRA2dOl3LwBHrtS9r90efY5YdQnlUBnG0bTspPKdKueZ66lD4DqktilBB5EcsAaQBcio8x8nsAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdADiai1S6MakgKjefRF7LHRY6N8izTpQJngy0Xn8EBAcUq_tEP-U86koFZTp6cnGOphtdVLQICZ7weOh8FNkp527cpw7a1ykVM7fwYOP8TckCMVMn9uQEvgN1gsfH1lcQbxNacEyQtFi2MgMuYUaZJYkqeux_EZqc-T6FXcBpHs3e0C7ac14uxVBFuZyRA2dOl3LwBHrtS9r90efY5YdQnlUBnG0bTspPKdKueZ66lD4DqktilBB5EcsAaQBcio8x8nsAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'Keep-Alive': 'timeout=3, max=500', 'Connection': 'Keep-Alive', 'Transfer-Encoding': 'chunked'}
2023-10-13 16:05:42,346 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImViN2VlZjViNjI3ZTQ3ZDBiZGQ3YTkzYzZmOTZlMmMyIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUWXhUMFppYlRsb1lXaFJUMXBMWm5WNlNIZG9ha1IwZWxCaVNtdEVOV2RMY1ROUWQyNDRUbmxXWTFkYWJUQnhXSFZOVVdGaFFYbEViSEZzVUdaWmVHRTFaVkJIV2trNFprbEJZazFOY21KWVl6ZFNhVVF3T0hRd1VrRm9ZWFpaVm1zM01GVlpVVlprVkhSeVZYVTVlVEJITkU1WGNYcDFkRTV4V0VoVmVXMTRWbGhsVDI0eVJsRkJjMmg2Y1ZSNlUwZFZhRmx2ZDNJNFVsUjFVbTAxWVY4NWJHTnJVRWxLYVhaNlprVkNiR3hXWkRCSVlsVnZWSGhFYkVoVUxUaG9kamc0WldkNmNtZFRPVkI2UVVadFVuSXdRMDVDTnpCVE1GZElUV2RrUzFOT2EzWnVMVmh5WXpRemQyOTRXR0ptYUdob1RXNWZjakk0TjNsRlVEaHBhRkJrUzIxcWJYZG5SMDVyUVc4MGNVUk1hMkp2VG00NU1HYzlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDU5NDIsICJleHAiOiAxNjk3MjA5NTQyfQ.Xvwl9PN70LhrDTIkn5fztXxAIqW8DECYO9Fy9Tdd3JqwB6PszVLv308zMbz8cG-_N3UV69wOlh_fv4iivEiZDg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLVTYyNVliU3d5NGlNZUtGbFJGY3hVa2xBWkV1NkNoUjNQcUdVV0s5UlZZejdCekxrVHdnaElxLXJlakdad0xYSnVCZnlpMHV3RjRoRzhvYWcwY1pNS1B4al9xMjdzWkxFV3RkV3hMc0lITjBUWmJheENpVEpPN0hJbE5VT1dNb3ctVDJnUGpLU0p1bmpZSEpjZUlmRWNhRGw3cXFfYkFmX0lpRFFuSmdCM1VNNDBGUzNFSmNaSWh1RkxIVkp4NVM2WXlYWUVITXQteFBNNzBRNU9tcTItMW1fOUVpUGM3OUxmR1FSMFZpUzRVTmFpM3lzbTZhbjVnYTZuZXpwWVBrSTdqQ2Q0ZlN1THRjbU81SER5SVJOOEZvdVFIVzl4bDBlbUFibjdfTmJXeTIycnNSSDB3T3FhVmktYjBTQkhOX3VLaHJUdldwNURzYUt5eGRQVFpmQnlMWlNlV3JZaTZtLVp4SUhpcnFJSjRBcG1XbG1OVjBNYURYeHY1MnM4TjFtSUtqTmdtemR0VUJPQmFLdHBDTmlVSkVfamlsZWtoUHpuRjZVT2xaWC15MTBPSkpFN00zN0g4eXR0cThoWFlvQmwtOExfUUtLbDg5WERtcEhvSFRHdVIxZzZRVGtmOHRSUUZpQW1hSkd2bzFmYkRFVGg2eDBGVXZGUm5rb3VIdzhCUGl5TTFMVDVIaUVKY3pLQ3NWYjlzaDM1RGZ0UHRwUnBObjc4Xy11RldibW1qeXYyUDdxZmcwVjRqbU5BSmJnSlBFLTdZeUZ5cWIxNDRGRUZaZDhqSVhEWFducGU5bEVkMDl2UExZLTBqSE1fYW0xaGdrMEVpWDBpSGYzRFo1UWUxdmNodi10UTdGbW1XdkU2SUd2VlpDMGg3aW82d0ZvTFVKYWNoTWJ5bG5PcXlzUGdUbUU1R3RBOTJBa1BaNW9BeDFLMF9uUE1vTFlMUURyaTZmODNOVEpBPT0=", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMyTXlSMUZGTUU1NGREQTVXa1JVVlhGeloweHNYM0JrZEUxYWVWTmhValZOYVVGRFR6VnJUekJtV1EifQ.eyJzdWIiOiAiYWY2MDBjYTY2M2VmOTM3MGFkMjM5ZjBmYTg0Njk4OGJiM2Q5NGFmNjE3MzE2ZmFjMTc0MjFmNzRlOTM2MTdhMiIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVlRZeFQwWmliVGxvWVdoUlQxcExablY2U0hkb2FrUjBlbEJpU210RU5XZExjVE5RZDI0NFRubFdZMWRhYlRCeFdIVk5VV0ZoUVhsRWJIRnNVR1paZUdFMVpWQkhXa2s0WmtsQllrMU5jbUpZWXpkU2FVUXdPSFF3VWtGb1lYWlpWbXMzTUZWWlVWWmtWSFJ5VlhVNWVUQkhORTVYY1hwMWRFNXhXRWhWZVcxNFZsaGxUMjR5UmxGQmMyaDZjVlI2VTBkVmFGbHZkM0k0VWxSMVVtMDFZVjg1YkdOclVFbEthWFo2WmtWQ2JHeFdaREJJWWxWdlZIaEViRWhVTFRob2RqZzRaV2Q2Y21kVE9WQjZRVVp0VW5Jd1EwNUNOekJUTUZkSVRXZGtTMU5PYTNadUxWaHlZelF6ZDI5NFdHSm1hR2hvVFc1ZmNqSTROM2xGVURocGFGQmtTMjFxYlhkblIwNXJRVzgwY1VSTWEySnZUbTQ1TUdjOVBRPT0iLCAiYXV0aF90aW1lIjogMTY5NzIwNTk0MSwgImFjciI6ICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZFByb3RlY3RlZFRyYW5zcG9ydCIsICJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImp0aSI6ICI5ODdmZThiYzY5ZDExMWVlOGQ4OTAyNDIwYWZmMGY1YyIsICJjbGllbnRfaWQiOiAicHJvdmFkaWluc2VyaW1lbnRvIiwgIm5vbmNlIjogIlF2cUR2MnVER01CaGd0MWtlbjZpUVJHdiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDU5NDIsICJleHAiOiAxNjk3MjA2MjQyLCAiYXVkIjogWyJwcm92YWRpaW5zZXJpbWVudG8iXX0.UGrZgnnY_jnGnVhVb0Us7HGGtxur0UxKU4Yfmmup2wGrrsPzvqgfvwRxxi_V2qKSwynUf86pa_qU_-WTg_5DXjTO8LWe7lwTWuzdzKa7WA1t83MRANi__BZxf5KIZAo27UAzxX_7JbZChjfq8rXY7cl8MDPpP37NrBLOIU-F3t3UuWywWmvUB-kJH_Ky_UY2T_Kgoi_t9K36s1PyUyFqEgbwLkSf4-isdC_wNrRWYzAPFRkPaVqTrdzqdU4Yw4m0cA1fJyHEgO2LckM26VbFPJ1bq9i3rFRiJ2lSPyFqY2wYtrq2vdVmVLl_XvbkUJzpri44iQyubseKIzxinka0UA"}
2023-10-13 16:05:42,346 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImViN2VlZjViNjI3ZTQ3ZDBiZGQ3YTkzYzZmOTZlMmMyIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUWXhUMFppYlRsb1lXaFJUMXBMWm5WNlNIZG9ha1IwZWxCaVNtdEVOV2RMY1ROUWQyNDRUbmxXWTFkYWJUQnhXSFZOVVdGaFFYbEViSEZzVUdaWmVHRTFaVkJIV2trNFprbEJZazFOY21KWVl6ZFNhVVF3T0hRd1VrRm9ZWFpaVm1zM01GVlpVVlprVkhSeVZYVTVlVEJITkU1WGNYcDFkRTV4V0VoVmVXMTRWbGhsVDI0eVJsRkJjMmg2Y1ZSNlUwZFZhRmx2ZDNJNFVsUjFVbTAxWVY4NWJHTnJVRWxLYVhaNlprVkNiR3hXWkRCSVlsVnZWSGhFYkVoVUxUaG9kamc0WldkNmNtZFRPVkI2UVVadFVuSXdRMDVDTnpCVE1GZElUV2RrUzFOT2EzWnVMVmh5WXpRemQyOTRXR0ptYUdob1RXNWZjakk0TjNsRlVEaHBhRkJrUzIxcWJYZG5SMDVyUVc4MGNVUk1hMkp2VG00NU1HYzlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDU5NDIsICJleHAiOiAxNjk3MjA5NTQyfQ.Xvwl9PN70LhrDTIkn5fztXxAIqW8DECYO9Fy9Tdd3JqwB6PszVLv308zMbz8cG-_N3UV69wOlh_fv4iivEiZDg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLVTYyNVliU3d5NGlNZUtGbFJGY3hVa2xBWkV1NkNoUjNQcUdVV0s5UlZZejdCekxrVHdnaElxLXJlakdad0xYSnVCZnlpMHV3RjRoRzhvYWcwY1pNS1B4al9xMjdzWkxFV3RkV3hMc0lITjBUWmJheENpVEpPN0hJbE5VT1dNb3ctVDJnUGpLU0p1bmpZSEpjZUlmRWNhRGw3cXFfYkFmX0lpRFFuSmdCM1VNNDBGUzNFSmNaSWh1RkxIVkp4NVM2WXlYWUVITXQteFBNNzBRNU9tcTItMW1fOUVpUGM3OUxmR1FSMFZpUzRVTmFpM3lzbTZhbjVnYTZuZXpwWVBrSTdqQ2Q0ZlN1THRjbU81SER5SVJOOEZvdVFIVzl4bDBlbUFibjdfTmJXeTIycnNSSDB3T3FhVmktYjBTQkhOX3VLaHJUdldwNURzYUt5eGRQVFpmQnlMWlNlV3JZaTZtLVp4SUhpcnFJSjRBcG1XbG1OVjBNYURYeHY1MnM4TjFtSUtqTmdtemR0VUJPQmFLdHBDTmlVSkVfamlsZWtoUHpuRjZVT2xaWC15MTBPSkpFN00zN0g4eXR0cThoWFlvQmwtOExfUUtLbDg5WERtcEhvSFRHdVIxZzZRVGtmOHRSUUZpQW1hSkd2bzFmYkRFVGg2eDBGVXZGUm5rb3VIdzhCUGl5TTFMVDVIaUVKY3pLQ3NWYjlzaDM1RGZ0UHRwUnBObjc4Xy11RldibW1qeXYyUDdxZmcwVjRqbU5BSmJnSlBFLTdZeUZ5cWIxNDRGRUZaZDhqSVhEWFducGU5bEVkMDl2UExZLTBqSE1fYW0xaGdrMEVpWDBpSGYzRFo1UWUxdmNodi10UTdGbW1XdkU2SUd2VlpDMGg3aW82d0ZvTFVKYWNoTWJ5bG5PcXlzUGdUbUU1R3RBOTJBa1BaNW9BeDFLMF9uUE1vTFlMUURyaTZmODNOVEpBPT0=", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMyTXlSMUZGTUU1NGREQTVXa1JVVlhGeloweHNYM0JrZEUxYWVWTmhValZOYVVGRFR6VnJUekJtV1EifQ.eyJzdWIiOiAiYWY2MDBjYTY2M2VmOTM3MGFkMjM5ZjBmYTg0Njk4OGJiM2Q5NGFmNjE3MzE2ZmFjMTc0MjFmNzRlOTM2MTdhMiIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVlRZeFQwWmliVGxvWVdoUlQxcExablY2U0hkb2FrUjBlbEJpU210RU5XZExjVE5RZDI0NFRubFdZMWRhYlRCeFdIVk5VV0ZoUVhsRWJIRnNVR1paZUdFMVpWQkhXa2s0WmtsQllrMU5jbUpZWXpkU2FVUXdPSFF3VWtGb1lYWlpWbXMzTUZWWlVWWmtWSFJ5VlhVNWVUQkhORTVYY1hwMWRFNXhXRWhWZVcxNFZsaGxUMjR5UmxGQmMyaDZjVlI2VTBkVmFGbHZkM0k0VWxSMVVtMDFZVjg1YkdOclVFbEthWFo2WmtWQ2JHeFdaREJJWWxWdlZIaEViRWhVTFRob2RqZzRaV2Q2Y21kVE9WQjZRVVp0VW5Jd1EwNUNOekJUTUZkSVRXZGtTMU5PYTNadUxWaHlZelF6ZDI5NFdHSm1hR2hvVFc1ZmNqSTROM2xGVURocGFGQmtTMjFxYlhkblIwNXJRVzgwY1VSTWEySnZUbTQ1TUdjOVBRPT0iLCAiYXV0aF90aW1lIjogMTY5NzIwNTk0MSwgImFjciI6ICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZFByb3RlY3RlZFRyYW5zcG9ydCIsICJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImp0aSI6ICI5ODdmZThiYzY5ZDExMWVlOGQ4OTAyNDIwYWZmMGY1YyIsICJjbGllbnRfaWQiOiAicHJvdmFkaWluc2VyaW1lbnRvIiwgIm5vbmNlIjogIlF2cUR2MnVER01CaGd0MWtlbjZpUVJHdiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDU5NDIsICJleHAiOiAxNjk3MjA2MjQyLCAiYXVkIjogWyJwcm92YWRpaW5zZXJpbWVudG8iXX0.UGrZgnnY_jnGnVhVb0Us7HGGtxur0UxKU4Yfmmup2wGrrsPzvqgfvwRxxi_V2qKSwynUf86pa_qU_-WTg_5DXjTO8LWe7lwTWuzdzKa7WA1t83MRANi__BZxf5KIZAo27UAzxX_7JbZChjfq8rXY7cl8MDPpP37NrBLOIU-F3t3UuWywWmvUB-kJH_Ky_UY2T_Kgoi_t9K36s1PyUyFqEgbwLkSf4-isdC_wNrRWYzAPFRkPaVqTrdzqdU4Yw4m0cA1fJyHEgO2LckM26VbFPJ1bq9i3rFRiJ2lSPyFqY2wYtrq2vdVmVLl_XvbkUJzpri44iQyubseKIzxinka0UA"}
2023-10-13 16:05:42,346 oidcrp.service DEBUG response format: json
2023-10-13 16:05:42,346 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-13 16:05:42,346 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImViN2VlZjViNjI3ZTQ3ZDBiZGQ3YTkzYzZmOTZlMmMyIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUWXhUMFppYlRsb1lXaFJUMXBMWm5WNlNIZG9ha1IwZWxCaVNtdEVOV2RMY1ROUWQyNDRUbmxXWTFkYWJUQnhXSFZOVVdGaFFYbEViSEZzVUdaWmVHRTFaVkJIV2trNFprbEJZazFOY21KWVl6ZFNhVVF3T0hRd1VrRm9ZWFpaVm1zM01GVlpVVlprVkhSeVZYVTVlVEJITkU1WGNYcDFkRTV4V0VoVmVXMTRWbGhsVDI0eVJsRkJjMmg2Y1ZSNlUwZFZhRmx2ZDNJNFVsUjFVbTAxWVY4NWJHTnJVRWxLYVhaNlprVkNiR3hXWkRCSVlsVnZWSGhFYkVoVUxUaG9kamc0WldkNmNtZFRPVkI2UVVadFVuSXdRMDVDTnpCVE1GZElUV2RrUzFOT2EzWnVMVmh5WXpRemQyOTRXR0ptYUdob1RXNWZjakk0TjNsRlVEaHBhRkJrUzIxcWJYZG5SMDVyUVc4MGNVUk1hMkp2VG00NU1HYzlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDU5NDIsICJleHAiOiAxNjk3MjA5NTQyfQ.Xvwl9PN70LhrDTIkn5fztXxAIqW8DECYO9Fy9Tdd3JqwB6PszVLv308zMbz8cG-_N3UV69wOlh_fv4iivEiZDg', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxLVTYyNVliU3d5NGlNZUtGbFJGY3hVa2xBWkV1NkNoUjNQcUdVV0s5UlZZejdCekxrVHdnaElxLXJlakdad0xYSnVCZnlpMHV3RjRoRzhvYWcwY1pNS1B4al9xMjdzWkxFV3RkV3hMc0lITjBUWmJheENpVEpPN0hJbE5VT1dNb3ctVDJnUGpLU0p1bmpZSEpjZUlmRWNhRGw3cXFfYkFmX0lpRFFuSmdCM1VNNDBGUzNFSmNaSWh1RkxIVkp4NVM2WXlYWUVITXQteFBNNzBRNU9tcTItMW1fOUVpUGM3OUxmR1FSMFZpUzRVTmFpM3lzbTZhbjVnYTZuZXpwWVBrSTdqQ2Q0ZlN1THRjbU81SER5SVJOOEZvdVFIVzl4bDBlbUFibjdfTmJXeTIycnNSSDB3T3FhVmktYjBTQkhOX3VLaHJUdldwNURzYUt5eGRQVFpmQnlMWlNlV3JZaTZtLVp4SUhpcnFJSjRBcG1XbG1OVjBNYURYeHY1MnM4TjFtSUtqTmdtemR0VUJPQmFLdHBDTmlVSkVfamlsZWtoUHpuRjZVT2xaWC15MTBPSkpFN00zN0g4eXR0cThoWFlvQmwtOExfUUtLbDg5WERtcEhvSFRHdVIxZzZRVGtmOHRSUUZpQW1hSkd2bzFmYkRFVGg2eDBGVXZGUm5rb3VIdzhCUGl5TTFMVDVIaUVKY3pLQ3NWYjlzaDM1RGZ0UHRwUnBObjc4Xy11RldibW1qeXYyUDdxZmcwVjRqbU5BSmJnSlBFLTdZeUZ5cWIxNDRGRUZaZDhqSVhEWFducGU5bEVkMDl2UExZLTBqSE1fYW0xaGdrMEVpWDBpSGYzRFo1UWUxdmNodi10UTdGbW1XdkU2SUd2VlpDMGg3aW82d0ZvTFVKYWNoTWJ5bG5PcXlzUGdUbUU1R3RBOTJBa1BaNW9BeDFLMF9uUE1vTFlMUURyaTZmODNOVEpBPT0=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6ImMyTXlSMUZGTUU1NGREQTVXa1JVVlhGeloweHNYM0JrZEUxYWVWTmhValZOYVVGRFR6VnJUekJtV1EifQ.eyJzdWIiOiAiYWY2MDBjYTY2M2VmOTM3MGFkMjM5ZjBmYTg0Njk4OGJiM2Q5NGFmNjE3MzE2ZmFjMTc0MjFmNzRlOTM2MTdhMiIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVlRZeFQwWmliVGxvWVdoUlQxcExablY2U0hkb2FrUjBlbEJpU210RU5XZExjVE5RZDI0NFRubFdZMWRhYlRCeFdIVk5VV0ZoUVhsRWJIRnNVR1paZUdFMVpWQkhXa2s0WmtsQllrMU5jbUpZWXpkU2FVUXdPSFF3VWtGb1lYWlpWbXMzTUZWWlVWWmtWSFJ5VlhVNWVUQkhORTVYY1hwMWRFNXhXRWhWZVcxNFZsaGxUMjR5UmxGQmMyaDZjVlI2VTBkVmFGbHZkM0k0VWxSMVVtMDFZVjg1YkdOclVFbEthWFo2WmtWQ2JHeFdaREJJWWxWdlZIaEViRWhVTFRob2RqZzRaV2Q2Y21kVE9WQjZRVVp0VW5Jd1EwNUNOekJUTUZkSVRXZGtTMU5PYTNadUxWaHlZelF6ZDI5NFdHSm1hR2hvVFc1ZmNqSTROM2xGVURocGFGQmtTMjFxYlhkblIwNXJRVzgwY1VSTWEySnZUbTQ1TUdjOVBRPT0iLCAiYXV0aF90aW1lIjogMTY5NzIwNTk0MSwgImFjciI6ICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZFByb3RlY3RlZFRyYW5zcG9ydCIsICJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImp0aSI6ICI5ODdmZThiYzY5ZDExMWVlOGQ4OTAyNDIwYWZmMGY1YyIsICJjbGllbnRfaWQiOiAicHJvdmFkaWluc2VyaW1lbnRvIiwgIm5vbmNlIjogIlF2cUR2MnVER01CaGd0MWtlbjZpUVJHdiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDU5NDIsICJleHAiOiAxNjk3MjA2MjQyLCAiYXVkIjogWyJwcm92YWRpaW5zZXJpbWVudG8iXX0.UGrZgnnY_jnGnVhVb0Us7HGGtxur0UxKU4Yfmmup2wGrrsPzvqgfvwRxxi_V2qKSwynUf86pa_qU_-WTg_5DXjTO8LWe7lwTWuzdzKa7WA1t83MRANi__BZxf5KIZAo27UAzxX_7JbZChjfq8rXY7cl8MDPpP37NrBLOIU-F3t3UuWywWmvUB-kJH_Ky_UY2T_Kgoi_t9K36s1PyUyFqEgbwLkSf4-isdC_wNrRWYzAPFRkPaVqTrdzqdU4Yw4m0cA1fJyHEgO2LckM26VbFPJ1bq9i3rFRiJ2lSPyFqY2wYtrq2vdVmVLl_XvbkUJzpri44iQyubseKIzxinka0UA'}"
2023-10-13 16:05:42,346 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://oidc.unimi.it', 'keyjar': <KeyJar(issuers=['', 'https://oidc.unimi.it'])>, 'verify': True, 'skew': 15}
2023-10-13 16:05:42,347 oidcmsg.message DEBUG Raw JSON: {'sub': 'af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2', 'sid': 'Z0FBQUFBQmxLVTYxT0ZibTloYWhRT1pLZnV6SHdoakR0elBiSmtENWdLcTNQd244TnlWY1dabTBxWHVNUWFhQXlEbHFsUGZZeGE1ZVBHWkk4ZklBYk1NcmJYYzdSaUQwOHQwUkFoYXZZVms3MFVZUVZkVHRyVXU5eTBHNE5XcXp1dE5xWEhVeW14VlhlT24yRlFBc2h6cVR6U0dVaFlvd3I4UlR1Um01YV85bGNrUElKaXZ6ZkVCbGxWZDBIYlVvVHhEbEhULThodjg4ZWd6cmdTOVB6QUZtUnIwQ05CNzBTMFdITWdkS1NOa3ZuLVhyYzQzd294WGJmaGhoTW5fcjI4N3lFUDhpaFBkS21qbXdnR05rQW80cURMa2JvTm45MGc9PQ==', 'auth_time': 1697205941, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '987fe8bc69d111ee8d8902420aff0f5c', 'client_id': 'provadiinserimento', 'nonce': 'QvqDv2uDGMBhgt1ken6iQRGv', 'iss': 'https://oidc.unimi.it', 'iat': 1697205942, 'exp': 1697206242, 'aud': ['provadiinserimento']}
2023-10-13 16:05:42,347 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ'}
2023-10-13 16:05:42,347 cryptojwt.key_jar DEBUG Key summary for https://oidc.unimi.it: RSA:sig:c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ, EC:sig:Y0JpcWJHX1A4Y1NXV1RUdFlwUGRVb2hYazNlbDJVR3lnMEVtS1hyNjhsMA
2023-10-13 16:05:42,347 oidcmsg.message DEBUG Found signing key.
2023-10-13 16:05:42,347 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-13 16:05:42,347 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ and use=
2023-10-13 16:05:42,347 cryptojwt.jwx DEBUG Picked: kid:c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ, use:sig, kty:RSA
2023-10-13 16:05:42,348 cryptojwt.jws.jws DEBUG Verified message using key with kid=c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ
2023-10-13 16:05:42,348 oidcmsg.oidc INFO Verified id_token: {'sub': 'af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2', 'sid': 'Z0FBQUFBQmxLVTYxT0ZibTloYWhRT1pLZnV6SHdoakR0elBiSmtENWdLcTNQd244TnlWY1dabTBxWHVNUWFhQXlEbHFsUGZZeGE1ZVBHWkk4ZklBYk1NcmJYYzdSaUQwOHQwUkFoYXZZVms3MFVZUVZkVHRyVXU5eTBHNE5XcXp1dE5xWEhVeW14VlhlT24yRlFBc2h6cVR6U0dVaFlvd3I4UlR1Um01YV85bGNrUElKaXZ6ZkVCbGxWZDBIYlVvVHhEbEhULThodjg4ZWd6cmdTOVB6QUZtUnIwQ05CNzBTMFdITWdkS1NOa3ZuLVhyYzQzd294WGJmaGhoTW5fcjI4N3lFUDhpaFBkS21qbXdnR05rQW80cURMa2JvTm45MGc9PQ==', 'auth_time': 1697205941, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '987fe8bc69d111ee8d8902420aff0f5c', 'client_id': 'provadiinserimento', 'nonce': 'QvqDv2uDGMBhgt1ken6iQRGv', 'iss': 'https://oidc.unimi.it', 'iat': 1697205942, 'exp': 1697206242, 'aud': ['provadiinserimento']}
2023-10-13 16:05:42,349 oidcrp.rp_handler DEBUG ID Token: {'sub': 'af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2', 'sid': 'Z0FBQUFBQmxLVTYxT0ZibTloYWhRT1pLZnV6SHdoakR0elBiSmtENWdLcTNQd244TnlWY1dabTBxWHVNUWFhQXlEbHFsUGZZeGE1ZVBHWkk4ZklBYk1NcmJYYzdSaUQwOHQwUkFoYXZZVms3MFVZUVZkVHRyVXU5eTBHNE5XcXp1dE5xWEhVeW14VlhlT24yRlFBc2h6cVR6U0dVaFlvd3I4UlR1Um01YV85bGNrUElKaXZ6ZkVCbGxWZDBIYlVvVHhEbEhULThodjg4ZWd6cmdTOVB6QUZtUnIwQ05CNzBTMFdITWdkS1NOa3ZuLVhyYzQzd294WGJmaGhoTW5fcjI4N3lFUDhpaFBkS21qbXdnR05rQW80cURMa2JvTm45MGc9PQ==', 'auth_time': 1697205941, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '987fe8bc69d111ee8d8902420aff0f5c', 'client_id': 'provadiinserimento', 'nonce': 'QvqDv2uDGMBhgt1ken6iQRGv', 'iss': 'https://oidc.unimi.it', 'iat': 1697205942, 'exp': 1697206242, 'aud': ['provadiinserimento']}
2023-10-13 16:05:42,350 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-13 16:05:42,350 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImViN2VlZjViNjI3ZTQ3ZDBiZGQ3YTkzYzZmOTZlMmMyIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUWXhUMFppYlRsb1lXaFJUMXBMWm5WNlNIZG9ha1IwZWxCaVNtdEVOV2RMY1ROUWQyNDRUbmxXWTFkYWJUQnhXSFZOVVdGaFFYbEViSEZzVUdaWmVHRTFaVkJIV2trNFprbEJZazFOY21KWVl6ZFNhVVF3T0hRd1VrRm9ZWFpaVm1zM01GVlpVVlprVkhSeVZYVTVlVEJITkU1WGNYcDFkRTV4V0VoVmVXMTRWbGhsVDI0eVJsRkJjMmg2Y1ZSNlUwZFZhRmx2ZDNJNFVsUjFVbTAxWVY4NWJHTnJVRWxLYVhaNlprVkNiR3hXWkRCSVlsVnZWSGhFYkVoVUxUaG9kamc0WldkNmNtZFRPVkI2UVVadFVuSXdRMDVDTnpCVE1GZElUV2RrUzFOT2EzWnVMVmh5WXpRemQyOTRXR0ptYUdob1RXNWZjakk0TjNsRlVEaHBhRkJrUzIxcWJYZG5SMDVyUVc4MGNVUk1hMkp2VG00NU1HYzlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDU5NDIsICJleHAiOiAxNjk3MjA5NTQyfQ.Xvwl9PN70LhrDTIkn5fztXxAIqW8DECYO9Fy9Tdd3JqwB6PszVLv308zMbz8cG-_N3UV69wOlh_fv4iivEiZDg'}
2023-10-13 16:05:42,350 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-13 16:05:42,350 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7fafaceb1890>, 'url': 'https://oidc.unimi.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImViN2VlZjViNjI3ZTQ3ZDBiZGQ3YTkzYzZmOTZlMmMyIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUWXhUMFppYlRsb1lXaFJUMXBMWm5WNlNIZG9ha1IwZWxCaVNtdEVOV2RMY1ROUWQyNDRUbmxXWTFkYWJUQnhXSFZOVVdGaFFYbEViSEZzVUdaWmVHRTFaVkJIV2trNFprbEJZazFOY21KWVl6ZFNhVVF3T0hRd1VrRm9ZWFpaVm1zM01GVlpVVlprVkhSeVZYVTVlVEJITkU1WGNYcDFkRTV4V0VoVmVXMTRWbGhsVDI0eVJsRkJjMmg2Y1ZSNlUwZFZhRmx2ZDNJNFVsUjFVbTAxWVY4NWJHTnJVRWxLYVhaNlprVkNiR3hXWkRCSVlsVnZWSGhFYkVoVUxUaG9kamc0WldkNmNtZFRPVkI2UVVadFVuSXdRMDVDTnpCVE1GZElUV2RrUzFOT2EzWnVMVmh5WXpRemQyOTRXR0ptYUdob1RXNWZjakk0TjNsRlVEaHBhRkJrUzIxcWJYZG5SMDVyUVc4MGNVUk1hMkp2VG00NU1HYzlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDU5NDIsICJleHAiOiAxNjk3MjA5NTQyfQ.Xvwl9PN70LhrDTIkn5fztXxAIqW8DECYO9Fy9Tdd3JqwB6PszVLv308zMbz8cG-_N3UV69wOlh_fv4iivEiZDg'}}
2023-10-13 16:05:42,350 oidcrp.oauth2 DEBUG Doing request with: URL:https://oidc.unimi.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImViN2VlZjViNjI3ZTQ3ZDBiZGQ3YTkzYzZmOTZlMmMyIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUWXhUMFppYlRsb1lXaFJUMXBMWm5WNlNIZG9ha1IwZWxCaVNtdEVOV2RMY1ROUWQyNDRUbmxXWTFkYWJUQnhXSFZOVVdGaFFYbEViSEZzVUdaWmVHRTFaVkJIV2trNFprbEJZazFOY21KWVl6ZFNhVVF3T0hRd1VrRm9ZWFpaVm1zM01GVlpVVlprVkhSeVZYVTVlVEJITkU1WGNYcDFkRTV4V0VoVmVXMTRWbGhsVDI0eVJsRkJjMmg2Y1ZSNlUwZFZhRmx2ZDNJNFVsUjFVbTAxWVY4NWJHTnJVRWxLYVhaNlprVkNiR3hXWkRCSVlsVnZWSGhFYkVoVUxUaG9kamc0WldkNmNtZFRPVkI2UVVadFVuSXdRMDVDTnpCVE1GZElUV2RrUzFOT2EzWnVMVmh5WXpRemQyOTRXR0ptYUdob1RXNWZjakk0TjNsRlVEaHBhRkJrUzIxcWJYZG5SMDVyUVc4MGNVUk1hMkp2VG00NU1HYzlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDU5NDIsICJleHAiOiAxNjk3MjA5NTQyfQ.Xvwl9PN70LhrDTIkn5fztXxAIqW8DECYO9Fy9Tdd3JqwB6PszVLv308zMbz8cG-_N3UV69wOlh_fv4iivEiZDg'}
2023-10-13 16:05:42,351 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): oidc.unimi.it:443
2023-10-13 16:05:43,204 urllib3.connectionpool DEBUG https://oidc.unimi.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-13 16:05:43,205 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:05:43,206 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:05:43,206 oidcrp.util DEBUG resp.headers: {'Date': 'Fri, 13 Oct 2023 14:05:39 GMT', 'Server': 'Apache/2.4.37 (Red Hat Enterprise Linux) OpenSSL/1.1.1g', 'Strict-Transport-Security': 'max-age=63072000;includeSubDomains;preload', 'Content-Type': 'application/json', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdADESQgUTnaCmlzEij5XBw82SvtD3mY7I2myQStvQcTmE2rO1LN3woaUQbpIxn3aJ3qLpJQt8-S3C2wRhEf3oFmD3juIUB99rzSZGoHjilUeD3HtfMCnmysTEXKCmDepvi4OXJnhTaMYENfKCzpOoXWtqvkTPB_mnrPMRhM02b4oUdRy_MpoRVgMd61qxEAj4QVO0N4es-OTzejNalQEUAiEFC50TcKJAAckjlrC71WuJOMky4d3S9DcA6Rjk0_C9pA0AAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdADESQgUTnaCmlzEij5XBw82SvtD3mY7I2myQStvQcTmE2rO1LN3woaUQbpIxn3aJ3qLpJQt8-S3C2wRhEf3oFmD3juIUB99rzSZGoHjilUeD3HtfMCnmysTEXKCmDepvi4OXJnhTaMYENfKCzpOoXWtqvkTPB_mnrPMRhM02b4oUdRy_MpoRVgMd61qxEAj4QVO0N4es-OTzejNalQEUAiEFC50TcKJAAckjlrC71WuJOMky4d3S9DcA6Rjk0_C9pA0AAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'Keep-Alive': 'timeout=3, max=500', 'Connection': 'Keep-Alive', 'Transfer-Encoding': 'chunked'}
2023-10-13 16:05:43,206 oidcrp.util DEBUG resp.txt: {"sub": "af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2", "given_name": "MARIA", "family_name": "UNIMIA", "nickname": "Maria Unimia", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-13 16:05:43,206 oidcrp.oauth2 DEBUG Successful response: {"sub": "af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2", "given_name": "MARIA", "family_name": "UNIMIA", "nickname": "Maria Unimia", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-13 16:05:43,206 oidcrp.service DEBUG response format: json
2023-10-13 16:05:43,206 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-13 16:05:43,206 oidcrp.service DEBUG Initial response parsing => "{'sub': 'af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2', 'given_name': 'MARIA', 'family_name': 'UNIMIA', 'nickname': 'Maria Unimia', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}"
2023-10-13 16:05:43,206 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://oidc.unimi.it', 'keyjar': <KeyJar(issuers=['', 'https://oidc.unimi.it'])>, 'verify': True, 'skew': 15}
2023-10-13 16:05:43,207 oidcrp.rp_handler DEBUG UserInfo: {'sub': 'af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2', 'given_name': 'MARIA', 'family_name': 'UNIMIA', 'nickname': 'Maria Unimia', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}
2023-10-13 16:05:43,210 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:05:43] "GET /authz_cb/satosa?state=SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR&scope=openid+offline_access+profile&code=Z0FBQUFBQmxLVTYxeXpkUm45T0ljdG9rLVRSRU9pazFIT2s0ZlFKbmZBdEZuTG1yVmZNT181UEI5RDN6NFlKeFZHMjhqZFc0ZENPZlJjd3NydzY0OFF2QzAxNXZNOEJCSUR3N0VsdjgyTlZHSjExQ01aRk1LWk1yQVFUN3AzU0w0My1XbGk3VlBOVjEyYlBHczBwMGg2T0FaR08wQnFDTFZ6aDQ1akJSVHpkRi1aREVvZjA4Y2hvR3czQTZVSFRfX0ZNSzl3UExycDVsTGpQTHYxWHgxbS0zRDZIWDhGMHBpcUs3WU5iTkJ1SXo0Vk8zWjh4RThoSG9OczFqX0diY2V1WThUYjlFOTFNQ21zNTRhVU9Ta0tFREprU0E1SmZGLVlwZzVWdHVSTDBOWDYxOHUtbHhGZG9NZi1ZM1d0M2s3Y1hFQmgtc0FUSFNjWGYtaDV2TkVCRmIyajlKbUZnZmhkWjhTeThzOVNWNjFDdy1KUHB1aG9oMTBmOTRjTTdXMWFIX1c0cGN5SndsVEtLRVJqUGFWdUpkZ2RQYlc4YnRWZnJfV25JalJsbVp4ZTg5UU04YlBqVE9jN09DVlBKaEZ0d2JzNXpzYTktb2dzS2JmdllIb3YwQmpSVkg4SGlKaTNoYzJZbkFYSXlYWW9tN0tNOWRzVDhIYldmQmk0WFZLWllvdUw0MkVVNnJjR2sxRm5zX29oNm9RQmNTZ0NkTFhuZmdaTnVTRWw3d2RFMEdfblJaUUJwWFlIei1WVTFnZ0k0RVd0Qm5fVy1HVFBrX2xjVy0tS2NmWHQ0YjBtUjc1UGtwb3gwNzJXbjNGZl9VOUJFR1VGMlZ3a3ZNX0dzMTdfNjRObHp1VjhEZXhkYnRqaTVwRzVnQXlOZXJsaWVZUm02bWVmcURoejBQLXNwQno1eVdUYWt1TEhtTEZTT244N1BmZ1BZeTBXVkRPUkxSVmZvRElSQ3l3dkZzYklNRE1RPT0%3D&iss=https://oidc.unimi.it&client_id=provadiinserimento HTTP/1.1" 200 -
2023-10-13 16:07:16,662 root DEBUG Configured logging using dictionary
2023-10-13 16:07:16,701 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-13 16:07:16,701 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-13 16:07:16,701 werkzeug INFO  * Restarting with stat
2023-10-13 16:07:16,880 root DEBUG Configured logging using dictionary
2023-10-13 16:07:16,917 werkzeug WARNING  * Debugger is active!
2023-10-13 16:07:16,917 werkzeug INFO  * Debugger PIN: 221-170-319
2023-10-13 16:07:21,119 flask_rp.views ERROR Unkown issuer: None not among []
2023-10-13 16:07:21,119 flask_rp.views ERROR Unknown OP identifier: None
2023-10-13 16:07:21,119 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:07:21] "[31m[1mGET /authz_cb/satosa?state=SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR&scope=openid+offline_access+profile&code=Z0FBQUFBQmxLVTYxeXpkUm45T0ljdG9rLVRSRU9pazFIT2s0ZlFKbmZBdEZuTG1yVmZNT181UEI5RDN6NFlKeFZHMjhqZFc0ZENPZlJjd3NydzY0OFF2QzAxNXZNOEJCSUR3N0VsdjgyTlZHSjExQ01aRk1LWk1yQVFUN3AzU0w0My1XbGk3VlBOVjEyYlBHczBwMGg2T0FaR08wQnFDTFZ6aDQ1akJSVHpkRi1aREVvZjA4Y2hvR3czQTZVSFRfX0ZNSzl3UExycDVsTGpQTHYxWHgxbS0zRDZIWDhGMHBpcUs3WU5iTkJ1SXo0Vk8zWjh4RThoSG9OczFqX0diY2V1WThUYjlFOTFNQ21zNTRhVU9Ta0tFREprU0E1SmZGLVlwZzVWdHVSTDBOWDYxOHUtbHhGZG9NZi1ZM1d0M2s3Y1hFQmgtc0FUSFNjWGYtaDV2TkVCRmIyajlKbUZnZmhkWjhTeThzOVNWNjFDdy1KUHB1aG9oMTBmOTRjTTdXMWFIX1c0cGN5SndsVEtLRVJqUGFWdUpkZ2RQYlc4YnRWZnJfV25JalJsbVp4ZTg5UU04YlBqVE9jN09DVlBKaEZ0d2JzNXpzYTktb2dzS2JmdllIb3YwQmpSVkg4SGlKaTNoYzJZbkFYSXlYWW9tN0tNOWRzVDhIYldmQmk0WFZLWllvdUw0MkVVNnJjR2sxRm5zX29oNm9RQmNTZ0NkTFhuZmdaTnVTRWw3d2RFMEdfblJaUUJwWFlIei1WVTFnZ0k0RVd0Qm5fVy1HVFBrX2xjVy0tS2NmWHQ0YjBtUjc1UGtwb3gwNzJXbjNGZl9VOUJFR1VGMlZ3a3ZNX0dzMTdfNjRObHp1VjhEZXhkYnRqaTVwRzVnQXlOZXJsaWVZUm02bWVmcURoejBQLXNwQno1eVdUYWt1TEhtTEZTT244N1BmZ1BZeTBXVkRPUkxSVmZvRElSQ3l3dkZzYklNRE1RPT0%3D&iss=https://oidc.unimi.it&client_id=provadiinserimento HTTP/1.1[0m" 400 -
2023-10-13 16:07:21,766 flask_rp.views ERROR Unkown issuer: None not among []
2023-10-13 16:07:21,766 flask_rp.views ERROR Unknown OP identifier: None
2023-10-13 16:07:21,766 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:07:21] "[31m[1mGET /authz_cb/satosa?state=SbTra8CTdQHcHdXpZ6o5DRixmf5MheuR&scope=openid+offline_access+profile&code=Z0FBQUFBQmxLVTYxeXpkUm45T0ljdG9rLVRSRU9pazFIT2s0ZlFKbmZBdEZuTG1yVmZNT181UEI5RDN6NFlKeFZHMjhqZFc0ZENPZlJjd3NydzY0OFF2QzAxNXZNOEJCSUR3N0VsdjgyTlZHSjExQ01aRk1LWk1yQVFUN3AzU0w0My1XbGk3VlBOVjEyYlBHczBwMGg2T0FaR08wQnFDTFZ6aDQ1akJSVHpkRi1aREVvZjA4Y2hvR3czQTZVSFRfX0ZNSzl3UExycDVsTGpQTHYxWHgxbS0zRDZIWDhGMHBpcUs3WU5iTkJ1SXo0Vk8zWjh4RThoSG9OczFqX0diY2V1WThUYjlFOTFNQ21zNTRhVU9Ta0tFREprU0E1SmZGLVlwZzVWdHVSTDBOWDYxOHUtbHhGZG9NZi1ZM1d0M2s3Y1hFQmgtc0FUSFNjWGYtaDV2TkVCRmIyajlKbUZnZmhkWjhTeThzOVNWNjFDdy1KUHB1aG9oMTBmOTRjTTdXMWFIX1c0cGN5SndsVEtLRVJqUGFWdUpkZ2RQYlc4YnRWZnJfV25JalJsbVp4ZTg5UU04YlBqVE9jN09DVlBKaEZ0d2JzNXpzYTktb2dzS2JmdllIb3YwQmpSVkg4SGlKaTNoYzJZbkFYSXlYWW9tN0tNOWRzVDhIYldmQmk0WFZLWllvdUw0MkVVNnJjR2sxRm5zX29oNm9RQmNTZ0NkTFhuZmdaTnVTRWw3d2RFMEdfblJaUUJwWFlIei1WVTFnZ0k0RVd0Qm5fVy1HVFBrX2xjVy0tS2NmWHQ0YjBtUjc1UGtwb3gwNzJXbjNGZl9VOUJFR1VGMlZ3a3ZNX0dzMTdfNjRObHp1VjhEZXhkYnRqaTVwRzVnQXlOZXJsaWVZUm02bWVmcURoejBQLXNwQno1eVdUYWt1TEhtTEZTT244N1BmZ1BZeTBXVkRPUkxSVmZvRElSQ3l3dkZzYklNRE1RPT0%3D&iss=https://oidc.unimi.it&client_id=provadiinserimento HTTP/1.1[0m" 400 -
2023-10-13 16:07:30,392 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:07:30] "GET / HTTP/1.1" 200 -
2023-10-13 16:07:33,459 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-13 16:07:33,459 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-13 16:07:33,459 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-13 16:07:33,459 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-13 16:07:33,494 oidcrp.rp_handler DEBUG Get provider info
2023-10-13 16:07:33,494 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-13 16:07:33,494 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://oidc.unimi.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-13 16:07:33,495 oidcrp.oauth2 DEBUG Doing request with: URL:https://oidc.unimi.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-13 16:07:33,496 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): oidc.unimi.it:443
2023-10-13 16:07:33,705 urllib3.connectionpool DEBUG https://oidc.unimi.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-13 16:07:33,706 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:07:33,707 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:07:33,707 oidcrp.util DEBUG resp.headers: {'Date': 'Fri, 13 Oct 2023 14:07:30 GMT', 'Server': 'Apache/2.4.37 (Red Hat Enterprise Linux) OpenSSL/1.1.1g', 'Strict-Transport-Security': 'max-age=63072000;includeSubDomains;preload', 'Content-Type': 'application/json', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADQNicZjwp7Mu06F53mayIF67Pry6ElQxuWLNQr85pQo7yxAhFiFdGv-sU3eJy_4b1mW7hprHwOG5YsOqlARg1hr7tACIN6K--wyvxea9Ic2Iz0-dZd0e7OpHns-e6LiUF3VER4COVz-ekh12hkeD9tQZJBlqCS2O6dHX-WeazhugD-515kSuXJ---bWUv27RVJrSryuahILi5xTnAA1Jm1cpEhXxqt6Tk8Z23HXtoQk-dVRzwvfCHVQAAAAAL5eioGktLyyAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADQNicZjwp7Mu06F53mayIF67Pry6ElQxuWLNQr85pQo7yxAhFiFdGv-sU3eJy_4b1mW7hprHwOG5YsOqlARg1hr7tACIN6K--wyvxea9Ic2Iz0-dZd0e7OpHns-e6LiUF3VER4COVz-ekh12hkeD9tQZJBlqCS2O6dHX-WeazhugD-515kSuXJ---bWUv27RVJrSryuahILi5xTnAA1Jm1cpEhXxqt6Tk8Z23HXtoQk-dVRzwvfCHVQAAAAAL5eioGktLyyAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'Keep-Alive': 'timeout=3, max=500', 'Connection': 'Keep-Alive', 'Transfer-Encoding': 'chunked'}
2023-10-13 16:07:33,707 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token", "implicit"], "jwks_uri": "https://oidc.unimi.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://oidc.unimi.it", "authorization_endpoint": "https://oidc.unimi.it/OIDC/authorization", "token_endpoint": "https://oidc.unimi.it/OIDC/token", "userinfo_endpoint": "https://oidc.unimi.it/OIDC/userinfo", "introspection_endpoint": "https://oidc.unimi.it/OIDC/introspection"}
2023-10-13 16:07:33,707 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token", "implicit"], "jwks_uri": "https://oidc.unimi.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://oidc.unimi.it", "authorization_endpoint": "https://oidc.unimi.it/OIDC/authorization", "token_endpoint": "https://oidc.unimi.it/OIDC/token", "userinfo_endpoint": "https://oidc.unimi.it/OIDC/userinfo", "introspection_endpoint": "https://oidc.unimi.it/OIDC/introspection"}
2023-10-13 16:07:33,707 oidcrp.service DEBUG response format: json
2023-10-13 16:07:33,707 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-13 16:07:33,708 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token', 'implicit'], 'jwks_uri': 'https://oidc.unimi.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://oidc.unimi.it', 'authorization_endpoint': 'https://oidc.unimi.it/OIDC/authorization', 'token_endpoint': 'https://oidc.unimi.it/OIDC/token', 'userinfo_endpoint': 'https://oidc.unimi.it/OIDC/userinfo', 'introspection_endpoint': 'https://oidc.unimi.it/OIDC/introspection'}"
2023-10-13 16:07:33,708 oidcrp.service DEBUG Verify response with {'iss': 'https://oidc.unimi.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'provadiinserimento'}
2023-10-13 16:07:33,710 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://oidc.unimi.it
2023-10-13 16:07:33,711 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-13 16:07:33,711 cryptojwt.key_bundle INFO Reading remote JWKS from https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:07:33,711 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:07:33,713 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): oidc.unimi.it:443
2023-10-13 16:07:33,920 urllib3.connectionpool DEBUG https://oidc.unimi.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-13 16:07:33,922 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ", "n": "tQKOGIUZUwAGf0ZcWcjx_1qODgb2JilM3NUutnJDMr6Pi4zFtoCRnr4wUVsC9cGPxoMzRgnpIp20w5cyjxk6G7UGg73biNVxVJeBxvNTy60B8CZv0Kc_JWqHK_bynHDoboI9-Mzp2eKDKb2INOlT7VFl-hj4NrTbVMN6FF3h1w2dFqxwraL2ySXow7RBE8OebcmqRkOyhEAfM03Ft6pq9HZYoiPr0qZoS-5wyJhty8moQq0u7QcuufCNwCh6kCWDs07T3CkZ5oFdbb-5htNy78UdntLGbzB7u6vzqhws-mT6hVvaygNSEqLGasWqeE7CrL7VIazzno3d0oO-C1SNoQ", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "Y0JpcWJHX1A4Y1NXV1RUdFlwUGRVb2hYazNlbDJVR3lnMEVtS1hyNjhsMA", "crv": "P-256", "x": "VKEzvdiATNL2xRGv98WuKOVgq5EnTLJbF4md-aUHjSU", "y": "u7sOk-_FzyzKeM0s3fqC54-pDWTCBC8cuZ0lyhuqBfI"}]} from https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:07:33,922 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ", "n": "tQKOGIUZUwAGf0ZcWcjx_1qODgb2JilM3NUutnJDMr6Pi4zFtoCRnr4wUVsC9cGPxoMzRgnpIp20w5cyjxk6G7UGg73biNVxVJeBxvNTy60B8CZv0Kc_JWqHK_bynHDoboI9-Mzp2eKDKb2INOlT7VFl-hj4NrTbVMN6FF3h1w2dFqxwraL2ySXow7RBE8OebcmqRkOyhEAfM03Ft6pq9HZYoiPr0qZoS-5wyJhty8moQq0u7QcuufCNwCh6kCWDs07T3CkZ5oFdbb-5htNy78UdntLGbzB7u6vzqhws-mT6hVvaygNSEqLGasWqeE7CrL7VIazzno3d0oO-C1SNoQ", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "Y0JpcWJHX1A4Y1NXV1RUdFlwUGRVb2hYazNlbDJVR3lnMEVtS1hyNjhsMA", "crv": "P-256", "x": "VKEzvdiATNL2xRGv98WuKOVgq5EnTLJbF4md-aUHjSU", "y": "u7sOk-_FzyzKeM0s3fqC54-pDWTCBC8cuZ0lyhuqBfI"}]} from https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:07:33,924 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'prompt': 'consent'}
2023-10-13 16:07:33,925 oidcrp.rp_handler DEBUG Do client registration
2023-10-13 16:07:33,925 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-13 16:07:33,925 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-13 16:07:33,926 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'Cw2fjoKjRz9p98HmX66MPDIZ', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'aDJ40HKUUH3uFqzqaDC4bV0gVuAadB0i'}
2023-10-13 16:07:33,927 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'Cw2fjoKjRz9p98HmX66MPDIZ', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'aDJ40HKUUH3uFqzqaDC4bV0gVuAadB0i', 'code_challenge': 'sHrRe6tKCJepGk2ybGhRIPLm3qKoSGNlWKEEQGO12IY', 'code_challenge_method': 'S256', 'client_id': 'provadiinserimento', 'prompt': 'consent'}
2023-10-13 16:07:33,927 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7fc982dfd790>, 'url': 'https://oidc.unimi.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=Cw2fjoKjRz9p98HmX66MPDIZ&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=aDJ40HKUUH3uFqzqaDC4bV0gVuAadB0i&code_challenge=sHrRe6tKCJepGk2ybGhRIPLm3qKoSGNlWKEEQGO12IY&code_challenge_method=S256&client_id=provadiinserimento&prompt=consent'}
2023-10-13 16:07:33,928 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:07:33] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-13 16:07:40,779 flask_rp.views DEBUG Issuer: https://oidc.unimi.it
2023-10-13 16:07:40,779 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-13 16:07:40,780 oidcrp.service DEBUG response format: dict
2023-10-13 16:07:40,780 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-13 16:07:40,780 oidcrp.service DEBUG Initial response parsing => "{'state': 'aDJ40HKUUH3uFqzqaDC4bV0gVuAadB0i', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxLVThzUGZ6VEpOYV9xbUVWdW45X0k3Wll1LVZDaklsSXBMNFRIR1NldmdrQkhpeEMwY1p1Z1hLclJHZC1mQnBYMlRIMXZQWGdmUDZ5NXFoa0tuYzlLZXZGcFFjbGhvUWpUNG5Ca0U3ODk5V0VySGVBMklySy1GeUlvUHM4Ynh4R2lpWFBHXzB5bGFhVERhaUljdDcwQlNOcGs4dnlvUXJKOXNacmpLdXhvRjNfTVpqenZEa0tROE9vMmZsd3hOMlBFaHp1R0k4VjN5ZGxLWU5iMEctZU5Ya1JMR0ZXTDRoUE5GeWhDMGpOTXVkOWR1X0Y1Skg3MzNxS2ZteXctRm5USHlmSi1QSlpJa3h1OUF2RzVLSDQ0NzlsV0JFODFxUWJ2SHdUR05aUUh3ckZPTnJfZjBXMWdicExMXzFlQzNuX2t4RGJJb0c3a0NHNWFRR3d0TzgzZWF1THd3eGlmZFg4Yk5xSHFZdVNoU1hMM05XMi1UeWFxSDcxVFFLYkpQYkhMeHhyNWUyZDBmemlxRHI3eF9EZmJqUGlybFZQdDNyQ2EwdUx0OTdRLVFtaU9Hd3BhVzFNZldadkYzbUVBWGJtdGxNekFfRl9nWFBtM3ZiSUI3UmJBVTRhR0dReHktaFV4UDd1R0FrTnVEMXNqeEp2RzE0aVc1bThCM0hoWVRMNDZPcm5ja0JBMDQyQ2h4Y0hPaVJHNjVXSEFIT2hVc2FyT0ZuYklzME1rWnBKV2NRak0wOTB4cEhHUnJJMTdFX3B2djVsNnE2X2tOdER6dE5iSGlVYWt3V0FkaFhjMzkwSVZnUk9jSk8zeDRVSTBMQmplOFdoTXNfMzJNSk94RThHenBvZW45Ym16VE1ETzNCQ3ZhSFRhNE5paG05dDdGRTlZNkVsaXpIRGthYlV4WVBRc250UTByQnpjV3ctNzB1QWxtMm1CWHhNSHZ5VGM1RzNtcmN0ZHVLQW1BPT0=', 'iss': 'https://oidc.unimi.it', 'client_id': 'provadiinserimento'}"
2023-10-13 16:07:40,780 oidcrp.service DEBUG Verify response with {'iss': 'https://oidc.unimi.it', 'keyjar': <KeyJar(issuers=['', 'https://oidc.unimi.it'])>, 'verify': True, 'skew': 15, 'client_id': 'provadiinserimento'}
2023-10-13 16:07:40,780 oidcrp.rp_handler DEBUG Authz response: {'state': 'aDJ40HKUUH3uFqzqaDC4bV0gVuAadB0i', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxLVThzUGZ6VEpOYV9xbUVWdW45X0k3Wll1LVZDaklsSXBMNFRIR1NldmdrQkhpeEMwY1p1Z1hLclJHZC1mQnBYMlRIMXZQWGdmUDZ5NXFoa0tuYzlLZXZGcFFjbGhvUWpUNG5Ca0U3ODk5V0VySGVBMklySy1GeUlvUHM4Ynh4R2lpWFBHXzB5bGFhVERhaUljdDcwQlNOcGs4dnlvUXJKOXNacmpLdXhvRjNfTVpqenZEa0tROE9vMmZsd3hOMlBFaHp1R0k4VjN5ZGxLWU5iMEctZU5Ya1JMR0ZXTDRoUE5GeWhDMGpOTXVkOWR1X0Y1Skg3MzNxS2ZteXctRm5USHlmSi1QSlpJa3h1OUF2RzVLSDQ0NzlsV0JFODFxUWJ2SHdUR05aUUh3ckZPTnJfZjBXMWdicExMXzFlQzNuX2t4RGJJb0c3a0NHNWFRR3d0TzgzZWF1THd3eGlmZFg4Yk5xSHFZdVNoU1hMM05XMi1UeWFxSDcxVFFLYkpQYkhMeHhyNWUyZDBmemlxRHI3eF9EZmJqUGlybFZQdDNyQ2EwdUx0OTdRLVFtaU9Hd3BhVzFNZldadkYzbUVBWGJtdGxNekFfRl9nWFBtM3ZiSUI3UmJBVTRhR0dReHktaFV4UDd1R0FrTnVEMXNqeEp2RzE0aVc1bThCM0hoWVRMNDZPcm5ja0JBMDQyQ2h4Y0hPaVJHNjVXSEFIT2hVc2FyT0ZuYklzME1rWnBKV2NRak0wOTB4cEhHUnJJMTdFX3B2djVsNnE2X2tOdER6dE5iSGlVYWt3V0FkaFhjMzkwSVZnUk9jSk8zeDRVSTBMQmplOFdoTXNfMzJNSk94RThHenBvZW45Ym16VE1ETzNCQ3ZhSFRhNE5paG05dDdGRTlZNkVsaXpIRGthYlV4WVBRc250UTByQnpjV3ctNzB1QWxtMm1CWHhNSHZ5VGM1RzNtcmN0ZHVLQW1BPT0=', 'iss': 'https://oidc.unimi.it', 'client_id': 'provadiinserimento'}
2023-10-13 16:07:40,781 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-13 16:07:40,781 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-13 16:07:40,781 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxLVThzUGZ6VEpOYV9xbUVWdW45X0k3Wll1LVZDaklsSXBMNFRIR1NldmdrQkhpeEMwY1p1Z1hLclJHZC1mQnBYMlRIMXZQWGdmUDZ5NXFoa0tuYzlLZXZGcFFjbGhvUWpUNG5Ca0U3ODk5V0VySGVBMklySy1GeUlvUHM4Ynh4R2lpWFBHXzB5bGFhVERhaUljdDcwQlNOcGs4dnlvUXJKOXNacmpLdXhvRjNfTVpqenZEa0tROE9vMmZsd3hOMlBFaHp1R0k4VjN5ZGxLWU5iMEctZU5Ya1JMR0ZXTDRoUE5GeWhDMGpOTXVkOWR1X0Y1Skg3MzNxS2ZteXctRm5USHlmSi1QSlpJa3h1OUF2RzVLSDQ0NzlsV0JFODFxUWJ2SHdUR05aUUh3ckZPTnJfZjBXMWdicExMXzFlQzNuX2t4RGJJb0c3a0NHNWFRR3d0TzgzZWF1THd3eGlmZFg4Yk5xSHFZdVNoU1hMM05XMi1UeWFxSDcxVFFLYkpQYkhMeHhyNWUyZDBmemlxRHI3eF9EZmJqUGlybFZQdDNyQ2EwdUx0OTdRLVFtaU9Hd3BhVzFNZldadkYzbUVBWGJtdGxNekFfRl9nWFBtM3ZiSUI3UmJBVTRhR0dReHktaFV4UDd1R0FrTnVEMXNqeEp2RzE0aVc1bThCM0hoWVRMNDZPcm5ja0JBMDQyQ2h4Y0hPaVJHNjVXSEFIT2hVc2FyT0ZuYklzME1rWnBKV2NRak0wOTB4cEhHUnJJMTdFX3B2djVsNnE2X2tOdER6dE5iSGlVYWt3V0FkaFhjMzkwSVZnUk9jSk8zeDRVSTBMQmplOFdoTXNfMzJNSk94RThHenBvZW45Ym16VE1ETzNCQ3ZhSFRhNE5paG05dDdGRTlZNkVsaXpIRGthYlV4WVBRc250UTByQnpjV3ctNzB1QWxtMm1CWHhNSHZ5VGM1RzNtcmN0ZHVLQW1BPT0=', 'state': 'aDJ40HKUUH3uFqzqaDC4bV0gVuAadB0i', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'provadiinserimento', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-13 16:07:40,782 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'provadiinserimento', 'state': 'aDJ40HKUUH3uFqzqaDC4bV0gVuAadB0i', 'code': 'Z0FBQUFBQmxLVThzUGZ6VEpOYV9xbUVWdW45X0k3Wll1LVZDaklsSXBMNFRIR1NldmdrQkhpeEMwY1p1Z1hLclJHZC1mQnBYMlRIMXZQWGdmUDZ5NXFoa0tuYzlLZXZGcFFjbGhvUWpUNG5Ca0U3ODk5V0VySGVBMklySy1GeUlvUHM4Ynh4R2lpWFBHXzB5bGFhVERhaUljdDcwQlNOcGs4dnlvUXJKOXNacmpLdXhvRjNfTVpqenZEa0tROE9vMmZsd3hOMlBFaHp1R0k4VjN5ZGxLWU5iMEctZU5Ya1JMR0ZXTDRoUE5GeWhDMGpOTXVkOWR1X0Y1Skg3MzNxS2ZteXctRm5USHlmSi1QSlpJa3h1OUF2RzVLSDQ0NzlsV0JFODFxUWJ2SHdUR05aUUh3ckZPTnJfZjBXMWdicExMXzFlQzNuX2t4RGJJb0c3a0NHNWFRR3d0TzgzZWF1THd3eGlmZFg4Yk5xSHFZdVNoU1hMM05XMi1UeWFxSDcxVFFLYkpQYkhMeHhyNWUyZDBmemlxRHI3eF9EZmJqUGlybFZQdDNyQ2EwdUx0OTdRLVFtaU9Hd3BhVzFNZldadkYzbUVBWGJtdGxNekFfRl9nWFBtM3ZiSUI3UmJBVTRhR0dReHktaFV4UDd1R0FrTnVEMXNqeEp2RzE0aVc1bThCM0hoWVRMNDZPcm5ja0JBMDQyQ2h4Y0hPaVJHNjVXSEFIT2hVc2FyT0ZuYklzME1rWnBKV2NRak0wOTB4cEhHUnJJMTdFX3B2djVsNnE2X2tOdER6dE5iSGlVYWt3V0FkaFhjMzkwSVZnUk9jSk8zeDRVSTBMQmplOFdoTXNfMzJNSk94RThHenBvZW45Ym16VE1ETzNCQ3ZhSFRhNE5paG05dDdGRTlZNkVsaXpIRGthYlV4WVBRc250UTByQnpjV3ctNzB1QWxtMm1CWHhNSHZ5VGM1RzNtcmN0ZHVLQW1BPT0=', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'OpakwFTOgOjKcEn3nFCByRSA3hVvRVYbCl7HW3bJV1fJpaQhoJlDe2dPOJDFPay5'}
2023-10-13 16:07:40,782 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-13 16:07:40,783 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7fc982e23b90>, 'url': 'https://oidc.unimi.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=aDJ40HKUUH3uFqzqaDC4bV0gVuAadB0i&code=Z0FBQUFBQmxLVThzUGZ6VEpOYV9xbUVWdW45X0k3Wll1LVZDaklsSXBMNFRIR1NldmdrQkhpeEMwY1p1Z1hLclJHZC1mQnBYMlRIMXZQWGdmUDZ5NXFoa0tuYzlLZXZGcFFjbGhvUWpUNG5Ca0U3ODk5V0VySGVBMklySy1GeUlvUHM4Ynh4R2lpWFBHXzB5bGFhVERhaUljdDcwQlNOcGs4dnlvUXJKOXNacmpLdXhvRjNfTVpqenZEa0tROE9vMmZsd3hOMlBFaHp1R0k4VjN5ZGxLWU5iMEctZU5Ya1JMR0ZXTDRoUE5GeWhDMGpOTXVkOWR1X0Y1Skg3MzNxS2ZteXctRm5USHlmSi1QSlpJa3h1OUF2RzVLSDQ0NzlsV0JFODFxUWJ2SHdUR05aUUh3ckZPTnJfZjBXMWdicExMXzFlQzNuX2t4RGJJb0c3a0NHNWFRR3d0TzgzZWF1THd3eGlmZFg4Yk5xSHFZdVNoU1hMM05XMi1UeWFxSDcxVFFLYkpQYkhMeHhyNWUyZDBmemlxRHI3eF9EZmJqUGlybFZQdDNyQ2EwdUx0OTdRLVFtaU9Hd3BhVzFNZldadkYzbUVBWGJtdGxNekFfRl9nWFBtM3ZiSUI3UmJBVTRhR0dReHktaFV4UDd1R0FrTnVEMXNqeEp2RzE0aVc1bThCM0hoWVRMNDZPcm5ja0JBMDQyQ2h4Y0hPaVJHNjVXSEFIT2hVc2FyT0ZuYklzME1rWnBKV2NRak0wOTB4cEhHUnJJMTdFX3B2djVsNnE2X2tOdER6dE5iSGlVYWt3V0FkaFhjMzkwSVZnUk9jSk8zeDRVSTBMQmplOFdoTXNfMzJNSk94RThHenBvZW45Ym16VE1ETzNCQ3ZhSFRhNE5paG05dDdGRTlZNkVsaXpIRGthYlV4WVBRc250UTByQnpjV3ctNzB1QWxtMm1CWHhNSHZ5VGM1RzNtcmN0ZHVLQW1BPT0%3D&code_verifier=OpakwFTOgOjKcEn3nFCByRSA3hVvRVYbCl7HW3bJV1fJpaQhoJlDe2dPOJDFPay5', 'headers': {'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-13 16:07:40,783 oidcrp.oauth2 DEBUG Doing request with: URL:https://oidc.unimi.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=aDJ40HKUUH3uFqzqaDC4bV0gVuAadB0i&code=Z0FBQUFBQmxLVThzUGZ6VEpOYV9xbUVWdW45X0k3Wll1LVZDaklsSXBMNFRIR1NldmdrQkhpeEMwY1p1Z1hLclJHZC1mQnBYMlRIMXZQWGdmUDZ5NXFoa0tuYzlLZXZGcFFjbGhvUWpUNG5Ca0U3ODk5V0VySGVBMklySy1GeUlvUHM4Ynh4R2lpWFBHXzB5bGFhVERhaUljdDcwQlNOcGs4dnlvUXJKOXNacmpLdXhvRjNfTVpqenZEa0tROE9vMmZsd3hOMlBFaHp1R0k4VjN5ZGxLWU5iMEctZU5Ya1JMR0ZXTDRoUE5GeWhDMGpOTXVkOWR1X0Y1Skg3MzNxS2ZteXctRm5USHlmSi1QSlpJa3h1OUF2RzVLSDQ0NzlsV0JFODFxUWJ2SHdUR05aUUh3ckZPTnJfZjBXMWdicExMXzFlQzNuX2t4RGJJb0c3a0NHNWFRR3d0TzgzZWF1THd3eGlmZFg4Yk5xSHFZdVNoU1hMM05XMi1UeWFxSDcxVFFLYkpQYkhMeHhyNWUyZDBmemlxRHI3eF9EZmJqUGlybFZQdDNyQ2EwdUx0OTdRLVFtaU9Hd3BhVzFNZldadkYzbUVBWGJtdGxNekFfRl9nWFBtM3ZiSUI3UmJBVTRhR0dReHktaFV4UDd1R0FrTnVEMXNqeEp2RzE0aVc1bThCM0hoWVRMNDZPcm5ja0JBMDQyQ2h4Y0hPaVJHNjVXSEFIT2hVc2FyT0ZuYklzME1rWnBKV2NRak0wOTB4cEhHUnJJMTdFX3B2djVsNnE2X2tOdER6dE5iSGlVYWt3V0FkaFhjMzkwSVZnUk9jSk8zeDRVSTBMQmplOFdoTXNfMzJNSk94RThHenBvZW45Ym16VE1ETzNCQ3ZhSFRhNE5paG05dDdGRTlZNkVsaXpIRGthYlV4WVBRc250UTByQnpjV3ctNzB1QWxtMm1CWHhNSHZ5VGM1RzNtcmN0ZHVLQW1BPT0%3D&code_verifier=OpakwFTOgOjKcEn3nFCByRSA3hVvRVYbCl7HW3bJV1fJpaQhoJlDe2dPOJDFPay5, https_args:{'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-13 16:07:40,784 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): oidc.unimi.it:443
2023-10-13 16:07:41,523 urllib3.connectionpool DEBUG https://oidc.unimi.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-13 16:07:41,524 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:07:41,524 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:07:41,524 oidcrp.util DEBUG resp.headers: {'Date': 'Fri, 13 Oct 2023 14:07:37 GMT', 'Server': 'Apache/2.4.37 (Red Hat Enterprise Linux) OpenSSL/1.1.1g', 'Strict-Transport-Security': 'max-age=63072000;includeSubDomains;preload', 'Content-Type': 'application/json', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACWNBuU0Yi7q--GV2jtptNeQAzGkBLcSDI6e5PHYZCMnt9aPqN2HBG22xL1QiJYpjLe4EGmZ34RYV2aiNcSZAUjyUfpXF9y6w6p2V7UooK_RmgNfCmZQS2y5JhNEGXTN2-xfkWq-VT9_0vFvyEQJ0VroJecJWZ6bkeHlGkyybQ_A1j6xeKpMqxhWYK_LuKz3scxZg8Q3ti36GyRJobQJ1ftdNpce_UChs1ndTl7c5chr3vwwIq3csLQ3AAAAAGSNwPaQYUKQAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACWNBuU0Yi7q--GV2jtptNeQAzGkBLcSDI6e5PHYZCMnt9aPqN2HBG22xL1QiJYpjLe4EGmZ34RYV2aiNcSZAUjyUfpXF9y6w6p2V7UooK_RmgNfCmZQS2y5JhNEGXTN2-xfkWq-VT9_0vFvyEQJ0VroJecJWZ6bkeHlGkyybQ_A1j6xeKpMqxhWYK_LuKz3scxZg8Q3ti36GyRJobQJ1ftdNpce_UChs1ndTl7c5chr3vwwIq3csLQ3AAAAAGSNwPaQYUKQAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'Keep-Alive': 'timeout=3, max=500', 'Connection': 'Keep-Alive', 'Transfer-Encoding': 'chunked'}
2023-10-13 16:07:41,524 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjc0NjQ1NGRhNmU3MDQwNjg4NDI0N2Y4OGNiNmFlMmM2IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUaHpha3hKZWtSTmEyRXlaMFJGUWw5RE4ybzJSbmRvWkdaS2FXSm1Xa3hGTlVkc2JtNWpXVWRhUlZSdWQxZDBXV1Y0UldSTk0wTm5OR3BOUm04eGMwaFNTa3haTTFWblJUVlBaV2cyTTNSNllrWjFWMlZVVVZCaWIycDNjbXd4WVhWM2EwUlRTMGR6WXkxMmVWUndjWHAxUTBkeE1qRm9UVkZHU0VGTGFteFBXbFJWWkhjMFQyVnJVMmRIYVV3MFpVUTBUMWxDVERJMlYwRk9RbVpOVDJnNVlrSkVjbkZCUVdoalYySTFiMDF6YWtwNGNHczFURFJIZFZSRmNuSXhUMFU1TFRWMFVrTjZOVEpuYUVsUFNIVTFNSEJTUWpWSVdqaGthRnBqUkdKSVpsWXhPR2sxVUc5Q0xXbG5SRVk1VXpJelRuVlpkbDl1WW00NU5ISXhkM0U1YlVKU1UxRjFWREpRUlRaak1sODRTWEpET1ZsblZGRTlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDYwNjEsICJleHAiOiAxNjk3MjA5NjYxfQ.Z5nyCNCi8TQykkQz6LNSea_9bntssc4SaGxUv6OWEHnbaUpPPowma7AASg0qJR9DNPa0xcquBz26fzGPU9SZQA", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLVTh0MzFPaUFiOGV6X2ZGc09GOEFyZmkzUVZPSG1fZGNIU3UyNkt3NWdOaUdFalNHVkctMTdldzVva2RISlNJNlozaHdUb3o2NktzLVlpZU0yZnU5OXVidENyMlA2ZUZiREpGbjFOb2hCOGNZWldsVnFyQVpJVXc4MjJGQlZKNngzTkJUejBKRFFRR2MyZU1hazU3d3lwNi1BVUFhYWttbENINnE1bmNIYmZQUDU5NWM4ZXFsR1NBcGxEdl9zU3pCRl9neldLNXlwYWFVWkNLck13YWxtQ0VSVlFqLTJpUGRDVlFXTUVTb3U4Z2tRQXBVVmdkSmZnN0lVM0N3NFdvejA5Ty0wNUxSU1ZMT1J1VG5RejVua2YzMGU2bE5waWdIMHI4VnNGZXU5Y2lVdk9XU2Z5em1IVlU1a3ZETXhLbW90MFRuYWVOZ29pQzFlUGF6anBBVEdpMkdDUjFaUVJqTjFHNGVCcGFnNFN5bEJKUHlZendFUVc4bk1ZZlFEbXg1ZVd2a1phbm5NVzVXaDRKQWNhUFZHN3VJR3ZqaEl1NWFwUGtSSDlYLWFIRHBHeHhzSkFWU25teDJoOWpReUdjUVVCd0U2dlhWaG1keDV6VE43c2d6eUxONXBMcUVNZF9vYXhDOWlFSnNpTnBMZlZGdC1nTW5sczRiNTBXa1hGc0dHbTV3QUhiSkpKdG5ZQ1BVNXRmSm4taVFoOGhZZEFTTHJBYlZLcHoyLWJ3SDU4ZEMtWTVaN0ctZWNWZk5iUUpsNG53Si14ZktkOWg2eHBKVWRCNDFBaFhyamhUUXlIWmh2VHFZQkV6NEFIV3dHVGxYU3VyRzMwZnVZcGpRMGlqSGVTMmQ3V3BXbk14cFlPbDR1WnFDSmdZTXFJVDF3ZU1fc2QyMEgtVVZfT3dYSUtMVTFGOEdtUjg0YUl3NUk0a0hOSllZYklCMEVUZlRKdGlSQk43S2JHSXZBPT0=", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMyTXlSMUZGTUU1NGREQTVXa1JVVlhGeloweHNYM0JrZEUxYWVWTmhValZOYVVGRFR6VnJUekJtV1EifQ.eyJzdWIiOiAiYWY2MDBjYTY2M2VmOTM3MGFkMjM5ZjBmYTg0Njk4OGJiM2Q5NGFmNjE3MzE2ZmFjMTc0MjFmNzRlOTM2MTdhMiIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVlRoemFreEpla1JOYTJFeVowUkZRbDlETjJvMlJuZG9aR1pLYVdKbVdreEZOVWRzYm01aldVZGFSVlJ1ZDFkMFdXVjRSV1JOTTBObk5HcE5SbTh4YzBoU1NreFpNMVZuUlRWUFpXZzJNM1I2WWtaMVYyVlVVVkJpYjJwM2Ntd3hZWFYzYTBSVFMwZHpZeTEyZVZSd2NYcDFRMGR4TWpGb1RWRkdTRUZMYW14UFdsUlZaSGMwVDJWclUyZEhhVXcwWlVRMFQxbENUREkyVjBGT1FtWk5UMmc1WWtKRWNuRkJRV2hqVjJJMWIwMXpha3A0Y0dzMVREUkhkVlJGY25JeFQwVTVMVFYwVWtONk5USm5hRWxQU0hVMU1IQlNRalZJV2poa2FGcGpSR0pJWmxZeE9HazFVRzlDTFdsblJFWTVVekl6VG5WWmRsOXVZbTQ1TkhJeGQzRTViVUpTVTFGMVZESlFSVFpqTWw4NFNYSkRPVmxuVkZFOVBRPT0iLCAiYXV0aF90aW1lIjogMTY5NzIwNjA2MCwgImFjciI6ICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZFByb3RlY3RlZFRyYW5zcG9ydCIsICJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImp0aSI6ICJkZjkxNGJiYjY5ZDExMWVlODZhMjAyNDIwYWZmMGY1YyIsICJjbGllbnRfaWQiOiAicHJvdmFkaWluc2VyaW1lbnRvIiwgIm5vbmNlIjogIkN3MmZqb0tqUno5cDk4SG1YNjZNUERJWiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDYwNjEsICJleHAiOiAxNjk3MjA2MzYxLCAiYXVkIjogWyJwcm92YWRpaW5zZXJpbWVudG8iXX0.gn-4xZkvpKb035FHNW1jM30NCrvapb3ETEV1BtmYgccdw0EheTICL9ot5_wzLMlsRAh8BjmWTrfriIfiIZppmrjpe84l3hRJ0eD2-aB8PkpASvk0UPkRBsHSH1QseOks7u3BQfI2rpIBCyHKl2WXl3l84P0kJ1Kl1feypDKnW17eCNCk4en4oqdGOGKq0gzlCZpVUtMKoZa7U7k-c9MfS3nZieaQFywhp7-iZWULw6_IS2szlVi31b_fOKkHXKAIPAxD9xJTrBRWiDAJyi1TIVZt1rZrLl_ocU4DmHmDpGSH6yA1SbFgkY065leZtW2C-C3nRcEHVSFMNZpb9i449Q"}
2023-10-13 16:07:41,525 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjc0NjQ1NGRhNmU3MDQwNjg4NDI0N2Y4OGNiNmFlMmM2IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUaHpha3hKZWtSTmEyRXlaMFJGUWw5RE4ybzJSbmRvWkdaS2FXSm1Xa3hGTlVkc2JtNWpXVWRhUlZSdWQxZDBXV1Y0UldSTk0wTm5OR3BOUm04eGMwaFNTa3haTTFWblJUVlBaV2cyTTNSNllrWjFWMlZVVVZCaWIycDNjbXd4WVhWM2EwUlRTMGR6WXkxMmVWUndjWHAxUTBkeE1qRm9UVkZHU0VGTGFteFBXbFJWWkhjMFQyVnJVMmRIYVV3MFpVUTBUMWxDVERJMlYwRk9RbVpOVDJnNVlrSkVjbkZCUVdoalYySTFiMDF6YWtwNGNHczFURFJIZFZSRmNuSXhUMFU1TFRWMFVrTjZOVEpuYUVsUFNIVTFNSEJTUWpWSVdqaGthRnBqUkdKSVpsWXhPR2sxVUc5Q0xXbG5SRVk1VXpJelRuVlpkbDl1WW00NU5ISXhkM0U1YlVKU1UxRjFWREpRUlRaak1sODRTWEpET1ZsblZGRTlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDYwNjEsICJleHAiOiAxNjk3MjA5NjYxfQ.Z5nyCNCi8TQykkQz6LNSea_9bntssc4SaGxUv6OWEHnbaUpPPowma7AASg0qJR9DNPa0xcquBz26fzGPU9SZQA", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLVTh0MzFPaUFiOGV6X2ZGc09GOEFyZmkzUVZPSG1fZGNIU3UyNkt3NWdOaUdFalNHVkctMTdldzVva2RISlNJNlozaHdUb3o2NktzLVlpZU0yZnU5OXVidENyMlA2ZUZiREpGbjFOb2hCOGNZWldsVnFyQVpJVXc4MjJGQlZKNngzTkJUejBKRFFRR2MyZU1hazU3d3lwNi1BVUFhYWttbENINnE1bmNIYmZQUDU5NWM4ZXFsR1NBcGxEdl9zU3pCRl9neldLNXlwYWFVWkNLck13YWxtQ0VSVlFqLTJpUGRDVlFXTUVTb3U4Z2tRQXBVVmdkSmZnN0lVM0N3NFdvejA5Ty0wNUxSU1ZMT1J1VG5RejVua2YzMGU2bE5waWdIMHI4VnNGZXU5Y2lVdk9XU2Z5em1IVlU1a3ZETXhLbW90MFRuYWVOZ29pQzFlUGF6anBBVEdpMkdDUjFaUVJqTjFHNGVCcGFnNFN5bEJKUHlZendFUVc4bk1ZZlFEbXg1ZVd2a1phbm5NVzVXaDRKQWNhUFZHN3VJR3ZqaEl1NWFwUGtSSDlYLWFIRHBHeHhzSkFWU25teDJoOWpReUdjUVVCd0U2dlhWaG1keDV6VE43c2d6eUxONXBMcUVNZF9vYXhDOWlFSnNpTnBMZlZGdC1nTW5sczRiNTBXa1hGc0dHbTV3QUhiSkpKdG5ZQ1BVNXRmSm4taVFoOGhZZEFTTHJBYlZLcHoyLWJ3SDU4ZEMtWTVaN0ctZWNWZk5iUUpsNG53Si14ZktkOWg2eHBKVWRCNDFBaFhyamhUUXlIWmh2VHFZQkV6NEFIV3dHVGxYU3VyRzMwZnVZcGpRMGlqSGVTMmQ3V3BXbk14cFlPbDR1WnFDSmdZTXFJVDF3ZU1fc2QyMEgtVVZfT3dYSUtMVTFGOEdtUjg0YUl3NUk0a0hOSllZYklCMEVUZlRKdGlSQk43S2JHSXZBPT0=", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMyTXlSMUZGTUU1NGREQTVXa1JVVlhGeloweHNYM0JrZEUxYWVWTmhValZOYVVGRFR6VnJUekJtV1EifQ.eyJzdWIiOiAiYWY2MDBjYTY2M2VmOTM3MGFkMjM5ZjBmYTg0Njk4OGJiM2Q5NGFmNjE3MzE2ZmFjMTc0MjFmNzRlOTM2MTdhMiIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVlRoemFreEpla1JOYTJFeVowUkZRbDlETjJvMlJuZG9aR1pLYVdKbVdreEZOVWRzYm01aldVZGFSVlJ1ZDFkMFdXVjRSV1JOTTBObk5HcE5SbTh4YzBoU1NreFpNMVZuUlRWUFpXZzJNM1I2WWtaMVYyVlVVVkJpYjJwM2Ntd3hZWFYzYTBSVFMwZHpZeTEyZVZSd2NYcDFRMGR4TWpGb1RWRkdTRUZMYW14UFdsUlZaSGMwVDJWclUyZEhhVXcwWlVRMFQxbENUREkyVjBGT1FtWk5UMmc1WWtKRWNuRkJRV2hqVjJJMWIwMXpha3A0Y0dzMVREUkhkVlJGY25JeFQwVTVMVFYwVWtONk5USm5hRWxQU0hVMU1IQlNRalZJV2poa2FGcGpSR0pJWmxZeE9HazFVRzlDTFdsblJFWTVVekl6VG5WWmRsOXVZbTQ1TkhJeGQzRTViVUpTVTFGMVZESlFSVFpqTWw4NFNYSkRPVmxuVkZFOVBRPT0iLCAiYXV0aF90aW1lIjogMTY5NzIwNjA2MCwgImFjciI6ICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZFByb3RlY3RlZFRyYW5zcG9ydCIsICJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImp0aSI6ICJkZjkxNGJiYjY5ZDExMWVlODZhMjAyNDIwYWZmMGY1YyIsICJjbGllbnRfaWQiOiAicHJvdmFkaWluc2VyaW1lbnRvIiwgIm5vbmNlIjogIkN3MmZqb0tqUno5cDk4SG1YNjZNUERJWiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDYwNjEsICJleHAiOiAxNjk3MjA2MzYxLCAiYXVkIjogWyJwcm92YWRpaW5zZXJpbWVudG8iXX0.gn-4xZkvpKb035FHNW1jM30NCrvapb3ETEV1BtmYgccdw0EheTICL9ot5_wzLMlsRAh8BjmWTrfriIfiIZppmrjpe84l3hRJ0eD2-aB8PkpASvk0UPkRBsHSH1QseOks7u3BQfI2rpIBCyHKl2WXl3l84P0kJ1Kl1feypDKnW17eCNCk4en4oqdGOGKq0gzlCZpVUtMKoZa7U7k-c9MfS3nZieaQFywhp7-iZWULw6_IS2szlVi31b_fOKkHXKAIPAxD9xJTrBRWiDAJyi1TIVZt1rZrLl_ocU4DmHmDpGSH6yA1SbFgkY065leZtW2C-C3nRcEHVSFMNZpb9i449Q"}
2023-10-13 16:07:41,525 oidcrp.service DEBUG response format: json
2023-10-13 16:07:41,525 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-13 16:07:41,525 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjc0NjQ1NGRhNmU3MDQwNjg4NDI0N2Y4OGNiNmFlMmM2IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUaHpha3hKZWtSTmEyRXlaMFJGUWw5RE4ybzJSbmRvWkdaS2FXSm1Xa3hGTlVkc2JtNWpXVWRhUlZSdWQxZDBXV1Y0UldSTk0wTm5OR3BOUm04eGMwaFNTa3haTTFWblJUVlBaV2cyTTNSNllrWjFWMlZVVVZCaWIycDNjbXd4WVhWM2EwUlRTMGR6WXkxMmVWUndjWHAxUTBkeE1qRm9UVkZHU0VGTGFteFBXbFJWWkhjMFQyVnJVMmRIYVV3MFpVUTBUMWxDVERJMlYwRk9RbVpOVDJnNVlrSkVjbkZCUVdoalYySTFiMDF6YWtwNGNHczFURFJIZFZSRmNuSXhUMFU1TFRWMFVrTjZOVEpuYUVsUFNIVTFNSEJTUWpWSVdqaGthRnBqUkdKSVpsWXhPR2sxVUc5Q0xXbG5SRVk1VXpJelRuVlpkbDl1WW00NU5ISXhkM0U1YlVKU1UxRjFWREpRUlRaak1sODRTWEpET1ZsblZGRTlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDYwNjEsICJleHAiOiAxNjk3MjA5NjYxfQ.Z5nyCNCi8TQykkQz6LNSea_9bntssc4SaGxUv6OWEHnbaUpPPowma7AASg0qJR9DNPa0xcquBz26fzGPU9SZQA', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxLVTh0MzFPaUFiOGV6X2ZGc09GOEFyZmkzUVZPSG1fZGNIU3UyNkt3NWdOaUdFalNHVkctMTdldzVva2RISlNJNlozaHdUb3o2NktzLVlpZU0yZnU5OXVidENyMlA2ZUZiREpGbjFOb2hCOGNZWldsVnFyQVpJVXc4MjJGQlZKNngzTkJUejBKRFFRR2MyZU1hazU3d3lwNi1BVUFhYWttbENINnE1bmNIYmZQUDU5NWM4ZXFsR1NBcGxEdl9zU3pCRl9neldLNXlwYWFVWkNLck13YWxtQ0VSVlFqLTJpUGRDVlFXTUVTb3U4Z2tRQXBVVmdkSmZnN0lVM0N3NFdvejA5Ty0wNUxSU1ZMT1J1VG5RejVua2YzMGU2bE5waWdIMHI4VnNGZXU5Y2lVdk9XU2Z5em1IVlU1a3ZETXhLbW90MFRuYWVOZ29pQzFlUGF6anBBVEdpMkdDUjFaUVJqTjFHNGVCcGFnNFN5bEJKUHlZendFUVc4bk1ZZlFEbXg1ZVd2a1phbm5NVzVXaDRKQWNhUFZHN3VJR3ZqaEl1NWFwUGtSSDlYLWFIRHBHeHhzSkFWU25teDJoOWpReUdjUVVCd0U2dlhWaG1keDV6VE43c2d6eUxONXBMcUVNZF9vYXhDOWlFSnNpTnBMZlZGdC1nTW5sczRiNTBXa1hGc0dHbTV3QUhiSkpKdG5ZQ1BVNXRmSm4taVFoOGhZZEFTTHJBYlZLcHoyLWJ3SDU4ZEMtWTVaN0ctZWNWZk5iUUpsNG53Si14ZktkOWg2eHBKVWRCNDFBaFhyamhUUXlIWmh2VHFZQkV6NEFIV3dHVGxYU3VyRzMwZnVZcGpRMGlqSGVTMmQ3V3BXbk14cFlPbDR1WnFDSmdZTXFJVDF3ZU1fc2QyMEgtVVZfT3dYSUtMVTFGOEdtUjg0YUl3NUk0a0hOSllZYklCMEVUZlRKdGlSQk43S2JHSXZBPT0=', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6ImMyTXlSMUZGTUU1NGREQTVXa1JVVlhGeloweHNYM0JrZEUxYWVWTmhValZOYVVGRFR6VnJUekJtV1EifQ.eyJzdWIiOiAiYWY2MDBjYTY2M2VmOTM3MGFkMjM5ZjBmYTg0Njk4OGJiM2Q5NGFmNjE3MzE2ZmFjMTc0MjFmNzRlOTM2MTdhMiIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVlRoemFreEpla1JOYTJFeVowUkZRbDlETjJvMlJuZG9aR1pLYVdKbVdreEZOVWRzYm01aldVZGFSVlJ1ZDFkMFdXVjRSV1JOTTBObk5HcE5SbTh4YzBoU1NreFpNMVZuUlRWUFpXZzJNM1I2WWtaMVYyVlVVVkJpYjJwM2Ntd3hZWFYzYTBSVFMwZHpZeTEyZVZSd2NYcDFRMGR4TWpGb1RWRkdTRUZMYW14UFdsUlZaSGMwVDJWclUyZEhhVXcwWlVRMFQxbENUREkyVjBGT1FtWk5UMmc1WWtKRWNuRkJRV2hqVjJJMWIwMXpha3A0Y0dzMVREUkhkVlJGY25JeFQwVTVMVFYwVWtONk5USm5hRWxQU0hVMU1IQlNRalZJV2poa2FGcGpSR0pJWmxZeE9HazFVRzlDTFdsblJFWTVVekl6VG5WWmRsOXVZbTQ1TkhJeGQzRTViVUpTVTFGMVZESlFSVFpqTWw4NFNYSkRPVmxuVkZFOVBRPT0iLCAiYXV0aF90aW1lIjogMTY5NzIwNjA2MCwgImFjciI6ICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZFByb3RlY3RlZFRyYW5zcG9ydCIsICJzY29wZSI6IFsib3BlbmlkIiwgInByb2ZpbGUiLCAib2ZmbGluZV9hY2Nlc3MiXSwgImp0aSI6ICJkZjkxNGJiYjY5ZDExMWVlODZhMjAyNDIwYWZmMGY1YyIsICJjbGllbnRfaWQiOiAicHJvdmFkaWluc2VyaW1lbnRvIiwgIm5vbmNlIjogIkN3MmZqb0tqUno5cDk4SG1YNjZNUERJWiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDYwNjEsICJleHAiOiAxNjk3MjA2MzYxLCAiYXVkIjogWyJwcm92YWRpaW5zZXJpbWVudG8iXX0.gn-4xZkvpKb035FHNW1jM30NCrvapb3ETEV1BtmYgccdw0EheTICL9ot5_wzLMlsRAh8BjmWTrfriIfiIZppmrjpe84l3hRJ0eD2-aB8PkpASvk0UPkRBsHSH1QseOks7u3BQfI2rpIBCyHKl2WXl3l84P0kJ1Kl1feypDKnW17eCNCk4en4oqdGOGKq0gzlCZpVUtMKoZa7U7k-c9MfS3nZieaQFywhp7-iZWULw6_IS2szlVi31b_fOKkHXKAIPAxD9xJTrBRWiDAJyi1TIVZt1rZrLl_ocU4DmHmDpGSH6yA1SbFgkY065leZtW2C-C3nRcEHVSFMNZpb9i449Q'}"
2023-10-13 16:07:41,525 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://oidc.unimi.it', 'keyjar': <KeyJar(issuers=['', 'https://oidc.unimi.it'])>, 'verify': True, 'skew': 15}
2023-10-13 16:07:41,526 oidcmsg.message DEBUG Raw JSON: {'sub': 'af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2', 'sid': 'Z0FBQUFBQmxLVThzakxJekRNa2EyZ0RFQl9DN2o2RndoZGZKaWJmWkxFNUdsbm5jWUdaRVRud1d0WWV4RWRNM0NnNGpNRm8xc0hSSkxZM1VnRTVPZWg2M3R6YkZ1V2VUUVBib2p3cmwxYXV3a0RTS0dzYy12eVRwcXp1Q0dxMjFoTVFGSEFLamxPWlRVZHc0T2VrU2dHaUw0ZUQ0T1lCTDI2V0FOQmZNT2g5YkJEcnFBQWhjV2I1b01zakp4cGs1TDRHdVRFcnIxT0U5LTV0UkN6NTJnaElPSHU1MHBSQjVIWjhkaFpjRGJIZlYxOGk1UG9CLWlnREY5UzIzTnVZdl9uYm45NHIxd3E5bUJSU1F1VDJQRTZjMl84SXJDOVlnVFE9PQ==', 'auth_time': 1697206060, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'df914bbb69d111ee86a202420aff0f5c', 'client_id': 'provadiinserimento', 'nonce': 'Cw2fjoKjRz9p98HmX66MPDIZ', 'iss': 'https://oidc.unimi.it', 'iat': 1697206061, 'exp': 1697206361, 'aud': ['provadiinserimento']}
2023-10-13 16:07:41,526 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ'}
2023-10-13 16:07:41,526 cryptojwt.key_jar DEBUG Key summary for https://oidc.unimi.it: RSA:sig:c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ, EC:sig:Y0JpcWJHX1A4Y1NXV1RUdFlwUGRVb2hYazNlbDJVR3lnMEVtS1hyNjhsMA
2023-10-13 16:07:41,527 oidcmsg.message DEBUG Found signing key.
2023-10-13 16:07:41,527 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-13 16:07:41,527 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ and use=
2023-10-13 16:07:41,527 cryptojwt.jwx DEBUG Picked: kid:c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ, use:sig, kty:RSA
2023-10-13 16:07:41,528 cryptojwt.jws.jws DEBUG Verified message using key with kid=c2MyR1FFME54dDA5WkRUVXFzZ0xsX3BkdE1aeVNhUjVNaUFDTzVrTzBmWQ
2023-10-13 16:07:41,528 oidcmsg.oidc INFO Verified id_token: {'sub': 'af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2', 'sid': 'Z0FBQUFBQmxLVThzakxJekRNa2EyZ0RFQl9DN2o2RndoZGZKaWJmWkxFNUdsbm5jWUdaRVRud1d0WWV4RWRNM0NnNGpNRm8xc0hSSkxZM1VnRTVPZWg2M3R6YkZ1V2VUUVBib2p3cmwxYXV3a0RTS0dzYy12eVRwcXp1Q0dxMjFoTVFGSEFLamxPWlRVZHc0T2VrU2dHaUw0ZUQ0T1lCTDI2V0FOQmZNT2g5YkJEcnFBQWhjV2I1b01zakp4cGs1TDRHdVRFcnIxT0U5LTV0UkN6NTJnaElPSHU1MHBSQjVIWjhkaFpjRGJIZlYxOGk1UG9CLWlnREY5UzIzTnVZdl9uYm45NHIxd3E5bUJSU1F1VDJQRTZjMl84SXJDOVlnVFE9PQ==', 'auth_time': 1697206060, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'df914bbb69d111ee86a202420aff0f5c', 'client_id': 'provadiinserimento', 'nonce': 'Cw2fjoKjRz9p98HmX66MPDIZ', 'iss': 'https://oidc.unimi.it', 'iat': 1697206061, 'exp': 1697206361, 'aud': ['provadiinserimento']}
2023-10-13 16:07:41,531 oidcrp.rp_handler DEBUG ID Token: {'sub': 'af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2', 'sid': 'Z0FBQUFBQmxLVThzakxJekRNa2EyZ0RFQl9DN2o2RndoZGZKaWJmWkxFNUdsbm5jWUdaRVRud1d0WWV4RWRNM0NnNGpNRm8xc0hSSkxZM1VnRTVPZWg2M3R6YkZ1V2VUUVBib2p3cmwxYXV3a0RTS0dzYy12eVRwcXp1Q0dxMjFoTVFGSEFLamxPWlRVZHc0T2VrU2dHaUw0ZUQ0T1lCTDI2V0FOQmZNT2g5YkJEcnFBQWhjV2I1b01zakp4cGs1TDRHdVRFcnIxT0U5LTV0UkN6NTJnaElPSHU1MHBSQjVIWjhkaFpjRGJIZlYxOGk1UG9CLWlnREY5UzIzTnVZdl9uYm45NHIxd3E5bUJSU1F1VDJQRTZjMl84SXJDOVlnVFE9PQ==', 'auth_time': 1697206060, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'df914bbb69d111ee86a202420aff0f5c', 'client_id': 'provadiinserimento', 'nonce': 'Cw2fjoKjRz9p98HmX66MPDIZ', 'iss': 'https://oidc.unimi.it', 'iat': 1697206061, 'exp': 1697206361, 'aud': ['provadiinserimento']}
2023-10-13 16:07:41,531 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-13 16:07:41,531 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjc0NjQ1NGRhNmU3MDQwNjg4NDI0N2Y4OGNiNmFlMmM2IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUaHpha3hKZWtSTmEyRXlaMFJGUWw5RE4ybzJSbmRvWkdaS2FXSm1Xa3hGTlVkc2JtNWpXVWRhUlZSdWQxZDBXV1Y0UldSTk0wTm5OR3BOUm04eGMwaFNTa3haTTFWblJUVlBaV2cyTTNSNllrWjFWMlZVVVZCaWIycDNjbXd4WVhWM2EwUlRTMGR6WXkxMmVWUndjWHAxUTBkeE1qRm9UVkZHU0VGTGFteFBXbFJWWkhjMFQyVnJVMmRIYVV3MFpVUTBUMWxDVERJMlYwRk9RbVpOVDJnNVlrSkVjbkZCUVdoalYySTFiMDF6YWtwNGNHczFURFJIZFZSRmNuSXhUMFU1TFRWMFVrTjZOVEpuYUVsUFNIVTFNSEJTUWpWSVdqaGthRnBqUkdKSVpsWXhPR2sxVUc5Q0xXbG5SRVk1VXpJelRuVlpkbDl1WW00NU5ISXhkM0U1YlVKU1UxRjFWREpRUlRaak1sODRTWEpET1ZsblZGRTlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDYwNjEsICJleHAiOiAxNjk3MjA5NjYxfQ.Z5nyCNCi8TQykkQz6LNSea_9bntssc4SaGxUv6OWEHnbaUpPPowma7AASg0qJR9DNPa0xcquBz26fzGPU9SZQA'}
2023-10-13 16:07:41,531 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-13 16:07:41,531 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7fc9805afed0>, 'url': 'https://oidc.unimi.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjc0NjQ1NGRhNmU3MDQwNjg4NDI0N2Y4OGNiNmFlMmM2IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUaHpha3hKZWtSTmEyRXlaMFJGUWw5RE4ybzJSbmRvWkdaS2FXSm1Xa3hGTlVkc2JtNWpXVWRhUlZSdWQxZDBXV1Y0UldSTk0wTm5OR3BOUm04eGMwaFNTa3haTTFWblJUVlBaV2cyTTNSNllrWjFWMlZVVVZCaWIycDNjbXd4WVhWM2EwUlRTMGR6WXkxMmVWUndjWHAxUTBkeE1qRm9UVkZHU0VGTGFteFBXbFJWWkhjMFQyVnJVMmRIYVV3MFpVUTBUMWxDVERJMlYwRk9RbVpOVDJnNVlrSkVjbkZCUVdoalYySTFiMDF6YWtwNGNHczFURFJIZFZSRmNuSXhUMFU1TFRWMFVrTjZOVEpuYUVsUFNIVTFNSEJTUWpWSVdqaGthRnBqUkdKSVpsWXhPR2sxVUc5Q0xXbG5SRVk1VXpJelRuVlpkbDl1WW00NU5ISXhkM0U1YlVKU1UxRjFWREpRUlRaak1sODRTWEpET1ZsblZGRTlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDYwNjEsICJleHAiOiAxNjk3MjA5NjYxfQ.Z5nyCNCi8TQykkQz6LNSea_9bntssc4SaGxUv6OWEHnbaUpPPowma7AASg0qJR9DNPa0xcquBz26fzGPU9SZQA'}}
2023-10-13 16:07:41,532 oidcrp.oauth2 DEBUG Doing request with: URL:https://oidc.unimi.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IlkwSnBjV0pIWDFBNFkxTlhWMVJVZEZsd1VHUlZiMmhZYXpObGJESlZSM2xuTUVWdFMxaHlOamhzTUEifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjc0NjQ1NGRhNmU3MDQwNjg4NDI0N2Y4OGNiNmFlMmM2IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogImFmNjAwY2E2NjNlZjkzNzBhZDIzOWYwZmE4NDY5ODhiYjNkOTRhZjYxNzMxNmZhYzE3NDIxZjc0ZTkzNjE3YTIiLCAic2lkIjogIlowRkJRVUZCUW14TFZUaHpha3hKZWtSTmEyRXlaMFJGUWw5RE4ybzJSbmRvWkdaS2FXSm1Xa3hGTlVkc2JtNWpXVWRhUlZSdWQxZDBXV1Y0UldSTk0wTm5OR3BOUm04eGMwaFNTa3haTTFWblJUVlBaV2cyTTNSNllrWjFWMlZVVVZCaWIycDNjbXd4WVhWM2EwUlRTMGR6WXkxMmVWUndjWHAxUTBkeE1qRm9UVkZHU0VGTGFteFBXbFJWWkhjMFQyVnJVMmRIYVV3MFpVUTBUMWxDVERJMlYwRk9RbVpOVDJnNVlrSkVjbkZCUVdoalYySTFiMDF6YWtwNGNHczFURFJIZFZSRmNuSXhUMFU1TFRWMFVrTjZOVEpuYUVsUFNIVTFNSEJTUWpWSVdqaGthRnBqUkdKSVpsWXhPR2sxVUc5Q0xXbG5SRVk1VXpJelRuVlpkbDl1WW00NU5ISXhkM0U1YlVKU1UxRjFWREpRUlRaak1sODRTWEpET1ZsblZGRTlQUT09IiwgInRva2VuX2NsYXNzIjogImFjY2Vzc190b2tlbiIsICJpc3MiOiAiaHR0cHM6Ly9vaWRjLnVuaW1pLml0IiwgImlhdCI6IDE2OTcyMDYwNjEsICJleHAiOiAxNjk3MjA5NjYxfQ.Z5nyCNCi8TQykkQz6LNSea_9bntssc4SaGxUv6OWEHnbaUpPPowma7AASg0qJR9DNPa0xcquBz26fzGPU9SZQA'}
2023-10-13 16:07:41,533 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): oidc.unimi.it:443
2023-10-13 16:07:42,391 urllib3.connectionpool DEBUG https://oidc.unimi.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-13 16:07:42,392 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:07:42,393 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:07:42,393 oidcrp.util DEBUG resp.headers: {'Date': 'Fri, 13 Oct 2023 14:07:38 GMT', 'Server': 'Apache/2.4.37 (Red Hat Enterprise Linux) OpenSSL/1.1.1g', 'Strict-Transport-Security': 'max-age=63072000;includeSubDomains;preload', 'Content-Type': 'application/json', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldABmShqU2gpKDu-oQFKA8kRVElCa3eaHDIooH8axeneiXvfUfMwad4fObMgK5iCebISqa709JxscG2eDsE14OTbeQ__QEbps7PIpXuKkj4NdowRVlO4iGRI-Okjeg3Z09sgFPeNeeMY0-wXBskYeizUDC2XburMPAkD_9npvS0xHKPEFHrW_0wWzfVrBT0HnEzQ4i1mY7IiuqCPQNeUJiW2IGLfT-mYVVQKvxYcYiVMepuykn6oKtqIzqAAAAAOq_ZamRt5r1AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldABmShqU2gpKDu-oQFKA8kRVElCa3eaHDIooH8axeneiXvfUfMwad4fObMgK5iCebISqa709JxscG2eDsE14OTbeQ__QEbps7PIpXuKkj4NdowRVlO4iGRI-Okjeg3Z09sgFPeNeeMY0-wXBskYeizUDC2XburMPAkD_9npvS0xHKPEFHrW_0wWzfVrBT0HnEzQ4i1mY7IiuqCPQNeUJiW2IGLfT-mYVVQKvxYcYiVMepuykn6oKtqIzqAAAAAOq_ZamRt5r1AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'Keep-Alive': 'timeout=3, max=500', 'Connection': 'Keep-Alive', 'Transfer-Encoding': 'chunked'}
2023-10-13 16:07:42,393 oidcrp.util DEBUG resp.txt: {"sub": "af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2", "given_name": "MARIA", "family_name": "UNIMIA", "nickname": "Maria Unimia", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-13 16:07:42,393 oidcrp.oauth2 DEBUG Successful response: {"sub": "af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2", "given_name": "MARIA", "family_name": "UNIMIA", "nickname": "Maria Unimia", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-13 16:07:42,393 oidcrp.service DEBUG response format: json
2023-10-13 16:07:42,393 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-13 16:07:42,393 oidcrp.service DEBUG Initial response parsing => "{'sub': 'af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2', 'given_name': 'MARIA', 'family_name': 'UNIMIA', 'nickname': 'Maria Unimia', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}"
2023-10-13 16:07:42,394 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://oidc.unimi.it', 'keyjar': <KeyJar(issuers=['', 'https://oidc.unimi.it'])>, 'verify': True, 'skew': 15}
2023-10-13 16:07:42,396 oidcrp.rp_handler DEBUG UserInfo: {'sub': 'af600ca663ef9370ad239f0fa846988bb3d94af617316fac17421f74e93617a2', 'given_name': 'MARIA', 'family_name': 'UNIMIA', 'nickname': 'Maria Unimia', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}
2023-10-13 16:07:42,404 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:07:42] "GET /authz_cb/satosa?state=aDJ40HKUUH3uFqzqaDC4bV0gVuAadB0i&scope=openid+offline_access+profile&code=Z0FBQUFBQmxLVThzUGZ6VEpOYV9xbUVWdW45X0k3Wll1LVZDaklsSXBMNFRIR1NldmdrQkhpeEMwY1p1Z1hLclJHZC1mQnBYMlRIMXZQWGdmUDZ5NXFoa0tuYzlLZXZGcFFjbGhvUWpUNG5Ca0U3ODk5V0VySGVBMklySy1GeUlvUHM4Ynh4R2lpWFBHXzB5bGFhVERhaUljdDcwQlNOcGs4dnlvUXJKOXNacmpLdXhvRjNfTVpqenZEa0tROE9vMmZsd3hOMlBFaHp1R0k4VjN5ZGxLWU5iMEctZU5Ya1JMR0ZXTDRoUE5GeWhDMGpOTXVkOWR1X0Y1Skg3MzNxS2ZteXctRm5USHlmSi1QSlpJa3h1OUF2RzVLSDQ0NzlsV0JFODFxUWJ2SHdUR05aUUh3ckZPTnJfZjBXMWdicExMXzFlQzNuX2t4RGJJb0c3a0NHNWFRR3d0TzgzZWF1THd3eGlmZFg4Yk5xSHFZdVNoU1hMM05XMi1UeWFxSDcxVFFLYkpQYkhMeHhyNWUyZDBmemlxRHI3eF9EZmJqUGlybFZQdDNyQ2EwdUx0OTdRLVFtaU9Hd3BhVzFNZldadkYzbUVBWGJtdGxNekFfRl9nWFBtM3ZiSUI3UmJBVTRhR0dReHktaFV4UDd1R0FrTnVEMXNqeEp2RzE0aVc1bThCM0hoWVRMNDZPcm5ja0JBMDQyQ2h4Y0hPaVJHNjVXSEFIT2hVc2FyT0ZuYklzME1rWnBKV2NRak0wOTB4cEhHUnJJMTdFX3B2djVsNnE2X2tOdER6dE5iSGlVYWt3V0FkaFhjMzkwSVZnUk9jSk8zeDRVSTBMQmplOFdoTXNfMzJNSk94RThHenBvZW45Ym16VE1ETzNCQ3ZhSFRhNE5paG05dDdGRTlZNkVsaXpIRGthYlV4WVBRc250UTByQnpjV3ctNzB1QWxtMm1CWHhNSHZ5VGM1RzNtcmN0ZHVLQW1BPT0%3D&iss=https://oidc.unimi.it&client_id=provadiinserimento HTTP/1.1" 200 -
2023-10-13 16:40:04,053 root DEBUG Configured logging using dictionary
2023-10-13 16:40:04,091 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-13 16:40:04,091 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-13 16:40:04,092 werkzeug INFO  * Restarting with stat
2023-10-13 16:40:04,270 root DEBUG Configured logging using dictionary
2023-10-13 16:40:04,307 werkzeug WARNING  * Debugger is active!
2023-10-13 16:40:04,307 werkzeug INFO  * Debugger PIN: 221-170-319
2023-10-13 16:40:13,859 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:40:13] "GET / HTTP/1.1" 200 -
2023-10-13 16:40:17,667 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-13 16:40:17,667 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-13 16:40:17,667 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-13 16:40:17,668 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-13 16:40:17,705 oidcrp.rp_handler DEBUG Get provider info
2023-10-13 16:40:17,705 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-13 16:40:17,705 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://oidc.unimi.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-13 16:40:17,705 oidcrp.oauth2 DEBUG Doing request with: URL:https://oidc.unimi.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-13 16:40:17,707 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): oidc.unimi.it:443
2023-10-13 16:40:17,952 urllib3.connectionpool DEBUG https://oidc.unimi.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-13 16:40:17,954 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:40:17,954 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:40:17,954 oidcrp.util DEBUG resp.headers: {'Date': 'Fri, 13 Oct 2023 14:40:14 GMT', 'Server': 'Apache/2.4.37 (Red Hat Enterprise Linux) OpenSSL/1.1.1g', 'Strict-Transport-Security': 'max-age=63072000;includeSubDomains;preload', 'Content-Type': 'application/json', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdACycCiYjFw1e5rfTTxW0HQS_RRN8yrBaKAc372JEG-HUsGiF9PKVH-UU79rD0tWx6at3c-kldIhgZ3GRoZV-w-RQmlHjROl63J4KKqsmwQareUtsGQlCP7JxXUne5FI99NaNU2lw8Bg7Qj5UCEQKVt2ogjsyi8IcGvxh1LAVgYi20XF5UwZXYBGDfWljiyzh8nOZZwFAjS-mLDCjGZFG9yBkTwFlOuVEnsS2qxiZcFV7pbL5ZSFcFg7-AAAAAI3Hm5tp--h1AAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdACycCiYjFw1e5rfTTxW0HQS_RRN8yrBaKAc372JEG-HUsGiF9PKVH-UU79rD0tWx6at3c-kldIhgZ3GRoZV-w-RQmlHjROl63J4KKqsmwQareUtsGQlCP7JxXUne5FI99NaNU2lw8Bg7Qj5UCEQKVt2ogjsyi8IcGvxh1LAVgYi20XF5UwZXYBGDfWljiyzh8nOZZwFAjS-mLDCjGZFG9yBkTwFlOuVEnsS2qxiZcFV7pbL5ZSFcFg7-AAAAAI3Hm5tp--h1AAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'Keep-Alive': 'timeout=3, max=500', 'Connection': 'Keep-Alive', 'Transfer-Encoding': 'chunked'}
2023-10-13 16:40:17,954 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://oidc.unimi.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://oidc.unimi.it", "authorization_endpoint": "https://oidc.unimi.it/OIDC/authorization", "token_endpoint": "https://oidc.unimi.it/OIDC/token", "userinfo_endpoint": "https://oidc.unimi.it/OIDC/userinfo", "introspection_endpoint": "https://oidc.unimi.it/OIDC/introspection"}
2023-10-13 16:40:17,954 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://oidc.unimi.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://oidc.unimi.it", "authorization_endpoint": "https://oidc.unimi.it/OIDC/authorization", "token_endpoint": "https://oidc.unimi.it/OIDC/token", "userinfo_endpoint": "https://oidc.unimi.it/OIDC/userinfo", "introspection_endpoint": "https://oidc.unimi.it/OIDC/introspection"}
2023-10-13 16:40:17,955 oidcrp.service DEBUG response format: json
2023-10-13 16:40:17,955 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-13 16:40:17,955 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['implicit', 'authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://oidc.unimi.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://oidc.unimi.it', 'authorization_endpoint': 'https://oidc.unimi.it/OIDC/authorization', 'token_endpoint': 'https://oidc.unimi.it/OIDC/token', 'userinfo_endpoint': 'https://oidc.unimi.it/OIDC/userinfo', 'introspection_endpoint': 'https://oidc.unimi.it/OIDC/introspection'}"
2023-10-13 16:40:17,955 oidcrp.service DEBUG Verify response with {'iss': 'https://oidc.unimi.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'provadiinserimento'}
2023-10-13 16:40:17,957 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://oidc.unimi.it
2023-10-13 16:40:17,958 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-13 16:40:17,958 cryptojwt.key_bundle INFO Reading remote JWKS from https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:40:17,958 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:40:17,960 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): oidc.unimi.it:443
2023-10-13 16:40:18,163 urllib3.connectionpool DEBUG https://oidc.unimi.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-13 16:40:18,164 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "Ry1mQXJ1YXhUSVZsMmFqX2JWVVlaLWg1TkczZmFfUmtTV2RIcFpMYnBaUQ", "n": "jN9xGrhOE7VLpgwFAN-hOviMXV5iXx9fN2IB5eto42WKI6ACfkEqD2IYMuAkUT8E8aJ3zcjQl7LiX-F4ndnQaEXFkdKC9i5A0PMcjmXIvZBJJDL7S4YwYEQ6TEU1QQdvBv2GWbMe1Kv1x1igK1rYIZGVbtt1F9JT9pM-_K7S6vbwgBMs4i8PtAqA12M9dYuw4b5LH0U05lL84SyxCFsHuLkey-zCQA2b_ML3ZPC_5SwqwqslrJoISWnnIn-KeB5zk0XyKkzbUlnczSdNb4-QJF1MzBVvQrPcDEmMzXC2rXSAU-1rJMr5jzPAD5l7SjYGNIAjDTrbIewXV6RknylM4Q", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "dmdNbVcxWmJMU3RoOWFGQ0tRWmNPNGxDS3Bzbm5DYUltOTFYLVQzNkhvdw", "crv": "P-256", "x": "tS-6882jiGznp-6ldGM8sBi3M5LWOcTcGLelImEJ6yw", "y": "2uAg-TqCGK_E97lcOcCPTuSvSXQRzsv45plCIteBh6U"}]} from https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:40:18,164 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "Ry1mQXJ1YXhUSVZsMmFqX2JWVVlaLWg1TkczZmFfUmtTV2RIcFpMYnBaUQ", "n": "jN9xGrhOE7VLpgwFAN-hOviMXV5iXx9fN2IB5eto42WKI6ACfkEqD2IYMuAkUT8E8aJ3zcjQl7LiX-F4ndnQaEXFkdKC9i5A0PMcjmXIvZBJJDL7S4YwYEQ6TEU1QQdvBv2GWbMe1Kv1x1igK1rYIZGVbtt1F9JT9pM-_K7S6vbwgBMs4i8PtAqA12M9dYuw4b5LH0U05lL84SyxCFsHuLkey-zCQA2b_ML3ZPC_5SwqwqslrJoISWnnIn-KeB5zk0XyKkzbUlnczSdNb4-QJF1MzBVvQrPcDEmMzXC2rXSAU-1rJMr5jzPAD5l7SjYGNIAjDTrbIewXV6RknylM4Q", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "dmdNbVcxWmJMU3RoOWFGQ0tRWmNPNGxDS3Bzbm5DYUltOTFYLVQzNkhvdw", "crv": "P-256", "x": "tS-6882jiGznp-6ldGM8sBi3M5LWOcTcGLelImEJ6yw", "y": "2uAg-TqCGK_E97lcOcCPTuSvSXQRzsv45plCIteBh6U"}]} from https://oidc.unimi.it/OIDC/jwks.json
2023-10-13 16:40:18,167 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'prompt': 'consent'}
2023-10-13 16:40:18,167 oidcrp.rp_handler DEBUG Do client registration
2023-10-13 16:40:18,167 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-13 16:40:18,168 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-13 16:40:18,168 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'Tzf4jMBhaQlhCS8tjO0HY5MC', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'JMOi8lTdSsAQR6IvjXxVv33NBeVvB45Z'}
2023-10-13 16:40:18,169 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'Tzf4jMBhaQlhCS8tjO0HY5MC', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'JMOi8lTdSsAQR6IvjXxVv33NBeVvB45Z', 'code_challenge': 'XYGZAyIGeMqXm_UHtwRXMfiEQXAzk7v4AiSYhk5mBxk', 'code_challenge_method': 'S256', 'client_id': 'provadiinserimento', 'prompt': 'consent'}
2023-10-13 16:40:18,170 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f16f1b0f950>, 'url': 'https://oidc.unimi.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=Tzf4jMBhaQlhCS8tjO0HY5MC&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=JMOi8lTdSsAQR6IvjXxVv33NBeVvB45Z&code_challenge=XYGZAyIGeMqXm_UHtwRXMfiEQXAzk7v4AiSYhk5mBxk&code_challenge_method=S256&client_id=provadiinserimento&prompt=consent'}
2023-10-13 16:40:18,171 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:40:18] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-13 16:40:53,102 root DEBUG Configured logging using dictionary
2023-10-13 16:40:53,141 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-13 16:40:53,141 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-13 16:40:53,142 werkzeug INFO  * Restarting with stat
2023-10-13 16:40:53,321 root DEBUG Configured logging using dictionary
2023-10-13 16:40:53,358 werkzeug WARNING  * Debugger is active!
2023-10-13 16:40:53,358 werkzeug INFO  * Debugger PIN: 221-170-319
2023-10-13 16:41:03,342 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:41:03] "GET / HTTP/1.1" 200 -
2023-10-13 16:41:06,395 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-13 16:41:06,395 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-13 16:41:06,395 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-13 16:41:06,395 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-13 16:41:06,434 oidcrp.rp_handler DEBUG Get provider info
2023-10-13 16:41:06,434 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-13 16:41:06,434 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://sso.isprambiente.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-13 16:41:06,434 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-13 16:41:06,436 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 16:41:06,674 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-13 16:41:06,675 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:41:06,676 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:41:06,676 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 14:41:06 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdABodSoaaxIZnJsmBhTDg0jIZyTCQzefsh6XbVVFUk3Aop_bNtJQFfBq_HRJi4kl9WGIbE-KDMNl9uJlzcwsIPTwJ9hVXPuoG67CyDceBHid1jrOjqpmlvyP99eKWivvMzE2Dk53zpqMI5Q1J29ZnCiMwwZkbc-iGVYHAB70fuFsvb4VTkiJMklyM05SaTTZtzEGH_R3KrqVGeHC3q4yXF2Wk-wVcoFFEFHqSk-ewYbsHWAvn9wg8jgAATZ8R-NLRtrwAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdABodSoaaxIZnJsmBhTDg0jIZyTCQzefsh6XbVVFUk3Aop_bNtJQFfBq_HRJi4kl9WGIbE-KDMNl9uJlzcwsIPTwJ9hVXPuoG67CyDceBHid1jrOjqpmlvyP99eKWivvMzE2Dk53zpqMI5Q1J29ZnCiMwwZkbc-iGVYHAB70fuFsvb4VTkiJMklyM05SaTTZtzEGH_R3KrqVGeHC3q4yXF2Wk-wVcoFFEFHqSk-ewYbsHWAvn9wg8jgAATZ8R-NLRtrwAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 16:41:06,676 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://sso.isprambiente.it", "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection"}
2023-10-13 16:41:06,676 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://sso.isprambiente.it", "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection"}
2023-10-13 16:41:06,676 oidcrp.service DEBUG response format: json
2023-10-13 16:41:06,676 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-13 16:41:06,677 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['implicit', 'authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://sso.isprambiente.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://sso.isprambiente.it', 'authorization_endpoint': 'https://sso.isprambiente.it/OIDC/authorization', 'token_endpoint': 'https://sso.isprambiente.it/OIDC/token', 'userinfo_endpoint': 'https://sso.isprambiente.it/OIDC/userinfo', 'introspection_endpoint': 'https://sso.isprambiente.it/OIDC/introspection'}"
2023-10-13 16:41:06,677 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'provadiinserimento'}
2023-10-13 16:41:06,679 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://sso.isprambiente.it
2023-10-13 16:41:06,679 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-13 16:41:06,680 cryptojwt.key_bundle INFO Reading remote JWKS from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 16:41:06,680 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 16:41:06,682 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 16:41:06,871 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-13 16:41:06,872 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ", "e": "AQAB", "n": "pVKjViCs2AlQinRtT-ZM8B6o8pXv8fzFu_uGMzU5g6nvjCq1gk_L8s0d88i9hOGkout0oQjJwIURuiE_2MKYlp3z4LB4o_yIboabnPHOvtsE2qXCFWlyLXlX1kEUmh9RElXbd0DfUmMhGqTcf5Y9Y3micd0E3NzgJdyN54BRSkYX7AMKPC23UgqYHMuj38vHqjO-aNPrdwvBBYbrRVXhHxG7uvjF_qm1prhm531zvDGjdf0MeVJS0WXZc92x2kexxs6JW_TaScXXvwQ8nlM9iqhNRGHdxWZvsyXSoV2SwpO8ybf8aWtjCJqUPofRdPRALSeRd9yaqF9GbTtOL6SdlQ"}, {"kty": "EC", "use": "sig", "kid": "ZksweGVJOGdMWW5uRXJ4Wkt4SS1PdkI0ZjNLblA4YzBVUmpmQ0xueVlRdw", "crv": "P-256", "x": "rv78hjpK-fPmcFquwNU3uqCq67yzS4Xyl0Kp7nzWy90", "y": "Rtd2le_0kUu381rMvWiiLjB29jVBODc9dd2w6BdlloI"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 16:41:06,872 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ", "e": "AQAB", "n": "pVKjViCs2AlQinRtT-ZM8B6o8pXv8fzFu_uGMzU5g6nvjCq1gk_L8s0d88i9hOGkout0oQjJwIURuiE_2MKYlp3z4LB4o_yIboabnPHOvtsE2qXCFWlyLXlX1kEUmh9RElXbd0DfUmMhGqTcf5Y9Y3micd0E3NzgJdyN54BRSkYX7AMKPC23UgqYHMuj38vHqjO-aNPrdwvBBYbrRVXhHxG7uvjF_qm1prhm531zvDGjdf0MeVJS0WXZc92x2kexxs6JW_TaScXXvwQ8nlM9iqhNRGHdxWZvsyXSoV2SwpO8ybf8aWtjCJqUPofRdPRALSeRd9yaqF9GbTtOL6SdlQ"}, {"kty": "EC", "use": "sig", "kid": "ZksweGVJOGdMWW5uRXJ4Wkt4SS1PdkI0ZjNLblA4YzBVUmpmQ0xueVlRdw", "crv": "P-256", "x": "rv78hjpK-fPmcFquwNU3uqCq67yzS4Xyl0Kp7nzWy90", "y": "Rtd2le_0kUu381rMvWiiLjB29jVBODc9dd2w6BdlloI"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 16:41:06,875 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'prompt': 'consent'}
2023-10-13 16:41:06,875 oidcrp.rp_handler DEBUG Do client registration
2023-10-13 16:41:06,875 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-13 16:41:06,875 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-13 16:41:06,876 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'YI0iDZWlUsCXJov1x8bJSSUq', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'boHTBljoGjfUwpJ0JW658cArd7UDtE4m'}
2023-10-13 16:41:06,877 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'YI0iDZWlUsCXJov1x8bJSSUq', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'boHTBljoGjfUwpJ0JW658cArd7UDtE4m', 'code_challenge': 'nESen9Mb04e8lM2jG-X86Lk4QM2xrKXAOFw8vYL-Ols', 'code_challenge_method': 'S256', 'client_id': 'provadiinserimento', 'prompt': 'consent'}
2023-10-13 16:41:06,877 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f52b28e2510>, 'url': 'https://sso.isprambiente.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=YI0iDZWlUsCXJov1x8bJSSUq&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=boHTBljoGjfUwpJ0JW658cArd7UDtE4m&code_challenge=nESen9Mb04e8lM2jG-X86Lk4QM2xrKXAOFw8vYL-Ols&code_challenge_method=S256&client_id=provadiinserimento&prompt=consent'}
2023-10-13 16:41:06,878 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:41:06] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-13 16:41:27,232 flask_rp.views DEBUG Issuer: https://sso.isprambiente.it
2023-10-13 16:41:27,232 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-13 16:41:27,232 oidcrp.service DEBUG response format: dict
2023-10-13 16:41:27,233 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-13 16:41:27,233 oidcrp.service DEBUG Initial response parsing => "{'state': 'boHTBljoGjfUwpJ0JW658cArd7UDtE4m', 'scope': 'openid profile offline_access', 'code': 'Z0FBQUFBQmxLVmNYLXZZOGtvUWVNTGhhLTNkMUk1SjJtcXNDeGlaQnNOME1lMGJ3RkZ5WDVUSUxhbkQtTjRKWGVpVEYxSVk3bVA0bzdsRk0ySTVHQ3ZVMUh4cXZPUG4xdGcwb1NFUnlMUGFJd3I1ZjVBWXpDZm1YRUNUMlJxcWtMZF9pUzM0MnQzdVF4QzNyUzFVNTJETzdveUIwYjk3cWdFUHZqTnNwWVIteGZJQ3FhbUoxSU1UaEhkTXRKQllkVVVkS2lIVXVxbXlnYm5kc2pkUUl2YkdXaGpTeEZvdk5DeVpKMFRzTTFTWkZjTUhBX2JkQV94RkZwMV8zRjFZcnVYalc2LU94ZW1oSHc1RTVyYkV2RENueFFrYmRnWDhlVlZ5UnV2TjVCSV9tbVJHOTl4dU1yNExWNjQwb25JWnZ2TXVldU5USEw2dUtCUk9SOFluV0VZWkZXdWJOTmxvOWRLNkJyd0E4cG56WWFIckZZQTl1VlpfUEw5empJR2VuWXJ5QXNMSnRSdWtxTnFhX1RrWkZmaGNrdU5scWhFeDduUlpQUnBkbzZRYXRyTXhtU0haOEpSLWY1dlFGODdaN2lIOUllQUswbm90NE14LVJKV25oQUJRcjkzSFRpSWpoVDk3d3RKZi1LM0IyeFJNU0dzRW5EWldyb090Q0NKRlc0VktLbkZvM3p1VXVyZC13WmMzR2hCYXFZazVQbmlSampZNFc0VlVEUm5Eb0JmWkNkWUFvaE5IbTJXYWZpVEZwQmlCYUQtX2o3enVHOFpIV1B0ZVFTLTBUaFhtNndxSkE4dmtHblpqYy1uT3VrbUd0ejV6c2liMmU5Z3JSbmVHVXRQeS1lZUFXLS01Q2xaSlBhem9EbU81Z3BDcnZ1eDJremJzczBmNFFjbWdYMzdtTnR5dEtxUG89', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}"
2023-10-13 16:41:27,233 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15, 'client_id': 'provadiinserimento'}
2023-10-13 16:41:27,233 oidcrp.rp_handler DEBUG Authz response: {'state': 'boHTBljoGjfUwpJ0JW658cArd7UDtE4m', 'scope': 'openid profile offline_access', 'code': 'Z0FBQUFBQmxLVmNYLXZZOGtvUWVNTGhhLTNkMUk1SjJtcXNDeGlaQnNOME1lMGJ3RkZ5WDVUSUxhbkQtTjRKWGVpVEYxSVk3bVA0bzdsRk0ySTVHQ3ZVMUh4cXZPUG4xdGcwb1NFUnlMUGFJd3I1ZjVBWXpDZm1YRUNUMlJxcWtMZF9pUzM0MnQzdVF4QzNyUzFVNTJETzdveUIwYjk3cWdFUHZqTnNwWVIteGZJQ3FhbUoxSU1UaEhkTXRKQllkVVVkS2lIVXVxbXlnYm5kc2pkUUl2YkdXaGpTeEZvdk5DeVpKMFRzTTFTWkZjTUhBX2JkQV94RkZwMV8zRjFZcnVYalc2LU94ZW1oSHc1RTVyYkV2RENueFFrYmRnWDhlVlZ5UnV2TjVCSV9tbVJHOTl4dU1yNExWNjQwb25JWnZ2TXVldU5USEw2dUtCUk9SOFluV0VZWkZXdWJOTmxvOWRLNkJyd0E4cG56WWFIckZZQTl1VlpfUEw5empJR2VuWXJ5QXNMSnRSdWtxTnFhX1RrWkZmaGNrdU5scWhFeDduUlpQUnBkbzZRYXRyTXhtU0haOEpSLWY1dlFGODdaN2lIOUllQUswbm90NE14LVJKV25oQUJRcjkzSFRpSWpoVDk3d3RKZi1LM0IyeFJNU0dzRW5EWldyb090Q0NKRlc0VktLbkZvM3p1VXVyZC13WmMzR2hCYXFZazVQbmlSampZNFc0VlVEUm5Eb0JmWkNkWUFvaE5IbTJXYWZpVEZwQmlCYUQtX2o3enVHOFpIV1B0ZVFTLTBUaFhtNndxSkE4dmtHblpqYy1uT3VrbUd0ejV6c2liMmU5Z3JSbmVHVXRQeS1lZUFXLS01Q2xaSlBhem9EbU81Z3BDcnZ1eDJremJzczBmNFFjbWdYMzdtTnR5dEtxUG89', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}
2023-10-13 16:41:27,234 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-13 16:41:27,234 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-13 16:41:27,234 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxLVmNYLXZZOGtvUWVNTGhhLTNkMUk1SjJtcXNDeGlaQnNOME1lMGJ3RkZ5WDVUSUxhbkQtTjRKWGVpVEYxSVk3bVA0bzdsRk0ySTVHQ3ZVMUh4cXZPUG4xdGcwb1NFUnlMUGFJd3I1ZjVBWXpDZm1YRUNUMlJxcWtMZF9pUzM0MnQzdVF4QzNyUzFVNTJETzdveUIwYjk3cWdFUHZqTnNwWVIteGZJQ3FhbUoxSU1UaEhkTXRKQllkVVVkS2lIVXVxbXlnYm5kc2pkUUl2YkdXaGpTeEZvdk5DeVpKMFRzTTFTWkZjTUhBX2JkQV94RkZwMV8zRjFZcnVYalc2LU94ZW1oSHc1RTVyYkV2RENueFFrYmRnWDhlVlZ5UnV2TjVCSV9tbVJHOTl4dU1yNExWNjQwb25JWnZ2TXVldU5USEw2dUtCUk9SOFluV0VZWkZXdWJOTmxvOWRLNkJyd0E4cG56WWFIckZZQTl1VlpfUEw5empJR2VuWXJ5QXNMSnRSdWtxTnFhX1RrWkZmaGNrdU5scWhFeDduUlpQUnBkbzZRYXRyTXhtU0haOEpSLWY1dlFGODdaN2lIOUllQUswbm90NE14LVJKV25oQUJRcjkzSFRpSWpoVDk3d3RKZi1LM0IyeFJNU0dzRW5EWldyb090Q0NKRlc0VktLbkZvM3p1VXVyZC13WmMzR2hCYXFZazVQbmlSampZNFc0VlVEUm5Eb0JmWkNkWUFvaE5IbTJXYWZpVEZwQmlCYUQtX2o3enVHOFpIV1B0ZVFTLTBUaFhtNndxSkE4dmtHblpqYy1uT3VrbUd0ejV6c2liMmU5Z3JSbmVHVXRQeS1lZUFXLS01Q2xaSlBhem9EbU81Z3BDcnZ1eDJremJzczBmNFFjbWdYMzdtTnR5dEtxUG89', 'state': 'boHTBljoGjfUwpJ0JW658cArd7UDtE4m', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'provadiinserimento', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-13 16:41:27,235 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'provadiinserimento', 'state': 'boHTBljoGjfUwpJ0JW658cArd7UDtE4m', 'code': 'Z0FBQUFBQmxLVmNYLXZZOGtvUWVNTGhhLTNkMUk1SjJtcXNDeGlaQnNOME1lMGJ3RkZ5WDVUSUxhbkQtTjRKWGVpVEYxSVk3bVA0bzdsRk0ySTVHQ3ZVMUh4cXZPUG4xdGcwb1NFUnlMUGFJd3I1ZjVBWXpDZm1YRUNUMlJxcWtMZF9pUzM0MnQzdVF4QzNyUzFVNTJETzdveUIwYjk3cWdFUHZqTnNwWVIteGZJQ3FhbUoxSU1UaEhkTXRKQllkVVVkS2lIVXVxbXlnYm5kc2pkUUl2YkdXaGpTeEZvdk5DeVpKMFRzTTFTWkZjTUhBX2JkQV94RkZwMV8zRjFZcnVYalc2LU94ZW1oSHc1RTVyYkV2RENueFFrYmRnWDhlVlZ5UnV2TjVCSV9tbVJHOTl4dU1yNExWNjQwb25JWnZ2TXVldU5USEw2dUtCUk9SOFluV0VZWkZXdWJOTmxvOWRLNkJyd0E4cG56WWFIckZZQTl1VlpfUEw5empJR2VuWXJ5QXNMSnRSdWtxTnFhX1RrWkZmaGNrdU5scWhFeDduUlpQUnBkbzZRYXRyTXhtU0haOEpSLWY1dlFGODdaN2lIOUllQUswbm90NE14LVJKV25oQUJRcjkzSFRpSWpoVDk3d3RKZi1LM0IyeFJNU0dzRW5EWldyb090Q0NKRlc0VktLbkZvM3p1VXVyZC13WmMzR2hCYXFZazVQbmlSampZNFc0VlVEUm5Eb0JmWkNkWUFvaE5IbTJXYWZpVEZwQmlCYUQtX2o3enVHOFpIV1B0ZVFTLTBUaFhtNndxSkE4dmtHblpqYy1uT3VrbUd0ejV6c2liMmU5Z3JSbmVHVXRQeS1lZUFXLS01Q2xaSlBhem9EbU81Z3BDcnZ1eDJremJzczBmNFFjbWdYMzdtTnR5dEtxUG89', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'nvEYCNmWB2qm7P0Oal0xv8VwL0qN5yrFQfVFTOaK0P8TL77nqEGaHGs6on2SFSRD'}
2023-10-13 16:41:27,235 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-13 16:41:27,235 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f52b28fb010>, 'url': 'https://sso.isprambiente.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=boHTBljoGjfUwpJ0JW658cArd7UDtE4m&code=Z0FBQUFBQmxLVmNYLXZZOGtvUWVNTGhhLTNkMUk1SjJtcXNDeGlaQnNOME1lMGJ3RkZ5WDVUSUxhbkQtTjRKWGVpVEYxSVk3bVA0bzdsRk0ySTVHQ3ZVMUh4cXZPUG4xdGcwb1NFUnlMUGFJd3I1ZjVBWXpDZm1YRUNUMlJxcWtMZF9pUzM0MnQzdVF4QzNyUzFVNTJETzdveUIwYjk3cWdFUHZqTnNwWVIteGZJQ3FhbUoxSU1UaEhkTXRKQllkVVVkS2lIVXVxbXlnYm5kc2pkUUl2YkdXaGpTeEZvdk5DeVpKMFRzTTFTWkZjTUhBX2JkQV94RkZwMV8zRjFZcnVYalc2LU94ZW1oSHc1RTVyYkV2RENueFFrYmRnWDhlVlZ5UnV2TjVCSV9tbVJHOTl4dU1yNExWNjQwb25JWnZ2TXVldU5USEw2dUtCUk9SOFluV0VZWkZXdWJOTmxvOWRLNkJyd0E4cG56WWFIckZZQTl1VlpfUEw5empJR2VuWXJ5QXNMSnRSdWtxTnFhX1RrWkZmaGNrdU5scWhFeDduUlpQUnBkbzZRYXRyTXhtU0haOEpSLWY1dlFGODdaN2lIOUllQUswbm90NE14LVJKV25oQUJRcjkzSFRpSWpoVDk3d3RKZi1LM0IyeFJNU0dzRW5EWldyb090Q0NKRlc0VktLbkZvM3p1VXVyZC13WmMzR2hCYXFZazVQbmlSampZNFc0VlVEUm5Eb0JmWkNkWUFvaE5IbTJXYWZpVEZwQmlCYUQtX2o3enVHOFpIV1B0ZVFTLTBUaFhtNndxSkE4dmtHblpqYy1uT3VrbUd0ejV6c2liMmU5Z3JSbmVHVXRQeS1lZUFXLS01Q2xaSlBhem9EbU81Z3BDcnZ1eDJremJzczBmNFFjbWdYMzdtTnR5dEtxUG89&code_verifier=nvEYCNmWB2qm7P0Oal0xv8VwL0qN5yrFQfVFTOaK0P8TL77nqEGaHGs6on2SFSRD', 'headers': {'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-13 16:41:27,236 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=boHTBljoGjfUwpJ0JW658cArd7UDtE4m&code=Z0FBQUFBQmxLVmNYLXZZOGtvUWVNTGhhLTNkMUk1SjJtcXNDeGlaQnNOME1lMGJ3RkZ5WDVUSUxhbkQtTjRKWGVpVEYxSVk3bVA0bzdsRk0ySTVHQ3ZVMUh4cXZPUG4xdGcwb1NFUnlMUGFJd3I1ZjVBWXpDZm1YRUNUMlJxcWtMZF9pUzM0MnQzdVF4QzNyUzFVNTJETzdveUIwYjk3cWdFUHZqTnNwWVIteGZJQ3FhbUoxSU1UaEhkTXRKQllkVVVkS2lIVXVxbXlnYm5kc2pkUUl2YkdXaGpTeEZvdk5DeVpKMFRzTTFTWkZjTUhBX2JkQV94RkZwMV8zRjFZcnVYalc2LU94ZW1oSHc1RTVyYkV2RENueFFrYmRnWDhlVlZ5UnV2TjVCSV9tbVJHOTl4dU1yNExWNjQwb25JWnZ2TXVldU5USEw2dUtCUk9SOFluV0VZWkZXdWJOTmxvOWRLNkJyd0E4cG56WWFIckZZQTl1VlpfUEw5empJR2VuWXJ5QXNMSnRSdWtxTnFhX1RrWkZmaGNrdU5scWhFeDduUlpQUnBkbzZRYXRyTXhtU0haOEpSLWY1dlFGODdaN2lIOUllQUswbm90NE14LVJKV25oQUJRcjkzSFRpSWpoVDk3d3RKZi1LM0IyeFJNU0dzRW5EWldyb090Q0NKRlc0VktLbkZvM3p1VXVyZC13WmMzR2hCYXFZazVQbmlSampZNFc0VlVEUm5Eb0JmWkNkWUFvaE5IbTJXYWZpVEZwQmlCYUQtX2o3enVHOFpIV1B0ZVFTLTBUaFhtNndxSkE4dmtHblpqYy1uT3VrbUd0ejV6c2liMmU5Z3JSbmVHVXRQeS1lZUFXLS01Q2xaSlBhem9EbU81Z3BDcnZ1eDJremJzczBmNFFjbWdYMzdtTnR5dEtxUG89&code_verifier=nvEYCNmWB2qm7P0Oal0xv8VwL0qN5yrFQfVFTOaK0P8TL77nqEGaHGs6on2SFSRD, https_args:{'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-13 16:41:27,237 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 16:41:27,855 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-13 16:41:27,857 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:41:27,857 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:41:27,857 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 14:41:27 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddACiVC6BhxAla9Onutvio8zanyDFY-vNlTiuuIfLreVZrt-lpHgV6Gf0RDf0KEKKBSj04JKA_mhPjaRlhLaWZQ8fOwOLfCo7aIzNa1y0qenfo_B_ME-xUldDnGbsavalGhZ_uDqdZzFYXgUU1m7C210s7aHZe5AJnI7W91oXhTkOyBQt-QDJbQns4g3DRf_nPNCu0d-cOm1d4W014BRuWpyK8d0im6gY2FkriB0bGH9t5AW4SKTrs9AAA6-s9sU7riMwAAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddACiVC6BhxAla9Onutvio8zanyDFY-vNlTiuuIfLreVZrt-lpHgV6Gf0RDf0KEKKBSj04JKA_mhPjaRlhLaWZQ8fOwOLfCo7aIzNa1y0qenfo_B_ME-xUldDnGbsavalGhZ_uDqdZzFYXgUU1m7C210s7aHZe5AJnI7W91oXhTkOyBQt-QDJbQns4g3DRf_nPNCu0d-cOm1d4W014BRuWpyK8d0im6gY2FkriB0bGH9t5AW4SKTrs9AAA6-s9sU7riMwAAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 16:41:27,857 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjQ1YjQzZmJiODliOTRlYzJhM2I2NjM0OTdiNmU3ZmM5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtTlliVE5NYnpScmNVaHhRMjlLTlRaNE5VRnFaSEV3ZW5OdlpsRjFOVVIzY2paUWN6VTBWRkJsT1hkMFdYWXpWVjl3ZEdFd01IQlpTVzFvTld4d09HVmtlbnBPZW0xZmRUVlhlakI2TjFSUFJFaG5XRTlyZW5WRWNHRkhOMWhqWmtSVFZXNXpWblF6YWkxWlpWVnhTMEZoWVdGQ1UyMVphMlZKY1ZFdGIwTjJabkUzYVU1eWNtb3pOM28xVFdSbWFIQnVaa05EVFdFemVtWlRUamd6UzBkMFFVRXRMVUZyYlZKd2MzcGlUVFI1VFdSTk4wSjJUMEZHTTJWeVVuYzNTM1oyUjNCcWRYcFFkblpNVldwTWFHRkNaMlZmVVRBNFZ6VlJTRGs0VTI1WVRWUjBNRWswVW5oSGVVeFNjMEZPZDB4QmJtNVJVbEpGYzJzeGVYZHRSbWROUVE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MDg3LCAiZXhwIjogMTY5NzIxMTY4N30.0hdfugP3XlJhsRqfCkkg2ghIviu8sHuPNXu334klJuwkHAWNxI1xQHWX3QZ2lw5mSaTLUAhoGt9b3WYTs3rE8w", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLVmNYc25felhiaVU0YzRBMXJZVUxKd09XbDRTY2ozYU92QjRWN1VsN3FYWVZQYmM2SGlrSGk5b19rSndGa2NiX20zWHgxUzkyanpzRTVvRDhzZmQta2NnbUhLYUNhUlBDZEJUZEtRcHVvc1hQandrNThVM1hrMHlGeWhnaTN4ZVYzRl9ZYTFncl9KZ3o1QTg1eUFqZE9PS3Vmekdqb1c1Z1VOUE1HcEIyZEc4V0VZd1ltejlrWEJfT1V5cDNmYjRsQnFJc1lVYWpaTHAybUZ5UVViTjNRY0k2MDJlZklYX3dJRjRzV1Q2UjlqZno5SFhWVDVsRVNpdGpXaXJ5Y09WRzQ2U3I3S1VCN0FfaGlRcXpXRG5GaTY4RWcxUXVNem1RUmMzSEVocTVVMXpUTXYza3BjV0FRZk0wcVdCTVpHVjgxT2diWHZqTENxV2gxa1VjZWVZdUpKVk5wMy1MZF9UUEE4RE9GNjlMNlBESFJpVVVveFhRTWcxcFpNdEFEUGxoOVFDaG9TcDBNZWYxalRXeWMtejJIT25JYllHTHRMbnZhTC1UanhJa0l5cTdnV2RoQmVpb3A1OFJ0M1NSRTgzaktLMlJOWHhsT3lCU3JCUlBrcEZKamxuTWJHaTZUc0NudmNDSDZsWmN2cllmNGRBcDZ4NmRoWFB1ZDBGM0VLTkxlTkdyRnNiZ0haTDNULUQ4ek5fRWZOTy1DLWZ6STRfR2VRY1R0V0dyYVJXN3pRNmdiMVVtdDlKbWI5NllFUE91N2dZVWNQTHRLMTY0czhSS3Y2WEhGNkREZE1RWkVZSWRoN0RwMVFNQlVfRjR4UDhCSEwzVGthN3Fwdl81RFMzc3hrMF9YUlNfWlo4VmFaM05HUnZfNWFtaFVBUl9YRjVvczlBN0s1NUhWQndrYlk9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik0wVnNjazE0UkdOQ1MyeHpTSFJGVGpoUWVIVkJVbkZFYWxabVZEaDViblZQVDFaTVZYSjVjMnMzU1EifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVm1OWWJUTk1ielJyY1VoeFEyOUtOVFo0TlVGcVpIRXdlbk52WmxGMU5VUjNjalpRY3pVMFZGQmxPWGQwV1hZelZWOXdkR0V3TUhCWlNXMW9OV3h3T0dWa2VucE9lbTFmZFRWWGVqQjZOMVJQUkVobldFOXJlblZFY0dGSE4xaGpaa1JUVlc1elZuUXphaTFaWlZWeFMwRmhZV0ZDVTIxWmEyVkpjVkV0YjBOMlpuRTNhVTV5Y21vek4zbzFUV1JtYUhCdVprTkRUV0V6ZW1aVFRqZ3pTMGQwUVVFdExVRnJiVkp3YzNwaVRUUjVUV1JOTjBKMlQwRkdNMlZ5VW5jM1MzWjJSM0JxZFhwUWRuWk1WV3BNYUdGQ1oyVmZVVEE0VnpWUlNEazRVMjVZVFZSME1FazBVbmhIZVV4U2MwRk9kMHhCYm01UlVsSkZjMnN4ZVhkdFJtZE5RUT09IiwgImF1dGhfdGltZSI6IDE2OTcyMDgwODcsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogIjk3NjJjNTY4NjlkNjExZWViZGZkMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAiWUkwaURaV2xVc0NYSm92MXg4YkpTU1VxIiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIwODA4NywgImV4cCI6IDE2OTcyMDgzODcsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.cgJwIc6Oi9ZAzy4zxLva7HotmjdYBGhFIizmCigw55boXv427iwiI5Ta51D3YFDe4wqFQn5DILbx8Jzjv4Jj_HCrRt2q6Dtv6LswKrQzYDBzGDbQivdZFsbnlJl_fkMocpOaEuSmP2MiLdR1m1XHjiqUXuFm3vQz8BWIT_RyOaNEpfyu9Ol5elm1hlpzemMJ0Pi5enTgSFkD5bqZZqHAUyWM7fw0g5NoDTVyachT7gMN3EuZV3Pip7ce15PoshfhzpjyVEkZVfyV5FW6Z0rl0gxOWbS14E0WUkaqXCh9rhHdsDyxMTDeUwcX5stwt74SyCxGyjRy-ccxeyAj6DsBUQ"}
2023-10-13 16:41:27,858 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjQ1YjQzZmJiODliOTRlYzJhM2I2NjM0OTdiNmU3ZmM5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtTlliVE5NYnpScmNVaHhRMjlLTlRaNE5VRnFaSEV3ZW5OdlpsRjFOVVIzY2paUWN6VTBWRkJsT1hkMFdYWXpWVjl3ZEdFd01IQlpTVzFvTld4d09HVmtlbnBPZW0xZmRUVlhlakI2TjFSUFJFaG5XRTlyZW5WRWNHRkhOMWhqWmtSVFZXNXpWblF6YWkxWlpWVnhTMEZoWVdGQ1UyMVphMlZKY1ZFdGIwTjJabkUzYVU1eWNtb3pOM28xVFdSbWFIQnVaa05EVFdFemVtWlRUamd6UzBkMFFVRXRMVUZyYlZKd2MzcGlUVFI1VFdSTk4wSjJUMEZHTTJWeVVuYzNTM1oyUjNCcWRYcFFkblpNVldwTWFHRkNaMlZmVVRBNFZ6VlJTRGs0VTI1WVRWUjBNRWswVW5oSGVVeFNjMEZPZDB4QmJtNVJVbEpGYzJzeGVYZHRSbWROUVE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MDg3LCAiZXhwIjogMTY5NzIxMTY4N30.0hdfugP3XlJhsRqfCkkg2ghIviu8sHuPNXu334klJuwkHAWNxI1xQHWX3QZ2lw5mSaTLUAhoGt9b3WYTs3rE8w", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLVmNYc25felhiaVU0YzRBMXJZVUxKd09XbDRTY2ozYU92QjRWN1VsN3FYWVZQYmM2SGlrSGk5b19rSndGa2NiX20zWHgxUzkyanpzRTVvRDhzZmQta2NnbUhLYUNhUlBDZEJUZEtRcHVvc1hQandrNThVM1hrMHlGeWhnaTN4ZVYzRl9ZYTFncl9KZ3o1QTg1eUFqZE9PS3Vmekdqb1c1Z1VOUE1HcEIyZEc4V0VZd1ltejlrWEJfT1V5cDNmYjRsQnFJc1lVYWpaTHAybUZ5UVViTjNRY0k2MDJlZklYX3dJRjRzV1Q2UjlqZno5SFhWVDVsRVNpdGpXaXJ5Y09WRzQ2U3I3S1VCN0FfaGlRcXpXRG5GaTY4RWcxUXVNem1RUmMzSEVocTVVMXpUTXYza3BjV0FRZk0wcVdCTVpHVjgxT2diWHZqTENxV2gxa1VjZWVZdUpKVk5wMy1MZF9UUEE4RE9GNjlMNlBESFJpVVVveFhRTWcxcFpNdEFEUGxoOVFDaG9TcDBNZWYxalRXeWMtejJIT25JYllHTHRMbnZhTC1UanhJa0l5cTdnV2RoQmVpb3A1OFJ0M1NSRTgzaktLMlJOWHhsT3lCU3JCUlBrcEZKamxuTWJHaTZUc0NudmNDSDZsWmN2cllmNGRBcDZ4NmRoWFB1ZDBGM0VLTkxlTkdyRnNiZ0haTDNULUQ4ek5fRWZOTy1DLWZ6STRfR2VRY1R0V0dyYVJXN3pRNmdiMVVtdDlKbWI5NllFUE91N2dZVWNQTHRLMTY0czhSS3Y2WEhGNkREZE1RWkVZSWRoN0RwMVFNQlVfRjR4UDhCSEwzVGthN3Fwdl81RFMzc3hrMF9YUlNfWlo4VmFaM05HUnZfNWFtaFVBUl9YRjVvczlBN0s1NUhWQndrYlk9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik0wVnNjazE0UkdOQ1MyeHpTSFJGVGpoUWVIVkJVbkZFYWxabVZEaDViblZQVDFaTVZYSjVjMnMzU1EifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVm1OWWJUTk1ielJyY1VoeFEyOUtOVFo0TlVGcVpIRXdlbk52WmxGMU5VUjNjalpRY3pVMFZGQmxPWGQwV1hZelZWOXdkR0V3TUhCWlNXMW9OV3h3T0dWa2VucE9lbTFmZFRWWGVqQjZOMVJQUkVobldFOXJlblZFY0dGSE4xaGpaa1JUVlc1elZuUXphaTFaWlZWeFMwRmhZV0ZDVTIxWmEyVkpjVkV0YjBOMlpuRTNhVTV5Y21vek4zbzFUV1JtYUhCdVprTkRUV0V6ZW1aVFRqZ3pTMGQwUVVFdExVRnJiVkp3YzNwaVRUUjVUV1JOTjBKMlQwRkdNMlZ5VW5jM1MzWjJSM0JxZFhwUWRuWk1WV3BNYUdGQ1oyVmZVVEE0VnpWUlNEazRVMjVZVFZSME1FazBVbmhIZVV4U2MwRk9kMHhCYm01UlVsSkZjMnN4ZVhkdFJtZE5RUT09IiwgImF1dGhfdGltZSI6IDE2OTcyMDgwODcsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogIjk3NjJjNTY4NjlkNjExZWViZGZkMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAiWUkwaURaV2xVc0NYSm92MXg4YkpTU1VxIiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIwODA4NywgImV4cCI6IDE2OTcyMDgzODcsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.cgJwIc6Oi9ZAzy4zxLva7HotmjdYBGhFIizmCigw55boXv427iwiI5Ta51D3YFDe4wqFQn5DILbx8Jzjv4Jj_HCrRt2q6Dtv6LswKrQzYDBzGDbQivdZFsbnlJl_fkMocpOaEuSmP2MiLdR1m1XHjiqUXuFm3vQz8BWIT_RyOaNEpfyu9Ol5elm1hlpzemMJ0Pi5enTgSFkD5bqZZqHAUyWM7fw0g5NoDTVyachT7gMN3EuZV3Pip7ce15PoshfhzpjyVEkZVfyV5FW6Z0rl0gxOWbS14E0WUkaqXCh9rhHdsDyxMTDeUwcX5stwt74SyCxGyjRy-ccxeyAj6DsBUQ"}
2023-10-13 16:41:27,858 oidcrp.service DEBUG response format: json
2023-10-13 16:41:27,858 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-13 16:41:27,859 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjQ1YjQzZmJiODliOTRlYzJhM2I2NjM0OTdiNmU3ZmM5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtTlliVE5NYnpScmNVaHhRMjlLTlRaNE5VRnFaSEV3ZW5OdlpsRjFOVVIzY2paUWN6VTBWRkJsT1hkMFdYWXpWVjl3ZEdFd01IQlpTVzFvTld4d09HVmtlbnBPZW0xZmRUVlhlakI2TjFSUFJFaG5XRTlyZW5WRWNHRkhOMWhqWmtSVFZXNXpWblF6YWkxWlpWVnhTMEZoWVdGQ1UyMVphMlZKY1ZFdGIwTjJabkUzYVU1eWNtb3pOM28xVFdSbWFIQnVaa05EVFdFemVtWlRUamd6UzBkMFFVRXRMVUZyYlZKd2MzcGlUVFI1VFdSTk4wSjJUMEZHTTJWeVVuYzNTM1oyUjNCcWRYcFFkblpNVldwTWFHRkNaMlZmVVRBNFZ6VlJTRGs0VTI1WVRWUjBNRWswVW5oSGVVeFNjMEZPZDB4QmJtNVJVbEpGYzJzeGVYZHRSbWROUVE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MDg3LCAiZXhwIjogMTY5NzIxMTY4N30.0hdfugP3XlJhsRqfCkkg2ghIviu8sHuPNXu334klJuwkHAWNxI1xQHWX3QZ2lw5mSaTLUAhoGt9b3WYTs3rE8w', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxLVmNYc25felhiaVU0YzRBMXJZVUxKd09XbDRTY2ozYU92QjRWN1VsN3FYWVZQYmM2SGlrSGk5b19rSndGa2NiX20zWHgxUzkyanpzRTVvRDhzZmQta2NnbUhLYUNhUlBDZEJUZEtRcHVvc1hQandrNThVM1hrMHlGeWhnaTN4ZVYzRl9ZYTFncl9KZ3o1QTg1eUFqZE9PS3Vmekdqb1c1Z1VOUE1HcEIyZEc4V0VZd1ltejlrWEJfT1V5cDNmYjRsQnFJc1lVYWpaTHAybUZ5UVViTjNRY0k2MDJlZklYX3dJRjRzV1Q2UjlqZno5SFhWVDVsRVNpdGpXaXJ5Y09WRzQ2U3I3S1VCN0FfaGlRcXpXRG5GaTY4RWcxUXVNem1RUmMzSEVocTVVMXpUTXYza3BjV0FRZk0wcVdCTVpHVjgxT2diWHZqTENxV2gxa1VjZWVZdUpKVk5wMy1MZF9UUEE4RE9GNjlMNlBESFJpVVVveFhRTWcxcFpNdEFEUGxoOVFDaG9TcDBNZWYxalRXeWMtejJIT25JYllHTHRMbnZhTC1UanhJa0l5cTdnV2RoQmVpb3A1OFJ0M1NSRTgzaktLMlJOWHhsT3lCU3JCUlBrcEZKamxuTWJHaTZUc0NudmNDSDZsWmN2cllmNGRBcDZ4NmRoWFB1ZDBGM0VLTkxlTkdyRnNiZ0haTDNULUQ4ek5fRWZOTy1DLWZ6STRfR2VRY1R0V0dyYVJXN3pRNmdiMVVtdDlKbWI5NllFUE91N2dZVWNQTHRLMTY0czhSS3Y2WEhGNkREZE1RWkVZSWRoN0RwMVFNQlVfRjR4UDhCSEwzVGthN3Fwdl81RFMzc3hrMF9YUlNfWlo4VmFaM05HUnZfNWFtaFVBUl9YRjVvczlBN0s1NUhWQndrYlk9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Ik0wVnNjazE0UkdOQ1MyeHpTSFJGVGpoUWVIVkJVbkZFYWxabVZEaDViblZQVDFaTVZYSjVjMnMzU1EifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVm1OWWJUTk1ielJyY1VoeFEyOUtOVFo0TlVGcVpIRXdlbk52WmxGMU5VUjNjalpRY3pVMFZGQmxPWGQwV1hZelZWOXdkR0V3TUhCWlNXMW9OV3h3T0dWa2VucE9lbTFmZFRWWGVqQjZOMVJQUkVobldFOXJlblZFY0dGSE4xaGpaa1JUVlc1elZuUXphaTFaWlZWeFMwRmhZV0ZDVTIxWmEyVkpjVkV0YjBOMlpuRTNhVTV5Y21vek4zbzFUV1JtYUhCdVprTkRUV0V6ZW1aVFRqZ3pTMGQwUVVFdExVRnJiVkp3YzNwaVRUUjVUV1JOTjBKMlQwRkdNMlZ5VW5jM1MzWjJSM0JxZFhwUWRuWk1WV3BNYUdGQ1oyVmZVVEE0VnpWUlNEazRVMjVZVFZSME1FazBVbmhIZVV4U2MwRk9kMHhCYm01UlVsSkZjMnN4ZVhkdFJtZE5RUT09IiwgImF1dGhfdGltZSI6IDE2OTcyMDgwODcsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogIjk3NjJjNTY4NjlkNjExZWViZGZkMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAiWUkwaURaV2xVc0NYSm92MXg4YkpTU1VxIiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIwODA4NywgImV4cCI6IDE2OTcyMDgzODcsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.cgJwIc6Oi9ZAzy4zxLva7HotmjdYBGhFIizmCigw55boXv427iwiI5Ta51D3YFDe4wqFQn5DILbx8Jzjv4Jj_HCrRt2q6Dtv6LswKrQzYDBzGDbQivdZFsbnlJl_fkMocpOaEuSmP2MiLdR1m1XHjiqUXuFm3vQz8BWIT_RyOaNEpfyu9Ol5elm1hlpzemMJ0Pi5enTgSFkD5bqZZqHAUyWM7fw0g5NoDTVyachT7gMN3EuZV3Pip7ce15PoshfhzpjyVEkZVfyV5FW6Z0rl0gxOWbS14E0WUkaqXCh9rhHdsDyxMTDeUwcX5stwt74SyCxGyjRy-ccxeyAj6DsBUQ'}"
2023-10-13 16:41:27,859 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15}
2023-10-13 16:41:27,860 oidcmsg.message DEBUG Raw JSON: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLVmNYbTNMbzRrcUhxQ29KNTZ4NUFqZHEwenNvZlF1NUR3cjZQczU0VFBlOXd0WXYzVV9wdGEwMHBZSW1oNWxwOGVkenpOem1fdTVXejB6N1RPREhnWE9renVEcGFHN1hjZkRTVW5zVnQzai1ZZVVxS0FhYWFCU21Za2VJcVEtb0N2ZnE3aU5ycmozN3o1TWRmaHBuZkNDTWEzemZTTjgzS0d0QUEtLUFrbVJwc3piTTR5TWRNN0J2T0FGM2VyUnc3S3Z2R3BqdXpQdnZMVWpMaGFCZ2VfUTA4VzVRSDk4U25YTVR0MEk0UnhHeUxSc0FOd0xBbm5RUlJFc2sxeXdtRmdNQQ==', 'auth_time': 1697208087, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '9762c56869d611eebdfd0242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': 'YI0iDZWlUsCXJov1x8bJSSUq', 'iss': 'https://sso.isprambiente.it', 'iat': 1697208087, 'exp': 1697208387, 'aud': ['provadiinserimento']}
2023-10-13 16:41:27,860 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ'}
2023-10-13 16:41:27,860 cryptojwt.key_jar DEBUG Key summary for https://sso.isprambiente.it: RSA:sig:M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ, EC:sig:ZksweGVJOGdMWW5uRXJ4Wkt4SS1PdkI0ZjNLblA4YzBVUmpmQ0xueVlRdw
2023-10-13 16:41:27,860 oidcmsg.message DEBUG Found signing key.
2023-10-13 16:41:27,860 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-13 16:41:27,860 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ and use=
2023-10-13 16:41:27,860 cryptojwt.jwx DEBUG Picked: kid:M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ, use:sig, kty:RSA
2023-10-13 16:41:27,861 cryptojwt.jws.jws DEBUG Verified message using key with kid=M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ
2023-10-13 16:41:27,861 oidcmsg.oidc INFO Verified id_token: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLVmNYbTNMbzRrcUhxQ29KNTZ4NUFqZHEwenNvZlF1NUR3cjZQczU0VFBlOXd0WXYzVV9wdGEwMHBZSW1oNWxwOGVkenpOem1fdTVXejB6N1RPREhnWE9renVEcGFHN1hjZkRTVW5zVnQzai1ZZVVxS0FhYWFCU21Za2VJcVEtb0N2ZnE3aU5ycmozN3o1TWRmaHBuZkNDTWEzemZTTjgzS0d0QUEtLUFrbVJwc3piTTR5TWRNN0J2T0FGM2VyUnc3S3Z2R3BqdXpQdnZMVWpMaGFCZ2VfUTA4VzVRSDk4U25YTVR0MEk0UnhHeUxSc0FOd0xBbm5RUlJFc2sxeXdtRmdNQQ==', 'auth_time': 1697208087, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '9762c56869d611eebdfd0242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': 'YI0iDZWlUsCXJov1x8bJSSUq', 'iss': 'https://sso.isprambiente.it', 'iat': 1697208087, 'exp': 1697208387, 'aud': ['provadiinserimento']}
2023-10-13 16:41:27,862 oidcrp.rp_handler DEBUG ID Token: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLVmNYbTNMbzRrcUhxQ29KNTZ4NUFqZHEwenNvZlF1NUR3cjZQczU0VFBlOXd0WXYzVV9wdGEwMHBZSW1oNWxwOGVkenpOem1fdTVXejB6N1RPREhnWE9renVEcGFHN1hjZkRTVW5zVnQzai1ZZVVxS0FhYWFCU21Za2VJcVEtb0N2ZnE3aU5ycmozN3o1TWRmaHBuZkNDTWEzemZTTjgzS0d0QUEtLUFrbVJwc3piTTR5TWRNN0J2T0FGM2VyUnc3S3Z2R3BqdXpQdnZMVWpMaGFCZ2VfUTA4VzVRSDk4U25YTVR0MEk0UnhHeUxSc0FOd0xBbm5RUlJFc2sxeXdtRmdNQQ==', 'auth_time': 1697208087, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '9762c56869d611eebdfd0242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': 'YI0iDZWlUsCXJov1x8bJSSUq', 'iss': 'https://sso.isprambiente.it', 'iat': 1697208087, 'exp': 1697208387, 'aud': ['provadiinserimento']}
2023-10-13 16:41:27,862 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-13 16:41:27,862 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjQ1YjQzZmJiODliOTRlYzJhM2I2NjM0OTdiNmU3ZmM5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtTlliVE5NYnpScmNVaHhRMjlLTlRaNE5VRnFaSEV3ZW5OdlpsRjFOVVIzY2paUWN6VTBWRkJsT1hkMFdYWXpWVjl3ZEdFd01IQlpTVzFvTld4d09HVmtlbnBPZW0xZmRUVlhlakI2TjFSUFJFaG5XRTlyZW5WRWNHRkhOMWhqWmtSVFZXNXpWblF6YWkxWlpWVnhTMEZoWVdGQ1UyMVphMlZKY1ZFdGIwTjJabkUzYVU1eWNtb3pOM28xVFdSbWFIQnVaa05EVFdFemVtWlRUamd6UzBkMFFVRXRMVUZyYlZKd2MzcGlUVFI1VFdSTk4wSjJUMEZHTTJWeVVuYzNTM1oyUjNCcWRYcFFkblpNVldwTWFHRkNaMlZmVVRBNFZ6VlJTRGs0VTI1WVRWUjBNRWswVW5oSGVVeFNjMEZPZDB4QmJtNVJVbEpGYzJzeGVYZHRSbWROUVE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MDg3LCAiZXhwIjogMTY5NzIxMTY4N30.0hdfugP3XlJhsRqfCkkg2ghIviu8sHuPNXu334klJuwkHAWNxI1xQHWX3QZ2lw5mSaTLUAhoGt9b3WYTs3rE8w'}
2023-10-13 16:41:27,862 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-13 16:41:27,862 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f52b3eded50>, 'url': 'https://sso.isprambiente.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjQ1YjQzZmJiODliOTRlYzJhM2I2NjM0OTdiNmU3ZmM5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtTlliVE5NYnpScmNVaHhRMjlLTlRaNE5VRnFaSEV3ZW5OdlpsRjFOVVIzY2paUWN6VTBWRkJsT1hkMFdYWXpWVjl3ZEdFd01IQlpTVzFvTld4d09HVmtlbnBPZW0xZmRUVlhlakI2TjFSUFJFaG5XRTlyZW5WRWNHRkhOMWhqWmtSVFZXNXpWblF6YWkxWlpWVnhTMEZoWVdGQ1UyMVphMlZKY1ZFdGIwTjJabkUzYVU1eWNtb3pOM28xVFdSbWFIQnVaa05EVFdFemVtWlRUamd6UzBkMFFVRXRMVUZyYlZKd2MzcGlUVFI1VFdSTk4wSjJUMEZHTTJWeVVuYzNTM1oyUjNCcWRYcFFkblpNVldwTWFHRkNaMlZmVVRBNFZ6VlJTRGs0VTI1WVRWUjBNRWswVW5oSGVVeFNjMEZPZDB4QmJtNVJVbEpGYzJzeGVYZHRSbWROUVE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MDg3LCAiZXhwIjogMTY5NzIxMTY4N30.0hdfugP3XlJhsRqfCkkg2ghIviu8sHuPNXu334klJuwkHAWNxI1xQHWX3QZ2lw5mSaTLUAhoGt9b3WYTs3rE8w'}}
2023-10-13 16:41:27,862 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjQ1YjQzZmJiODliOTRlYzJhM2I2NjM0OTdiNmU3ZmM5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtTlliVE5NYnpScmNVaHhRMjlLTlRaNE5VRnFaSEV3ZW5OdlpsRjFOVVIzY2paUWN6VTBWRkJsT1hkMFdYWXpWVjl3ZEdFd01IQlpTVzFvTld4d09HVmtlbnBPZW0xZmRUVlhlakI2TjFSUFJFaG5XRTlyZW5WRWNHRkhOMWhqWmtSVFZXNXpWblF6YWkxWlpWVnhTMEZoWVdGQ1UyMVphMlZKY1ZFdGIwTjJabkUzYVU1eWNtb3pOM28xVFdSbWFIQnVaa05EVFdFemVtWlRUamd6UzBkMFFVRXRMVUZyYlZKd2MzcGlUVFI1VFdSTk4wSjJUMEZHTTJWeVVuYzNTM1oyUjNCcWRYcFFkblpNVldwTWFHRkNaMlZmVVRBNFZ6VlJTRGs0VTI1WVRWUjBNRWswVW5oSGVVeFNjMEZPZDB4QmJtNVJVbEpGYzJzeGVYZHRSbWROUVE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MDg3LCAiZXhwIjogMTY5NzIxMTY4N30.0hdfugP3XlJhsRqfCkkg2ghIviu8sHuPNXu334klJuwkHAWNxI1xQHWX3QZ2lw5mSaTLUAhoGt9b3WYTs3rE8w'}
2023-10-13 16:41:27,862 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 16:41:28,483 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-13 16:41:28,485 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:41:28,485 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:41:28,485 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 14:41:28 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADiRR-NyXUg1FwmYR-n3kOhMAqVJYWx94PXdxt2Dnd06NAacVr4R-XEWcN_ZRyLHc1X_hUb9PSRu6prtzLWiZdfXQ6pdxJG70JdiJ93R9cKDSRg6hwgYM_dOff6P7NlvvLA2crmJsKhWkyxD_THo_ZW2J57qfI7impcLJGWx-iteCgRR2Tl0i4X4_C8WvZtrbb1tShO8Hr6wYOWXAZip6au6AhWnIVz03PNQAcJJTOXdpf4agCz-Vr1UAAAAAKcLipZqZxU4AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADiRR-NyXUg1FwmYR-n3kOhMAqVJYWx94PXdxt2Dnd06NAacVr4R-XEWcN_ZRyLHc1X_hUb9PSRu6prtzLWiZdfXQ6pdxJG70JdiJ93R9cKDSRg6hwgYM_dOff6P7NlvvLA2crmJsKhWkyxD_THo_ZW2J57qfI7impcLJGWx-iteCgRR2Tl0i4X4_C8WvZtrbb1tShO8Hr6wYOWXAZip6au6AhWnIVz03PNQAcJJTOXdpf4agCz-Vr1UAAAAAKcLipZqZxU4AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 16:41:28,485 oidcrp.util DEBUG resp.txt: {"sub": "5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619", "name": "ANDREA", "given_name": "ANDREA", "family_name": "RANALDI", "nickname": "RANALDI", "acr": "https://www.spid.gov.it/SpidL2"}
2023-10-13 16:41:28,485 oidcrp.oauth2 DEBUG Successful response: {"sub": "5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619", "name": "ANDREA", "given_name": "ANDREA", "family_name": "RANALDI", "nickname": "RANALDI", "acr": "https://www.spid.gov.it/SpidL2"}
2023-10-13 16:41:28,485 oidcrp.service DEBUG response format: json
2023-10-13 16:41:28,485 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-13 16:41:28,486 oidcrp.service DEBUG Initial response parsing => "{'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'name': 'ANDREA', 'given_name': 'ANDREA', 'family_name': 'RANALDI', 'nickname': 'RANALDI', 'acr': 'https://www.spid.gov.it/SpidL2'}"
2023-10-13 16:41:28,486 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15}
2023-10-13 16:41:28,488 oidcrp.rp_handler DEBUG UserInfo: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'name': 'ANDREA', 'given_name': 'ANDREA', 'family_name': 'RANALDI', 'nickname': 'RANALDI', 'acr': 'https://www.spid.gov.it/SpidL2'}
2023-10-13 16:41:28,497 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:41:28] "GET /authz_cb/satosa?state=boHTBljoGjfUwpJ0JW658cArd7UDtE4m&scope=openid+profile+offline_access&code=Z0FBQUFBQmxLVmNYLXZZOGtvUWVNTGhhLTNkMUk1SjJtcXNDeGlaQnNOME1lMGJ3RkZ5WDVUSUxhbkQtTjRKWGVpVEYxSVk3bVA0bzdsRk0ySTVHQ3ZVMUh4cXZPUG4xdGcwb1NFUnlMUGFJd3I1ZjVBWXpDZm1YRUNUMlJxcWtMZF9pUzM0MnQzdVF4QzNyUzFVNTJETzdveUIwYjk3cWdFUHZqTnNwWVIteGZJQ3FhbUoxSU1UaEhkTXRKQllkVVVkS2lIVXVxbXlnYm5kc2pkUUl2YkdXaGpTeEZvdk5DeVpKMFRzTTFTWkZjTUhBX2JkQV94RkZwMV8zRjFZcnVYalc2LU94ZW1oSHc1RTVyYkV2RENueFFrYmRnWDhlVlZ5UnV2TjVCSV9tbVJHOTl4dU1yNExWNjQwb25JWnZ2TXVldU5USEw2dUtCUk9SOFluV0VZWkZXdWJOTmxvOWRLNkJyd0E4cG56WWFIckZZQTl1VlpfUEw5empJR2VuWXJ5QXNMSnRSdWtxTnFhX1RrWkZmaGNrdU5scWhFeDduUlpQUnBkbzZRYXRyTXhtU0haOEpSLWY1dlFGODdaN2lIOUllQUswbm90NE14LVJKV25oQUJRcjkzSFRpSWpoVDk3d3RKZi1LM0IyeFJNU0dzRW5EWldyb090Q0NKRlc0VktLbkZvM3p1VXVyZC13WmMzR2hCYXFZazVQbmlSampZNFc0VlVEUm5Eb0JmWkNkWUFvaE5IbTJXYWZpVEZwQmlCYUQtX2o3enVHOFpIV1B0ZVFTLTBUaFhtNndxSkE4dmtHblpqYy1uT3VrbUd0ejV6c2liMmU5Z3JSbmVHVXRQeS1lZUFXLS01Q2xaSlBhem9EbU81Z3BDcnZ1eDJremJzczBmNFFjbWdYMzdtTnR5dEtxUG89&iss=https://sso.isprambiente.it&client_id=provadiinserimento HTTP/1.1" 200 -
2023-10-13 16:45:24,603 root DEBUG Configured logging using dictionary
2023-10-13 16:45:24,642 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-13 16:45:24,642 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-13 16:45:24,642 werkzeug INFO  * Restarting with stat
2023-10-13 16:45:24,822 root DEBUG Configured logging using dictionary
2023-10-13 16:45:24,859 werkzeug WARNING  * Debugger is active!
2023-10-13 16:45:24,859 werkzeug INFO  * Debugger PIN: 221-170-319
2023-10-13 16:45:36,478 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:45:36] "GET / HTTP/1.1" 200 -
2023-10-13 16:45:40,825 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-13 16:45:40,825 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-13 16:45:40,825 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-13 16:45:40,825 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-13 16:45:40,861 oidcrp.rp_handler DEBUG Get provider info
2023-10-13 16:45:40,861 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-13 16:45:40,861 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://sso.isprambiente.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-13 16:45:40,861 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-13 16:45:40,862 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 16:45:41,090 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-13 16:45:41,091 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:45:41,092 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:45:41,092 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 14:45:41 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdADkaRxmLd37UMv_vIdldDdZ8320bDey6g6Lt1MMFirJaE0pOsQoFotpn1_bdFr2weGc2JMt_sSithSHkAfrYwi7Lm3D_Qj8js7eXc6GwsgSXjONFYREZgF8Jpi-u71GTE3gLeey8f5c_f2ilEsQUtMAyTnQ7ZIjC7yjbpjqqT05rdYmwErYNafrWXd_tTpN_qa8PQlC6f81eO6n5DghFZ9NOBka8yuzDRWVRZN3QcUpwDnmmZ7RCKMMANIAxo8MDpbMAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdADkaRxmLd37UMv_vIdldDdZ8320bDey6g6Lt1MMFirJaE0pOsQoFotpn1_bdFr2weGc2JMt_sSithSHkAfrYwi7Lm3D_Qj8js7eXc6GwsgSXjONFYREZgF8Jpi-u71GTE3gLeey8f5c_f2ilEsQUtMAyTnQ7ZIjC7yjbpjqqT05rdYmwErYNafrWXd_tTpN_qa8PQlC6f81eO6n5DghFZ9NOBka8yuzDRWVRZN3QcUpwDnmmZ7RCKMMANIAxo8MDpbMAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 16:45:41,092 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://sso.isprambiente.it", "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection"}
2023-10-13 16:45:41,092 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://sso.isprambiente.it", "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection"}
2023-10-13 16:45:41,092 oidcrp.service DEBUG response format: json
2023-10-13 16:45:41,092 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-13 16:45:41,093 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['implicit', 'authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://sso.isprambiente.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://sso.isprambiente.it', 'authorization_endpoint': 'https://sso.isprambiente.it/OIDC/authorization', 'token_endpoint': 'https://sso.isprambiente.it/OIDC/token', 'userinfo_endpoint': 'https://sso.isprambiente.it/OIDC/userinfo', 'introspection_endpoint': 'https://sso.isprambiente.it/OIDC/introspection'}"
2023-10-13 16:45:41,093 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'provadiinserimento'}
2023-10-13 16:45:41,095 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://sso.isprambiente.it
2023-10-13 16:45:41,095 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-13 16:45:41,095 cryptojwt.key_bundle INFO Reading remote JWKS from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 16:45:41,096 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 16:45:41,097 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 16:45:41,286 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-13 16:45:41,287 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ", "e": "AQAB", "n": "pVKjViCs2AlQinRtT-ZM8B6o8pXv8fzFu_uGMzU5g6nvjCq1gk_L8s0d88i9hOGkout0oQjJwIURuiE_2MKYlp3z4LB4o_yIboabnPHOvtsE2qXCFWlyLXlX1kEUmh9RElXbd0DfUmMhGqTcf5Y9Y3micd0E3NzgJdyN54BRSkYX7AMKPC23UgqYHMuj38vHqjO-aNPrdwvBBYbrRVXhHxG7uvjF_qm1prhm531zvDGjdf0MeVJS0WXZc92x2kexxs6JW_TaScXXvwQ8nlM9iqhNRGHdxWZvsyXSoV2SwpO8ybf8aWtjCJqUPofRdPRALSeRd9yaqF9GbTtOL6SdlQ"}, {"kty": "EC", "use": "sig", "kid": "ZksweGVJOGdMWW5uRXJ4Wkt4SS1PdkI0ZjNLblA4YzBVUmpmQ0xueVlRdw", "crv": "P-256", "x": "rv78hjpK-fPmcFquwNU3uqCq67yzS4Xyl0Kp7nzWy90", "y": "Rtd2le_0kUu381rMvWiiLjB29jVBODc9dd2w6BdlloI"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 16:45:41,287 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ", "e": "AQAB", "n": "pVKjViCs2AlQinRtT-ZM8B6o8pXv8fzFu_uGMzU5g6nvjCq1gk_L8s0d88i9hOGkout0oQjJwIURuiE_2MKYlp3z4LB4o_yIboabnPHOvtsE2qXCFWlyLXlX1kEUmh9RElXbd0DfUmMhGqTcf5Y9Y3micd0E3NzgJdyN54BRSkYX7AMKPC23UgqYHMuj38vHqjO-aNPrdwvBBYbrRVXhHxG7uvjF_qm1prhm531zvDGjdf0MeVJS0WXZc92x2kexxs6JW_TaScXXvwQ8nlM9iqhNRGHdxWZvsyXSoV2SwpO8ybf8aWtjCJqUPofRdPRALSeRd9yaqF9GbTtOL6SdlQ"}, {"kty": "EC", "use": "sig", "kid": "ZksweGVJOGdMWW5uRXJ4Wkt4SS1PdkI0ZjNLblA4YzBVUmpmQ0xueVlRdw", "crv": "P-256", "x": "rv78hjpK-fPmcFquwNU3uqCq67yzS4Xyl0Kp7nzWy90", "y": "Rtd2le_0kUu381rMvWiiLjB29jVBODc9dd2w6BdlloI"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 16:45:41,289 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'prompt': 'consent'}
2023-10-13 16:45:41,290 oidcrp.rp_handler DEBUG Do client registration
2023-10-13 16:45:41,290 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-13 16:45:41,290 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-13 16:45:41,290 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'lGmWBWc5W9fwJ6270gROe2u0', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'tfvXDihUH3NpOwLUyZeaORKzE61TBxAY'}
2023-10-13 16:45:41,291 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'lGmWBWc5W9fwJ6270gROe2u0', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'tfvXDihUH3NpOwLUyZeaORKzE61TBxAY', 'code_challenge': 'OlcsR1X4HTHMFYNpOqvanRWbEEyzZrJj7xY0IXoYnh0', 'code_challenge_method': 'S256', 'client_id': 'provadiinserimento', 'prompt': 'consent'}
2023-10-13 16:45:41,292 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f97be2630d0>, 'url': 'https://sso.isprambiente.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=lGmWBWc5W9fwJ6270gROe2u0&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=tfvXDihUH3NpOwLUyZeaORKzE61TBxAY&code_challenge=OlcsR1X4HTHMFYNpOqvanRWbEEyzZrJj7xY0IXoYnh0&code_challenge_method=S256&client_id=provadiinserimento&prompt=consent'}
2023-10-13 16:45:41,293 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:45:41] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-13 16:46:06,141 flask_rp.views DEBUG Issuer: https://sso.isprambiente.it
2023-10-13 16:46:06,141 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-13 16:46:06,141 oidcrp.service DEBUG response format: dict
2023-10-13 16:46:06,141 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-13 16:46:06,141 oidcrp.service DEBUG Initial response parsing => "{'state': 'tfvXDihUH3NpOwLUyZeaORKzE61TBxAY', 'scope': 'openid profile offline_access', 'code': 'Z0FBQUFBQmxLVmd1enAtb3dlMTVkc1ZWX3cyQ3VvM3pLMHhmMTRSQ05zeGNnYlVQZEdQcVZYM1JJUTZXTTk2N0x5Sjd2Q1B5SFZxV0NpYmdDckZmTVdvTWpuSFlZYTlOTERLZVpKc0RYay1iWGdJbXNRSVhTUmhSLUFnRExaZE01eDliYm83dDFKajZCTUxSQ05WZWRqSUdBUHpCU01GNkozT0V6RnpUdXp5ekRMRXpWRC1PTFR6VVFMWVVPUlZ4amlZUFk5NWpocHdWRlpQSDViWmM2d01vTGVaY3Rtc1M4UUdhbUNaaGJkVl8tY3dYZDF5NnZpLUw4OExtblhoYm42WlFDRlJwbDhEcmpGLU4yR0JZd1lvQnd5RDVMUVJVM3JhUGV6SXYxRUVnWXdES0ZzWHBBQnRqMnVlZjl3LXBlcUJ2eFB5eEd4cmhZS3dNVjRkWWh3cUVDTFlEdnpCVDlkVHdwajgwMnJsc21idGU1d2ZpbjFHeEVQR2dnemVaeVJ5SnY0aUhOV05Banh2azl6VTQ2Tnpxc1k0b2dHNUpqM3JMVGZWY3JGbzQzWjNabHQtdld3X0FvYmw0UWZZbUdobjEyNWtleWlLcnNyM0tEWEJVLTlIODhfVzlyeWVEVDZKTnhRSzBMbXJwLVFsOFFOWllVYjlHbFN0bXlSLUh4MDEtWndRX0FKMURTeXVkMzdTeV9CUngxQVNPSjgwWHRSNlhlT3pfb3hzcDlMODEta2lHZ1JreTFrcE5SeXFCc2l6eFFNbzBuZTIxQ0FBWFdDdGMwVDJzZTkwUUkzUGhWQVp4VVlHczZmMGVrdy1Xd0J3UFJrTTZRTnlveW53V0lDNkQxcWdxX0o3MURENjg1NG5lcXhhZnlJRDlfUFd2cGR2V0tfWFhCZ2lSQ1c5YjV6TlBvelE9', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}"
2023-10-13 16:46:06,141 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15, 'client_id': 'provadiinserimento'}
2023-10-13 16:46:06,142 oidcrp.rp_handler DEBUG Authz response: {'state': 'tfvXDihUH3NpOwLUyZeaORKzE61TBxAY', 'scope': 'openid profile offline_access', 'code': 'Z0FBQUFBQmxLVmd1enAtb3dlMTVkc1ZWX3cyQ3VvM3pLMHhmMTRSQ05zeGNnYlVQZEdQcVZYM1JJUTZXTTk2N0x5Sjd2Q1B5SFZxV0NpYmdDckZmTVdvTWpuSFlZYTlOTERLZVpKc0RYay1iWGdJbXNRSVhTUmhSLUFnRExaZE01eDliYm83dDFKajZCTUxSQ05WZWRqSUdBUHpCU01GNkozT0V6RnpUdXp5ekRMRXpWRC1PTFR6VVFMWVVPUlZ4amlZUFk5NWpocHdWRlpQSDViWmM2d01vTGVaY3Rtc1M4UUdhbUNaaGJkVl8tY3dYZDF5NnZpLUw4OExtblhoYm42WlFDRlJwbDhEcmpGLU4yR0JZd1lvQnd5RDVMUVJVM3JhUGV6SXYxRUVnWXdES0ZzWHBBQnRqMnVlZjl3LXBlcUJ2eFB5eEd4cmhZS3dNVjRkWWh3cUVDTFlEdnpCVDlkVHdwajgwMnJsc21idGU1d2ZpbjFHeEVQR2dnemVaeVJ5SnY0aUhOV05Banh2azl6VTQ2Tnpxc1k0b2dHNUpqM3JMVGZWY3JGbzQzWjNabHQtdld3X0FvYmw0UWZZbUdobjEyNWtleWlLcnNyM0tEWEJVLTlIODhfVzlyeWVEVDZKTnhRSzBMbXJwLVFsOFFOWllVYjlHbFN0bXlSLUh4MDEtWndRX0FKMURTeXVkMzdTeV9CUngxQVNPSjgwWHRSNlhlT3pfb3hzcDlMODEta2lHZ1JreTFrcE5SeXFCc2l6eFFNbzBuZTIxQ0FBWFdDdGMwVDJzZTkwUUkzUGhWQVp4VVlHczZmMGVrdy1Xd0J3UFJrTTZRTnlveW53V0lDNkQxcWdxX0o3MURENjg1NG5lcXhhZnlJRDlfUFd2cGR2V0tfWFhCZ2lSQ1c5YjV6TlBvelE9', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}
2023-10-13 16:46:06,142 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-13 16:46:06,142 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-13 16:46:06,143 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxLVmd1enAtb3dlMTVkc1ZWX3cyQ3VvM3pLMHhmMTRSQ05zeGNnYlVQZEdQcVZYM1JJUTZXTTk2N0x5Sjd2Q1B5SFZxV0NpYmdDckZmTVdvTWpuSFlZYTlOTERLZVpKc0RYay1iWGdJbXNRSVhTUmhSLUFnRExaZE01eDliYm83dDFKajZCTUxSQ05WZWRqSUdBUHpCU01GNkozT0V6RnpUdXp5ekRMRXpWRC1PTFR6VVFMWVVPUlZ4amlZUFk5NWpocHdWRlpQSDViWmM2d01vTGVaY3Rtc1M4UUdhbUNaaGJkVl8tY3dYZDF5NnZpLUw4OExtblhoYm42WlFDRlJwbDhEcmpGLU4yR0JZd1lvQnd5RDVMUVJVM3JhUGV6SXYxRUVnWXdES0ZzWHBBQnRqMnVlZjl3LXBlcUJ2eFB5eEd4cmhZS3dNVjRkWWh3cUVDTFlEdnpCVDlkVHdwajgwMnJsc21idGU1d2ZpbjFHeEVQR2dnemVaeVJ5SnY0aUhOV05Banh2azl6VTQ2Tnpxc1k0b2dHNUpqM3JMVGZWY3JGbzQzWjNabHQtdld3X0FvYmw0UWZZbUdobjEyNWtleWlLcnNyM0tEWEJVLTlIODhfVzlyeWVEVDZKTnhRSzBMbXJwLVFsOFFOWllVYjlHbFN0bXlSLUh4MDEtWndRX0FKMURTeXVkMzdTeV9CUngxQVNPSjgwWHRSNlhlT3pfb3hzcDlMODEta2lHZ1JreTFrcE5SeXFCc2l6eFFNbzBuZTIxQ0FBWFdDdGMwVDJzZTkwUUkzUGhWQVp4VVlHczZmMGVrdy1Xd0J3UFJrTTZRTnlveW53V0lDNkQxcWdxX0o3MURENjg1NG5lcXhhZnlJRDlfUFd2cGR2V0tfWFhCZ2lSQ1c5YjV6TlBvelE9', 'state': 'tfvXDihUH3NpOwLUyZeaORKzE61TBxAY', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'provadiinserimento', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-13 16:46:06,143 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'provadiinserimento', 'state': 'tfvXDihUH3NpOwLUyZeaORKzE61TBxAY', 'code': 'Z0FBQUFBQmxLVmd1enAtb3dlMTVkc1ZWX3cyQ3VvM3pLMHhmMTRSQ05zeGNnYlVQZEdQcVZYM1JJUTZXTTk2N0x5Sjd2Q1B5SFZxV0NpYmdDckZmTVdvTWpuSFlZYTlOTERLZVpKc0RYay1iWGdJbXNRSVhTUmhSLUFnRExaZE01eDliYm83dDFKajZCTUxSQ05WZWRqSUdBUHpCU01GNkozT0V6RnpUdXp5ekRMRXpWRC1PTFR6VVFMWVVPUlZ4amlZUFk5NWpocHdWRlpQSDViWmM2d01vTGVaY3Rtc1M4UUdhbUNaaGJkVl8tY3dYZDF5NnZpLUw4OExtblhoYm42WlFDRlJwbDhEcmpGLU4yR0JZd1lvQnd5RDVMUVJVM3JhUGV6SXYxRUVnWXdES0ZzWHBBQnRqMnVlZjl3LXBlcUJ2eFB5eEd4cmhZS3dNVjRkWWh3cUVDTFlEdnpCVDlkVHdwajgwMnJsc21idGU1d2ZpbjFHeEVQR2dnemVaeVJ5SnY0aUhOV05Banh2azl6VTQ2Tnpxc1k0b2dHNUpqM3JMVGZWY3JGbzQzWjNabHQtdld3X0FvYmw0UWZZbUdobjEyNWtleWlLcnNyM0tEWEJVLTlIODhfVzlyeWVEVDZKTnhRSzBMbXJwLVFsOFFOWllVYjlHbFN0bXlSLUh4MDEtWndRX0FKMURTeXVkMzdTeV9CUngxQVNPSjgwWHRSNlhlT3pfb3hzcDlMODEta2lHZ1JreTFrcE5SeXFCc2l6eFFNbzBuZTIxQ0FBWFdDdGMwVDJzZTkwUUkzUGhWQVp4VVlHczZmMGVrdy1Xd0J3UFJrTTZRTnlveW53V0lDNkQxcWdxX0o3MURENjg1NG5lcXhhZnlJRDlfUFd2cGR2V0tfWFhCZ2lSQ1c5YjV6TlBvelE9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'CVz1ilGgn5HsgpqElqdkARkpd3ayxinO70s3jd0nUU1uUbVUtpDsUTbulVFjeT9K'}
2023-10-13 16:46:06,144 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-13 16:46:06,144 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f97be522090>, 'url': 'https://sso.isprambiente.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=tfvXDihUH3NpOwLUyZeaORKzE61TBxAY&code=Z0FBQUFBQmxLVmd1enAtb3dlMTVkc1ZWX3cyQ3VvM3pLMHhmMTRSQ05zeGNnYlVQZEdQcVZYM1JJUTZXTTk2N0x5Sjd2Q1B5SFZxV0NpYmdDckZmTVdvTWpuSFlZYTlOTERLZVpKc0RYay1iWGdJbXNRSVhTUmhSLUFnRExaZE01eDliYm83dDFKajZCTUxSQ05WZWRqSUdBUHpCU01GNkozT0V6RnpUdXp5ekRMRXpWRC1PTFR6VVFMWVVPUlZ4amlZUFk5NWpocHdWRlpQSDViWmM2d01vTGVaY3Rtc1M4UUdhbUNaaGJkVl8tY3dYZDF5NnZpLUw4OExtblhoYm42WlFDRlJwbDhEcmpGLU4yR0JZd1lvQnd5RDVMUVJVM3JhUGV6SXYxRUVnWXdES0ZzWHBBQnRqMnVlZjl3LXBlcUJ2eFB5eEd4cmhZS3dNVjRkWWh3cUVDTFlEdnpCVDlkVHdwajgwMnJsc21idGU1d2ZpbjFHeEVQR2dnemVaeVJ5SnY0aUhOV05Banh2azl6VTQ2Tnpxc1k0b2dHNUpqM3JMVGZWY3JGbzQzWjNabHQtdld3X0FvYmw0UWZZbUdobjEyNWtleWlLcnNyM0tEWEJVLTlIODhfVzlyeWVEVDZKTnhRSzBMbXJwLVFsOFFOWllVYjlHbFN0bXlSLUh4MDEtWndRX0FKMURTeXVkMzdTeV9CUngxQVNPSjgwWHRSNlhlT3pfb3hzcDlMODEta2lHZ1JreTFrcE5SeXFCc2l6eFFNbzBuZTIxQ0FBWFdDdGMwVDJzZTkwUUkzUGhWQVp4VVlHczZmMGVrdy1Xd0J3UFJrTTZRTnlveW53V0lDNkQxcWdxX0o3MURENjg1NG5lcXhhZnlJRDlfUFd2cGR2V0tfWFhCZ2lSQ1c5YjV6TlBvelE9&code_verifier=CVz1ilGgn5HsgpqElqdkARkpd3ayxinO70s3jd0nUU1uUbVUtpDsUTbulVFjeT9K', 'headers': {'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-13 16:46:06,144 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=tfvXDihUH3NpOwLUyZeaORKzE61TBxAY&code=Z0FBQUFBQmxLVmd1enAtb3dlMTVkc1ZWX3cyQ3VvM3pLMHhmMTRSQ05zeGNnYlVQZEdQcVZYM1JJUTZXTTk2N0x5Sjd2Q1B5SFZxV0NpYmdDckZmTVdvTWpuSFlZYTlOTERLZVpKc0RYay1iWGdJbXNRSVhTUmhSLUFnRExaZE01eDliYm83dDFKajZCTUxSQ05WZWRqSUdBUHpCU01GNkozT0V6RnpUdXp5ekRMRXpWRC1PTFR6VVFMWVVPUlZ4amlZUFk5NWpocHdWRlpQSDViWmM2d01vTGVaY3Rtc1M4UUdhbUNaaGJkVl8tY3dYZDF5NnZpLUw4OExtblhoYm42WlFDRlJwbDhEcmpGLU4yR0JZd1lvQnd5RDVMUVJVM3JhUGV6SXYxRUVnWXdES0ZzWHBBQnRqMnVlZjl3LXBlcUJ2eFB5eEd4cmhZS3dNVjRkWWh3cUVDTFlEdnpCVDlkVHdwajgwMnJsc21idGU1d2ZpbjFHeEVQR2dnemVaeVJ5SnY0aUhOV05Banh2azl6VTQ2Tnpxc1k0b2dHNUpqM3JMVGZWY3JGbzQzWjNabHQtdld3X0FvYmw0UWZZbUdobjEyNWtleWlLcnNyM0tEWEJVLTlIODhfVzlyeWVEVDZKTnhRSzBMbXJwLVFsOFFOWllVYjlHbFN0bXlSLUh4MDEtWndRX0FKMURTeXVkMzdTeV9CUngxQVNPSjgwWHRSNlhlT3pfb3hzcDlMODEta2lHZ1JreTFrcE5SeXFCc2l6eFFNbzBuZTIxQ0FBWFdDdGMwVDJzZTkwUUkzUGhWQVp4VVlHczZmMGVrdy1Xd0J3UFJrTTZRTnlveW53V0lDNkQxcWdxX0o3MURENjg1NG5lcXhhZnlJRDlfUFd2cGR2V0tfWFhCZ2lSQ1c5YjV6TlBvelE9&code_verifier=CVz1ilGgn5HsgpqElqdkARkpd3ayxinO70s3jd0nUU1uUbVUtpDsUTbulVFjeT9K, https_args:{'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-13 16:46:06,146 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 16:46:06,780 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-13 16:46:06,781 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:46:06,781 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:46:06,781 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 14:46:06 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACucBsVdGtPBGw4zhsq5b5hikVM7AiiaKKK6ndjE-3AxvKGk0FSe85_u_MIWXKvnwRQ96E7TXV-cm_Wnxax3mb0e0ty63T9ZdbN9jHi2u98MtYnkxo8_9SN6oRVRlmxFUdpH9Pq8KTQo-XzF0yl3Bl1BGnZk6Vt4z7_PEe6rI8bdWlrGklYNiVWRElP9KMdU4jPb3eTs1GsU_Nh_VwH7Y3pGy6ikrCRrscSVJ1_HQTAO8738a0j0B9oA3MlqvrxjbTAAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACucBsVdGtPBGw4zhsq5b5hikVM7AiiaKKK6ndjE-3AxvKGk0FSe85_u_MIWXKvnwRQ96E7TXV-cm_Wnxax3mb0e0ty63T9ZdbN9jHi2u98MtYnkxo8_9SN6oRVRlmxFUdpH9Pq8KTQo-XzF0yl3Bl1BGnZk6Vt4z7_PEe6rI8bdWlrGklYNiVWRElP9KMdU4jPb3eTs1GsU_Nh_VwH7Y3pGy6ikrCRrscSVJ1_HQTAO8738a0j0B9oA3MlqvrxjbTAAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 16:46:06,782 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImM4MTJlMmEyNWNmMDRjMDBhM2UwYjE3MzEzMjFkNjkwIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtZDFiMWhoVERoTVlsZHVkSFpLZGxGWGEzTnlRblozT1dSeVpHRnNRMWg2UW5CRlltZG9VbkUwYkU1SE1EZDFXbGhWVjBwaGVETkdTRXBDTlc1VlVIRk1RV3BDYVVwdk5HeEliWGh0Y20xQ2RWZ3RTbEJNV2toU1dEZ3hNWE5tZFZkSFpqVm5RblZ4TUZBMk0yWmpOVFJsVUdWeldtWjJZa0ZtYkdOc1pXSlRlRzVFTVVvelIza3dTVTR0VGpJd2IzRkVjRWxxTFU5V1NuY3lTa3MwYzI1MmRYb3dYemRFZDI5NmFtZHlXamd6Y1d0a2EzaExhR3cyYlZsb1FYVnRlVzFaVldGRUxVVjJkWFV0Wm1KRVRrYzVXVXhKZVRCSlNtNUpjbTlYTURsRlRsTTRPVkp4V201aGNuZFBaUzFNYWxoMVpHSmxNbkJVUlZJMVZUQXljSGRVVmc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MzY2LCAiZXhwIjogMTY5NzIxMTk2Nn0.rrAHa2a2t0TxXWHzaxoWimRP787eYD242DpnNus6qQ0u0-VOVjibkABpdtFL8j42aiWkgjON1O2FHnCSvhK1AA", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLVmd1UDBhaWdOTXEyTlpzZF80RWVTbUFaRDZiZFRZdDJYWGt2TWFiTXVLZ1RPdEdWZUF2bWRxdmxwdUFpOGx2TkN4S2VsTkZKdEdQUmhNX3E5SUI5VHczWVNYZkFXbkxiYTRHbTU3MEwwM3BRMndkNTg0MnNPTnFkcnVqcmUydkI4QmRidEJkRDVPYXFTMVpNODZPd1l6OFVaN1FvTEUzUXhDa1NZYWlOcHF1NGdKVUY5eGRidWtUd3QyOFlka21lU1F5RDM2ZGxsWm5ncldpOG9sbjcwTHliQW9pOXh4NTZtcXoxaUFGcWwyblpHOFZ6T3RoWXFJckw3UnBOS0hNV2RiMzFDbC1JQlF4RzFmOGVkZHJZLWwwbHVJVFZ5S2tPdWRodzVLWW1hcUNwU3RtV1VhRllzRTU0SS1GajMwZjhicVRIUmtCMDM4aDdVd2VXZE9mVmhhcWFjbklGdklRQ2pXRDZVbzZrajZPUjRVVVVtcF95Rjg1ZmpLZGZPNnZ4RGU4dl83Z0Fuc1Y1TG1qQkdaTElZTEJzVVZHdjVHTkxPNFJlUHlDdGJHVjJnOHE1aVBmUTBRZk9VZkpxUWY1N0dZZmQ3dV9JMEtid0JWcVQ2b2ozTWVCWmhEUmZfX2p4ajBubC16UDVxcmNBLW9jbkFBZ2FUZWVGM0dfSlpNTzMxY2c5ZHRabGplc3hIdXo1ZV9iNWNLNU0xalRreEQ5MUJSckRiaDdVM0ljUUs3a3RzWE5keTBza3pxRXRmTzVUOGE2STRsVUdKWVpuX08tcWFrZXdrQ0ZJSjFzdi1WV0NZSjlYbS1BTlo5ZUVQcVpTQkwwVTAtVS1kb3U3T2tmb2RaelFkeklRcGZzR0YtS3RBbnlzOE5za2FzZ29pWWVja3BPMGxCdjBUVWlkOEU9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik0wVnNjazE0UkdOQ1MyeHpTSFJGVGpoUWVIVkJVbkZFYWxabVZEaDViblZQVDFaTVZYSjVjMnMzU1EifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVm1kMWIxaGhURGhNWWxkdWRIWktkbEZYYTNOeVFuWjNPV1J5WkdGc1ExaDZRbkJGWW1kb1VuRTBiRTVITURkMVdsaFZWMHBoZUROR1NFcENOVzVWVUhGTVFXcENhVXB2Tkd4SWJYaHRjbTFDZFZndFNsQk1Xa2hTV0RneE1YTm1kVmRIWmpWblFuVnhNRkEyTTJaak5UUmxVR1Z6V21aMllrRm1iR05zWldKVGVHNUVNVW96UjNrd1NVNHRUakl3YjNGRWNFbHFMVTlXU25jeVNrczBjMjUyZFhvd1h6ZEVkMjk2YW1keVdqZ3pjV3RrYTNoTGFHdzJiVmxvUVhWdGVXMVpWV0ZFTFVWMmRYVXRabUpFVGtjNVdVeEplVEJKU201SmNtOVhNRGxGVGxNNE9WSnhXbTVoY25kUFpTMU1hbGgxWkdKbE1uQlVSVkkxVlRBeWNIZFVWZz09IiwgImF1dGhfdGltZSI6IDE2OTcyMDgzNjYsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogIjNkOWMwMjRiNjlkNzExZWViOGMwMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAibEdtV0JXYzVXOWZ3SjYyNzBnUk9lMnUwIiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIwODM2NiwgImV4cCI6IDE2OTcyMDg2NjYsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.bMe4U9QPYK859NosX2nQ8dm6hF2qVpg2fe2hnUXASl0OP-TVOVewaJSvyZ2OizO0gmnhuokBFubNrY3FO10tDsRJA_rpgqv2FI_Y9Lsskth0BiSvo0mYbNfxmtix7zCBlaVPvvnyJJrAQBiZ-nSZ6jEo3dMEKpAmv8dOJkOKf-ejBHx0EpdiF_yimmyVdIY9iCfb3QORBPf2kusov_ctJu3pGKeKwXpKjEw9CCLKlUDH4gV9B-jQ_tQ4pIgrBBf3-KTeQQioNA6L0Jn5JzV0hMsE5OjGKSL72betZaLCLCpitehT_Wn5HE2Pe0KmibysOsEw1inu9wYMncqAfwXWjg"}
2023-10-13 16:46:06,782 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImM4MTJlMmEyNWNmMDRjMDBhM2UwYjE3MzEzMjFkNjkwIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtZDFiMWhoVERoTVlsZHVkSFpLZGxGWGEzTnlRblozT1dSeVpHRnNRMWg2UW5CRlltZG9VbkUwYkU1SE1EZDFXbGhWVjBwaGVETkdTRXBDTlc1VlVIRk1RV3BDYVVwdk5HeEliWGh0Y20xQ2RWZ3RTbEJNV2toU1dEZ3hNWE5tZFZkSFpqVm5RblZ4TUZBMk0yWmpOVFJsVUdWeldtWjJZa0ZtYkdOc1pXSlRlRzVFTVVvelIza3dTVTR0VGpJd2IzRkVjRWxxTFU5V1NuY3lTa3MwYzI1MmRYb3dYemRFZDI5NmFtZHlXamd6Y1d0a2EzaExhR3cyYlZsb1FYVnRlVzFaVldGRUxVVjJkWFV0Wm1KRVRrYzVXVXhKZVRCSlNtNUpjbTlYTURsRlRsTTRPVkp4V201aGNuZFBaUzFNYWxoMVpHSmxNbkJVUlZJMVZUQXljSGRVVmc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MzY2LCAiZXhwIjogMTY5NzIxMTk2Nn0.rrAHa2a2t0TxXWHzaxoWimRP787eYD242DpnNus6qQ0u0-VOVjibkABpdtFL8j42aiWkgjON1O2FHnCSvhK1AA", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLVmd1UDBhaWdOTXEyTlpzZF80RWVTbUFaRDZiZFRZdDJYWGt2TWFiTXVLZ1RPdEdWZUF2bWRxdmxwdUFpOGx2TkN4S2VsTkZKdEdQUmhNX3E5SUI5VHczWVNYZkFXbkxiYTRHbTU3MEwwM3BRMndkNTg0MnNPTnFkcnVqcmUydkI4QmRidEJkRDVPYXFTMVpNODZPd1l6OFVaN1FvTEUzUXhDa1NZYWlOcHF1NGdKVUY5eGRidWtUd3QyOFlka21lU1F5RDM2ZGxsWm5ncldpOG9sbjcwTHliQW9pOXh4NTZtcXoxaUFGcWwyblpHOFZ6T3RoWXFJckw3UnBOS0hNV2RiMzFDbC1JQlF4RzFmOGVkZHJZLWwwbHVJVFZ5S2tPdWRodzVLWW1hcUNwU3RtV1VhRllzRTU0SS1GajMwZjhicVRIUmtCMDM4aDdVd2VXZE9mVmhhcWFjbklGdklRQ2pXRDZVbzZrajZPUjRVVVVtcF95Rjg1ZmpLZGZPNnZ4RGU4dl83Z0Fuc1Y1TG1qQkdaTElZTEJzVVZHdjVHTkxPNFJlUHlDdGJHVjJnOHE1aVBmUTBRZk9VZkpxUWY1N0dZZmQ3dV9JMEtid0JWcVQ2b2ozTWVCWmhEUmZfX2p4ajBubC16UDVxcmNBLW9jbkFBZ2FUZWVGM0dfSlpNTzMxY2c5ZHRabGplc3hIdXo1ZV9iNWNLNU0xalRreEQ5MUJSckRiaDdVM0ljUUs3a3RzWE5keTBza3pxRXRmTzVUOGE2STRsVUdKWVpuX08tcWFrZXdrQ0ZJSjFzdi1WV0NZSjlYbS1BTlo5ZUVQcVpTQkwwVTAtVS1kb3U3T2tmb2RaelFkeklRcGZzR0YtS3RBbnlzOE5za2FzZ29pWWVja3BPMGxCdjBUVWlkOEU9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik0wVnNjazE0UkdOQ1MyeHpTSFJGVGpoUWVIVkJVbkZFYWxabVZEaDViblZQVDFaTVZYSjVjMnMzU1EifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVm1kMWIxaGhURGhNWWxkdWRIWktkbEZYYTNOeVFuWjNPV1J5WkdGc1ExaDZRbkJGWW1kb1VuRTBiRTVITURkMVdsaFZWMHBoZUROR1NFcENOVzVWVUhGTVFXcENhVXB2Tkd4SWJYaHRjbTFDZFZndFNsQk1Xa2hTV0RneE1YTm1kVmRIWmpWblFuVnhNRkEyTTJaak5UUmxVR1Z6V21aMllrRm1iR05zWldKVGVHNUVNVW96UjNrd1NVNHRUakl3YjNGRWNFbHFMVTlXU25jeVNrczBjMjUyZFhvd1h6ZEVkMjk2YW1keVdqZ3pjV3RrYTNoTGFHdzJiVmxvUVhWdGVXMVpWV0ZFTFVWMmRYVXRabUpFVGtjNVdVeEplVEJKU201SmNtOVhNRGxGVGxNNE9WSnhXbTVoY25kUFpTMU1hbGgxWkdKbE1uQlVSVkkxVlRBeWNIZFVWZz09IiwgImF1dGhfdGltZSI6IDE2OTcyMDgzNjYsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogIjNkOWMwMjRiNjlkNzExZWViOGMwMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAibEdtV0JXYzVXOWZ3SjYyNzBnUk9lMnUwIiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIwODM2NiwgImV4cCI6IDE2OTcyMDg2NjYsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.bMe4U9QPYK859NosX2nQ8dm6hF2qVpg2fe2hnUXASl0OP-TVOVewaJSvyZ2OizO0gmnhuokBFubNrY3FO10tDsRJA_rpgqv2FI_Y9Lsskth0BiSvo0mYbNfxmtix7zCBlaVPvvnyJJrAQBiZ-nSZ6jEo3dMEKpAmv8dOJkOKf-ejBHx0EpdiF_yimmyVdIY9iCfb3QORBPf2kusov_ctJu3pGKeKwXpKjEw9CCLKlUDH4gV9B-jQ_tQ4pIgrBBf3-KTeQQioNA6L0Jn5JzV0hMsE5OjGKSL72betZaLCLCpitehT_Wn5HE2Pe0KmibysOsEw1inu9wYMncqAfwXWjg"}
2023-10-13 16:46:06,782 oidcrp.service DEBUG response format: json
2023-10-13 16:46:06,782 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-13 16:46:06,782 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImM4MTJlMmEyNWNmMDRjMDBhM2UwYjE3MzEzMjFkNjkwIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtZDFiMWhoVERoTVlsZHVkSFpLZGxGWGEzTnlRblozT1dSeVpHRnNRMWg2UW5CRlltZG9VbkUwYkU1SE1EZDFXbGhWVjBwaGVETkdTRXBDTlc1VlVIRk1RV3BDYVVwdk5HeEliWGh0Y20xQ2RWZ3RTbEJNV2toU1dEZ3hNWE5tZFZkSFpqVm5RblZ4TUZBMk0yWmpOVFJsVUdWeldtWjJZa0ZtYkdOc1pXSlRlRzVFTVVvelIza3dTVTR0VGpJd2IzRkVjRWxxTFU5V1NuY3lTa3MwYzI1MmRYb3dYemRFZDI5NmFtZHlXamd6Y1d0a2EzaExhR3cyYlZsb1FYVnRlVzFaVldGRUxVVjJkWFV0Wm1KRVRrYzVXVXhKZVRCSlNtNUpjbTlYTURsRlRsTTRPVkp4V201aGNuZFBaUzFNYWxoMVpHSmxNbkJVUlZJMVZUQXljSGRVVmc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MzY2LCAiZXhwIjogMTY5NzIxMTk2Nn0.rrAHa2a2t0TxXWHzaxoWimRP787eYD242DpnNus6qQ0u0-VOVjibkABpdtFL8j42aiWkgjON1O2FHnCSvhK1AA', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxLVmd1UDBhaWdOTXEyTlpzZF80RWVTbUFaRDZiZFRZdDJYWGt2TWFiTXVLZ1RPdEdWZUF2bWRxdmxwdUFpOGx2TkN4S2VsTkZKdEdQUmhNX3E5SUI5VHczWVNYZkFXbkxiYTRHbTU3MEwwM3BRMndkNTg0MnNPTnFkcnVqcmUydkI4QmRidEJkRDVPYXFTMVpNODZPd1l6OFVaN1FvTEUzUXhDa1NZYWlOcHF1NGdKVUY5eGRidWtUd3QyOFlka21lU1F5RDM2ZGxsWm5ncldpOG9sbjcwTHliQW9pOXh4NTZtcXoxaUFGcWwyblpHOFZ6T3RoWXFJckw3UnBOS0hNV2RiMzFDbC1JQlF4RzFmOGVkZHJZLWwwbHVJVFZ5S2tPdWRodzVLWW1hcUNwU3RtV1VhRllzRTU0SS1GajMwZjhicVRIUmtCMDM4aDdVd2VXZE9mVmhhcWFjbklGdklRQ2pXRDZVbzZrajZPUjRVVVVtcF95Rjg1ZmpLZGZPNnZ4RGU4dl83Z0Fuc1Y1TG1qQkdaTElZTEJzVVZHdjVHTkxPNFJlUHlDdGJHVjJnOHE1aVBmUTBRZk9VZkpxUWY1N0dZZmQ3dV9JMEtid0JWcVQ2b2ozTWVCWmhEUmZfX2p4ajBubC16UDVxcmNBLW9jbkFBZ2FUZWVGM0dfSlpNTzMxY2c5ZHRabGplc3hIdXo1ZV9iNWNLNU0xalRreEQ5MUJSckRiaDdVM0ljUUs3a3RzWE5keTBza3pxRXRmTzVUOGE2STRsVUdKWVpuX08tcWFrZXdrQ0ZJSjFzdi1WV0NZSjlYbS1BTlo5ZUVQcVpTQkwwVTAtVS1kb3U3T2tmb2RaelFkeklRcGZzR0YtS3RBbnlzOE5za2FzZ29pWWVja3BPMGxCdjBUVWlkOEU9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Ik0wVnNjazE0UkdOQ1MyeHpTSFJGVGpoUWVIVkJVbkZFYWxabVZEaDViblZQVDFaTVZYSjVjMnMzU1EifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMVm1kMWIxaGhURGhNWWxkdWRIWktkbEZYYTNOeVFuWjNPV1J5WkdGc1ExaDZRbkJGWW1kb1VuRTBiRTVITURkMVdsaFZWMHBoZUROR1NFcENOVzVWVUhGTVFXcENhVXB2Tkd4SWJYaHRjbTFDZFZndFNsQk1Xa2hTV0RneE1YTm1kVmRIWmpWblFuVnhNRkEyTTJaak5UUmxVR1Z6V21aMllrRm1iR05zWldKVGVHNUVNVW96UjNrd1NVNHRUakl3YjNGRWNFbHFMVTlXU25jeVNrczBjMjUyZFhvd1h6ZEVkMjk2YW1keVdqZ3pjV3RrYTNoTGFHdzJiVmxvUVhWdGVXMVpWV0ZFTFVWMmRYVXRabUpFVGtjNVdVeEplVEJKU201SmNtOVhNRGxGVGxNNE9WSnhXbTVoY25kUFpTMU1hbGgxWkdKbE1uQlVSVkkxVlRBeWNIZFVWZz09IiwgImF1dGhfdGltZSI6IDE2OTcyMDgzNjYsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogIjNkOWMwMjRiNjlkNzExZWViOGMwMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAibEdtV0JXYzVXOWZ3SjYyNzBnUk9lMnUwIiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIwODM2NiwgImV4cCI6IDE2OTcyMDg2NjYsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.bMe4U9QPYK859NosX2nQ8dm6hF2qVpg2fe2hnUXASl0OP-TVOVewaJSvyZ2OizO0gmnhuokBFubNrY3FO10tDsRJA_rpgqv2FI_Y9Lsskth0BiSvo0mYbNfxmtix7zCBlaVPvvnyJJrAQBiZ-nSZ6jEo3dMEKpAmv8dOJkOKf-ejBHx0EpdiF_yimmyVdIY9iCfb3QORBPf2kusov_ctJu3pGKeKwXpKjEw9CCLKlUDH4gV9B-jQ_tQ4pIgrBBf3-KTeQQioNA6L0Jn5JzV0hMsE5OjGKSL72betZaLCLCpitehT_Wn5HE2Pe0KmibysOsEw1inu9wYMncqAfwXWjg'}"
2023-10-13 16:46:06,783 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15}
2023-10-13 16:46:06,784 oidcmsg.message DEBUG Raw JSON: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLVmd1b1hhTDhMYldudHZKdlFXa3NyQnZ3OWRyZGFsQ1h6QnBFYmdoUnE0bE5HMDd1WlhVV0pheDNGSEpCNW5VUHFMQWpCaUpvNGxIbXhtcm1CdVgtSlBMWkhSWDgxMXNmdVdHZjVnQnVxMFA2M2ZjNTRlUGVzWmZ2YkFmbGNsZWJTeG5EMUozR3kwSU4tTjIwb3FEcElqLU9WSncySks0c252dXowXzdEd296amdyWjgzcWtka3hLaGw2bVloQXVteW1ZVWFELUV2dXUtZmJETkc5WUxJeTBJSm5Jcm9XMDlFTlM4OVJxWm5hcndPZS1Malh1ZGJlMnBURVI1VTAycHdUVg==', 'auth_time': 1697208366, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '3d9c024b69d711eeb8c00242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': 'lGmWBWc5W9fwJ6270gROe2u0', 'iss': 'https://sso.isprambiente.it', 'iat': 1697208366, 'exp': 1697208666, 'aud': ['provadiinserimento']}
2023-10-13 16:46:06,784 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ'}
2023-10-13 16:46:06,784 cryptojwt.key_jar DEBUG Key summary for https://sso.isprambiente.it: RSA:sig:M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ, EC:sig:ZksweGVJOGdMWW5uRXJ4Wkt4SS1PdkI0ZjNLblA4YzBVUmpmQ0xueVlRdw
2023-10-13 16:46:06,784 oidcmsg.message DEBUG Found signing key.
2023-10-13 16:46:06,784 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-13 16:46:06,785 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ and use=
2023-10-13 16:46:06,785 cryptojwt.jwx DEBUG Picked: kid:M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ, use:sig, kty:RSA
2023-10-13 16:46:06,786 cryptojwt.jws.jws DEBUG Verified message using key with kid=M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ
2023-10-13 16:46:06,786 oidcmsg.oidc INFO Verified id_token: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLVmd1b1hhTDhMYldudHZKdlFXa3NyQnZ3OWRyZGFsQ1h6QnBFYmdoUnE0bE5HMDd1WlhVV0pheDNGSEpCNW5VUHFMQWpCaUpvNGxIbXhtcm1CdVgtSlBMWkhSWDgxMXNmdVdHZjVnQnVxMFA2M2ZjNTRlUGVzWmZ2YkFmbGNsZWJTeG5EMUozR3kwSU4tTjIwb3FEcElqLU9WSncySks0c252dXowXzdEd296amdyWjgzcWtka3hLaGw2bVloQXVteW1ZVWFELUV2dXUtZmJETkc5WUxJeTBJSm5Jcm9XMDlFTlM4OVJxWm5hcndPZS1Malh1ZGJlMnBURVI1VTAycHdUVg==', 'auth_time': 1697208366, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '3d9c024b69d711eeb8c00242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': 'lGmWBWc5W9fwJ6270gROe2u0', 'iss': 'https://sso.isprambiente.it', 'iat': 1697208366, 'exp': 1697208666, 'aud': ['provadiinserimento']}
2023-10-13 16:46:06,789 oidcrp.rp_handler DEBUG ID Token: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLVmd1b1hhTDhMYldudHZKdlFXa3NyQnZ3OWRyZGFsQ1h6QnBFYmdoUnE0bE5HMDd1WlhVV0pheDNGSEpCNW5VUHFMQWpCaUpvNGxIbXhtcm1CdVgtSlBMWkhSWDgxMXNmdVdHZjVnQnVxMFA2M2ZjNTRlUGVzWmZ2YkFmbGNsZWJTeG5EMUozR3kwSU4tTjIwb3FEcElqLU9WSncySks0c252dXowXzdEd296amdyWjgzcWtka3hLaGw2bVloQXVteW1ZVWFELUV2dXUtZmJETkc5WUxJeTBJSm5Jcm9XMDlFTlM4OVJxWm5hcndPZS1Malh1ZGJlMnBURVI1VTAycHdUVg==', 'auth_time': 1697208366, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '3d9c024b69d711eeb8c00242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': 'lGmWBWc5W9fwJ6270gROe2u0', 'iss': 'https://sso.isprambiente.it', 'iat': 1697208366, 'exp': 1697208666, 'aud': ['provadiinserimento']}
2023-10-13 16:46:06,789 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-13 16:46:06,789 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImM4MTJlMmEyNWNmMDRjMDBhM2UwYjE3MzEzMjFkNjkwIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtZDFiMWhoVERoTVlsZHVkSFpLZGxGWGEzTnlRblozT1dSeVpHRnNRMWg2UW5CRlltZG9VbkUwYkU1SE1EZDFXbGhWVjBwaGVETkdTRXBDTlc1VlVIRk1RV3BDYVVwdk5HeEliWGh0Y20xQ2RWZ3RTbEJNV2toU1dEZ3hNWE5tZFZkSFpqVm5RblZ4TUZBMk0yWmpOVFJsVUdWeldtWjJZa0ZtYkdOc1pXSlRlRzVFTVVvelIza3dTVTR0VGpJd2IzRkVjRWxxTFU5V1NuY3lTa3MwYzI1MmRYb3dYemRFZDI5NmFtZHlXamd6Y1d0a2EzaExhR3cyYlZsb1FYVnRlVzFaVldGRUxVVjJkWFV0Wm1KRVRrYzVXVXhKZVRCSlNtNUpjbTlYTURsRlRsTTRPVkp4V201aGNuZFBaUzFNYWxoMVpHSmxNbkJVUlZJMVZUQXljSGRVVmc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MzY2LCAiZXhwIjogMTY5NzIxMTk2Nn0.rrAHa2a2t0TxXWHzaxoWimRP787eYD242DpnNus6qQ0u0-VOVjibkABpdtFL8j42aiWkgjON1O2FHnCSvhK1AA'}
2023-10-13 16:46:06,790 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-13 16:46:06,790 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f97be522090>, 'url': 'https://sso.isprambiente.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImM4MTJlMmEyNWNmMDRjMDBhM2UwYjE3MzEzMjFkNjkwIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtZDFiMWhoVERoTVlsZHVkSFpLZGxGWGEzTnlRblozT1dSeVpHRnNRMWg2UW5CRlltZG9VbkUwYkU1SE1EZDFXbGhWVjBwaGVETkdTRXBDTlc1VlVIRk1RV3BDYVVwdk5HeEliWGh0Y20xQ2RWZ3RTbEJNV2toU1dEZ3hNWE5tZFZkSFpqVm5RblZ4TUZBMk0yWmpOVFJsVUdWeldtWjJZa0ZtYkdOc1pXSlRlRzVFTVVvelIza3dTVTR0VGpJd2IzRkVjRWxxTFU5V1NuY3lTa3MwYzI1MmRYb3dYemRFZDI5NmFtZHlXamd6Y1d0a2EzaExhR3cyYlZsb1FYVnRlVzFaVldGRUxVVjJkWFV0Wm1KRVRrYzVXVXhKZVRCSlNtNUpjbTlYTURsRlRsTTRPVkp4V201aGNuZFBaUzFNYWxoMVpHSmxNbkJVUlZJMVZUQXljSGRVVmc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MzY2LCAiZXhwIjogMTY5NzIxMTk2Nn0.rrAHa2a2t0TxXWHzaxoWimRP787eYD242DpnNus6qQ0u0-VOVjibkABpdtFL8j42aiWkgjON1O2FHnCSvhK1AA'}}
2023-10-13 16:46:06,790 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogImM4MTJlMmEyNWNmMDRjMDBhM2UwYjE3MzEzMjFkNjkwIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFZtZDFiMWhoVERoTVlsZHVkSFpLZGxGWGEzTnlRblozT1dSeVpHRnNRMWg2UW5CRlltZG9VbkUwYkU1SE1EZDFXbGhWVjBwaGVETkdTRXBDTlc1VlVIRk1RV3BDYVVwdk5HeEliWGh0Y20xQ2RWZ3RTbEJNV2toU1dEZ3hNWE5tZFZkSFpqVm5RblZ4TUZBMk0yWmpOVFJsVUdWeldtWjJZa0ZtYkdOc1pXSlRlRzVFTVVvelIza3dTVTR0VGpJd2IzRkVjRWxxTFU5V1NuY3lTa3MwYzI1MmRYb3dYemRFZDI5NmFtZHlXamd6Y1d0a2EzaExhR3cyYlZsb1FYVnRlVzFaVldGRUxVVjJkWFV0Wm1KRVRrYzVXVXhKZVRCSlNtNUpjbTlYTURsRlRsTTRPVkp4V201aGNuZFBaUzFNYWxoMVpHSmxNbkJVUlZJMVZUQXljSGRVVmc9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjA4MzY2LCAiZXhwIjogMTY5NzIxMTk2Nn0.rrAHa2a2t0TxXWHzaxoWimRP787eYD242DpnNus6qQ0u0-VOVjibkABpdtFL8j42aiWkgjON1O2FHnCSvhK1AA'}
2023-10-13 16:46:06,792 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 16:46:07,428 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-13 16:46:07,429 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 16:46:07,430 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 16:46:07,430 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 14:46:07 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdAD0OQsTzV8KFv3uJeTLiafZTBcoJkJ6ZqX65AmUOOG5cdfgb4N6rZnTcI2521Ac22Xgz3MIMSRxGxQNQPGRGLIHsxV-iI5ogG4A6r-6nvQJ2Yi_g7wDjntIINEuXaeEkbG3_kuoAyAN_sQ7_BGXJjlscdtm1F9d6kvzV3g1a7CNkmEpVmVoQEhYQphHvCRrv12geAOuLAnl2hLpMcA_elZ4pFkY_REEz2Zklzbeme_Q6sUtCRmTZn__nHwAAABeeFEoSULqPAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdAD0OQsTzV8KFv3uJeTLiafZTBcoJkJ6ZqX65AmUOOG5cdfgb4N6rZnTcI2521Ac22Xgz3MIMSRxGxQNQPGRGLIHsxV-iI5ogG4A6r-6nvQJ2Yi_g7wDjntIINEuXaeEkbG3_kuoAyAN_sQ7_BGXJjlscdtm1F9d6kvzV3g1a7CNkmEpVmVoQEhYQphHvCRrv12geAOuLAnl2hLpMcA_elZ4pFkY_REEz2Zklzbeme_Q6sUtCRmTZn__nHwAAABeeFEoSULqPAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 16:46:07,430 oidcrp.util DEBUG resp.txt: {"sub": "5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619", "name": "ANDREA", "given_name": "ANDREA", "family_name": "RANALDI", "nickname": "RANALDI", "acr": "https://www.spid.gov.it/SpidL2"}
2023-10-13 16:46:07,430 oidcrp.oauth2 DEBUG Successful response: {"sub": "5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619", "name": "ANDREA", "given_name": "ANDREA", "family_name": "RANALDI", "nickname": "RANALDI", "acr": "https://www.spid.gov.it/SpidL2"}
2023-10-13 16:46:07,430 oidcrp.service DEBUG response format: json
2023-10-13 16:46:07,430 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-13 16:46:07,431 oidcrp.service DEBUG Initial response parsing => "{'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'name': 'ANDREA', 'given_name': 'ANDREA', 'family_name': 'RANALDI', 'nickname': 'RANALDI', 'acr': 'https://www.spid.gov.it/SpidL2'}"
2023-10-13 16:46:07,431 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15}
2023-10-13 16:46:07,433 oidcrp.rp_handler DEBUG UserInfo: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'name': 'ANDREA', 'given_name': 'ANDREA', 'family_name': 'RANALDI', 'nickname': 'RANALDI', 'acr': 'https://www.spid.gov.it/SpidL2'}
2023-10-13 16:46:07,442 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 16:46:07] "GET /authz_cb/satosa?state=tfvXDihUH3NpOwLUyZeaORKzE61TBxAY&scope=openid+profile+offline_access&code=Z0FBQUFBQmxLVmd1enAtb3dlMTVkc1ZWX3cyQ3VvM3pLMHhmMTRSQ05zeGNnYlVQZEdQcVZYM1JJUTZXTTk2N0x5Sjd2Q1B5SFZxV0NpYmdDckZmTVdvTWpuSFlZYTlOTERLZVpKc0RYay1iWGdJbXNRSVhTUmhSLUFnRExaZE01eDliYm83dDFKajZCTUxSQ05WZWRqSUdBUHpCU01GNkozT0V6RnpUdXp5ekRMRXpWRC1PTFR6VVFMWVVPUlZ4amlZUFk5NWpocHdWRlpQSDViWmM2d01vTGVaY3Rtc1M4UUdhbUNaaGJkVl8tY3dYZDF5NnZpLUw4OExtblhoYm42WlFDRlJwbDhEcmpGLU4yR0JZd1lvQnd5RDVMUVJVM3JhUGV6SXYxRUVnWXdES0ZzWHBBQnRqMnVlZjl3LXBlcUJ2eFB5eEd4cmhZS3dNVjRkWWh3cUVDTFlEdnpCVDlkVHdwajgwMnJsc21idGU1d2ZpbjFHeEVQR2dnemVaeVJ5SnY0aUhOV05Banh2azl6VTQ2Tnpxc1k0b2dHNUpqM3JMVGZWY3JGbzQzWjNabHQtdld3X0FvYmw0UWZZbUdobjEyNWtleWlLcnNyM0tEWEJVLTlIODhfVzlyeWVEVDZKTnhRSzBMbXJwLVFsOFFOWllVYjlHbFN0bXlSLUh4MDEtWndRX0FKMURTeXVkMzdTeV9CUngxQVNPSjgwWHRSNlhlT3pfb3hzcDlMODEta2lHZ1JreTFrcE5SeXFCc2l6eFFNbzBuZTIxQ0FBWFdDdGMwVDJzZTkwUUkzUGhWQVp4VVlHczZmMGVrdy1Xd0J3UFJrTTZRTnlveW53V0lDNkQxcWdxX0o3MURENjg1NG5lcXhhZnlJRDlfUFd2cGR2V0tfWFhCZ2lSQ1c5YjV6TlBvelE9&iss=https://sso.isprambiente.it&client_id=provadiinserimento HTTP/1.1" 200 -
2023-10-13 18:35:56,448 root DEBUG Configured logging using dictionary
2023-10-13 18:35:56,487 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-13 18:35:56,487 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-13 18:35:56,487 werkzeug INFO  * Restarting with stat
2023-10-13 18:35:56,666 root DEBUG Configured logging using dictionary
2023-10-13 18:35:56,703 werkzeug WARNING  * Debugger is active!
2023-10-13 18:35:56,703 werkzeug INFO  * Debugger PIN: 221-170-319
2023-10-13 18:37:33,709 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 18:37:33] "[33mGET /authz_cb/ HTTP/1.1[0m" 404 -
2023-10-13 18:37:42,745 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 18:37:42] "GET / HTTP/1.1" 200 -
2023-10-13 18:37:48,303 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-13 18:37:48,303 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-13 18:37:48,303 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-13 18:37:48,304 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-13 18:37:48,345 oidcrp.rp_handler DEBUG Get provider info
2023-10-13 18:37:48,345 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-13 18:37:48,345 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://sso.isprambiente.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-13 18:37:48,345 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-13 18:37:48,346 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 18:37:48,511 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-13 18:37:48,512 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 18:37:48,513 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 18:37:48,513 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 16:37:48 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADoOAuPKYhZTsPpiuAiD5WZXOsmF7ogR2LuKpabXmw42Q-e15_Sgiz1QdxytJ38w_69n-WfT0WxjoSzS142U35g-oRBrf_lqArFiniSsGvzlY0FmnBv3ZgSr4KTFH0ia5W3I-bUk1V9i5zKuEyGp_WVWvX4Ir5jJOoNfjKyThfQgZc4xecVFyTinjwhTtidtSWljRgRlRH__lYvp9Bdu0avuF40eDTjCpvrTAMlZICTFmE2Whz2RbI4ZAAAAAIqNkJ2TYeiIAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADoOAuPKYhZTsPpiuAiD5WZXOsmF7ogR2LuKpabXmw42Q-e15_Sgiz1QdxytJ38w_69n-WfT0WxjoSzS142U35g-oRBrf_lqArFiniSsGvzlY0FmnBv3ZgSr4KTFH0ia5W3I-bUk1V9i5zKuEyGp_WVWvX4Ir5jJOoNfjKyThfQgZc4xecVFyTinjwhTtidtSWljRgRlRH__lYvp9Bdu0avuF40eDTjCpvrTAMlZICTFmE2Whz2RbI4ZAAAAAIqNkJ2TYeiIAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 18:37:48,513 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://sso.isprambiente.it", "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection"}
2023-10-13 18:37:48,513 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["implicit", "authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://sso.isprambiente.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://sso.isprambiente.it", "authorization_endpoint": "https://sso.isprambiente.it/OIDC/authorization", "token_endpoint": "https://sso.isprambiente.it/OIDC/token", "userinfo_endpoint": "https://sso.isprambiente.it/OIDC/userinfo", "introspection_endpoint": "https://sso.isprambiente.it/OIDC/introspection"}
2023-10-13 18:37:48,513 oidcrp.service DEBUG response format: json
2023-10-13 18:37:48,513 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-13 18:37:48,514 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['implicit', 'authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://sso.isprambiente.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://sso.isprambiente.it', 'authorization_endpoint': 'https://sso.isprambiente.it/OIDC/authorization', 'token_endpoint': 'https://sso.isprambiente.it/OIDC/token', 'userinfo_endpoint': 'https://sso.isprambiente.it/OIDC/userinfo', 'introspection_endpoint': 'https://sso.isprambiente.it/OIDC/introspection'}"
2023-10-13 18:37:48,514 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'provadiinserimento'}
2023-10-13 18:37:48,515 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://sso.isprambiente.it
2023-10-13 18:37:48,516 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-13 18:37:48,516 cryptojwt.key_bundle INFO Reading remote JWKS from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 18:37:48,516 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 18:37:48,518 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 18:37:48,668 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-13 18:37:48,669 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ", "e": "AQAB", "n": "pVKjViCs2AlQinRtT-ZM8B6o8pXv8fzFu_uGMzU5g6nvjCq1gk_L8s0d88i9hOGkout0oQjJwIURuiE_2MKYlp3z4LB4o_yIboabnPHOvtsE2qXCFWlyLXlX1kEUmh9RElXbd0DfUmMhGqTcf5Y9Y3micd0E3NzgJdyN54BRSkYX7AMKPC23UgqYHMuj38vHqjO-aNPrdwvBBYbrRVXhHxG7uvjF_qm1prhm531zvDGjdf0MeVJS0WXZc92x2kexxs6JW_TaScXXvwQ8nlM9iqhNRGHdxWZvsyXSoV2SwpO8ybf8aWtjCJqUPofRdPRALSeRd9yaqF9GbTtOL6SdlQ"}, {"kty": "EC", "use": "sig", "kid": "ZksweGVJOGdMWW5uRXJ4Wkt4SS1PdkI0ZjNLblA4YzBVUmpmQ0xueVlRdw", "crv": "P-256", "x": "rv78hjpK-fPmcFquwNU3uqCq67yzS4Xyl0Kp7nzWy90", "y": "Rtd2le_0kUu381rMvWiiLjB29jVBODc9dd2w6BdlloI"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 18:37:48,670 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ", "e": "AQAB", "n": "pVKjViCs2AlQinRtT-ZM8B6o8pXv8fzFu_uGMzU5g6nvjCq1gk_L8s0d88i9hOGkout0oQjJwIURuiE_2MKYlp3z4LB4o_yIboabnPHOvtsE2qXCFWlyLXlX1kEUmh9RElXbd0DfUmMhGqTcf5Y9Y3micd0E3NzgJdyN54BRSkYX7AMKPC23UgqYHMuj38vHqjO-aNPrdwvBBYbrRVXhHxG7uvjF_qm1prhm531zvDGjdf0MeVJS0WXZc92x2kexxs6JW_TaScXXvwQ8nlM9iqhNRGHdxWZvsyXSoV2SwpO8ybf8aWtjCJqUPofRdPRALSeRd9yaqF9GbTtOL6SdlQ"}, {"kty": "EC", "use": "sig", "kid": "ZksweGVJOGdMWW5uRXJ4Wkt4SS1PdkI0ZjNLblA4YzBVUmpmQ0xueVlRdw", "crv": "P-256", "x": "rv78hjpK-fPmcFquwNU3uqCq67yzS4Xyl0Kp7nzWy90", "y": "Rtd2le_0kUu381rMvWiiLjB29jVBODc9dd2w6BdlloI"}]} from https://sso.isprambiente.it/OIDC/jwks.json
2023-10-13 18:37:48,672 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-13 18:37:48,672 oidcrp.rp_handler DEBUG Do client registration
2023-10-13 18:37:48,673 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-13 18:37:48,673 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-13 18:37:48,673 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'dHrUU4rBi0lcxtHgh18GDIPT', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'xLxp9oIvezv5IayOb4jVFGw9QweCoTzL'}
2023-10-13 18:37:48,674 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'dHrUU4rBi0lcxtHgh18GDIPT', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'xLxp9oIvezv5IayOb4jVFGw9QweCoTzL', 'code_challenge': 'qw2lN08WOJpFTUBmlu668aHgCWitOPRuu9zQIlknhjI', 'code_challenge_method': 'S256', 'client_id': 'provadiinserimento', 'prompt': 'consent'}
2023-10-13 18:37:48,675 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f1f59c9b290>, 'url': 'https://sso.isprambiente.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=dHrUU4rBi0lcxtHgh18GDIPT&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=xLxp9oIvezv5IayOb4jVFGw9QweCoTzL&code_challenge=qw2lN08WOJpFTUBmlu668aHgCWitOPRuu9zQIlknhjI&code_challenge_method=S256&client_id=provadiinserimento&prompt=consent'}
2023-10-13 18:37:48,676 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 18:37:48] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-13 18:38:22,613 flask_rp.views DEBUG Issuer: https://sso.isprambiente.it
2023-10-13 18:38:22,613 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-13 18:38:22,613 oidcrp.service DEBUG response format: dict
2023-10-13 18:38:22,613 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-13 18:38:22,613 oidcrp.service DEBUG Initial response parsing => "{'state': 'xLxp9oIvezv5IayOb4jVFGw9QweCoTzL', 'scope': 'openid profile offline_access', 'code': 'Z0FBQUFBQmxLWEotNWp6OFdfNno2ZDQ4Qy1TMEtnblZYbTZWbHRSbnZ3TDVraTE4Q0VqaWJacE5lOEllWFFBSFJvMEZsbE1xMXhZNjRUTXkxQkE2dW5PWGMyRzZTc2VXanlXTGJwMWt5eUJ6VE5TTVlFYUJqUWdWT3o1dFZLamZlOXFBSHhhdG9HcG1vVGtaSUNmbXFldW5qU1d2NFRYX3J3OXdqT0FJQlBfYmhVLVZucks4RWlWUjZ4ak8zNlRFUDE5dmp4ODNvRmpLTldoRExuUkhDQUc1NjBCRUJlalh2SGVPanVqMnlDTjJhZEhsZ2Y2anlGMnYtblpQSkFENk80bHE2blpFa1loMzNUVmZudUl4ejdJM3VHVktXXzNXZWpxdTk1R3dVbnZ2dTB6SzdzcUFza3NuRGFJSWs4dFhyOTRod1dPd2tNNWZRUWVDb0I3NjExRG9NeUtrMU1GT2VsZjhablRZcEdyUjlmaUZFUWItOUxmR0ZFcUJuTmJpdkZhYnJmMWJpMmkwZkpMSVp2NFFYS2tfUnZZMkZhdHRkXzF2ZXBmZ095XzVRcGE1QXdNOHpwQzNIa0pqNXJqTEZyT0RIVllIQWZoQjNnYm9qZFhvb05EeHZHZlkxN3lpdURSRXoxN2RNOVZGamhLQjdud2NJbmlObUplWElidEpZaDd5UzlEODNkOUQwall5SUZwcGVFdXh6SXMwQ29EY3VTOENiY3ZlZlBIa0NwdDJJYUttM1JfZ2cxTGdVMVBON253UzB6Z1pjb2dTbGtTcXppRHNvbUYtVzNyR0c4TzNib3dsdUdyZDZwQzllOXpBdTNJbFpQNGpMeFhBVTkwb2VROUZlMkpabUlHeElmSmNuaXh6U3lPNFA3OXZNYkFtcXpmX0RFbkRaRGRlMEhXaVBTbXlYWGM9', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}"
2023-10-13 18:38:22,613 oidcrp.service DEBUG Verify response with {'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15, 'client_id': 'provadiinserimento'}
2023-10-13 18:38:22,614 oidcrp.rp_handler DEBUG Authz response: {'state': 'xLxp9oIvezv5IayOb4jVFGw9QweCoTzL', 'scope': 'openid profile offline_access', 'code': 'Z0FBQUFBQmxLWEotNWp6OFdfNno2ZDQ4Qy1TMEtnblZYbTZWbHRSbnZ3TDVraTE4Q0VqaWJacE5lOEllWFFBSFJvMEZsbE1xMXhZNjRUTXkxQkE2dW5PWGMyRzZTc2VXanlXTGJwMWt5eUJ6VE5TTVlFYUJqUWdWT3o1dFZLamZlOXFBSHhhdG9HcG1vVGtaSUNmbXFldW5qU1d2NFRYX3J3OXdqT0FJQlBfYmhVLVZucks4RWlWUjZ4ak8zNlRFUDE5dmp4ODNvRmpLTldoRExuUkhDQUc1NjBCRUJlalh2SGVPanVqMnlDTjJhZEhsZ2Y2anlGMnYtblpQSkFENk80bHE2blpFa1loMzNUVmZudUl4ejdJM3VHVktXXzNXZWpxdTk1R3dVbnZ2dTB6SzdzcUFza3NuRGFJSWs4dFhyOTRod1dPd2tNNWZRUWVDb0I3NjExRG9NeUtrMU1GT2VsZjhablRZcEdyUjlmaUZFUWItOUxmR0ZFcUJuTmJpdkZhYnJmMWJpMmkwZkpMSVp2NFFYS2tfUnZZMkZhdHRkXzF2ZXBmZ095XzVRcGE1QXdNOHpwQzNIa0pqNXJqTEZyT0RIVllIQWZoQjNnYm9qZFhvb05EeHZHZlkxN3lpdURSRXoxN2RNOVZGamhLQjdud2NJbmlObUplWElidEpZaDd5UzlEODNkOUQwall5SUZwcGVFdXh6SXMwQ29EY3VTOENiY3ZlZlBIa0NwdDJJYUttM1JfZ2cxTGdVMVBON253UzB6Z1pjb2dTbGtTcXppRHNvbUYtVzNyR0c4TzNib3dsdUdyZDZwQzllOXpBdTNJbFpQNGpMeFhBVTkwb2VROUZlMkpabUlHeElmSmNuaXh6U3lPNFA3OXZNYkFtcXpmX0RFbkRaRGRlMEhXaVBTbXlYWGM9', 'iss': 'https://sso.isprambiente.it', 'client_id': 'provadiinserimento'}
2023-10-13 18:38:22,614 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-13 18:38:22,614 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-13 18:38:22,615 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxLWEotNWp6OFdfNno2ZDQ4Qy1TMEtnblZYbTZWbHRSbnZ3TDVraTE4Q0VqaWJacE5lOEllWFFBSFJvMEZsbE1xMXhZNjRUTXkxQkE2dW5PWGMyRzZTc2VXanlXTGJwMWt5eUJ6VE5TTVlFYUJqUWdWT3o1dFZLamZlOXFBSHhhdG9HcG1vVGtaSUNmbXFldW5qU1d2NFRYX3J3OXdqT0FJQlBfYmhVLVZucks4RWlWUjZ4ak8zNlRFUDE5dmp4ODNvRmpLTldoRExuUkhDQUc1NjBCRUJlalh2SGVPanVqMnlDTjJhZEhsZ2Y2anlGMnYtblpQSkFENk80bHE2blpFa1loMzNUVmZudUl4ejdJM3VHVktXXzNXZWpxdTk1R3dVbnZ2dTB6SzdzcUFza3NuRGFJSWs4dFhyOTRod1dPd2tNNWZRUWVDb0I3NjExRG9NeUtrMU1GT2VsZjhablRZcEdyUjlmaUZFUWItOUxmR0ZFcUJuTmJpdkZhYnJmMWJpMmkwZkpMSVp2NFFYS2tfUnZZMkZhdHRkXzF2ZXBmZ095XzVRcGE1QXdNOHpwQzNIa0pqNXJqTEZyT0RIVllIQWZoQjNnYm9qZFhvb05EeHZHZlkxN3lpdURSRXoxN2RNOVZGamhLQjdud2NJbmlObUplWElidEpZaDd5UzlEODNkOUQwall5SUZwcGVFdXh6SXMwQ29EY3VTOENiY3ZlZlBIa0NwdDJJYUttM1JfZ2cxTGdVMVBON253UzB6Z1pjb2dTbGtTcXppRHNvbUYtVzNyR0c4TzNib3dsdUdyZDZwQzllOXpBdTNJbFpQNGpMeFhBVTkwb2VROUZlMkpabUlHeElmSmNuaXh6U3lPNFA3OXZNYkFtcXpmX0RFbkRaRGRlMEhXaVBTbXlYWGM9', 'state': 'xLxp9oIvezv5IayOb4jVFGw9QweCoTzL', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'provadiinserimento', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-13 18:38:22,615 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'provadiinserimento', 'state': 'xLxp9oIvezv5IayOb4jVFGw9QweCoTzL', 'code': 'Z0FBQUFBQmxLWEotNWp6OFdfNno2ZDQ4Qy1TMEtnblZYbTZWbHRSbnZ3TDVraTE4Q0VqaWJacE5lOEllWFFBSFJvMEZsbE1xMXhZNjRUTXkxQkE2dW5PWGMyRzZTc2VXanlXTGJwMWt5eUJ6VE5TTVlFYUJqUWdWT3o1dFZLamZlOXFBSHhhdG9HcG1vVGtaSUNmbXFldW5qU1d2NFRYX3J3OXdqT0FJQlBfYmhVLVZucks4RWlWUjZ4ak8zNlRFUDE5dmp4ODNvRmpLTldoRExuUkhDQUc1NjBCRUJlalh2SGVPanVqMnlDTjJhZEhsZ2Y2anlGMnYtblpQSkFENk80bHE2blpFa1loMzNUVmZudUl4ejdJM3VHVktXXzNXZWpxdTk1R3dVbnZ2dTB6SzdzcUFza3NuRGFJSWs4dFhyOTRod1dPd2tNNWZRUWVDb0I3NjExRG9NeUtrMU1GT2VsZjhablRZcEdyUjlmaUZFUWItOUxmR0ZFcUJuTmJpdkZhYnJmMWJpMmkwZkpMSVp2NFFYS2tfUnZZMkZhdHRkXzF2ZXBmZ095XzVRcGE1QXdNOHpwQzNIa0pqNXJqTEZyT0RIVllIQWZoQjNnYm9qZFhvb05EeHZHZlkxN3lpdURSRXoxN2RNOVZGamhLQjdud2NJbmlObUplWElidEpZaDd5UzlEODNkOUQwall5SUZwcGVFdXh6SXMwQ29EY3VTOENiY3ZlZlBIa0NwdDJJYUttM1JfZ2cxTGdVMVBON253UzB6Z1pjb2dTbGtTcXppRHNvbUYtVzNyR0c4TzNib3dsdUdyZDZwQzllOXpBdTNJbFpQNGpMeFhBVTkwb2VROUZlMkpabUlHeElmSmNuaXh6U3lPNFA3OXZNYkFtcXpmX0RFbkRaRGRlMEhXaVBTbXlYWGM9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'MMP9JIho8gMlx1WHvqoeuZQG8XjCN09YOE9AYktHwW39VWFI4iFUPsoENQEvBGmM'}
2023-10-13 18:38:22,615 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-13 18:38:22,616 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f1f57431990>, 'url': 'https://sso.isprambiente.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=xLxp9oIvezv5IayOb4jVFGw9QweCoTzL&code=Z0FBQUFBQmxLWEotNWp6OFdfNno2ZDQ4Qy1TMEtnblZYbTZWbHRSbnZ3TDVraTE4Q0VqaWJacE5lOEllWFFBSFJvMEZsbE1xMXhZNjRUTXkxQkE2dW5PWGMyRzZTc2VXanlXTGJwMWt5eUJ6VE5TTVlFYUJqUWdWT3o1dFZLamZlOXFBSHhhdG9HcG1vVGtaSUNmbXFldW5qU1d2NFRYX3J3OXdqT0FJQlBfYmhVLVZucks4RWlWUjZ4ak8zNlRFUDE5dmp4ODNvRmpLTldoRExuUkhDQUc1NjBCRUJlalh2SGVPanVqMnlDTjJhZEhsZ2Y2anlGMnYtblpQSkFENk80bHE2blpFa1loMzNUVmZudUl4ejdJM3VHVktXXzNXZWpxdTk1R3dVbnZ2dTB6SzdzcUFza3NuRGFJSWs4dFhyOTRod1dPd2tNNWZRUWVDb0I3NjExRG9NeUtrMU1GT2VsZjhablRZcEdyUjlmaUZFUWItOUxmR0ZFcUJuTmJpdkZhYnJmMWJpMmkwZkpMSVp2NFFYS2tfUnZZMkZhdHRkXzF2ZXBmZ095XzVRcGE1QXdNOHpwQzNIa0pqNXJqTEZyT0RIVllIQWZoQjNnYm9qZFhvb05EeHZHZlkxN3lpdURSRXoxN2RNOVZGamhLQjdud2NJbmlObUplWElidEpZaDd5UzlEODNkOUQwall5SUZwcGVFdXh6SXMwQ29EY3VTOENiY3ZlZlBIa0NwdDJJYUttM1JfZ2cxTGdVMVBON253UzB6Z1pjb2dTbGtTcXppRHNvbUYtVzNyR0c4TzNib3dsdUdyZDZwQzllOXpBdTNJbFpQNGpMeFhBVTkwb2VROUZlMkpabUlHeElmSmNuaXh6U3lPNFA3OXZNYkFtcXpmX0RFbkRaRGRlMEhXaVBTbXlYWGM9&code_verifier=MMP9JIho8gMlx1WHvqoeuZQG8XjCN09YOE9AYktHwW39VWFI4iFUPsoENQEvBGmM', 'headers': {'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-13 18:38:22,616 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=provadiinserimento&state=xLxp9oIvezv5IayOb4jVFGw9QweCoTzL&code=Z0FBQUFBQmxLWEotNWp6OFdfNno2ZDQ4Qy1TMEtnblZYbTZWbHRSbnZ3TDVraTE4Q0VqaWJacE5lOEllWFFBSFJvMEZsbE1xMXhZNjRUTXkxQkE2dW5PWGMyRzZTc2VXanlXTGJwMWt5eUJ6VE5TTVlFYUJqUWdWT3o1dFZLamZlOXFBSHhhdG9HcG1vVGtaSUNmbXFldW5qU1d2NFRYX3J3OXdqT0FJQlBfYmhVLVZucks4RWlWUjZ4ak8zNlRFUDE5dmp4ODNvRmpLTldoRExuUkhDQUc1NjBCRUJlalh2SGVPanVqMnlDTjJhZEhsZ2Y2anlGMnYtblpQSkFENk80bHE2blpFa1loMzNUVmZudUl4ejdJM3VHVktXXzNXZWpxdTk1R3dVbnZ2dTB6SzdzcUFza3NuRGFJSWs4dFhyOTRod1dPd2tNNWZRUWVDb0I3NjExRG9NeUtrMU1GT2VsZjhablRZcEdyUjlmaUZFUWItOUxmR0ZFcUJuTmJpdkZhYnJmMWJpMmkwZkpMSVp2NFFYS2tfUnZZMkZhdHRkXzF2ZXBmZ095XzVRcGE1QXdNOHpwQzNIa0pqNXJqTEZyT0RIVllIQWZoQjNnYm9qZFhvb05EeHZHZlkxN3lpdURSRXoxN2RNOVZGamhLQjdud2NJbmlObUplWElidEpZaDd5UzlEODNkOUQwall5SUZwcGVFdXh6SXMwQ29EY3VTOENiY3ZlZlBIa0NwdDJJYUttM1JfZ2cxTGdVMVBON253UzB6Z1pjb2dTbGtTcXppRHNvbUYtVzNyR0c4TzNib3dsdUdyZDZwQzllOXpBdTNJbFpQNGpMeFhBVTkwb2VROUZlMkpabUlHeElmSmNuaXh6U3lPNFA3OXZNYkFtcXpmX0RFbkRaRGRlMEhXaVBTbXlYWGM9&code_verifier=MMP9JIho8gMlx1WHvqoeuZQG8XjCN09YOE9AYktHwW39VWFI4iFUPsoENQEvBGmM, https_args:{'Authorization': 'Basic cHJvdmFkaWluc2VyaW1lbnRvOjE5Y2M2OWI3MGQwMTA4ZjYzMGU1MmY3MmY3YTNiZDM3YmE0ZTExNjc4YWQxYTc0MzRlOTgxOGUx', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-13 18:38:22,618 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 18:38:23,188 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-13 18:38:23,190 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 18:38:23,190 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 18:38:23,190 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 16:38:23 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACUTwgOSbCAjbzwcYsp0Elk-G8zgsIXkk5ebegPv1I3i0vsNyB8pqlVDw18K5aer7u0AIlaHctlk2T_IcjR6mO0UFLmTeKqAyuw39X6q8IfnofI4ITZz6-hK6pa_JJf4HjcHqCbsUVXp-O9tvhtmsiaqBRPaXnJKH8gX5ccv5tFVqEYuPn3wwNCd1xdoAo5lBqdBR8jScrQfN5mshlFz7k1Qos2CisXyJ8bfEMkydYrjbi8G8qXwZGEAJtPO2ILpeS0AAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACUTwgOSbCAjbzwcYsp0Elk-G8zgsIXkk5ebegPv1I3i0vsNyB8pqlVDw18K5aer7u0AIlaHctlk2T_IcjR6mO0UFLmTeKqAyuw39X6q8IfnofI4ITZz6-hK6pa_JJf4HjcHqCbsUVXp-O9tvhtmsiaqBRPaXnJKH8gX5ccv5tFVqEYuPn3wwNCd1xdoAo5lBqdBR8jScrQfN5mshlFz7k1Qos2CisXyJ8bfEMkydYrjbi8G8qXwZGEAJtPO2ILpeS0AAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 18:38:23,190 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjAxNGQyZTE0M2FkNTQyZDdiZjRkZjVhMmEwNGVjM2U5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFdFb3RRMjFFYkhJME1uUkJiMkpSWmpGeFYwZFBMVWh6TXpsVWNXaGZRVXh6ZG5ad1pHWjJhazFVVjJkT1drNVliSGhOY0d4RloyaDJjVzVOZW10ZmJWRlVhR05XZFc5SmQyOURNR3BLUkY5UGVIZE5RMEZTWVRGTU56UXhVblE1YjIxUlNsWTRNVE5YVWtjMVRtaGhiMjlJY1Y5UmJteGtVRVpsVDNrM1RURTVjalZHWDBaRWNGOU5YMUI2VGw5WFUyUnJRVWhMYm5sUmFUUjBWRWxtYTNkYU4zaFpkVmhsVjNsRWNqRTVUa2RmZG5ObmFWZE5SbE5VVW5aaWJISkNOemxaZEVkMFVXSmlPWGN0WkVoNVl6VnNWMjF3VlU4MGFYRnphV0Z1TWxjeFZIaHphVlJGVFZSWE16VkJhVFZwTVVVMVgzTklkbko0ZW05VWJIbzBSVUV0TFE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjE1MTAzLCAiZXhwIjogMTY5NzIxODcwM30.h0CtOZIgq9mhqLuCS8L7RU-_aPETOqgFmH74gSB1QIstjDzuQrnUgY-dRH0eR48fM5vC2Qd3JhI9VgbANS7IcQ", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLWEpfVGgwMkhmU0NISEVMbGY3UjI3Q0daRFVpaXJXX0thWS05V1FaSWVoQUY1N2hyc1dtM3RCRmJFbXEyMkZfMVRyYXBxUGtzQ1JvekcwWEs4WFQ4R1RBZ2duTEJNTFlJd2NhSmxOazZYQTltVEplLWVaNE1CNDY0ckMyMFBacENuVnZrcjE5SU1lSWR4TDJqWllnUklSb3NKU0VxcldMRmpTTkpSSnc2WDVzcFQ3V3lkYWhLQWNyZWwwM0xHUGh5eGs4eGZEUkZUOUIzYTR5V1IwMkdHUVlmYkxkUVJUUUs4LU1oRzlWSVByZ0V1MHZFQ3lpUWhCUmVlY2ZJN0lrMWhlVVIxMmRiaFZIN0pUSm1kei00QWpubzFkTENudVprQ0Y1LWJDbHo0Tkhoc3FTYkZNcDBFRjA2UGx6Q3B2bjhLTUZJdnh5aklTajFrNlFKTGNhTDBmdGdsbnJtSld2WmZ6ZDdHUkdURExKWnZuUlU1UHRBZXNQUUs1Mnl3czB5Y3JkYW9XeVdmdEstTDdSbjBmZlVScXlNdVhZRzJfeGN2empuQnBCQlF6c19rQjBtd2dRMnNwTUV0V1dPSTgwOFk0VnhrTUFySGsyOUZhcXdZZnYxMlN2SUdOdjhuSDQ5LUdZeFhKWURENlRGX1hLcFJOYkJpTnpGVVlaWUNfMzBma1dILVBIb2JGS1VqRTVndndBX0I4UGRvaGN2ZXI4NUkzYm1HalZ0bUZFblJlYkxTOVNCb0dtRUt1SzhfZHFtTVgxOXJPYkY3aGMtME94ZXV4bkpxcUxSRUJBMWNoZjVubU96WGxBcDl6R1NIOUwyTXV5bXdoc1RyWUQ5SS1CcWFxZ19peHRQUWVyLXVQMElxS2k1S201TWQzbkFUUnI3SHFETTlSeUdIMkhNSWc9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik0wVnNjazE0UkdOQ1MyeHpTSFJGVGpoUWVIVkJVbkZFYWxabVZEaDViblZQVDFaTVZYSjVjMnMzU1EifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMV0VvdFEyMUViSEkwTW5SQmIySlJaakZ4VjBkUExVaHpNemxVY1doZlFVeHpkblp3WkdaMmFrMVVWMmRPV2s1WWJIaE5jR3hGWjJoMmNXNU5lbXRmYlZGVWFHTldkVzlKZDI5RE1HcEtSRjlQZUhkTlEwRlNZVEZNTnpReFVuUTViMjFSU2xZNE1UTlhVa2MxVG1oaGIyOUljVjlSYm14a1VFWmxUM2szVFRFNWNqVkdYMFpFY0Y5TlgxQjZUbDlYVTJSclFVaExibmxSYVRSMFZFbG1hM2RhTjNoWmRWaGxWM2xFY2pFNVRrZGZkbk5uYVZkTlJsTlVVblppYkhKQ056bFpkRWQwVVdKaU9YY3RaRWg1WXpWc1YyMXdWVTgwYVhGemFXRnVNbGN4VkhoemFWUkZUVlJYTXpWQmFUVnBNVVUxWDNOSWRuSjRlbTlVYkhvMFJVRXRMUT09IiwgImF1dGhfdGltZSI6IDE2OTcyMTUxMDIsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogImVjY2IyNGYzNjllNjExZWU5NmMyMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAiZEhyVVU0ckJpMGxjeHRIZ2gxOEdESVBUIiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIxNTEwMywgImV4cCI6IDE2OTcyMTU0MDMsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.Ro-91kpg_8gysFurmG3Mt78XZ-e8kTmOBawWd75VgtJFEnkHmYIpOzlKP_ySh7tMWPUtZcyNmGaseCS0W7z3upS51DFrZY4J_8rctfMskhQdbQxjLQob0fi-hWD_Lr-Nk0jIP_hVhoD80HpZ0llBx7vRcj2vJExyrWfHE9c3VQg0Eqv2iUSekk8DxFpxyYUrXkPqf22w097THUtr2E_PVI9JIo-s8rKouhglLHPPoRwEs_lueGeKOLn3FE36WQUbVufjg21ZUVwEGArU_osDt-zEZKgMDoCJ2vzAyg4yc3yMfWBl7tVC1T8HQHONxtvmcoS7NPuuxZF7nU6mrKRbAw"}
2023-10-13 18:38:23,191 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjAxNGQyZTE0M2FkNTQyZDdiZjRkZjVhMmEwNGVjM2U5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFdFb3RRMjFFYkhJME1uUkJiMkpSWmpGeFYwZFBMVWh6TXpsVWNXaGZRVXh6ZG5ad1pHWjJhazFVVjJkT1drNVliSGhOY0d4RloyaDJjVzVOZW10ZmJWRlVhR05XZFc5SmQyOURNR3BLUkY5UGVIZE5RMEZTWVRGTU56UXhVblE1YjIxUlNsWTRNVE5YVWtjMVRtaGhiMjlJY1Y5UmJteGtVRVpsVDNrM1RURTVjalZHWDBaRWNGOU5YMUI2VGw5WFUyUnJRVWhMYm5sUmFUUjBWRWxtYTNkYU4zaFpkVmhsVjNsRWNqRTVUa2RmZG5ObmFWZE5SbE5VVW5aaWJISkNOemxaZEVkMFVXSmlPWGN0WkVoNVl6VnNWMjF3VlU4MGFYRnphV0Z1TWxjeFZIaHphVlJGVFZSWE16VkJhVFZwTVVVMVgzTklkbko0ZW05VWJIbzBSVUV0TFE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjE1MTAzLCAiZXhwIjogMTY5NzIxODcwM30.h0CtOZIgq9mhqLuCS8L7RU-_aPETOqgFmH74gSB1QIstjDzuQrnUgY-dRH0eR48fM5vC2Qd3JhI9VgbANS7IcQ", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxLWEpfVGgwMkhmU0NISEVMbGY3UjI3Q0daRFVpaXJXX0thWS05V1FaSWVoQUY1N2hyc1dtM3RCRmJFbXEyMkZfMVRyYXBxUGtzQ1JvekcwWEs4WFQ4R1RBZ2duTEJNTFlJd2NhSmxOazZYQTltVEplLWVaNE1CNDY0ckMyMFBacENuVnZrcjE5SU1lSWR4TDJqWllnUklSb3NKU0VxcldMRmpTTkpSSnc2WDVzcFQ3V3lkYWhLQWNyZWwwM0xHUGh5eGs4eGZEUkZUOUIzYTR5V1IwMkdHUVlmYkxkUVJUUUs4LU1oRzlWSVByZ0V1MHZFQ3lpUWhCUmVlY2ZJN0lrMWhlVVIxMmRiaFZIN0pUSm1kei00QWpubzFkTENudVprQ0Y1LWJDbHo0Tkhoc3FTYkZNcDBFRjA2UGx6Q3B2bjhLTUZJdnh5aklTajFrNlFKTGNhTDBmdGdsbnJtSld2WmZ6ZDdHUkdURExKWnZuUlU1UHRBZXNQUUs1Mnl3czB5Y3JkYW9XeVdmdEstTDdSbjBmZlVScXlNdVhZRzJfeGN2empuQnBCQlF6c19rQjBtd2dRMnNwTUV0V1dPSTgwOFk0VnhrTUFySGsyOUZhcXdZZnYxMlN2SUdOdjhuSDQ5LUdZeFhKWURENlRGX1hLcFJOYkJpTnpGVVlaWUNfMzBma1dILVBIb2JGS1VqRTVndndBX0I4UGRvaGN2ZXI4NUkzYm1HalZ0bUZFblJlYkxTOVNCb0dtRUt1SzhfZHFtTVgxOXJPYkY3aGMtME94ZXV4bkpxcUxSRUJBMWNoZjVubU96WGxBcDl6R1NIOUwyTXV5bXdoc1RyWUQ5SS1CcWFxZ19peHRQUWVyLXVQMElxS2k1S201TWQzbkFUUnI3SHFETTlSeUdIMkhNSWc9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik0wVnNjazE0UkdOQ1MyeHpTSFJGVGpoUWVIVkJVbkZFYWxabVZEaDViblZQVDFaTVZYSjVjMnMzU1EifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMV0VvdFEyMUViSEkwTW5SQmIySlJaakZ4VjBkUExVaHpNemxVY1doZlFVeHpkblp3WkdaMmFrMVVWMmRPV2s1WWJIaE5jR3hGWjJoMmNXNU5lbXRmYlZGVWFHTldkVzlKZDI5RE1HcEtSRjlQZUhkTlEwRlNZVEZNTnpReFVuUTViMjFSU2xZNE1UTlhVa2MxVG1oaGIyOUljVjlSYm14a1VFWmxUM2szVFRFNWNqVkdYMFpFY0Y5TlgxQjZUbDlYVTJSclFVaExibmxSYVRSMFZFbG1hM2RhTjNoWmRWaGxWM2xFY2pFNVRrZGZkbk5uYVZkTlJsTlVVblppYkhKQ056bFpkRWQwVVdKaU9YY3RaRWg1WXpWc1YyMXdWVTgwYVhGemFXRnVNbGN4VkhoemFWUkZUVlJYTXpWQmFUVnBNVVUxWDNOSWRuSjRlbTlVYkhvMFJVRXRMUT09IiwgImF1dGhfdGltZSI6IDE2OTcyMTUxMDIsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogImVjY2IyNGYzNjllNjExZWU5NmMyMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAiZEhyVVU0ckJpMGxjeHRIZ2gxOEdESVBUIiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIxNTEwMywgImV4cCI6IDE2OTcyMTU0MDMsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.Ro-91kpg_8gysFurmG3Mt78XZ-e8kTmOBawWd75VgtJFEnkHmYIpOzlKP_ySh7tMWPUtZcyNmGaseCS0W7z3upS51DFrZY4J_8rctfMskhQdbQxjLQob0fi-hWD_Lr-Nk0jIP_hVhoD80HpZ0llBx7vRcj2vJExyrWfHE9c3VQg0Eqv2iUSekk8DxFpxyYUrXkPqf22w097THUtr2E_PVI9JIo-s8rKouhglLHPPoRwEs_lueGeKOLn3FE36WQUbVufjg21ZUVwEGArU_osDt-zEZKgMDoCJ2vzAyg4yc3yMfWBl7tVC1T8HQHONxtvmcoS7NPuuxZF7nU6mrKRbAw"}
2023-10-13 18:38:23,191 oidcrp.service DEBUG response format: json
2023-10-13 18:38:23,191 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-13 18:38:23,191 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjAxNGQyZTE0M2FkNTQyZDdiZjRkZjVhMmEwNGVjM2U5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFdFb3RRMjFFYkhJME1uUkJiMkpSWmpGeFYwZFBMVWh6TXpsVWNXaGZRVXh6ZG5ad1pHWjJhazFVVjJkT1drNVliSGhOY0d4RloyaDJjVzVOZW10ZmJWRlVhR05XZFc5SmQyOURNR3BLUkY5UGVIZE5RMEZTWVRGTU56UXhVblE1YjIxUlNsWTRNVE5YVWtjMVRtaGhiMjlJY1Y5UmJteGtVRVpsVDNrM1RURTVjalZHWDBaRWNGOU5YMUI2VGw5WFUyUnJRVWhMYm5sUmFUUjBWRWxtYTNkYU4zaFpkVmhsVjNsRWNqRTVUa2RmZG5ObmFWZE5SbE5VVW5aaWJISkNOemxaZEVkMFVXSmlPWGN0WkVoNVl6VnNWMjF3VlU4MGFYRnphV0Z1TWxjeFZIaHphVlJGVFZSWE16VkJhVFZwTVVVMVgzTklkbko0ZW05VWJIbzBSVUV0TFE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjE1MTAzLCAiZXhwIjogMTY5NzIxODcwM30.h0CtOZIgq9mhqLuCS8L7RU-_aPETOqgFmH74gSB1QIstjDzuQrnUgY-dRH0eR48fM5vC2Qd3JhI9VgbANS7IcQ', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxLWEpfVGgwMkhmU0NISEVMbGY3UjI3Q0daRFVpaXJXX0thWS05V1FaSWVoQUY1N2hyc1dtM3RCRmJFbXEyMkZfMVRyYXBxUGtzQ1JvekcwWEs4WFQ4R1RBZ2duTEJNTFlJd2NhSmxOazZYQTltVEplLWVaNE1CNDY0ckMyMFBacENuVnZrcjE5SU1lSWR4TDJqWllnUklSb3NKU0VxcldMRmpTTkpSSnc2WDVzcFQ3V3lkYWhLQWNyZWwwM0xHUGh5eGs4eGZEUkZUOUIzYTR5V1IwMkdHUVlmYkxkUVJUUUs4LU1oRzlWSVByZ0V1MHZFQ3lpUWhCUmVlY2ZJN0lrMWhlVVIxMmRiaFZIN0pUSm1kei00QWpubzFkTENudVprQ0Y1LWJDbHo0Tkhoc3FTYkZNcDBFRjA2UGx6Q3B2bjhLTUZJdnh5aklTajFrNlFKTGNhTDBmdGdsbnJtSld2WmZ6ZDdHUkdURExKWnZuUlU1UHRBZXNQUUs1Mnl3czB5Y3JkYW9XeVdmdEstTDdSbjBmZlVScXlNdVhZRzJfeGN2empuQnBCQlF6c19rQjBtd2dRMnNwTUV0V1dPSTgwOFk0VnhrTUFySGsyOUZhcXdZZnYxMlN2SUdOdjhuSDQ5LUdZeFhKWURENlRGX1hLcFJOYkJpTnpGVVlaWUNfMzBma1dILVBIb2JGS1VqRTVndndBX0I4UGRvaGN2ZXI4NUkzYm1HalZ0bUZFblJlYkxTOVNCb0dtRUt1SzhfZHFtTVgxOXJPYkY3aGMtME94ZXV4bkpxcUxSRUJBMWNoZjVubU96WGxBcDl6R1NIOUwyTXV5bXdoc1RyWUQ5SS1CcWFxZ19peHRQUWVyLXVQMElxS2k1S201TWQzbkFUUnI3SHFETTlSeUdIMkhNSWc9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Ik0wVnNjazE0UkdOQ1MyeHpTSFJGVGpoUWVIVkJVbkZFYWxabVZEaDViblZQVDFaTVZYSjVjMnMzU1EifQ.eyJzdWIiOiAiNWM5ZTNkMjYyMGFjNzBmZjM3YjZkYzFjNTUxZTA5Mjc1Y2Q0ZjJmOTNlNGE2MjUzNTBjZmMzNmQ4MDRjNzYxOSIsICJzaWQiOiAiWjBGQlFVRkJRbXhMV0VvdFEyMUViSEkwTW5SQmIySlJaakZ4VjBkUExVaHpNemxVY1doZlFVeHpkblp3WkdaMmFrMVVWMmRPV2s1WWJIaE5jR3hGWjJoMmNXNU5lbXRmYlZGVWFHTldkVzlKZDI5RE1HcEtSRjlQZUhkTlEwRlNZVEZNTnpReFVuUTViMjFSU2xZNE1UTlhVa2MxVG1oaGIyOUljVjlSYm14a1VFWmxUM2szVFRFNWNqVkdYMFpFY0Y5TlgxQjZUbDlYVTJSclFVaExibmxSYVRSMFZFbG1hM2RhTjNoWmRWaGxWM2xFY2pFNVRrZGZkbk5uYVZkTlJsTlVVblppYkhKQ056bFpkRWQwVVdKaU9YY3RaRWg1WXpWc1YyMXdWVTgwYVhGemFXRnVNbGN4VkhoemFWUkZUVlJYTXpWQmFUVnBNVVUxWDNOSWRuSjRlbTlVYkhvMFJVRXRMUT09IiwgImF1dGhfdGltZSI6IDE2OTcyMTUxMDIsICJhY3IiOiAiaHR0cHM6Ly93d3cuc3BpZC5nb3YuaXQvU3BpZEwyIiwgInNjb3BlIjogWyJvcGVuaWQiLCAicHJvZmlsZSIsICJvZmZsaW5lX2FjY2VzcyJdLCAianRpIjogImVjY2IyNGYzNjllNjExZWU5NmMyMDI0MmMwYThiMDAzIiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAibm9uY2UiOiAiZEhyVVU0ckJpMGxjeHRIZ2gxOEdESVBUIiwgImlzcyI6ICJodHRwczovL3Nzby5pc3ByYW1iaWVudGUuaXQiLCAiaWF0IjogMTY5NzIxNTEwMywgImV4cCI6IDE2OTcyMTU0MDMsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdfQ.Ro-91kpg_8gysFurmG3Mt78XZ-e8kTmOBawWd75VgtJFEnkHmYIpOzlKP_ySh7tMWPUtZcyNmGaseCS0W7z3upS51DFrZY4J_8rctfMskhQdbQxjLQob0fi-hWD_Lr-Nk0jIP_hVhoD80HpZ0llBx7vRcj2vJExyrWfHE9c3VQg0Eqv2iUSekk8DxFpxyYUrXkPqf22w097THUtr2E_PVI9JIo-s8rKouhglLHPPoRwEs_lueGeKOLn3FE36WQUbVufjg21ZUVwEGArU_osDt-zEZKgMDoCJ2vzAyg4yc3yMfWBl7tVC1T8HQHONxtvmcoS7NPuuxZF7nU6mrKRbAw'}"
2023-10-13 18:38:23,192 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15}
2023-10-13 18:38:23,192 oidcmsg.message DEBUG Raw JSON: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLWEotQ21EbHI0MnRBb2JRZjFxV0dPLUhzMzlUcWhfQUxzdnZwZGZ2ak1UV2dOWk5YbHhNcGxFZ2h2cW5NemtfbVFUaGNWdW9Jd29DMGpKRF9PeHdNQ0FSYTFMNzQxUnQ5b21RSlY4MTNXUkc1Tmhhb29IcV9RbmxkUEZlT3k3TTE5cjVGX0ZEcF9NX1B6Tl9XU2RrQUhLbnlRaTR0VElma3daN3hZdVhlV3lEcjE5TkdfdnNnaVdNRlNUUnZibHJCNzlZdEd0UWJiOXctZEh5YzVsV21wVU80aXFzaWFuMlcxVHhzaVRFTVRXMzVBaTVpMUU1X3NIdnJ4em9UbHo0RUEtLQ==', 'auth_time': 1697215102, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'eccb24f369e611ee96c20242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': 'dHrUU4rBi0lcxtHgh18GDIPT', 'iss': 'https://sso.isprambiente.it', 'iat': 1697215103, 'exp': 1697215403, 'aud': ['provadiinserimento']}
2023-10-13 18:38:23,192 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ'}
2023-10-13 18:38:23,193 cryptojwt.key_jar DEBUG Key summary for https://sso.isprambiente.it: RSA:sig:M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ, EC:sig:ZksweGVJOGdMWW5uRXJ4Wkt4SS1PdkI0ZjNLblA4YzBVUmpmQ0xueVlRdw
2023-10-13 18:38:23,193 oidcmsg.message DEBUG Found signing key.
2023-10-13 18:38:23,193 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-13 18:38:23,193 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ and use=
2023-10-13 18:38:23,193 cryptojwt.jwx DEBUG Picked: kid:M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ, use:sig, kty:RSA
2023-10-13 18:38:23,194 cryptojwt.jws.jws DEBUG Verified message using key with kid=M0Vsck14RGNCS2xzSHRFTjhQeHVBUnFEalZmVDh5bnVPT1ZMVXJ5c2s3SQ
2023-10-13 18:38:23,195 oidcmsg.oidc INFO Verified id_token: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLWEotQ21EbHI0MnRBb2JRZjFxV0dPLUhzMzlUcWhfQUxzdnZwZGZ2ak1UV2dOWk5YbHhNcGxFZ2h2cW5NemtfbVFUaGNWdW9Jd29DMGpKRF9PeHdNQ0FSYTFMNzQxUnQ5b21RSlY4MTNXUkc1Tmhhb29IcV9RbmxkUEZlT3k3TTE5cjVGX0ZEcF9NX1B6Tl9XU2RrQUhLbnlRaTR0VElma3daN3hZdVhlV3lEcjE5TkdfdnNnaVdNRlNUUnZibHJCNzlZdEd0UWJiOXctZEh5YzVsV21wVU80aXFzaWFuMlcxVHhzaVRFTVRXMzVBaTVpMUU1X3NIdnJ4em9UbHo0RUEtLQ==', 'auth_time': 1697215102, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'eccb24f369e611ee96c20242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': 'dHrUU4rBi0lcxtHgh18GDIPT', 'iss': 'https://sso.isprambiente.it', 'iat': 1697215103, 'exp': 1697215403, 'aud': ['provadiinserimento']}
2023-10-13 18:38:23,198 oidcrp.rp_handler DEBUG ID Token: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'sid': 'Z0FBQUFBQmxLWEotQ21EbHI0MnRBb2JRZjFxV0dPLUhzMzlUcWhfQUxzdnZwZGZ2ak1UV2dOWk5YbHhNcGxFZ2h2cW5NemtfbVFUaGNWdW9Jd29DMGpKRF9PeHdNQ0FSYTFMNzQxUnQ5b21RSlY4MTNXUkc1Tmhhb29IcV9RbmxkUEZlT3k3TTE5cjVGX0ZEcF9NX1B6Tl9XU2RrQUhLbnlRaTR0VElma3daN3hZdVhlV3lEcjE5TkdfdnNnaVdNRlNUUnZibHJCNzlZdEd0UWJiOXctZEh5YzVsV21wVU80aXFzaWFuMlcxVHhzaVRFTVRXMzVBaTVpMUU1X3NIdnJ4em9UbHo0RUEtLQ==', 'auth_time': 1697215102, 'acr': 'https://www.spid.gov.it/SpidL2', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'eccb24f369e611ee96c20242c0a8b003', 'client_id': 'provadiinserimento', 'nonce': 'dHrUU4rBi0lcxtHgh18GDIPT', 'iss': 'https://sso.isprambiente.it', 'iat': 1697215103, 'exp': 1697215403, 'aud': ['provadiinserimento']}
2023-10-13 18:38:23,198 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-13 18:38:23,198 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjAxNGQyZTE0M2FkNTQyZDdiZjRkZjVhMmEwNGVjM2U5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFdFb3RRMjFFYkhJME1uUkJiMkpSWmpGeFYwZFBMVWh6TXpsVWNXaGZRVXh6ZG5ad1pHWjJhazFVVjJkT1drNVliSGhOY0d4RloyaDJjVzVOZW10ZmJWRlVhR05XZFc5SmQyOURNR3BLUkY5UGVIZE5RMEZTWVRGTU56UXhVblE1YjIxUlNsWTRNVE5YVWtjMVRtaGhiMjlJY1Y5UmJteGtVRVpsVDNrM1RURTVjalZHWDBaRWNGOU5YMUI2VGw5WFUyUnJRVWhMYm5sUmFUUjBWRWxtYTNkYU4zaFpkVmhsVjNsRWNqRTVUa2RmZG5ObmFWZE5SbE5VVW5aaWJISkNOemxaZEVkMFVXSmlPWGN0WkVoNVl6VnNWMjF3VlU4MGFYRnphV0Z1TWxjeFZIaHphVlJGVFZSWE16VkJhVFZwTVVVMVgzTklkbko0ZW05VWJIbzBSVUV0TFE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjE1MTAzLCAiZXhwIjogMTY5NzIxODcwM30.h0CtOZIgq9mhqLuCS8L7RU-_aPETOqgFmH74gSB1QIstjDzuQrnUgY-dRH0eR48fM5vC2Qd3JhI9VgbANS7IcQ'}
2023-10-13 18:38:23,198 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-13 18:38:23,198 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f1f58db4a50>, 'url': 'https://sso.isprambiente.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjAxNGQyZTE0M2FkNTQyZDdiZjRkZjVhMmEwNGVjM2U5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFdFb3RRMjFFYkhJME1uUkJiMkpSWmpGeFYwZFBMVWh6TXpsVWNXaGZRVXh6ZG5ad1pHWjJhazFVVjJkT1drNVliSGhOY0d4RloyaDJjVzVOZW10ZmJWRlVhR05XZFc5SmQyOURNR3BLUkY5UGVIZE5RMEZTWVRGTU56UXhVblE1YjIxUlNsWTRNVE5YVWtjMVRtaGhiMjlJY1Y5UmJteGtVRVpsVDNrM1RURTVjalZHWDBaRWNGOU5YMUI2VGw5WFUyUnJRVWhMYm5sUmFUUjBWRWxtYTNkYU4zaFpkVmhsVjNsRWNqRTVUa2RmZG5ObmFWZE5SbE5VVW5aaWJISkNOemxaZEVkMFVXSmlPWGN0WkVoNVl6VnNWMjF3VlU4MGFYRnphV0Z1TWxjeFZIaHphVlJGVFZSWE16VkJhVFZwTVVVMVgzTklkbko0ZW05VWJIbzBSVUV0TFE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjE1MTAzLCAiZXhwIjogMTY5NzIxODcwM30.h0CtOZIgq9mhqLuCS8L7RU-_aPETOqgFmH74gSB1QIstjDzuQrnUgY-dRH0eR48fM5vC2Qd3JhI9VgbANS7IcQ'}}
2023-10-13 18:38:23,199 oidcrp.oauth2 DEBUG Doing request with: URL:https://sso.isprambiente.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6Ilprc3dlR1ZKT0dkTVdXNXVSWEo0V2t0NFNTMVBka0kwWmpOTGJsQTRZekJWVW1wbVEweHVlVmxSZHcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbInByb3ZhZGlpbnNlcmltZW50byJdLCAianRpIjogIjAxNGQyZTE0M2FkNTQyZDdiZjRkZjVhMmEwNGVjM2U5IiwgImNsaWVudF9pZCI6ICJwcm92YWRpaW5zZXJpbWVudG8iLCAic3ViIjogIjVjOWUzZDI2MjBhYzcwZmYzN2I2ZGMxYzU1MWUwOTI3NWNkNGYyZjkzZTRhNjI1MzUwY2ZjMzZkODA0Yzc2MTkiLCAic2lkIjogIlowRkJRVUZCUW14TFdFb3RRMjFFYkhJME1uUkJiMkpSWmpGeFYwZFBMVWh6TXpsVWNXaGZRVXh6ZG5ad1pHWjJhazFVVjJkT1drNVliSGhOY0d4RloyaDJjVzVOZW10ZmJWRlVhR05XZFc5SmQyOURNR3BLUkY5UGVIZE5RMEZTWVRGTU56UXhVblE1YjIxUlNsWTRNVE5YVWtjMVRtaGhiMjlJY1Y5UmJteGtVRVpsVDNrM1RURTVjalZHWDBaRWNGOU5YMUI2VGw5WFUyUnJRVWhMYm5sUmFUUjBWRWxtYTNkYU4zaFpkVmhsVjNsRWNqRTVUa2RmZG5ObmFWZE5SbE5VVW5aaWJISkNOemxaZEVkMFVXSmlPWGN0WkVoNVl6VnNWMjF3VlU4MGFYRnphV0Z1TWxjeFZIaHphVlJGVFZSWE16VkJhVFZwTVVVMVgzTklkbko0ZW05VWJIbzBSVUV0TFE9PSIsICJ0b2tlbl9jbGFzcyI6ICJhY2Nlc3NfdG9rZW4iLCAiaXNzIjogImh0dHBzOi8vc3NvLmlzcHJhbWJpZW50ZS5pdCIsICJpYXQiOiAxNjk3MjE1MTAzLCAiZXhwIjogMTY5NzIxODcwM30.h0CtOZIgq9mhqLuCS8L7RU-_aPETOqgFmH74gSB1QIstjDzuQrnUgY-dRH0eR48fM5vC2Qd3JhI9VgbANS7IcQ'}
2023-10-13 18:38:23,200 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): sso.isprambiente.it:443
2023-10-13 18:38:23,740 urllib3.connectionpool DEBUG https://sso.isprambiente.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-13 18:38:23,742 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-13 18:38:23,742 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-13 18:38:23,742 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Fri, 13 Oct 2023 16:38:23 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADidiGeJn2QQGZun9KKnSCLkGzBaddUCH-m70JKDcRCrK3oejB9W_dZkELKbpO0psVcT0HH92YTRXaYXH452E5xWHWVXHmz7Kd42lPGsi85SqviZoJMJhCHMrjJzaVukjR907kUZDbmcbb984PZycqR_rgJSPrAy44ulB93dP0hLdsRUt_kD7WjUIedqCXNlbv8ML1RnveBe_snGylpVoRN6V1FyF7603L9c8e7xJa2EEW3o1y7eJ1YgAAAAAIf8PBLlZP9GAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADidiGeJn2QQGZun9KKnSCLkGzBaddUCH-m70JKDcRCrK3oejB9W_dZkELKbpO0psVcT0HH92YTRXaYXH452E5xWHWVXHmz7Kd42lPGsi85SqviZoJMJhCHMrjJzaVukjR907kUZDbmcbb984PZycqR_rgJSPrAy44ulB93dP0hLdsRUt_kD7WjUIedqCXNlbv8ML1RnveBe_snGylpVoRN6V1FyF7603L9c8e7xJa2EEW3o1y7eJ1YgAAAAAIf8PBLlZP9GAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-13 18:38:23,742 oidcrp.util DEBUG resp.txt: {"sub": "5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619", "name": "ANDREA", "given_name": "ANDREA", "family_name": "RANALDI", "nickname": "RANALDI", "acr": "https://www.spid.gov.it/SpidL2"}
2023-10-13 18:38:23,742 oidcrp.oauth2 DEBUG Successful response: {"sub": "5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619", "name": "ANDREA", "given_name": "ANDREA", "family_name": "RANALDI", "nickname": "RANALDI", "acr": "https://www.spid.gov.it/SpidL2"}
2023-10-13 18:38:23,742 oidcrp.service DEBUG response format: json
2023-10-13 18:38:23,742 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-13 18:38:23,743 oidcrp.service DEBUG Initial response parsing => "{'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'name': 'ANDREA', 'given_name': 'ANDREA', 'family_name': 'RANALDI', 'nickname': 'RANALDI', 'acr': 'https://www.spid.gov.it/SpidL2'}"
2023-10-13 18:38:23,743 oidcrp.service DEBUG Verify response with {'client_id': 'provadiinserimento', 'iss': 'https://sso.isprambiente.it', 'keyjar': <KeyJar(issuers=['', 'https://sso.isprambiente.it'])>, 'verify': True, 'skew': 15}
2023-10-13 18:38:23,745 oidcrp.rp_handler DEBUG UserInfo: {'sub': '5c9e3d2620ac70ff37b6dc1c551e09275cd4f2f93e4a625350cfc36d804c7619', 'name': 'ANDREA', 'given_name': 'ANDREA', 'family_name': 'RANALDI', 'nickname': 'RANALDI', 'acr': 'https://www.spid.gov.it/SpidL2'}
2023-10-13 18:38:23,753 werkzeug INFO 127.0.0.1 - - [13/Oct/2023 18:38:23] "GET /authz_cb/satosa?state=xLxp9oIvezv5IayOb4jVFGw9QweCoTzL&scope=openid+profile+offline_access&code=Z0FBQUFBQmxLWEotNWp6OFdfNno2ZDQ4Qy1TMEtnblZYbTZWbHRSbnZ3TDVraTE4Q0VqaWJacE5lOEllWFFBSFJvMEZsbE1xMXhZNjRUTXkxQkE2dW5PWGMyRzZTc2VXanlXTGJwMWt5eUJ6VE5TTVlFYUJqUWdWT3o1dFZLamZlOXFBSHhhdG9HcG1vVGtaSUNmbXFldW5qU1d2NFRYX3J3OXdqT0FJQlBfYmhVLVZucks4RWlWUjZ4ak8zNlRFUDE5dmp4ODNvRmpLTldoRExuUkhDQUc1NjBCRUJlalh2SGVPanVqMnlDTjJhZEhsZ2Y2anlGMnYtblpQSkFENk80bHE2blpFa1loMzNUVmZudUl4ejdJM3VHVktXXzNXZWpxdTk1R3dVbnZ2dTB6SzdzcUFza3NuRGFJSWs4dFhyOTRod1dPd2tNNWZRUWVDb0I3NjExRG9NeUtrMU1GT2VsZjhablRZcEdyUjlmaUZFUWItOUxmR0ZFcUJuTmJpdkZhYnJmMWJpMmkwZkpMSVp2NFFYS2tfUnZZMkZhdHRkXzF2ZXBmZ095XzVRcGE1QXdNOHpwQzNIa0pqNXJqTEZyT0RIVllIQWZoQjNnYm9qZFhvb05EeHZHZlkxN3lpdURSRXoxN2RNOVZGamhLQjdud2NJbmlObUplWElidEpZaDd5UzlEODNkOUQwall5SUZwcGVFdXh6SXMwQ29EY3VTOENiY3ZlZlBIa0NwdDJJYUttM1JfZ2cxTGdVMVBON253UzB6Z1pjb2dTbGtTcXppRHNvbUYtVzNyR0c4TzNib3dsdUdyZDZwQzllOXpBdTNJbFpQNGpMeFhBVTkwb2VROUZlMkpabUlHeElmSmNuaXh6U3lPNFA3OXZNYkFtcXpmX0RFbkRaRGRlMEhXaVBTbXlYWGM9&iss=https://sso.isprambiente.it&client_id=provadiinserimento HTTP/1.1" 200 -
2023-10-17 15:36:50,732 root DEBUG Configured logging using dictionary
2023-10-17 15:36:50,776 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-17 15:36:50,776 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-17 15:36:50,776 werkzeug INFO  * Restarting with stat
2023-10-17 15:36:50,956 root DEBUG Configured logging using dictionary
2023-10-17 15:36:50,993 werkzeug WARNING  * Debugger is active!
2023-10-17 15:36:50,993 werkzeug INFO  * Debugger PIN: 506-049-290
2023-10-17 15:37:08,268 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 15:37:08] "GET / HTTP/1.1" 200 -
2023-10-17 15:37:08,312 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 15:37:08] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2023-10-17 15:37:12,391 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 15:37:12,391 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 15:37:12,391 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 15:37:12,391 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 15:37:12,426 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 15:37:12,426 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 15:37:12,426 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 15:37:12,426 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 15:37:12,427 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 15:37:12,446 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 15:37:12,446 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 15:37:12,446 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 15:37:12,447 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 13:37:12 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdACWeCGY2sHG3QZGL1OoZUa1R8DQxNL5KWphPRJ7rw5gD8bfaJiC9pwbOT-Vb68eQ_5TXzbyFHAUn4D-dI-Yk4VMtdyczwp6uTJmCqAeLcnVZifcsH5AYl84WMqhA344mAFM-VCsObdOAwVPg7Gqz8VRQs0RVsqYGAPoNP308y8iOpzHrsp3jzQRP7-U9EbH9RpyLJxqhFNnCCbONdW655tZlLiTeyUgsVw1eYggAQJB5OjtUR_Bcppl-zQAAAA26WSBIEsYSAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdACWeCGY2sHG3QZGL1OoZUa1R8DQxNL5KWphPRJ7rw5gD8bfaJiC9pwbOT-Vb68eQ_5TXzbyFHAUn4D-dI-Yk4VMtdyczwp6uTJmCqAeLcnVZifcsH5AYl84WMqhA344mAFM-VCsObdOAwVPg7Gqz8VRQs0RVsqYGAPoNP308y8iOpzHrsp3jzQRP7-U9EbH9RpyLJxqhFNnCCbONdW655tZlLiTeyUgsVw1eYggAQJB5OjtUR_Bcppl-zQAAAA26WSBIEsYSAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 15:37:12,447 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 15:37:12,447 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 15:37:12,447 oidcrp.service DEBUG response format: json
2023-10-17 15:37:12,447 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 15:37:12,447 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 15:37:12,447 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 15:37:12,448 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 15:37:12,448 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 15:37:12,448 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 15:37:12,448 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 15:37:12,449 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 15:37:12,466 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 15:37:12,467 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "bGV2QXVITmp1aVprTnRyUmJRMTNTd1JydlRoR3I5SUNSWkVuT2Z4VzNfYw", "e": "AQAB", "n": "tjGsgydz39HJ7fDv6CXtsAHe7U187qCu5sCNu89E37T_WlBda2WrvPu5C5EKESGVGyZtR3NIBFV6eWj-kNyqkni7xXqKviwvtxOebYEhNI9PogEiseT5WmBhH6LaxZw2vzFMrA4ztSfWDDZW0dikF0PqM6Zz4oP-vE0Q3fcNM-XDGdkG6YWYUBurKOXYfaCcOfDEo6XxS0CDEzcnk54Nfq89NjZNS2BRT5cCzje-d-HtwOdKce3Olz5L9VlOywdVc0VKCxn04wC_Occ8dgp6zR3sO9iya-G-VVoSPsGNSpeG8-ob_s5xXGuskcpjK_Mz_nNGHLr32NUgN99hghQuwQ"}, {"kty": "EC", "use": "sig", "kid": "ajFUOXFXLTU3WjNxbWNCYTd4WU1JSmlEbkxKX3V1UkRrV0ZmU3RzNGRxbw", "crv": "P-256", "x": "q2nHd2K0BmN8fUqM7a4M4b7EVBjHrqVJnfIKYTbfl50", "y": "ER73Xi1bgnGbsO92SJAQBQtRMCv5SscEkrqU2gRQUTU"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 15:37:12,467 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "bGV2QXVITmp1aVprTnRyUmJRMTNTd1JydlRoR3I5SUNSWkVuT2Z4VzNfYw", "e": "AQAB", "n": "tjGsgydz39HJ7fDv6CXtsAHe7U187qCu5sCNu89E37T_WlBda2WrvPu5C5EKESGVGyZtR3NIBFV6eWj-kNyqkni7xXqKviwvtxOebYEhNI9PogEiseT5WmBhH6LaxZw2vzFMrA4ztSfWDDZW0dikF0PqM6Zz4oP-vE0Q3fcNM-XDGdkG6YWYUBurKOXYfaCcOfDEo6XxS0CDEzcnk54Nfq89NjZNS2BRT5cCzje-d-HtwOdKce3Olz5L9VlOywdVc0VKCxn04wC_Occ8dgp6zR3sO9iya-G-VVoSPsGNSpeG8-ob_s5xXGuskcpjK_Mz_nNGHLr32NUgN99hghQuwQ"}, {"kty": "EC", "use": "sig", "kid": "ajFUOXFXLTU3WjNxbWNCYTd4WU1JSmlEbkxKX3V1UkRrV0ZmU3RzNGRxbw", "crv": "P-256", "x": "q2nHd2K0BmN8fUqM7a4M4b7EVBjHrqVJnfIKYTbfl50", "y": "ER73Xi1bgnGbsO92SJAQBQtRMCv5SscEkrqU2gRQUTU"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 15:37:12,468 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-17 15:37:12,468 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 15:37:12,468 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 15:37:12,468 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 15:37:12,468 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'v4SwuE7UUVnUo3E63pHDQSdC', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'CwBjXY6BUDvyjTgDasEjq9Dt4FXg2jN0'}
2023-10-17 15:37:12,469 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'v4SwuE7UUVnUo3E63pHDQSdC', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'CwBjXY6BUDvyjTgDasEjq9Dt4FXg2jN0', 'code_challenge': 'BXDqPyMX6UMnKUrnS_EZSVSLOULWFApMbarje7NUJ3A', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 15:37:12,469 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7fc95cb2f710>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=v4SwuE7UUVnUo3E63pHDQSdC&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=CwBjXY6BUDvyjTgDasEjq9Dt4FXg2jN0&code_challenge=BXDqPyMX6UMnKUrnS_EZSVSLOULWFApMbarje7NUJ3A&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 15:37:12,470 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 15:37:12] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 15:39:54,862 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 15:39:54] "GET / HTTP/1.1" 200 -
2023-10-17 15:39:57,755 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 15:39:57,755 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 15:39:57,755 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 15:39:57,755 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 15:39:57,788 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 15:39:57,788 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 15:39:57,788 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 15:39:57,788 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 15:39:57,789 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 15:39:57,805 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 15:39:57,806 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 15:39:57,806 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 15:39:57,806 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 13:39:57 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddACOOSQRhp0XisCMpBSZRGYoqMv55f_jgaiMyHKZ6qPsUIn45fAH9YRjoN1_qVgIE7nlrHTH4Eij7Mgtn5MBE00BczUyfv4oXf1Af0zQ7PkS5NGgDVhkuy76ObNfH-_NxzMrzsMmmkhDElPTSPfibFg0Y4aBjJ4r3TW6EKrKbzHF9jBIJkyKuygSFvzECTcN1CrKFilq5D3QyYtiL6wJ29k5Mt7WfzOiywTzqpbV9M3URXIiQ82BcWAAA3Eu72QMQUZwAAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddACOOSQRhp0XisCMpBSZRGYoqMv55f_jgaiMyHKZ6qPsUIn45fAH9YRjoN1_qVgIE7nlrHTH4Eij7Mgtn5MBE00BczUyfv4oXf1Af0zQ7PkS5NGgDVhkuy76ObNfH-_NxzMrzsMmmkhDElPTSPfibFg0Y4aBjJ4r3TW6EKrKbzHF9jBIJkyKuygSFvzECTcN1CrKFilq5D3QyYtiL6wJ29k5Mt7WfzOiywTzqpbV9M3URXIiQ82BcWAAA3Eu72QMQUZwAAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 15:39:57,806 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 15:39:57,806 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 15:39:57,806 oidcrp.service DEBUG response format: json
2023-10-17 15:39:57,806 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 15:39:57,806 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 15:39:57,806 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 15:39:57,807 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 15:39:57,807 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 15:39:57,807 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 15:39:57,807 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 15:39:57,808 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 15:39:57,828 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 15:39:57,828 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "bGV2QXVITmp1aVprTnRyUmJRMTNTd1JydlRoR3I5SUNSWkVuT2Z4VzNfYw", "e": "AQAB", "n": "tjGsgydz39HJ7fDv6CXtsAHe7U187qCu5sCNu89E37T_WlBda2WrvPu5C5EKESGVGyZtR3NIBFV6eWj-kNyqkni7xXqKviwvtxOebYEhNI9PogEiseT5WmBhH6LaxZw2vzFMrA4ztSfWDDZW0dikF0PqM6Zz4oP-vE0Q3fcNM-XDGdkG6YWYUBurKOXYfaCcOfDEo6XxS0CDEzcnk54Nfq89NjZNS2BRT5cCzje-d-HtwOdKce3Olz5L9VlOywdVc0VKCxn04wC_Occ8dgp6zR3sO9iya-G-VVoSPsGNSpeG8-ob_s5xXGuskcpjK_Mz_nNGHLr32NUgN99hghQuwQ"}, {"kty": "EC", "use": "sig", "kid": "ajFUOXFXLTU3WjNxbWNCYTd4WU1JSmlEbkxKX3V1UkRrV0ZmU3RzNGRxbw", "crv": "P-256", "x": "q2nHd2K0BmN8fUqM7a4M4b7EVBjHrqVJnfIKYTbfl50", "y": "ER73Xi1bgnGbsO92SJAQBQtRMCv5SscEkrqU2gRQUTU"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 15:39:57,828 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "bGV2QXVITmp1aVprTnRyUmJRMTNTd1JydlRoR3I5SUNSWkVuT2Z4VzNfYw", "e": "AQAB", "n": "tjGsgydz39HJ7fDv6CXtsAHe7U187qCu5sCNu89E37T_WlBda2WrvPu5C5EKESGVGyZtR3NIBFV6eWj-kNyqkni7xXqKviwvtxOebYEhNI9PogEiseT5WmBhH6LaxZw2vzFMrA4ztSfWDDZW0dikF0PqM6Zz4oP-vE0Q3fcNM-XDGdkG6YWYUBurKOXYfaCcOfDEo6XxS0CDEzcnk54Nfq89NjZNS2BRT5cCzje-d-HtwOdKce3Olz5L9VlOywdVc0VKCxn04wC_Occ8dgp6zR3sO9iya-G-VVoSPsGNSpeG8-ob_s5xXGuskcpjK_Mz_nNGHLr32NUgN99hghQuwQ"}, {"kty": "EC", "use": "sig", "kid": "ajFUOXFXLTU3WjNxbWNCYTd4WU1JSmlEbkxKX3V1UkRrV0ZmU3RzNGRxbw", "crv": "P-256", "x": "q2nHd2K0BmN8fUqM7a4M4b7EVBjHrqVJnfIKYTbfl50", "y": "ER73Xi1bgnGbsO92SJAQBQtRMCv5SscEkrqU2gRQUTU"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 15:39:57,829 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-17 15:39:57,829 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 15:39:57,829 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 15:39:57,829 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 15:39:57,829 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'kOEG1h3CsoDQqNX6ZEOMGfYr', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'gZ77RRUDtx7yNu53ogmHouLUgXBEcjI2'}
2023-10-17 15:39:57,830 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'kOEG1h3CsoDQqNX6ZEOMGfYr', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'gZ77RRUDtx7yNu53ogmHouLUgXBEcjI2', 'code_challenge': 'o85VaiKpSaS9Uo-isVr3YnAkMZ1XIYOkfD41V85xmU4', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 15:39:57,830 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7fc95e15a050>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=kOEG1h3CsoDQqNX6ZEOMGfYr&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=gZ77RRUDtx7yNu53ogmHouLUgXBEcjI2&code_challenge=o85VaiKpSaS9Uo-isVr3YnAkMZ1XIYOkfD41V85xmU4&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 15:39:57,830 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 15:39:57] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 15:40:15,456 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 15:40:15,456 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 15:40:15,456 oidcrp.service DEBUG response format: dict
2023-10-17 15:40:15,456 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 15:40:15,456 oidcrp.service DEBUG Initial response parsing => "{'state': 'gZ77RRUDtx7yNu53ogmHouLUgXBEcjI2', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxMbzZfMkE1RTB6TXlZVFFzNWxYYk1rWFptckExNUEwQnZxYjdaalUzRkJSTkx2YUNoaVhUaGFiLTBIYWpsQWNCWUtzMUU2RnUtaVhKMEdfT29qWjB0RWFzVkZEaE0wd3F4YUZHWFpMSjJ3bmdfc3lTSWNfQ0llb1B4anVnTVVDWjk3bVd2OUFwcHRKYm82RlFmQWh6WGV6cVdLOXg0M296RHZOMWEybl9lV3hxU0QxcDhMOUVKamxGaXpDOTgtNWRpZ3c0SnNCYmpaRGpnUkx3MGIxSElHMDV6V21jU09FLTN4am44QmJqRDRSQkVNOW5sSTg0UGc0WkZXME5zMDZ6ZnMtSHh3OTlXTTdtYzEwMUs1b2JEWWtxcnFqVU1lYl85N3hKRDZDRW5xTWxnZmhTRUw0aXVnNE95N3NyNlNvM2RnMUttVzNvaTVLZHNXdjJ4YXpNNEJjWV91bzRRS0JaeTVYRGVvSVFoTk1kcjVjLTJNMEN4RXAtdVdEb2R5WEdVdG43ZUtQYlJfMHBneXNtSS14cHB4eGJpM2FWaXUwWjJHbERWX0d2VEZZRThVMXdhUjNsdzRSdXE0WHFhcTZXcFJoTTR5VGhFV1pwcWVPdFBQakhZRjJzWTZZOFFHLUU2MkdDSjhnVlJhVGEtWnYybjF4VzdwRmZxMS0wZUVBcDdRUUlCMzEtOXBfRWtTSVNuVmRORG5MLTJDdkxvUUVuWjNUbEJvZUhJYl93R2JFVHpyMXhfVlJfVVp4Vy1YYVF4SGVJNjEyX1R5V01Kem96SDczMXhSUEVvT0pjWUxBdXZIbGVLQll6ZXM1VE93NG5fQmdlR0xubUw0Rmk0azZ6bFpoakwxTFB2QVR1Q0V4bzZVdml2eTZjNmFoalp3TmM0V19oaUt2SzdJTzNmOVU9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 15:40:15,456 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 15:40:15,457 oidcrp.rp_handler DEBUG Authz response: {'state': 'gZ77RRUDtx7yNu53ogmHouLUgXBEcjI2', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxMbzZfMkE1RTB6TXlZVFFzNWxYYk1rWFptckExNUEwQnZxYjdaalUzRkJSTkx2YUNoaVhUaGFiLTBIYWpsQWNCWUtzMUU2RnUtaVhKMEdfT29qWjB0RWFzVkZEaE0wd3F4YUZHWFpMSjJ3bmdfc3lTSWNfQ0llb1B4anVnTVVDWjk3bVd2OUFwcHRKYm82RlFmQWh6WGV6cVdLOXg0M296RHZOMWEybl9lV3hxU0QxcDhMOUVKamxGaXpDOTgtNWRpZ3c0SnNCYmpaRGpnUkx3MGIxSElHMDV6V21jU09FLTN4am44QmJqRDRSQkVNOW5sSTg0UGc0WkZXME5zMDZ6ZnMtSHh3OTlXTTdtYzEwMUs1b2JEWWtxcnFqVU1lYl85N3hKRDZDRW5xTWxnZmhTRUw0aXVnNE95N3NyNlNvM2RnMUttVzNvaTVLZHNXdjJ4YXpNNEJjWV91bzRRS0JaeTVYRGVvSVFoTk1kcjVjLTJNMEN4RXAtdVdEb2R5WEdVdG43ZUtQYlJfMHBneXNtSS14cHB4eGJpM2FWaXUwWjJHbERWX0d2VEZZRThVMXdhUjNsdzRSdXE0WHFhcTZXcFJoTTR5VGhFV1pwcWVPdFBQakhZRjJzWTZZOFFHLUU2MkdDSjhnVlJhVGEtWnYybjF4VzdwRmZxMS0wZUVBcDdRUUlCMzEtOXBfRWtTSVNuVmRORG5MLTJDdkxvUUVuWjNUbEJvZUhJYl93R2JFVHpyMXhfVlJfVVp4Vy1YYVF4SGVJNjEyX1R5V01Kem96SDczMXhSUEVvT0pjWUxBdXZIbGVLQll6ZXM1VE93NG5fQmdlR0xubUw0Rmk0azZ6bFpoakwxTFB2QVR1Q0V4bzZVdml2eTZjNmFoalp3TmM0V19oaUt2SzdJTzNmOVU9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 15:40:15,457 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 15:40:15,457 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 15:40:15,457 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMbzZfMkE1RTB6TXlZVFFzNWxYYk1rWFptckExNUEwQnZxYjdaalUzRkJSTkx2YUNoaVhUaGFiLTBIYWpsQWNCWUtzMUU2RnUtaVhKMEdfT29qWjB0RWFzVkZEaE0wd3F4YUZHWFpMSjJ3bmdfc3lTSWNfQ0llb1B4anVnTVVDWjk3bVd2OUFwcHRKYm82RlFmQWh6WGV6cVdLOXg0M296RHZOMWEybl9lV3hxU0QxcDhMOUVKamxGaXpDOTgtNWRpZ3c0SnNCYmpaRGpnUkx3MGIxSElHMDV6V21jU09FLTN4am44QmJqRDRSQkVNOW5sSTg0UGc0WkZXME5zMDZ6ZnMtSHh3OTlXTTdtYzEwMUs1b2JEWWtxcnFqVU1lYl85N3hKRDZDRW5xTWxnZmhTRUw0aXVnNE95N3NyNlNvM2RnMUttVzNvaTVLZHNXdjJ4YXpNNEJjWV91bzRRS0JaeTVYRGVvSVFoTk1kcjVjLTJNMEN4RXAtdVdEb2R5WEdVdG43ZUtQYlJfMHBneXNtSS14cHB4eGJpM2FWaXUwWjJHbERWX0d2VEZZRThVMXdhUjNsdzRSdXE0WHFhcTZXcFJoTTR5VGhFV1pwcWVPdFBQakhZRjJzWTZZOFFHLUU2MkdDSjhnVlJhVGEtWnYybjF4VzdwRmZxMS0wZUVBcDdRUUlCMzEtOXBfRWtTSVNuVmRORG5MLTJDdkxvUUVuWjNUbEJvZUhJYl93R2JFVHpyMXhfVlJfVVp4Vy1YYVF4SGVJNjEyX1R5V01Kem96SDczMXhSUEVvT0pjWUxBdXZIbGVLQll6ZXM1VE93NG5fQmdlR0xubUw0Rmk0azZ6bFpoakwxTFB2QVR1Q0V4bzZVdml2eTZjNmFoalp3TmM0V19oaUt2SzdJTzNmOVU9', 'state': 'gZ77RRUDtx7yNu53ogmHouLUgXBEcjI2', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY'}
2023-10-17 15:40:15,457 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'gZ77RRUDtx7yNu53ogmHouLUgXBEcjI2', 'code': 'Z0FBQUFBQmxMbzZfMkE1RTB6TXlZVFFzNWxYYk1rWFptckExNUEwQnZxYjdaalUzRkJSTkx2YUNoaVhUaGFiLTBIYWpsQWNCWUtzMUU2RnUtaVhKMEdfT29qWjB0RWFzVkZEaE0wd3F4YUZHWFpMSjJ3bmdfc3lTSWNfQ0llb1B4anVnTVVDWjk3bVd2OUFwcHRKYm82RlFmQWh6WGV6cVdLOXg0M296RHZOMWEybl9lV3hxU0QxcDhMOUVKamxGaXpDOTgtNWRpZ3c0SnNCYmpaRGpnUkx3MGIxSElHMDV6V21jU09FLTN4am44QmJqRDRSQkVNOW5sSTg0UGc0WkZXME5zMDZ6ZnMtSHh3OTlXTTdtYzEwMUs1b2JEWWtxcnFqVU1lYl85N3hKRDZDRW5xTWxnZmhTRUw0aXVnNE95N3NyNlNvM2RnMUttVzNvaTVLZHNXdjJ4YXpNNEJjWV91bzRRS0JaeTVYRGVvSVFoTk1kcjVjLTJNMEN4RXAtdVdEb2R5WEdVdG43ZUtQYlJfMHBneXNtSS14cHB4eGJpM2FWaXUwWjJHbERWX0d2VEZZRThVMXdhUjNsdzRSdXE0WHFhcTZXcFJoTTR5VGhFV1pwcWVPdFBQakhZRjJzWTZZOFFHLUU2MkdDSjhnVlJhVGEtWnYybjF4VzdwRmZxMS0wZUVBcDdRUUlCMzEtOXBfRWtTSVNuVmRORG5MLTJDdkxvUUVuWjNUbEJvZUhJYl93R2JFVHpyMXhfVlJfVVp4Vy1YYVF4SGVJNjEyX1R5V01Kem96SDczMXhSUEVvT0pjWUxBdXZIbGVLQll6ZXM1VE93NG5fQmdlR0xubUw0Rmk0azZ6bFpoakwxTFB2QVR1Q0V4bzZVdml2eTZjNmFoalp3TmM0V19oaUt2SzdJTzNmOVU9', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY', 'code_verifier': 'MaQdCVQtxuF4Hr3hucsgn3RGTsIT0DJ2kGbIomUaYNiVie3mR1DuWIZYllTQEukt'}
2023-10-17 15:40:15,457 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 15:40:15,457 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7fc95e147050>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=gZ77RRUDtx7yNu53ogmHouLUgXBEcjI2&code=Z0FBQUFBQmxMbzZfMkE1RTB6TXlZVFFzNWxYYk1rWFptckExNUEwQnZxYjdaalUzRkJSTkx2YUNoaVhUaGFiLTBIYWpsQWNCWUtzMUU2RnUtaVhKMEdfT29qWjB0RWFzVkZEaE0wd3F4YUZHWFpMSjJ3bmdfc3lTSWNfQ0llb1B4anVnTVVDWjk3bVd2OUFwcHRKYm82RlFmQWh6WGV6cVdLOXg0M296RHZOMWEybl9lV3hxU0QxcDhMOUVKamxGaXpDOTgtNWRpZ3c0SnNCYmpaRGpnUkx3MGIxSElHMDV6V21jU09FLTN4am44QmJqRDRSQkVNOW5sSTg0UGc0WkZXME5zMDZ6ZnMtSHh3OTlXTTdtYzEwMUs1b2JEWWtxcnFqVU1lYl85N3hKRDZDRW5xTWxnZmhTRUw0aXVnNE95N3NyNlNvM2RnMUttVzNvaTVLZHNXdjJ4YXpNNEJjWV91bzRRS0JaeTVYRGVvSVFoTk1kcjVjLTJNMEN4RXAtdVdEb2R5WEdVdG43ZUtQYlJfMHBneXNtSS14cHB4eGJpM2FWaXUwWjJHbERWX0d2VEZZRThVMXdhUjNsdzRSdXE0WHFhcTZXcFJoTTR5VGhFV1pwcWVPdFBQakhZRjJzWTZZOFFHLUU2MkdDSjhnVlJhVGEtWnYybjF4VzdwRmZxMS0wZUVBcDdRUUlCMzEtOXBfRWtTSVNuVmRORG5MLTJDdkxvUUVuWjNUbEJvZUhJYl93R2JFVHpyMXhfVlJfVVp4Vy1YYVF4SGVJNjEyX1R5V01Kem96SDczMXhSUEVvT0pjWUxBdXZIbGVLQll6ZXM1VE93NG5fQmdlR0xubUw0Rmk0azZ6bFpoakwxTFB2QVR1Q0V4bzZVdml2eTZjNmFoalp3TmM0V19oaUt2SzdJTzNmOVU9&code_verifier=MaQdCVQtxuF4Hr3hucsgn3RGTsIT0DJ2kGbIomUaYNiVie3mR1DuWIZYllTQEukt', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 15:40:15,457 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=gZ77RRUDtx7yNu53ogmHouLUgXBEcjI2&code=Z0FBQUFBQmxMbzZfMkE1RTB6TXlZVFFzNWxYYk1rWFptckExNUEwQnZxYjdaalUzRkJSTkx2YUNoaVhUaGFiLTBIYWpsQWNCWUtzMUU2RnUtaVhKMEdfT29qWjB0RWFzVkZEaE0wd3F4YUZHWFpMSjJ3bmdfc3lTSWNfQ0llb1B4anVnTVVDWjk3bVd2OUFwcHRKYm82RlFmQWh6WGV6cVdLOXg0M296RHZOMWEybl9lV3hxU0QxcDhMOUVKamxGaXpDOTgtNWRpZ3c0SnNCYmpaRGpnUkx3MGIxSElHMDV6V21jU09FLTN4am44QmJqRDRSQkVNOW5sSTg0UGc0WkZXME5zMDZ6ZnMtSHh3OTlXTTdtYzEwMUs1b2JEWWtxcnFqVU1lYl85N3hKRDZDRW5xTWxnZmhTRUw0aXVnNE95N3NyNlNvM2RnMUttVzNvaTVLZHNXdjJ4YXpNNEJjWV91bzRRS0JaeTVYRGVvSVFoTk1kcjVjLTJNMEN4RXAtdVdEb2R5WEdVdG43ZUtQYlJfMHBneXNtSS14cHB4eGJpM2FWaXUwWjJHbERWX0d2VEZZRThVMXdhUjNsdzRSdXE0WHFhcTZXcFJoTTR5VGhFV1pwcWVPdFBQakhZRjJzWTZZOFFHLUU2MkdDSjhnVlJhVGEtWnYybjF4VzdwRmZxMS0wZUVBcDdRUUlCMzEtOXBfRWtTSVNuVmRORG5MLTJDdkxvUUVuWjNUbEJvZUhJYl93R2JFVHpyMXhfVlJfVVp4Vy1YYVF4SGVJNjEyX1R5V01Kem96SDczMXhSUEVvT0pjWUxBdXZIbGVLQll6ZXM1VE93NG5fQmdlR0xubUw0Rmk0azZ6bFpoakwxTFB2QVR1Q0V4bzZVdml2eTZjNmFoalp3TmM0V19oaUt2SzdJTzNmOVU9&code_verifier=MaQdCVQtxuF4Hr3hucsgn3RGTsIT0DJ2kGbIomUaYNiVie3mR1DuWIZYllTQEukt, https_args:{'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 15:40:15,458 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 15:40:15,593 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 403 None
2023-10-17 15:40:15,594 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 15:40:15,594 oidcrp.oauth2 ERROR Error response (403): {"error": "unauthorized_client", "error_description": ""}
2023-10-17 15:40:15,594 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 13:40:15 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdADmQhsawhmFMfsjcyNHfcK-UOmhbE58DuQ2in033JcS_ISUI3S2cvqrtmyPJoNCETC9smFoHqkkiSX6VSH7aPt53moooQApiBaJUhx6cW5DylKVP3tOcQ_pTKGYk9XfpKX6k_036W1rZzvRl8MFxFjMFNiInaiwrr4tMs4HYrGXyKc4w7izteq6xhUAJOVNgjNPOfGJ7USEZq7Njo9BmSiTQRZNjMijZ-8-kFHhK_WXvnjcQSqVu4h5OAAAAAB7i-qVy8eoFAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdADmQhsawhmFMfsjcyNHfcK-UOmhbE58DuQ2in033JcS_ISUI3S2cvqrtmyPJoNCETC9smFoHqkkiSX6VSH7aPt53moooQApiBaJUhx6cW5DylKVP3tOcQ_pTKGYk9XfpKX6k_036W1rZzvRl8MFxFjMFNiInaiwrr4tMs4HYrGXyKc4w7izteq6xhUAJOVNgjNPOfGJ7USEZq7Njo9BmSiTQRZNjMijZ-8-kFHhK_WXvnjcQSqVu4h5OAAAAAB7i-qVy8eoFAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure'}
2023-10-17 15:40:15,594 oidcrp.util DEBUG resp.txt: {"error": "unauthorized_client", "error_description": ""}
2023-10-17 15:40:15,594 oidcrp.service DEBUG response format: json
2023-10-17 15:40:15,594 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 15:40:15,594 oidcrp.service DEBUG Initial response parsing => "{'error': 'unauthorized_client'}"
2023-10-17 15:40:15,594 oidcrp.service DEBUG Error response: {'error': 'unauthorized_client'}
2023-10-17 15:40:15,595 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 15:40:15] "[31m[1mGET /authz_cb/satosa?state=gZ77RRUDtx7yNu53ogmHouLUgXBEcjI2&scope=openid+offline_access+profile&code=Z0FBQUFBQmxMbzZfMkE1RTB6TXlZVFFzNWxYYk1rWFptckExNUEwQnZxYjdaalUzRkJSTkx2YUNoaVhUaGFiLTBIYWpsQWNCWUtzMUU2RnUtaVhKMEdfT29qWjB0RWFzVkZEaE0wd3F4YUZHWFpMSjJ3bmdfc3lTSWNfQ0llb1B4anVnTVVDWjk3bVd2OUFwcHRKYm82RlFmQWh6WGV6cVdLOXg0M296RHZOMWEybl9lV3hxU0QxcDhMOUVKamxGaXpDOTgtNWRpZ3c0SnNCYmpaRGpnUkx3MGIxSElHMDV6V21jU09FLTN4am44QmJqRDRSQkVNOW5sSTg0UGc0WkZXME5zMDZ6ZnMtSHh3OTlXTTdtYzEwMUs1b2JEWWtxcnFqVU1lYl85N3hKRDZDRW5xTWxnZmhTRUw0aXVnNE95N3NyNlNvM2RnMUttVzNvaTVLZHNXdjJ4YXpNNEJjWV91bzRRS0JaeTVYRGVvSVFoTk1kcjVjLTJNMEN4RXAtdVdEb2R5WEdVdG43ZUtQYlJfMHBneXNtSS14cHB4eGJpM2FWaXUwWjJHbERWX0d2VEZZRThVMXdhUjNsdzRSdXE0WHFhcTZXcFJoTTR5VGhFV1pwcWVPdFBQakhZRjJzWTZZOFFHLUU2MkdDSjhnVlJhVGEtWnYybjF4VzdwRmZxMS0wZUVBcDdRUUlCMzEtOXBfRWtTSVNuVmRORG5MLTJDdkxvUUVuWjNUbEJvZUhJYl93R2JFVHpyMXhfVlJfVVp4Vy1YYVF4SGVJNjEyX1R5V01Kem96SDczMXhSUEVvT0pjWUxBdXZIbGVLQll6ZXM1VE93NG5fQmdlR0xubUw0Rmk0azZ6bFpoakwxTFB2QVR1Q0V4bzZVdml2eTZjNmFoalp3TmM0V19oaUt2SzdJTzNmOVU9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1[0m" 403 -
2023-10-17 15:40:15,647 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 15:40:15] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2023-10-17 20:41:31,635 root DEBUG Configured logging using dictionary
2023-10-17 20:41:31,678 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-17 20:41:31,678 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-17 20:41:31,678 werkzeug INFO  * Restarting with stat
2023-10-17 20:41:31,856 root DEBUG Configured logging using dictionary
2023-10-17 20:41:31,894 werkzeug WARNING  * Debugger is active!
2023-10-17 20:41:31,894 werkzeug INFO  * Debugger PIN: 506-049-290
2023-10-17 20:46:39,240 root DEBUG Configured logging using dictionary
2023-10-17 20:46:39,279 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-17 20:46:39,279 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-17 20:46:39,279 werkzeug INFO  * Restarting with stat
2023-10-17 20:46:39,457 root DEBUG Configured logging using dictionary
2023-10-17 20:46:39,494 werkzeug WARNING  * Debugger is active!
2023-10-17 20:46:39,494 werkzeug INFO  * Debugger PIN: 506-049-290
2023-10-17 20:46:42,544 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 20:46:42] "GET / HTTP/1.1" 200 -
2023-10-17 20:46:42,679 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 20:46:42] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2023-10-17 20:46:47,846 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 20:46:47,846 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 20:46:47,846 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 20:46:47,846 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 20:46:47,884 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 20:46:47,884 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 20:46:47,884 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 20:46:47,884 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 20:46:47,887 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 20:46:47,911 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 20:46:47,911 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 20:46:47,911 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 20:46:47,911 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 18:46:47 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACqcBcUKuI0wUpK3v7WDl1TgGaFS7jc1Qdr9nO8ijtMbR7seDPshj0s45X2Opb6kU37t9fCs82_UjLc2nj0TMy6vREoght_dTF9haHAu04vM-9wQB3MR-VfuT599Nmg_yfqRxdL4faQ9OBHpmWZiup4QlmYrN6MBLbqTDY5BZRVUk6_DDxrtIdZa1UHf9-3Pg16vSt08LjhqofivIN0od6e7tlMzl98QZAQumEpBiv4zv9grFg0_ejQAAAAAAFeHdyuOnFEMAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACqcBcUKuI0wUpK3v7WDl1TgGaFS7jc1Qdr9nO8ijtMbR7seDPshj0s45X2Opb6kU37t9fCs82_UjLc2nj0TMy6vREoght_dTF9haHAu04vM-9wQB3MR-VfuT599Nmg_yfqRxdL4faQ9OBHpmWZiup4QlmYrN6MBLbqTDY5BZRVUk6_DDxrtIdZa1UHf9-3Pg16vSt08LjhqofivIN0od6e7tlMzl98QZAQumEpBiv4zv9grFg0_ejQAAAAAAFeHdyuOnFEMAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 20:46:47,911 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 20:46:47,911 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 20:46:47,911 oidcrp.service DEBUG response format: json
2023-10-17 20:46:47,911 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 20:46:47,911 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 20:46:47,911 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 20:46:47,912 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 20:46:47,912 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 20:46:47,912 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 20:46:47,912 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 20:46:47,913 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 20:46:47,935 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 20:46:47,935 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "bGV2QXVITmp1aVprTnRyUmJRMTNTd1JydlRoR3I5SUNSWkVuT2Z4VzNfYw", "e": "AQAB", "n": "tjGsgydz39HJ7fDv6CXtsAHe7U187qCu5sCNu89E37T_WlBda2WrvPu5C5EKESGVGyZtR3NIBFV6eWj-kNyqkni7xXqKviwvtxOebYEhNI9PogEiseT5WmBhH6LaxZw2vzFMrA4ztSfWDDZW0dikF0PqM6Zz4oP-vE0Q3fcNM-XDGdkG6YWYUBurKOXYfaCcOfDEo6XxS0CDEzcnk54Nfq89NjZNS2BRT5cCzje-d-HtwOdKce3Olz5L9VlOywdVc0VKCxn04wC_Occ8dgp6zR3sO9iya-G-VVoSPsGNSpeG8-ob_s5xXGuskcpjK_Mz_nNGHLr32NUgN99hghQuwQ"}, {"kty": "EC", "use": "sig", "kid": "ajFUOXFXLTU3WjNxbWNCYTd4WU1JSmlEbkxKX3V1UkRrV0ZmU3RzNGRxbw", "crv": "P-256", "x": "q2nHd2K0BmN8fUqM7a4M4b7EVBjHrqVJnfIKYTbfl50", "y": "ER73Xi1bgnGbsO92SJAQBQtRMCv5SscEkrqU2gRQUTU"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 20:46:47,935 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "bGV2QXVITmp1aVprTnRyUmJRMTNTd1JydlRoR3I5SUNSWkVuT2Z4VzNfYw", "e": "AQAB", "n": "tjGsgydz39HJ7fDv6CXtsAHe7U187qCu5sCNu89E37T_WlBda2WrvPu5C5EKESGVGyZtR3NIBFV6eWj-kNyqkni7xXqKviwvtxOebYEhNI9PogEiseT5WmBhH6LaxZw2vzFMrA4ztSfWDDZW0dikF0PqM6Zz4oP-vE0Q3fcNM-XDGdkG6YWYUBurKOXYfaCcOfDEo6XxS0CDEzcnk54Nfq89NjZNS2BRT5cCzje-d-HtwOdKce3Olz5L9VlOywdVc0VKCxn04wC_Occ8dgp6zR3sO9iya-G-VVoSPsGNSpeG8-ob_s5xXGuskcpjK_Mz_nNGHLr32NUgN99hghQuwQ"}, {"kty": "EC", "use": "sig", "kid": "ajFUOXFXLTU3WjNxbWNCYTd4WU1JSmlEbkxKX3V1UkRrV0ZmU3RzNGRxbw", "crv": "P-256", "x": "q2nHd2K0BmN8fUqM7a4M4b7EVBjHrqVJnfIKYTbfl50", "y": "ER73Xi1bgnGbsO92SJAQBQtRMCv5SscEkrqU2gRQUTU"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 20:46:47,936 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-17 20:46:47,936 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 20:46:47,936 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 20:46:47,936 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 20:46:47,937 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'ovpnNyg6snH6aaDjgnvKmwce', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'XrgmtIhmJPyHFQtJdHqC2gM9mKfUZv9b'}
2023-10-17 20:46:47,937 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'ovpnNyg6snH6aaDjgnvKmwce', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'XrgmtIhmJPyHFQtJdHqC2gM9mKfUZv9b', 'code_challenge': '91CpmXxuzKslUYT7cwUJ35slrnEjTNJfWgC_IXfOpJU', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 20:46:47,937 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f0044ab3e50>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=ovpnNyg6snH6aaDjgnvKmwce&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=XrgmtIhmJPyHFQtJdHqC2gM9mKfUZv9b&code_challenge=91CpmXxuzKslUYT7cwUJ35slrnEjTNJfWgC_IXfOpJU&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 20:46:47,937 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 20:46:47] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 21:07:36,588 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:07:36] "GET / HTTP/1.1" 200 -
2023-10-17 21:07:40,624 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:07:40] "GET / HTTP/1.1" 200 -
2023-10-17 21:07:43,278 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:07:43] "GET / HTTP/1.1" 200 -
2023-10-17 21:07:50,728 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 21:07:50,728 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 21:07:50,728 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 21:07:50,728 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 21:07:50,761 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 21:07:50,761 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 21:07:50,761 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 21:07:50,761 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 21:07:50,762 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:07:50,779 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 21:07:50,779 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:07:50,779 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 21:07:50,779 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:07:50 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALtdADoTiYVW9Pl5NhY7hiCwlu_L_oAyRuVpSjec4ZCzSrIk5mpCmV-QkFVEvEQi2UkYrcgt8foH82pEgwb_L34mitaLsNPWudReHIc06P9FwK6bN6TixNW6JSo3ga6opWxiiB8fscj8XuMsVnZ6hjqdq6D5AJpJ5-RnxC8hDOOrDbd4luZaXqrK89-5HOrL21uwASwp9_5ZuVyd3PNStuiGGBBxHkt8tYuN_4P75iUk9hBDej3OXHnCt8IJmgAAAKHvXlTqjj0wAAHXAcABAADLVYGGscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALtdADoTiYVW9Pl5NhY7hiCwlu_L_oAyRuVpSjec4ZCzSrIk5mpCmV-QkFVEvEQi2UkYrcgt8foH82pEgwb_L34mitaLsNPWudReHIc06P9FwK6bN6TixNW6JSo3ga6opWxiiB8fscj8XuMsVnZ6hjqdq6D5AJpJ5-RnxC8hDOOrDbd4luZaXqrK89-5HOrL21uwASwp9_5ZuVyd3PNStuiGGBBxHkt8tYuN_4P75iUk9hBDej3OXHnCt8IJmgAAAKHvXlTqjj0wAAHXAcABAADLVYGGscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 21:07:50,779 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:07:50,779 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:07:50,779 oidcrp.service DEBUG response format: json
2023-10-17 21:07:50,779 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 21:07:50,779 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 21:07:50,779 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 21:07:50,780 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 21:07:50,780 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 21:07:50,780 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:07:50,780 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:07:50,780 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:07:50,797 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 21:07:50,797 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "bGV2QXVITmp1aVprTnRyUmJRMTNTd1JydlRoR3I5SUNSWkVuT2Z4VzNfYw", "e": "AQAB", "n": "tjGsgydz39HJ7fDv6CXtsAHe7U187qCu5sCNu89E37T_WlBda2WrvPu5C5EKESGVGyZtR3NIBFV6eWj-kNyqkni7xXqKviwvtxOebYEhNI9PogEiseT5WmBhH6LaxZw2vzFMrA4ztSfWDDZW0dikF0PqM6Zz4oP-vE0Q3fcNM-XDGdkG6YWYUBurKOXYfaCcOfDEo6XxS0CDEzcnk54Nfq89NjZNS2BRT5cCzje-d-HtwOdKce3Olz5L9VlOywdVc0VKCxn04wC_Occ8dgp6zR3sO9iya-G-VVoSPsGNSpeG8-ob_s5xXGuskcpjK_Mz_nNGHLr32NUgN99hghQuwQ"}, {"kty": "EC", "use": "sig", "kid": "ajFUOXFXLTU3WjNxbWNCYTd4WU1JSmlEbkxKX3V1UkRrV0ZmU3RzNGRxbw", "crv": "P-256", "x": "q2nHd2K0BmN8fUqM7a4M4b7EVBjHrqVJnfIKYTbfl50", "y": "ER73Xi1bgnGbsO92SJAQBQtRMCv5SscEkrqU2gRQUTU"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:07:50,797 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "bGV2QXVITmp1aVprTnRyUmJRMTNTd1JydlRoR3I5SUNSWkVuT2Z4VzNfYw", "e": "AQAB", "n": "tjGsgydz39HJ7fDv6CXtsAHe7U187qCu5sCNu89E37T_WlBda2WrvPu5C5EKESGVGyZtR3NIBFV6eWj-kNyqkni7xXqKviwvtxOebYEhNI9PogEiseT5WmBhH6LaxZw2vzFMrA4ztSfWDDZW0dikF0PqM6Zz4oP-vE0Q3fcNM-XDGdkG6YWYUBurKOXYfaCcOfDEo6XxS0CDEzcnk54Nfq89NjZNS2BRT5cCzje-d-HtwOdKce3Olz5L9VlOywdVc0VKCxn04wC_Occ8dgp6zR3sO9iya-G-VVoSPsGNSpeG8-ob_s5xXGuskcpjK_Mz_nNGHLr32NUgN99hghQuwQ"}, {"kty": "EC", "use": "sig", "kid": "ajFUOXFXLTU3WjNxbWNCYTd4WU1JSmlEbkxKX3V1UkRrV0ZmU3RzNGRxbw", "crv": "P-256", "x": "q2nHd2K0BmN8fUqM7a4M4b7EVBjHrqVJnfIKYTbfl50", "y": "ER73Xi1bgnGbsO92SJAQBQtRMCv5SscEkrqU2gRQUTU"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:07:50,798 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-17 21:07:50,798 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 21:07:50,798 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 21:07:50,798 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 21:07:50,798 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'fW3Ls2EOXrnJrZz7ilIVTCfD', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'cWApEvU0LmBjFyjMK6LziVbAWWF0MNJY'}
2023-10-17 21:07:50,798 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'fW3Ls2EOXrnJrZz7ilIVTCfD', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'cWApEvU0LmBjFyjMK6LziVbAWWF0MNJY', 'code_challenge': 'bcUVMD68s-vi9D5XTQUGhERMEkg4CnczaaD7cNB1fkU', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 21:07:50,799 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f0042282390>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=fW3Ls2EOXrnJrZz7ilIVTCfD&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=cWApEvU0LmBjFyjMK6LziVbAWWF0MNJY&code_challenge=bcUVMD68s-vi9D5XTQUGhERMEkg4CnczaaD7cNB1fkU&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 21:07:50,799 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:07:50] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 21:08:01,332 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 21:08:01,332 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 21:08:01,332 oidcrp.service DEBUG response format: dict
2023-10-17 21:08:01,332 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 21:08:01,332 oidcrp.service DEBUG Initial response parsing => "{'state': 'cWApEvU0LmBjFyjMK6LziVbAWWF0MNJY', 'scope': 'offline_access openid profile', 'code': 'Z0FBQUFBQmxMdHVSdjQ0QXJFNjJ3NlotMDl0QUpnZXBCRkxEcWU5UVk3d2p4YzdCTmc1NEpiUm0xYlZxRnVSUUhXWGE2R0VyX1BfTUdndkg5aFRybjNIbFpMRktYdGcxT2Z4cXQ2UEJ4R2xWalNHOXp2M0xMY2tPOUpWeVNxRDBsbnphaVlzSjkxYm5IU0dZczV4Ynp1NnJvTDBBNkVYTEpKZldMSHdlcWpIa2M0NzBxWFBrS3ZmV1FJai1yZlA0bDJRRnNoR2k1WDJuUU5ZcDgzREpQbWppQmxTLW96S0ZZZW5IWWdNZUVWU190THBmV1g4eFUxdUxVODdfWEZUcDVHYUpMdGVpQ01tbTNVR2loeXhud3NLanQyUmRJNTF2U0pWZWtkMDNKQy1oX054U1lJOFZEQ3IySzhEU281c0pWZnRtR09FZVNBTWdmSUd3LXBRZ2lBNWJQcElzQ3poWUVWMF9aMmw4bFhrRnVXNkdDOFAtRzlhUmZZajlnVWhKZUJHcHhQS0FfLWFiYTl0RnBNeENRdG5QclJ6THhsRVJUMlA2dVFuTUlsVkhnaHE5c01aYjBlLW52ZWpISU1Ca2RDaXh2cTBIRTNSTXNqYU1RY2o5UmtGa1hBaTFMTDFQMTdzVll4UWhGTF9VRG1nakxHeWxlOHV4cTBVS3hDTU1aUXFWUV9iV1E0MFNqSFA2VEtla3hSSTFwSUJjTE5OeDB5YWR1RHlHbTI0bk9PbUhzbGJaU3NQdVk1YVM3ZE9UVnFHcUxqTVhuWVYtVGRGYTZwaU5JUlRkblUyWTVfS3Qxa0NNcmN3UGZJdnJSLVgxZGN4WGc5Wnd3TzVFMElnSTMtQXVkdGdPaHp3OFdQS0VTeGxGUXdhcjBUSVZXa3hUNGtTMzR5NVhsbzhJOGxINGJ1T3pWRTA9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 21:08:01,332 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 21:08:01,332 oidcrp.rp_handler DEBUG Authz response: {'state': 'cWApEvU0LmBjFyjMK6LziVbAWWF0MNJY', 'scope': 'offline_access openid profile', 'code': 'Z0FBQUFBQmxMdHVSdjQ0QXJFNjJ3NlotMDl0QUpnZXBCRkxEcWU5UVk3d2p4YzdCTmc1NEpiUm0xYlZxRnVSUUhXWGE2R0VyX1BfTUdndkg5aFRybjNIbFpMRktYdGcxT2Z4cXQ2UEJ4R2xWalNHOXp2M0xMY2tPOUpWeVNxRDBsbnphaVlzSjkxYm5IU0dZczV4Ynp1NnJvTDBBNkVYTEpKZldMSHdlcWpIa2M0NzBxWFBrS3ZmV1FJai1yZlA0bDJRRnNoR2k1WDJuUU5ZcDgzREpQbWppQmxTLW96S0ZZZW5IWWdNZUVWU190THBmV1g4eFUxdUxVODdfWEZUcDVHYUpMdGVpQ01tbTNVR2loeXhud3NLanQyUmRJNTF2U0pWZWtkMDNKQy1oX054U1lJOFZEQ3IySzhEU281c0pWZnRtR09FZVNBTWdmSUd3LXBRZ2lBNWJQcElzQ3poWUVWMF9aMmw4bFhrRnVXNkdDOFAtRzlhUmZZajlnVWhKZUJHcHhQS0FfLWFiYTl0RnBNeENRdG5QclJ6THhsRVJUMlA2dVFuTUlsVkhnaHE5c01aYjBlLW52ZWpISU1Ca2RDaXh2cTBIRTNSTXNqYU1RY2o5UmtGa1hBaTFMTDFQMTdzVll4UWhGTF9VRG1nakxHeWxlOHV4cTBVS3hDTU1aUXFWUV9iV1E0MFNqSFA2VEtla3hSSTFwSUJjTE5OeDB5YWR1RHlHbTI0bk9PbUhzbGJaU3NQdVk1YVM3ZE9UVnFHcUxqTVhuWVYtVGRGYTZwaU5JUlRkblUyWTVfS3Qxa0NNcmN3UGZJdnJSLVgxZGN4WGc5Wnd3TzVFMElnSTMtQXVkdGdPaHp3OFdQS0VTeGxGUXdhcjBUSVZXa3hUNGtTMzR5NVhsbzhJOGxINGJ1T3pWRTA9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 21:08:01,332 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 21:08:01,332 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 21:08:01,332 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMdHVSdjQ0QXJFNjJ3NlotMDl0QUpnZXBCRkxEcWU5UVk3d2p4YzdCTmc1NEpiUm0xYlZxRnVSUUhXWGE2R0VyX1BfTUdndkg5aFRybjNIbFpMRktYdGcxT2Z4cXQ2UEJ4R2xWalNHOXp2M0xMY2tPOUpWeVNxRDBsbnphaVlzSjkxYm5IU0dZczV4Ynp1NnJvTDBBNkVYTEpKZldMSHdlcWpIa2M0NzBxWFBrS3ZmV1FJai1yZlA0bDJRRnNoR2k1WDJuUU5ZcDgzREpQbWppQmxTLW96S0ZZZW5IWWdNZUVWU190THBmV1g4eFUxdUxVODdfWEZUcDVHYUpMdGVpQ01tbTNVR2loeXhud3NLanQyUmRJNTF2U0pWZWtkMDNKQy1oX054U1lJOFZEQ3IySzhEU281c0pWZnRtR09FZVNBTWdmSUd3LXBRZ2lBNWJQcElzQ3poWUVWMF9aMmw4bFhrRnVXNkdDOFAtRzlhUmZZajlnVWhKZUJHcHhQS0FfLWFiYTl0RnBNeENRdG5QclJ6THhsRVJUMlA2dVFuTUlsVkhnaHE5c01aYjBlLW52ZWpISU1Ca2RDaXh2cTBIRTNSTXNqYU1RY2o5UmtGa1hBaTFMTDFQMTdzVll4UWhGTF9VRG1nakxHeWxlOHV4cTBVS3hDTU1aUXFWUV9iV1E0MFNqSFA2VEtla3hSSTFwSUJjTE5OeDB5YWR1RHlHbTI0bk9PbUhzbGJaU3NQdVk1YVM3ZE9UVnFHcUxqTVhuWVYtVGRGYTZwaU5JUlRkblUyWTVfS3Qxa0NNcmN3UGZJdnJSLVgxZGN4WGc5Wnd3TzVFMElnSTMtQXVkdGdPaHp3OFdQS0VTeGxGUXdhcjBUSVZXa3hUNGtTMzR5NVhsbzhJOGxINGJ1T3pWRTA9', 'state': 'cWApEvU0LmBjFyjMK6LziVbAWWF0MNJY', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY'}
2023-10-17 21:08:01,332 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'cWApEvU0LmBjFyjMK6LziVbAWWF0MNJY', 'code': 'Z0FBQUFBQmxMdHVSdjQ0QXJFNjJ3NlotMDl0QUpnZXBCRkxEcWU5UVk3d2p4YzdCTmc1NEpiUm0xYlZxRnVSUUhXWGE2R0VyX1BfTUdndkg5aFRybjNIbFpMRktYdGcxT2Z4cXQ2UEJ4R2xWalNHOXp2M0xMY2tPOUpWeVNxRDBsbnphaVlzSjkxYm5IU0dZczV4Ynp1NnJvTDBBNkVYTEpKZldMSHdlcWpIa2M0NzBxWFBrS3ZmV1FJai1yZlA0bDJRRnNoR2k1WDJuUU5ZcDgzREpQbWppQmxTLW96S0ZZZW5IWWdNZUVWU190THBmV1g4eFUxdUxVODdfWEZUcDVHYUpMdGVpQ01tbTNVR2loeXhud3NLanQyUmRJNTF2U0pWZWtkMDNKQy1oX054U1lJOFZEQ3IySzhEU281c0pWZnRtR09FZVNBTWdmSUd3LXBRZ2lBNWJQcElzQ3poWUVWMF9aMmw4bFhrRnVXNkdDOFAtRzlhUmZZajlnVWhKZUJHcHhQS0FfLWFiYTl0RnBNeENRdG5QclJ6THhsRVJUMlA2dVFuTUlsVkhnaHE5c01aYjBlLW52ZWpISU1Ca2RDaXh2cTBIRTNSTXNqYU1RY2o5UmtGa1hBaTFMTDFQMTdzVll4UWhGTF9VRG1nakxHeWxlOHV4cTBVS3hDTU1aUXFWUV9iV1E0MFNqSFA2VEtla3hSSTFwSUJjTE5OeDB5YWR1RHlHbTI0bk9PbUhzbGJaU3NQdVk1YVM3ZE9UVnFHcUxqTVhuWVYtVGRGYTZwaU5JUlRkblUyWTVfS3Qxa0NNcmN3UGZJdnJSLVgxZGN4WGc5Wnd3TzVFMElnSTMtQXVkdGdPaHp3OFdQS0VTeGxGUXdhcjBUSVZXa3hUNGtTMzR5NVhsbzhJOGxINGJ1T3pWRTA9', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY', 'code_verifier': 'XJfLC28SMAf3Ae9aKk8kUYjRJFT8GbMO0iQtXqTeO0G1rkkprxlRmdmukuYG0mAi'}
2023-10-17 21:08:01,332 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 21:08:01,332 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f0042281fd0>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=cWApEvU0LmBjFyjMK6LziVbAWWF0MNJY&code=Z0FBQUFBQmxMdHVSdjQ0QXJFNjJ3NlotMDl0QUpnZXBCRkxEcWU5UVk3d2p4YzdCTmc1NEpiUm0xYlZxRnVSUUhXWGE2R0VyX1BfTUdndkg5aFRybjNIbFpMRktYdGcxT2Z4cXQ2UEJ4R2xWalNHOXp2M0xMY2tPOUpWeVNxRDBsbnphaVlzSjkxYm5IU0dZczV4Ynp1NnJvTDBBNkVYTEpKZldMSHdlcWpIa2M0NzBxWFBrS3ZmV1FJai1yZlA0bDJRRnNoR2k1WDJuUU5ZcDgzREpQbWppQmxTLW96S0ZZZW5IWWdNZUVWU190THBmV1g4eFUxdUxVODdfWEZUcDVHYUpMdGVpQ01tbTNVR2loeXhud3NLanQyUmRJNTF2U0pWZWtkMDNKQy1oX054U1lJOFZEQ3IySzhEU281c0pWZnRtR09FZVNBTWdmSUd3LXBRZ2lBNWJQcElzQ3poWUVWMF9aMmw4bFhrRnVXNkdDOFAtRzlhUmZZajlnVWhKZUJHcHhQS0FfLWFiYTl0RnBNeENRdG5QclJ6THhsRVJUMlA2dVFuTUlsVkhnaHE5c01aYjBlLW52ZWpISU1Ca2RDaXh2cTBIRTNSTXNqYU1RY2o5UmtGa1hBaTFMTDFQMTdzVll4UWhGTF9VRG1nakxHeWxlOHV4cTBVS3hDTU1aUXFWUV9iV1E0MFNqSFA2VEtla3hSSTFwSUJjTE5OeDB5YWR1RHlHbTI0bk9PbUhzbGJaU3NQdVk1YVM3ZE9UVnFHcUxqTVhuWVYtVGRGYTZwaU5JUlRkblUyWTVfS3Qxa0NNcmN3UGZJdnJSLVgxZGN4WGc5Wnd3TzVFMElnSTMtQXVkdGdPaHp3OFdQS0VTeGxGUXdhcjBUSVZXa3hUNGtTMzR5NVhsbzhJOGxINGJ1T3pWRTA9&code_verifier=XJfLC28SMAf3Ae9aKk8kUYjRJFT8GbMO0iQtXqTeO0G1rkkprxlRmdmukuYG0mAi', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 21:08:01,333 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=cWApEvU0LmBjFyjMK6LziVbAWWF0MNJY&code=Z0FBQUFBQmxMdHVSdjQ0QXJFNjJ3NlotMDl0QUpnZXBCRkxEcWU5UVk3d2p4YzdCTmc1NEpiUm0xYlZxRnVSUUhXWGE2R0VyX1BfTUdndkg5aFRybjNIbFpMRktYdGcxT2Z4cXQ2UEJ4R2xWalNHOXp2M0xMY2tPOUpWeVNxRDBsbnphaVlzSjkxYm5IU0dZczV4Ynp1NnJvTDBBNkVYTEpKZldMSHdlcWpIa2M0NzBxWFBrS3ZmV1FJai1yZlA0bDJRRnNoR2k1WDJuUU5ZcDgzREpQbWppQmxTLW96S0ZZZW5IWWdNZUVWU190THBmV1g4eFUxdUxVODdfWEZUcDVHYUpMdGVpQ01tbTNVR2loeXhud3NLanQyUmRJNTF2U0pWZWtkMDNKQy1oX054U1lJOFZEQ3IySzhEU281c0pWZnRtR09FZVNBTWdmSUd3LXBRZ2lBNWJQcElzQ3poWUVWMF9aMmw4bFhrRnVXNkdDOFAtRzlhUmZZajlnVWhKZUJHcHhQS0FfLWFiYTl0RnBNeENRdG5QclJ6THhsRVJUMlA2dVFuTUlsVkhnaHE5c01aYjBlLW52ZWpISU1Ca2RDaXh2cTBIRTNSTXNqYU1RY2o5UmtGa1hBaTFMTDFQMTdzVll4UWhGTF9VRG1nakxHeWxlOHV4cTBVS3hDTU1aUXFWUV9iV1E0MFNqSFA2VEtla3hSSTFwSUJjTE5OeDB5YWR1RHlHbTI0bk9PbUhzbGJaU3NQdVk1YVM3ZE9UVnFHcUxqTVhuWVYtVGRGYTZwaU5JUlRkblUyWTVfS3Qxa0NNcmN3UGZJdnJSLVgxZGN4WGc5Wnd3TzVFMElnSTMtQXVkdGdPaHp3OFdQS0VTeGxGUXdhcjBUSVZXa3hUNGtTMzR5NVhsbzhJOGxINGJ1T3pWRTA9&code_verifier=XJfLC28SMAf3Ae9aKk8kUYjRJFT8GbMO0iQtXqTeO0G1rkkprxlRmdmukuYG0mAi, https_args:{'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 21:08:01,333 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:08:01,469 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 403 None
2023-10-17 21:08:01,469 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:08:01,469 oidcrp.oauth2 ERROR Error response (403): {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:08:01,469 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:08:01 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALtdADGNivhqOB3GYebUpl00LowwfxbcyPHyhcSy-CSz-RhcWO9PMiGXJsRLjogg9Tx5g3AeodA2U-O8Biwj0_vo-QwjB8VfxSPK3glVnifb34SdzeRLzQneH6v6E2k5I1QiRMUBxQpChAno3zy_yNFlSeG0k41Xm-4gwPk-GIp21XS_jT0fv-VPYW1LKxVyzwiYuVPmnku5AbCR2Y6K0An9fimELJhVYoBqfraNPGQ36wHOH0r9kWLsrf1WtgEAAKihqRs3VREYAAHXAcABAADLVYGGscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALtdADGNivhqOB3GYebUpl00LowwfxbcyPHyhcSy-CSz-RhcWO9PMiGXJsRLjogg9Tx5g3AeodA2U-O8Biwj0_vo-QwjB8VfxSPK3glVnifb34SdzeRLzQneH6v6E2k5I1QiRMUBxQpChAno3zy_yNFlSeG0k41Xm-4gwPk-GIp21XS_jT0fv-VPYW1LKxVyzwiYuVPmnku5AbCR2Y6K0An9fimELJhVYoBqfraNPGQ36wHOH0r9kWLsrf1WtgEAAKihqRs3VREYAAHXAcABAADLVYGGscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure'}
2023-10-17 21:08:01,469 oidcrp.util DEBUG resp.txt: {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:08:01,469 oidcrp.service DEBUG response format: json
2023-10-17 21:08:01,469 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 21:08:01,469 oidcrp.service DEBUG Initial response parsing => "{'error': 'unauthorized_client'}"
2023-10-17 21:08:01,469 oidcrp.service DEBUG Error response: {'error': 'unauthorized_client'}
2023-10-17 21:08:01,470 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:08:01] "[31m[1mGET /authz_cb/satosa?state=cWApEvU0LmBjFyjMK6LziVbAWWF0MNJY&scope=offline_access+openid+profile&code=Z0FBQUFBQmxMdHVSdjQ0QXJFNjJ3NlotMDl0QUpnZXBCRkxEcWU5UVk3d2p4YzdCTmc1NEpiUm0xYlZxRnVSUUhXWGE2R0VyX1BfTUdndkg5aFRybjNIbFpMRktYdGcxT2Z4cXQ2UEJ4R2xWalNHOXp2M0xMY2tPOUpWeVNxRDBsbnphaVlzSjkxYm5IU0dZczV4Ynp1NnJvTDBBNkVYTEpKZldMSHdlcWpIa2M0NzBxWFBrS3ZmV1FJai1yZlA0bDJRRnNoR2k1WDJuUU5ZcDgzREpQbWppQmxTLW96S0ZZZW5IWWdNZUVWU190THBmV1g4eFUxdUxVODdfWEZUcDVHYUpMdGVpQ01tbTNVR2loeXhud3NLanQyUmRJNTF2U0pWZWtkMDNKQy1oX054U1lJOFZEQ3IySzhEU281c0pWZnRtR09FZVNBTWdmSUd3LXBRZ2lBNWJQcElzQ3poWUVWMF9aMmw4bFhrRnVXNkdDOFAtRzlhUmZZajlnVWhKZUJHcHhQS0FfLWFiYTl0RnBNeENRdG5QclJ6THhsRVJUMlA2dVFuTUlsVkhnaHE5c01aYjBlLW52ZWpISU1Ca2RDaXh2cTBIRTNSTXNqYU1RY2o5UmtGa1hBaTFMTDFQMTdzVll4UWhGTF9VRG1nakxHeWxlOHV4cTBVS3hDTU1aUXFWUV9iV1E0MFNqSFA2VEtla3hSSTFwSUJjTE5OeDB5YWR1RHlHbTI0bk9PbUhzbGJaU3NQdVk1YVM3ZE9UVnFHcUxqTVhuWVYtVGRGYTZwaU5JUlRkblUyWTVfS3Qxa0NNcmN3UGZJdnJSLVgxZGN4WGc5Wnd3TzVFMElnSTMtQXVkdGdPaHp3OFdQS0VTeGxGUXdhcjBUSVZXa3hUNGtTMzR5NVhsbzhJOGxINGJ1T3pWRTA9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1[0m" 403 -
2023-10-17 21:11:11,119 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:11:11] "GET / HTTP/1.1" 200 -
2023-10-17 21:11:15,245 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 21:11:15,245 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 21:11:15,245 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 21:11:15,245 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 21:11:15,284 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 21:11:15,284 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 21:11:15,285 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 21:11:15,285 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 21:11:15,285 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:11:15,302 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 21:11:15,303 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:11:15,303 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 21:11:15,303 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:11:15 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACsLRYdDcftEeNS1HsNDWPewZz7HFYr4ovKZ99nBatM0s3ODZbO1Pl-5R_ZKJYo_tJhHxSZP8bKDLDxme04nooTUnpfF90LmYwsossZHkcq3pB93Z-BWso9s8T4JUYWf4vkZbZovIMsOQ1cvfa09KGOYNBclPXnWOgHh6k5mHbCL4FrTjjaGkZlEfJ7LNas19V53t2YnQZ_JzD_GAiT0KBH33ZWrP-hSYEaoVjd0ICo1Uyu-ypZ5R-btAAAAABlE_8eNMSVXAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACsLRYdDcftEeNS1HsNDWPewZz7HFYr4ovKZ99nBatM0s3ODZbO1Pl-5R_ZKJYo_tJhHxSZP8bKDLDxme04nooTUnpfF90LmYwsossZHkcq3pB93Z-BWso9s8T4JUYWf4vkZbZovIMsOQ1cvfa09KGOYNBclPXnWOgHh6k5mHbCL4FrTjjaGkZlEfJ7LNas19V53t2YnQZ_JzD_GAiT0KBH33ZWrP-hSYEaoVjd0ICo1Uyu-ypZ5R-btAAAAABlE_8eNMSVXAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 21:11:15,303 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:11:15,303 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:11:15,303 oidcrp.service DEBUG response format: json
2023-10-17 21:11:15,303 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 21:11:15,303 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 21:11:15,303 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 21:11:15,304 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 21:11:15,304 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 21:11:15,304 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:11:15,304 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:11:15,305 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:11:15,321 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 21:11:15,321 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "bGV2QXVITmp1aVprTnRyUmJRMTNTd1JydlRoR3I5SUNSWkVuT2Z4VzNfYw", "e": "AQAB", "n": "tjGsgydz39HJ7fDv6CXtsAHe7U187qCu5sCNu89E37T_WlBda2WrvPu5C5EKESGVGyZtR3NIBFV6eWj-kNyqkni7xXqKviwvtxOebYEhNI9PogEiseT5WmBhH6LaxZw2vzFMrA4ztSfWDDZW0dikF0PqM6Zz4oP-vE0Q3fcNM-XDGdkG6YWYUBurKOXYfaCcOfDEo6XxS0CDEzcnk54Nfq89NjZNS2BRT5cCzje-d-HtwOdKce3Olz5L9VlOywdVc0VKCxn04wC_Occ8dgp6zR3sO9iya-G-VVoSPsGNSpeG8-ob_s5xXGuskcpjK_Mz_nNGHLr32NUgN99hghQuwQ"}, {"kty": "EC", "use": "sig", "kid": "ajFUOXFXLTU3WjNxbWNCYTd4WU1JSmlEbkxKX3V1UkRrV0ZmU3RzNGRxbw", "crv": "P-256", "x": "q2nHd2K0BmN8fUqM7a4M4b7EVBjHrqVJnfIKYTbfl50", "y": "ER73Xi1bgnGbsO92SJAQBQtRMCv5SscEkrqU2gRQUTU"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:11:15,321 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "bGV2QXVITmp1aVprTnRyUmJRMTNTd1JydlRoR3I5SUNSWkVuT2Z4VzNfYw", "e": "AQAB", "n": "tjGsgydz39HJ7fDv6CXtsAHe7U187qCu5sCNu89E37T_WlBda2WrvPu5C5EKESGVGyZtR3NIBFV6eWj-kNyqkni7xXqKviwvtxOebYEhNI9PogEiseT5WmBhH6LaxZw2vzFMrA4ztSfWDDZW0dikF0PqM6Zz4oP-vE0Q3fcNM-XDGdkG6YWYUBurKOXYfaCcOfDEo6XxS0CDEzcnk54Nfq89NjZNS2BRT5cCzje-d-HtwOdKce3Olz5L9VlOywdVc0VKCxn04wC_Occ8dgp6zR3sO9iya-G-VVoSPsGNSpeG8-ob_s5xXGuskcpjK_Mz_nNGHLr32NUgN99hghQuwQ"}, {"kty": "EC", "use": "sig", "kid": "ajFUOXFXLTU3WjNxbWNCYTd4WU1JSmlEbkxKX3V1UkRrV0ZmU3RzNGRxbw", "crv": "P-256", "x": "q2nHd2K0BmN8fUqM7a4M4b7EVBjHrqVJnfIKYTbfl50", "y": "ER73Xi1bgnGbsO92SJAQBQtRMCv5SscEkrqU2gRQUTU"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:11:15,322 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-17 21:11:15,322 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 21:11:15,322 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 21:11:15,322 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 21:11:15,322 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'wMTS6YbUc7Wisfzd5fwxaZSK', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': '7ZFo1Krxzd4mqXIcKlgltFPTQdRvmThb'}
2023-10-17 21:11:15,322 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'wMTS6YbUc7Wisfzd5fwxaZSK', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': '7ZFo1Krxzd4mqXIcKlgltFPTQdRvmThb', 'code_challenge': 'fP_rJAEEnDmu12uU8zna-z9IsqM27AIDCGCv08fndFQ', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 21:11:15,322 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f0044ae5b90>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=wMTS6YbUc7Wisfzd5fwxaZSK&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=7ZFo1Krxzd4mqXIcKlgltFPTQdRvmThb&code_challenge=fP_rJAEEnDmu12uU8zna-z9IsqM27AIDCGCv08fndFQ&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 21:11:15,323 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:11:15] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 21:11:27,216 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 21:11:27,216 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 21:11:27,216 oidcrp.service DEBUG response format: dict
2023-10-17 21:11:27,216 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 21:11:27,216 oidcrp.service DEBUG Initial response parsing => "{'state': '7ZFo1Krxzd4mqXIcKlgltFPTQdRvmThb', 'scope': 'offline_access openid profile', 'code': 'Z0FBQUFBQmxMdHhmQkpBTjZxd1pubjNnU08yZzlBb3BlcWpUc0p1ZmZiNm9Ed0doOGxvUGFtT1F3ZzFLQW4tZDB0dGpLUVpXeGRnN2QxTEktbEd2dFlxYjNyUXJWV3NlVllVT1hLN0Raek54UEhfN1dSMlJfOGhWUU13MkZXbDdBWHVjOGZSUDBpdE51OWdqSV9ESHFNVXdPY0ltanlGYW1rYThqNFNkM0JHUXdwdVpDalFMbVhQTlg2UjQwbTVmYXNjTk1lem80N1ZVWXFCZUlxQUVNYkpmdHA5WDZBbDEybG85TFg4Y011R2VTemVLSkZTTnRsZ3BRbnNRcmlrd3QzcVp5bm5xWVBCQmhYZEZwSmwxNjBaZS10S0Jzd1BRMEVxQllwMVhORTZvamNQNUx6VmQxRFFCZ0IybmlWeGhKbnhjRjlPc3R0RU5DQ0VUd2dPVGN6RzhlUUphRnJld1gtNXZMckNLeUNXU2tKMy02Vy1DMlV6TTRZU3RFU25CWTd6X0hKQ0FINHVkaGlPQjdxdTNHdWNraWJUZlRSSlBtWUJrR0dyVld0V1V6c19GM2ZoZXJOYXl1WmwtRVA3bDM3VExaUkRwNVk5MmU5VWI4RTZLMUFJMkI3QVQ2eGJDNGxsdk11M0x0QkwtQ0gyRWZsQk05dHZUY3RGbzEyOGIwdjlVTk95MlVfVG9wUndhYm9mWFJPb0pxT3pfc1JULXZZUjFweVBLaEcwMWMyVHk1X3cyekFNVy1icWRnTzZUT0RTR2tYS1g0RVhTM3JQSGRNcG80QktIb3JEWkpiYmxkNHZjVnNUOWFrOTBsSUo0ckI1OGE5ODJmUWVKeGRKbTRidUxRMmw1NGJXTjIwUklmMG9mS08zYzVMWVhtX3ZKMHFkTS15OUktVEVNTFM1T1ppb3pOeDA9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 21:11:27,216 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 21:11:27,216 oidcrp.rp_handler DEBUG Authz response: {'state': '7ZFo1Krxzd4mqXIcKlgltFPTQdRvmThb', 'scope': 'offline_access openid profile', 'code': 'Z0FBQUFBQmxMdHhmQkpBTjZxd1pubjNnU08yZzlBb3BlcWpUc0p1ZmZiNm9Ed0doOGxvUGFtT1F3ZzFLQW4tZDB0dGpLUVpXeGRnN2QxTEktbEd2dFlxYjNyUXJWV3NlVllVT1hLN0Raek54UEhfN1dSMlJfOGhWUU13MkZXbDdBWHVjOGZSUDBpdE51OWdqSV9ESHFNVXdPY0ltanlGYW1rYThqNFNkM0JHUXdwdVpDalFMbVhQTlg2UjQwbTVmYXNjTk1lem80N1ZVWXFCZUlxQUVNYkpmdHA5WDZBbDEybG85TFg4Y011R2VTemVLSkZTTnRsZ3BRbnNRcmlrd3QzcVp5bm5xWVBCQmhYZEZwSmwxNjBaZS10S0Jzd1BRMEVxQllwMVhORTZvamNQNUx6VmQxRFFCZ0IybmlWeGhKbnhjRjlPc3R0RU5DQ0VUd2dPVGN6RzhlUUphRnJld1gtNXZMckNLeUNXU2tKMy02Vy1DMlV6TTRZU3RFU25CWTd6X0hKQ0FINHVkaGlPQjdxdTNHdWNraWJUZlRSSlBtWUJrR0dyVld0V1V6c19GM2ZoZXJOYXl1WmwtRVA3bDM3VExaUkRwNVk5MmU5VWI4RTZLMUFJMkI3QVQ2eGJDNGxsdk11M0x0QkwtQ0gyRWZsQk05dHZUY3RGbzEyOGIwdjlVTk95MlVfVG9wUndhYm9mWFJPb0pxT3pfc1JULXZZUjFweVBLaEcwMWMyVHk1X3cyekFNVy1icWRnTzZUT0RTR2tYS1g0RVhTM3JQSGRNcG80QktIb3JEWkpiYmxkNHZjVnNUOWFrOTBsSUo0ckI1OGE5ODJmUWVKeGRKbTRidUxRMmw1NGJXTjIwUklmMG9mS08zYzVMWVhtX3ZKMHFkTS15OUktVEVNTFM1T1ppb3pOeDA9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 21:11:27,216 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 21:11:27,216 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 21:11:27,216 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMdHhmQkpBTjZxd1pubjNnU08yZzlBb3BlcWpUc0p1ZmZiNm9Ed0doOGxvUGFtT1F3ZzFLQW4tZDB0dGpLUVpXeGRnN2QxTEktbEd2dFlxYjNyUXJWV3NlVllVT1hLN0Raek54UEhfN1dSMlJfOGhWUU13MkZXbDdBWHVjOGZSUDBpdE51OWdqSV9ESHFNVXdPY0ltanlGYW1rYThqNFNkM0JHUXdwdVpDalFMbVhQTlg2UjQwbTVmYXNjTk1lem80N1ZVWXFCZUlxQUVNYkpmdHA5WDZBbDEybG85TFg4Y011R2VTemVLSkZTTnRsZ3BRbnNRcmlrd3QzcVp5bm5xWVBCQmhYZEZwSmwxNjBaZS10S0Jzd1BRMEVxQllwMVhORTZvamNQNUx6VmQxRFFCZ0IybmlWeGhKbnhjRjlPc3R0RU5DQ0VUd2dPVGN6RzhlUUphRnJld1gtNXZMckNLeUNXU2tKMy02Vy1DMlV6TTRZU3RFU25CWTd6X0hKQ0FINHVkaGlPQjdxdTNHdWNraWJUZlRSSlBtWUJrR0dyVld0V1V6c19GM2ZoZXJOYXl1WmwtRVA3bDM3VExaUkRwNVk5MmU5VWI4RTZLMUFJMkI3QVQ2eGJDNGxsdk11M0x0QkwtQ0gyRWZsQk05dHZUY3RGbzEyOGIwdjlVTk95MlVfVG9wUndhYm9mWFJPb0pxT3pfc1JULXZZUjFweVBLaEcwMWMyVHk1X3cyekFNVy1icWRnTzZUT0RTR2tYS1g0RVhTM3JQSGRNcG80QktIb3JEWkpiYmxkNHZjVnNUOWFrOTBsSUo0ckI1OGE5ODJmUWVKeGRKbTRidUxRMmw1NGJXTjIwUklmMG9mS08zYzVMWVhtX3ZKMHFkTS15OUktVEVNTFM1T1ppb3pOeDA9', 'state': '7ZFo1Krxzd4mqXIcKlgltFPTQdRvmThb', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY'}
2023-10-17 21:11:27,217 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': '7ZFo1Krxzd4mqXIcKlgltFPTQdRvmThb', 'code': 'Z0FBQUFBQmxMdHhmQkpBTjZxd1pubjNnU08yZzlBb3BlcWpUc0p1ZmZiNm9Ed0doOGxvUGFtT1F3ZzFLQW4tZDB0dGpLUVpXeGRnN2QxTEktbEd2dFlxYjNyUXJWV3NlVllVT1hLN0Raek54UEhfN1dSMlJfOGhWUU13MkZXbDdBWHVjOGZSUDBpdE51OWdqSV9ESHFNVXdPY0ltanlGYW1rYThqNFNkM0JHUXdwdVpDalFMbVhQTlg2UjQwbTVmYXNjTk1lem80N1ZVWXFCZUlxQUVNYkpmdHA5WDZBbDEybG85TFg4Y011R2VTemVLSkZTTnRsZ3BRbnNRcmlrd3QzcVp5bm5xWVBCQmhYZEZwSmwxNjBaZS10S0Jzd1BRMEVxQllwMVhORTZvamNQNUx6VmQxRFFCZ0IybmlWeGhKbnhjRjlPc3R0RU5DQ0VUd2dPVGN6RzhlUUphRnJld1gtNXZMckNLeUNXU2tKMy02Vy1DMlV6TTRZU3RFU25CWTd6X0hKQ0FINHVkaGlPQjdxdTNHdWNraWJUZlRSSlBtWUJrR0dyVld0V1V6c19GM2ZoZXJOYXl1WmwtRVA3bDM3VExaUkRwNVk5MmU5VWI4RTZLMUFJMkI3QVQ2eGJDNGxsdk11M0x0QkwtQ0gyRWZsQk05dHZUY3RGbzEyOGIwdjlVTk95MlVfVG9wUndhYm9mWFJPb0pxT3pfc1JULXZZUjFweVBLaEcwMWMyVHk1X3cyekFNVy1icWRnTzZUT0RTR2tYS1g0RVhTM3JQSGRNcG80QktIb3JEWkpiYmxkNHZjVnNUOWFrOTBsSUo0ckI1OGE5ODJmUWVKeGRKbTRidUxRMmw1NGJXTjIwUklmMG9mS08zYzVMWVhtX3ZKMHFkTS15OUktVEVNTFM1T1ppb3pOeDA9', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY', 'code_verifier': 'lILU5d52MmEeX3cn5FYmpdi0VvLcRo6ZN8sXXS3DE1cTmHDPfBk6h8bAJSJwIGkS'}
2023-10-17 21:11:27,217 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 21:11:27,217 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f004229f6d0>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=7ZFo1Krxzd4mqXIcKlgltFPTQdRvmThb&code=Z0FBQUFBQmxMdHhmQkpBTjZxd1pubjNnU08yZzlBb3BlcWpUc0p1ZmZiNm9Ed0doOGxvUGFtT1F3ZzFLQW4tZDB0dGpLUVpXeGRnN2QxTEktbEd2dFlxYjNyUXJWV3NlVllVT1hLN0Raek54UEhfN1dSMlJfOGhWUU13MkZXbDdBWHVjOGZSUDBpdE51OWdqSV9ESHFNVXdPY0ltanlGYW1rYThqNFNkM0JHUXdwdVpDalFMbVhQTlg2UjQwbTVmYXNjTk1lem80N1ZVWXFCZUlxQUVNYkpmdHA5WDZBbDEybG85TFg4Y011R2VTemVLSkZTTnRsZ3BRbnNRcmlrd3QzcVp5bm5xWVBCQmhYZEZwSmwxNjBaZS10S0Jzd1BRMEVxQllwMVhORTZvamNQNUx6VmQxRFFCZ0IybmlWeGhKbnhjRjlPc3R0RU5DQ0VUd2dPVGN6RzhlUUphRnJld1gtNXZMckNLeUNXU2tKMy02Vy1DMlV6TTRZU3RFU25CWTd6X0hKQ0FINHVkaGlPQjdxdTNHdWNraWJUZlRSSlBtWUJrR0dyVld0V1V6c19GM2ZoZXJOYXl1WmwtRVA3bDM3VExaUkRwNVk5MmU5VWI4RTZLMUFJMkI3QVQ2eGJDNGxsdk11M0x0QkwtQ0gyRWZsQk05dHZUY3RGbzEyOGIwdjlVTk95MlVfVG9wUndhYm9mWFJPb0pxT3pfc1JULXZZUjFweVBLaEcwMWMyVHk1X3cyekFNVy1icWRnTzZUT0RTR2tYS1g0RVhTM3JQSGRNcG80QktIb3JEWkpiYmxkNHZjVnNUOWFrOTBsSUo0ckI1OGE5ODJmUWVKeGRKbTRidUxRMmw1NGJXTjIwUklmMG9mS08zYzVMWVhtX3ZKMHFkTS15OUktVEVNTFM1T1ppb3pOeDA9&code_verifier=lILU5d52MmEeX3cn5FYmpdi0VvLcRo6ZN8sXXS3DE1cTmHDPfBk6h8bAJSJwIGkS', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 21:11:27,217 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=7ZFo1Krxzd4mqXIcKlgltFPTQdRvmThb&code=Z0FBQUFBQmxMdHhmQkpBTjZxd1pubjNnU08yZzlBb3BlcWpUc0p1ZmZiNm9Ed0doOGxvUGFtT1F3ZzFLQW4tZDB0dGpLUVpXeGRnN2QxTEktbEd2dFlxYjNyUXJWV3NlVllVT1hLN0Raek54UEhfN1dSMlJfOGhWUU13MkZXbDdBWHVjOGZSUDBpdE51OWdqSV9ESHFNVXdPY0ltanlGYW1rYThqNFNkM0JHUXdwdVpDalFMbVhQTlg2UjQwbTVmYXNjTk1lem80N1ZVWXFCZUlxQUVNYkpmdHA5WDZBbDEybG85TFg4Y011R2VTemVLSkZTTnRsZ3BRbnNRcmlrd3QzcVp5bm5xWVBCQmhYZEZwSmwxNjBaZS10S0Jzd1BRMEVxQllwMVhORTZvamNQNUx6VmQxRFFCZ0IybmlWeGhKbnhjRjlPc3R0RU5DQ0VUd2dPVGN6RzhlUUphRnJld1gtNXZMckNLeUNXU2tKMy02Vy1DMlV6TTRZU3RFU25CWTd6X0hKQ0FINHVkaGlPQjdxdTNHdWNraWJUZlRSSlBtWUJrR0dyVld0V1V6c19GM2ZoZXJOYXl1WmwtRVA3bDM3VExaUkRwNVk5MmU5VWI4RTZLMUFJMkI3QVQ2eGJDNGxsdk11M0x0QkwtQ0gyRWZsQk05dHZUY3RGbzEyOGIwdjlVTk95MlVfVG9wUndhYm9mWFJPb0pxT3pfc1JULXZZUjFweVBLaEcwMWMyVHk1X3cyekFNVy1icWRnTzZUT0RTR2tYS1g0RVhTM3JQSGRNcG80QktIb3JEWkpiYmxkNHZjVnNUOWFrOTBsSUo0ckI1OGE5ODJmUWVKeGRKbTRidUxRMmw1NGJXTjIwUklmMG9mS08zYzVMWVhtX3ZKMHFkTS15OUktVEVNTFM1T1ppb3pOeDA9&code_verifier=lILU5d52MmEeX3cn5FYmpdi0VvLcRo6ZN8sXXS3DE1cTmHDPfBk6h8bAJSJwIGkS, https_args:{'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 21:11:27,217 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:11:27,358 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 403 None
2023-10-17 21:11:27,358 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:11:27,359 oidcrp.oauth2 ERROR Error response (403): {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:11:27,359 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:11:27 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldAC0RgyPYYjzycvD-sgryiZAJfJ2PRNPPmqADv6jctBPgpxYGdPMbGAMV5BEnyCtlBQbmy-FeuXE0Taknww_PGqw_sFzBAqG9szC8y9viPC7LCbNkm9gYoesk717YGTK79IuxfEl7mPEBI9XA6qHHeXWn6TKrK_L6Et2XkQnogNLNVMLyXlOGTcGkQyU_3H_iQks1odXLWpxG-AmorMjKzI3_ashyUQj4XD_kkrHWtS7IHnG58m-PPDupAAAAAFQpiI7OntFNAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldAC0RgyPYYjzycvD-sgryiZAJfJ2PRNPPmqADv6jctBPgpxYGdPMbGAMV5BEnyCtlBQbmy-FeuXE0Taknww_PGqw_sFzBAqG9szC8y9viPC7LCbNkm9gYoesk717YGTK79IuxfEl7mPEBI9XA6qHHeXWn6TKrK_L6Et2XkQnogNLNVMLyXlOGTcGkQyU_3H_iQks1odXLWpxG-AmorMjKzI3_ashyUQj4XD_kkrHWtS7IHnG58m-PPDupAAAAAFQpiI7OntFNAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure'}
2023-10-17 21:11:27,359 oidcrp.util DEBUG resp.txt: {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:11:27,359 oidcrp.service DEBUG response format: json
2023-10-17 21:11:27,359 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 21:11:27,359 oidcrp.service DEBUG Initial response parsing => "{'error': 'unauthorized_client'}"
2023-10-17 21:11:27,359 oidcrp.service DEBUG Error response: {'error': 'unauthorized_client'}
2023-10-17 21:11:27,360 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:11:27] "[31m[1mGET /authz_cb/satosa?state=7ZFo1Krxzd4mqXIcKlgltFPTQdRvmThb&scope=offline_access+openid+profile&code=Z0FBQUFBQmxMdHhmQkpBTjZxd1pubjNnU08yZzlBb3BlcWpUc0p1ZmZiNm9Ed0doOGxvUGFtT1F3ZzFLQW4tZDB0dGpLUVpXeGRnN2QxTEktbEd2dFlxYjNyUXJWV3NlVllVT1hLN0Raek54UEhfN1dSMlJfOGhWUU13MkZXbDdBWHVjOGZSUDBpdE51OWdqSV9ESHFNVXdPY0ltanlGYW1rYThqNFNkM0JHUXdwdVpDalFMbVhQTlg2UjQwbTVmYXNjTk1lem80N1ZVWXFCZUlxQUVNYkpmdHA5WDZBbDEybG85TFg4Y011R2VTemVLSkZTTnRsZ3BRbnNRcmlrd3QzcVp5bm5xWVBCQmhYZEZwSmwxNjBaZS10S0Jzd1BRMEVxQllwMVhORTZvamNQNUx6VmQxRFFCZ0IybmlWeGhKbnhjRjlPc3R0RU5DQ0VUd2dPVGN6RzhlUUphRnJld1gtNXZMckNLeUNXU2tKMy02Vy1DMlV6TTRZU3RFU25CWTd6X0hKQ0FINHVkaGlPQjdxdTNHdWNraWJUZlRSSlBtWUJrR0dyVld0V1V6c19GM2ZoZXJOYXl1WmwtRVA3bDM3VExaUkRwNVk5MmU5VWI4RTZLMUFJMkI3QVQ2eGJDNGxsdk11M0x0QkwtQ0gyRWZsQk05dHZUY3RGbzEyOGIwdjlVTk95MlVfVG9wUndhYm9mWFJPb0pxT3pfc1JULXZZUjFweVBLaEcwMWMyVHk1X3cyekFNVy1icWRnTzZUT0RTR2tYS1g0RVhTM3JQSGRNcG80QktIb3JEWkpiYmxkNHZjVnNUOWFrOTBsSUo0ckI1OGE5ODJmUWVKeGRKbTRidUxRMmw1NGJXTjIwUklmMG9mS08zYzVMWVhtX3ZKMHFkTS15OUktVEVNTFM1T1ppb3pOeDA9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1[0m" 403 -
2023-10-17 21:23:22,588 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:23:22] "GET / HTTP/1.1" 200 -
2023-10-17 21:23:25,915 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:23:25] "GET / HTTP/1.1" 200 -
2023-10-17 21:23:28,419 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 21:23:28,419 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 21:23:28,419 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 21:23:28,419 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 21:23:28,456 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 21:23:28,456 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 21:23:28,456 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 21:23:28,457 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 21:23:28,457 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:23:28,479 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 21:23:28,479 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:23:28,479 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 21:23:28,480 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:23:28 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACsZwyeDtlIsRSailfOfpqw0C5zRp6L741ouIErcyf0fj-8xIk6H5GneJyd1a3NxypRHYQ3GJQ5GqZbpV6GOKTnp0cE0JG09Vp1soxqMYP1V-mVsPnrd2aHPXDsX_ywapZBj9h1rKbmeULOfVCPZr-dEn-SKcqc3S4O0N2K1BIuE4-uuqTpQLuTLnfS4QnAwQhUZFxOrzz79qtBeV-pDa4J5XLpo0_DBCuQuDygvom94KitJ3irNgnkARFgzW2iZ22EAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACsZwyeDtlIsRSailfOfpqw0C5zRp6L741ouIErcyf0fj-8xIk6H5GneJyd1a3NxypRHYQ3GJQ5GqZbpV6GOKTnp0cE0JG09Vp1soxqMYP1V-mVsPnrd2aHPXDsX_ywapZBj9h1rKbmeULOfVCPZr-dEn-SKcqc3S4O0N2K1BIuE4-uuqTpQLuTLnfS4QnAwQhUZFxOrzz79qtBeV-pDa4J5XLpo0_DBCuQuDygvom94KitJ3irNgnkARFgzW2iZ22EAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 21:23:28,480 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:23:28,480 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:23:28,480 oidcrp.service DEBUG response format: json
2023-10-17 21:23:28,480 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 21:23:28,480 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 21:23:28,480 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 21:23:28,480 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 21:23:28,481 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 21:23:28,481 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:23:28,481 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:23:28,481 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:23:28,504 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 21:23:28,505 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "NmNzMTFRbnFhaTA5WXk3b01FbUVMQTItbGlaYm5ET3RoSF9GbXRVZ19KZw", "e": "AQAB", "n": "4rD9i4nY0uRdLm1sOjKwHyMEYdXCBQ0EEyUbYZK636JEHMXBN_ZJqNk0-X4qXheNYQPr7UJ4bWFOybVdeTS0AvNHZUtWOludhh88Uy6MqmTRf6laJcH9_YRiwo8Fv4SatCT5bjIcNsRnajljiHODzNDXg05IgM99nivf_QtxyoduqstUeb_qZnTYMarp4H-hVCaRgqM8-pGbPa43H5ERvshb2nRngU86PJ6N-LFZbxB0R_jQmnizKNDCfeKb9deEaZUYLKMpiXKs1yyk9bt3pbuDO5qE6AO5eo6Ag8_4k-JxfHqpzNnnLBwykSn2og8EgZHl0jrCCQRdxNBIecklww"}, {"kty": "EC", "use": "sig", "kid": "SnZlWG9KWVRqTGF5NFpEZGV3NmU0ZTg1clVubXM4aDl6bU9oQUstdEZzWQ", "crv": "P-256", "x": "zJFdC1y7yXOZHu0wxDhlUP6fHHaZ_NMIT7qpmhz-mIQ", "y": "jauvr5CVfzitDCxWroEDIoYjQdcaO-UJwKEN3koUfK0"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:23:28,505 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "NmNzMTFRbnFhaTA5WXk3b01FbUVMQTItbGlaYm5ET3RoSF9GbXRVZ19KZw", "e": "AQAB", "n": "4rD9i4nY0uRdLm1sOjKwHyMEYdXCBQ0EEyUbYZK636JEHMXBN_ZJqNk0-X4qXheNYQPr7UJ4bWFOybVdeTS0AvNHZUtWOludhh88Uy6MqmTRf6laJcH9_YRiwo8Fv4SatCT5bjIcNsRnajljiHODzNDXg05IgM99nivf_QtxyoduqstUeb_qZnTYMarp4H-hVCaRgqM8-pGbPa43H5ERvshb2nRngU86PJ6N-LFZbxB0R_jQmnizKNDCfeKb9deEaZUYLKMpiXKs1yyk9bt3pbuDO5qE6AO5eo6Ag8_4k-JxfHqpzNnnLBwykSn2og8EgZHl0jrCCQRdxNBIecklww"}, {"kty": "EC", "use": "sig", "kid": "SnZlWG9KWVRqTGF5NFpEZGV3NmU0ZTg1clVubXM4aDl6bU9oQUstdEZzWQ", "crv": "P-256", "x": "zJFdC1y7yXOZHu0wxDhlUP6fHHaZ_NMIT7qpmhz-mIQ", "y": "jauvr5CVfzitDCxWroEDIoYjQdcaO-UJwKEN3koUfK0"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:23:28,506 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-17 21:23:28,506 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 21:23:28,506 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 21:23:28,506 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 21:23:28,506 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': '72LXP5LxVEY3xEAXsMZC68ri', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'U0Lw8gSR4MpdjPdmihrpXiRJYrTA1X8k'}
2023-10-17 21:23:28,506 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': '72LXP5LxVEY3xEAXsMZC68ri', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'U0Lw8gSR4MpdjPdmihrpXiRJYrTA1X8k', 'code_challenge': 'pgBYd61oEBeHOCt2YITevazyN8AOEYTdyuEuU1b5WX4', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 21:23:28,506 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f004350ec50>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=72LXP5LxVEY3xEAXsMZC68ri&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=U0Lw8gSR4MpdjPdmihrpXiRJYrTA1X8k&code_challenge=pgBYd61oEBeHOCt2YITevazyN8AOEYTdyuEuU1b5WX4&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 21:23:28,507 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:23:28] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 21:23:49,335 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 21:23:49,335 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 21:23:49,335 oidcrp.service DEBUG response format: dict
2023-10-17 21:23:49,335 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 21:23:49,335 oidcrp.service DEBUG Initial response parsing => "{'state': 'U0Lw8gSR4MpdjPdmihrpXiRJYrTA1X8k', 'scope': 'profile openid offline_access', 'code': 'Z0FBQUFBQmxMdDlGM1lJNGRfQUNUc0wwYU5WbHdVTXV5RWliUm91RHByQWFxeVBGM0ZuRmd3UGlmTi1BRkZ2YmIzcUxoVkpKRzZaaFYwdnI2NjJobXVWTWJCa2RzZEwxWW1VT0d1Q25fZDZyT3JveC1adUNhTWw4MERKTzV0QThfNkFpVkRKNTEzWFFnRjNxR1VHQXNNcHFVOWZiUEdHQVMzZHlXenFNTkstY2s5bmIzY3dfdDZ5TUVoYUljZjFWNkltb0pwN05tbzM5ZDVnLXAyemFTVHlJWjVud2c2RVdoTWRBYUpKbFo5VThTeGlzRGVlYW5hMkoybG9mRjFhbnZHRUVCa1BpMGhCX19hSmN2aERiMmxvUmFUMEZ5ZUpIcHl6THU4SFZLRUNiTmR1RGo4b3Vmd2NQLWFYTkVSd2dhenBYWFpLQXBoYmdsOUVYWnNDYlZGLXZsOFdxTzdmMzAteHpxbHExbEVBeTZ2VXJCQUJ5V0cxdnhlXzBneUtYUHpvb3ZzMmkzRVhHM0oxM2NfU1E4OTZnNTNyTzN6WHZOUHMwbE1MRGRRUUFwTDg3cnI1djE0TjFkZjRYZUQzXzMteGtjdlZybmVReVJsNmNFTFc1YWVBczVCT3hnN1lJNjNyb1cyal8wa2l4WDhOLVA1WTlOYXJheGJhOEN1S1lYT3hUb3pJUzRTUFlObE5XZTNhRGZPbG9XUlF6ZEFjdlJZS3BRenNKSll4dElNeUhzRjVFMEx1TFpKRnJkNmtXYWxkVUFwYjc1NUZkY1c4eTBLNTJoS2tVVUdOdGpqZkxUOWkyUFJSUnVBc1NrVkt6dmVuNXcxNUM3VS1DVFlBTDg3Ukk4dHlDckFtbDhsUFR1UnVHd054dWx5MWdpVmx3YW5VdkxZazZaU2JSeGU5X3o0ZmhMTlk9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 21:23:49,335 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 21:23:49,335 oidcrp.rp_handler DEBUG Authz response: {'state': 'U0Lw8gSR4MpdjPdmihrpXiRJYrTA1X8k', 'scope': 'profile openid offline_access', 'code': 'Z0FBQUFBQmxMdDlGM1lJNGRfQUNUc0wwYU5WbHdVTXV5RWliUm91RHByQWFxeVBGM0ZuRmd3UGlmTi1BRkZ2YmIzcUxoVkpKRzZaaFYwdnI2NjJobXVWTWJCa2RzZEwxWW1VT0d1Q25fZDZyT3JveC1adUNhTWw4MERKTzV0QThfNkFpVkRKNTEzWFFnRjNxR1VHQXNNcHFVOWZiUEdHQVMzZHlXenFNTkstY2s5bmIzY3dfdDZ5TUVoYUljZjFWNkltb0pwN05tbzM5ZDVnLXAyemFTVHlJWjVud2c2RVdoTWRBYUpKbFo5VThTeGlzRGVlYW5hMkoybG9mRjFhbnZHRUVCa1BpMGhCX19hSmN2aERiMmxvUmFUMEZ5ZUpIcHl6THU4SFZLRUNiTmR1RGo4b3Vmd2NQLWFYTkVSd2dhenBYWFpLQXBoYmdsOUVYWnNDYlZGLXZsOFdxTzdmMzAteHpxbHExbEVBeTZ2VXJCQUJ5V0cxdnhlXzBneUtYUHpvb3ZzMmkzRVhHM0oxM2NfU1E4OTZnNTNyTzN6WHZOUHMwbE1MRGRRUUFwTDg3cnI1djE0TjFkZjRYZUQzXzMteGtjdlZybmVReVJsNmNFTFc1YWVBczVCT3hnN1lJNjNyb1cyal8wa2l4WDhOLVA1WTlOYXJheGJhOEN1S1lYT3hUb3pJUzRTUFlObE5XZTNhRGZPbG9XUlF6ZEFjdlJZS3BRenNKSll4dElNeUhzRjVFMEx1TFpKRnJkNmtXYWxkVUFwYjc1NUZkY1c4eTBLNTJoS2tVVUdOdGpqZkxUOWkyUFJSUnVBc1NrVkt6dmVuNXcxNUM3VS1DVFlBTDg3Ukk4dHlDckFtbDhsUFR1UnVHd054dWx5MWdpVmx3YW5VdkxZazZaU2JSeGU5X3o0ZmhMTlk9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 21:23:49,335 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 21:23:49,336 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 21:23:49,336 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMdDlGM1lJNGRfQUNUc0wwYU5WbHdVTXV5RWliUm91RHByQWFxeVBGM0ZuRmd3UGlmTi1BRkZ2YmIzcUxoVkpKRzZaaFYwdnI2NjJobXVWTWJCa2RzZEwxWW1VT0d1Q25fZDZyT3JveC1adUNhTWw4MERKTzV0QThfNkFpVkRKNTEzWFFnRjNxR1VHQXNNcHFVOWZiUEdHQVMzZHlXenFNTkstY2s5bmIzY3dfdDZ5TUVoYUljZjFWNkltb0pwN05tbzM5ZDVnLXAyemFTVHlJWjVud2c2RVdoTWRBYUpKbFo5VThTeGlzRGVlYW5hMkoybG9mRjFhbnZHRUVCa1BpMGhCX19hSmN2aERiMmxvUmFUMEZ5ZUpIcHl6THU4SFZLRUNiTmR1RGo4b3Vmd2NQLWFYTkVSd2dhenBYWFpLQXBoYmdsOUVYWnNDYlZGLXZsOFdxTzdmMzAteHpxbHExbEVBeTZ2VXJCQUJ5V0cxdnhlXzBneUtYUHpvb3ZzMmkzRVhHM0oxM2NfU1E4OTZnNTNyTzN6WHZOUHMwbE1MRGRRUUFwTDg3cnI1djE0TjFkZjRYZUQzXzMteGtjdlZybmVReVJsNmNFTFc1YWVBczVCT3hnN1lJNjNyb1cyal8wa2l4WDhOLVA1WTlOYXJheGJhOEN1S1lYT3hUb3pJUzRTUFlObE5XZTNhRGZPbG9XUlF6ZEFjdlJZS3BRenNKSll4dElNeUhzRjVFMEx1TFpKRnJkNmtXYWxkVUFwYjc1NUZkY1c4eTBLNTJoS2tVVUdOdGpqZkxUOWkyUFJSUnVBc1NrVkt6dmVuNXcxNUM3VS1DVFlBTDg3Ukk4dHlDckFtbDhsUFR1UnVHd054dWx5MWdpVmx3YW5VdkxZazZaU2JSeGU5X3o0ZmhMTlk9', 'state': 'U0Lw8gSR4MpdjPdmihrpXiRJYrTA1X8k', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY'}
2023-10-17 21:23:49,336 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'U0Lw8gSR4MpdjPdmihrpXiRJYrTA1X8k', 'code': 'Z0FBQUFBQmxMdDlGM1lJNGRfQUNUc0wwYU5WbHdVTXV5RWliUm91RHByQWFxeVBGM0ZuRmd3UGlmTi1BRkZ2YmIzcUxoVkpKRzZaaFYwdnI2NjJobXVWTWJCa2RzZEwxWW1VT0d1Q25fZDZyT3JveC1adUNhTWw4MERKTzV0QThfNkFpVkRKNTEzWFFnRjNxR1VHQXNNcHFVOWZiUEdHQVMzZHlXenFNTkstY2s5bmIzY3dfdDZ5TUVoYUljZjFWNkltb0pwN05tbzM5ZDVnLXAyemFTVHlJWjVud2c2RVdoTWRBYUpKbFo5VThTeGlzRGVlYW5hMkoybG9mRjFhbnZHRUVCa1BpMGhCX19hSmN2aERiMmxvUmFUMEZ5ZUpIcHl6THU4SFZLRUNiTmR1RGo4b3Vmd2NQLWFYTkVSd2dhenBYWFpLQXBoYmdsOUVYWnNDYlZGLXZsOFdxTzdmMzAteHpxbHExbEVBeTZ2VXJCQUJ5V0cxdnhlXzBneUtYUHpvb3ZzMmkzRVhHM0oxM2NfU1E4OTZnNTNyTzN6WHZOUHMwbE1MRGRRUUFwTDg3cnI1djE0TjFkZjRYZUQzXzMteGtjdlZybmVReVJsNmNFTFc1YWVBczVCT3hnN1lJNjNyb1cyal8wa2l4WDhOLVA1WTlOYXJheGJhOEN1S1lYT3hUb3pJUzRTUFlObE5XZTNhRGZPbG9XUlF6ZEFjdlJZS3BRenNKSll4dElNeUhzRjVFMEx1TFpKRnJkNmtXYWxkVUFwYjc1NUZkY1c4eTBLNTJoS2tVVUdOdGpqZkxUOWkyUFJSUnVBc1NrVkt6dmVuNXcxNUM3VS1DVFlBTDg3Ukk4dHlDckFtbDhsUFR1UnVHd054dWx5MWdpVmx3YW5VdkxZazZaU2JSeGU5X3o0ZmhMTlk9', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY', 'code_verifier': 'H5LSvr4zK0Ri5pU3qUExv9swmR6OZguxiTVTRyFnk320QQJaNQd5DG9QjtbyTET8'}
2023-10-17 21:23:49,336 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 21:23:49,336 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f00422ab790>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=U0Lw8gSR4MpdjPdmihrpXiRJYrTA1X8k&code=Z0FBQUFBQmxMdDlGM1lJNGRfQUNUc0wwYU5WbHdVTXV5RWliUm91RHByQWFxeVBGM0ZuRmd3UGlmTi1BRkZ2YmIzcUxoVkpKRzZaaFYwdnI2NjJobXVWTWJCa2RzZEwxWW1VT0d1Q25fZDZyT3JveC1adUNhTWw4MERKTzV0QThfNkFpVkRKNTEzWFFnRjNxR1VHQXNNcHFVOWZiUEdHQVMzZHlXenFNTkstY2s5bmIzY3dfdDZ5TUVoYUljZjFWNkltb0pwN05tbzM5ZDVnLXAyemFTVHlJWjVud2c2RVdoTWRBYUpKbFo5VThTeGlzRGVlYW5hMkoybG9mRjFhbnZHRUVCa1BpMGhCX19hSmN2aERiMmxvUmFUMEZ5ZUpIcHl6THU4SFZLRUNiTmR1RGo4b3Vmd2NQLWFYTkVSd2dhenBYWFpLQXBoYmdsOUVYWnNDYlZGLXZsOFdxTzdmMzAteHpxbHExbEVBeTZ2VXJCQUJ5V0cxdnhlXzBneUtYUHpvb3ZzMmkzRVhHM0oxM2NfU1E4OTZnNTNyTzN6WHZOUHMwbE1MRGRRUUFwTDg3cnI1djE0TjFkZjRYZUQzXzMteGtjdlZybmVReVJsNmNFTFc1YWVBczVCT3hnN1lJNjNyb1cyal8wa2l4WDhOLVA1WTlOYXJheGJhOEN1S1lYT3hUb3pJUzRTUFlObE5XZTNhRGZPbG9XUlF6ZEFjdlJZS3BRenNKSll4dElNeUhzRjVFMEx1TFpKRnJkNmtXYWxkVUFwYjc1NUZkY1c4eTBLNTJoS2tVVUdOdGpqZkxUOWkyUFJSUnVBc1NrVkt6dmVuNXcxNUM3VS1DVFlBTDg3Ukk4dHlDckFtbDhsUFR1UnVHd054dWx5MWdpVmx3YW5VdkxZazZaU2JSeGU5X3o0ZmhMTlk9&code_verifier=H5LSvr4zK0Ri5pU3qUExv9swmR6OZguxiTVTRyFnk320QQJaNQd5DG9QjtbyTET8', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 21:23:49,336 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=U0Lw8gSR4MpdjPdmihrpXiRJYrTA1X8k&code=Z0FBQUFBQmxMdDlGM1lJNGRfQUNUc0wwYU5WbHdVTXV5RWliUm91RHByQWFxeVBGM0ZuRmd3UGlmTi1BRkZ2YmIzcUxoVkpKRzZaaFYwdnI2NjJobXVWTWJCa2RzZEwxWW1VT0d1Q25fZDZyT3JveC1adUNhTWw4MERKTzV0QThfNkFpVkRKNTEzWFFnRjNxR1VHQXNNcHFVOWZiUEdHQVMzZHlXenFNTkstY2s5bmIzY3dfdDZ5TUVoYUljZjFWNkltb0pwN05tbzM5ZDVnLXAyemFTVHlJWjVud2c2RVdoTWRBYUpKbFo5VThTeGlzRGVlYW5hMkoybG9mRjFhbnZHRUVCa1BpMGhCX19hSmN2aERiMmxvUmFUMEZ5ZUpIcHl6THU4SFZLRUNiTmR1RGo4b3Vmd2NQLWFYTkVSd2dhenBYWFpLQXBoYmdsOUVYWnNDYlZGLXZsOFdxTzdmMzAteHpxbHExbEVBeTZ2VXJCQUJ5V0cxdnhlXzBneUtYUHpvb3ZzMmkzRVhHM0oxM2NfU1E4OTZnNTNyTzN6WHZOUHMwbE1MRGRRUUFwTDg3cnI1djE0TjFkZjRYZUQzXzMteGtjdlZybmVReVJsNmNFTFc1YWVBczVCT3hnN1lJNjNyb1cyal8wa2l4WDhOLVA1WTlOYXJheGJhOEN1S1lYT3hUb3pJUzRTUFlObE5XZTNhRGZPbG9XUlF6ZEFjdlJZS3BRenNKSll4dElNeUhzRjVFMEx1TFpKRnJkNmtXYWxkVUFwYjc1NUZkY1c4eTBLNTJoS2tVVUdOdGpqZkxUOWkyUFJSUnVBc1NrVkt6dmVuNXcxNUM3VS1DVFlBTDg3Ukk4dHlDckFtbDhsUFR1UnVHd054dWx5MWdpVmx3YW5VdkxZazZaU2JSeGU5X3o0ZmhMTlk9&code_verifier=H5LSvr4zK0Ri5pU3qUExv9swmR6OZguxiTVTRyFnk320QQJaNQd5DG9QjtbyTET8, https_args:{'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 21:23:49,336 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:23:49,489 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 403 None
2023-10-17 21:23:49,489 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:23:49,489 oidcrp.oauth2 ERROR Error response (403): {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:23:49,489 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:23:49 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldAC-TAqNq2Zzxj0OXtJuGtm_s8_jTUnLoOVbw_A0eAWlZC3blcRyKDk5WNAh6qXuNHsrZBPW2M3DjU7wHTyCxG5S4sMjF7QKh2xvfbe51O0h2on4pF6wxHUcTLAb7Ou5BAUes1sY1p-FbMtvOxl7JFsVze7aqN1ouXAo33g3l1AXzvnzd4-Q3ls_vEm6hotIbLD94RhkXSSBQq8_FoD-OZt6iA82gUoqW3S6dXspZ6UFDOGzluaBM0gwAAAAAAESxOqc0AvHGAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldAC-TAqNq2Zzxj0OXtJuGtm_s8_jTUnLoOVbw_A0eAWlZC3blcRyKDk5WNAh6qXuNHsrZBPW2M3DjU7wHTyCxG5S4sMjF7QKh2xvfbe51O0h2on4pF6wxHUcTLAb7Ou5BAUes1sY1p-FbMtvOxl7JFsVze7aqN1ouXAo33g3l1AXzvnzd4-Q3ls_vEm6hotIbLD94RhkXSSBQq8_FoD-OZt6iA82gUoqW3S6dXspZ6UFDOGzluaBM0gwAAAAAAESxOqc0AvHGAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure'}
2023-10-17 21:23:49,489 oidcrp.util DEBUG resp.txt: {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:23:49,489 oidcrp.service DEBUG response format: json
2023-10-17 21:23:49,489 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 21:23:49,489 oidcrp.service DEBUG Initial response parsing => "{'error': 'unauthorized_client'}"
2023-10-17 21:23:49,489 oidcrp.service DEBUG Error response: {'error': 'unauthorized_client'}
2023-10-17 21:23:49,491 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:23:49] "[31m[1mGET /authz_cb/satosa?state=U0Lw8gSR4MpdjPdmihrpXiRJYrTA1X8k&scope=profile+openid+offline_access&code=Z0FBQUFBQmxMdDlGM1lJNGRfQUNUc0wwYU5WbHdVTXV5RWliUm91RHByQWFxeVBGM0ZuRmd3UGlmTi1BRkZ2YmIzcUxoVkpKRzZaaFYwdnI2NjJobXVWTWJCa2RzZEwxWW1VT0d1Q25fZDZyT3JveC1adUNhTWw4MERKTzV0QThfNkFpVkRKNTEzWFFnRjNxR1VHQXNNcHFVOWZiUEdHQVMzZHlXenFNTkstY2s5bmIzY3dfdDZ5TUVoYUljZjFWNkltb0pwN05tbzM5ZDVnLXAyemFTVHlJWjVud2c2RVdoTWRBYUpKbFo5VThTeGlzRGVlYW5hMkoybG9mRjFhbnZHRUVCa1BpMGhCX19hSmN2aERiMmxvUmFUMEZ5ZUpIcHl6THU4SFZLRUNiTmR1RGo4b3Vmd2NQLWFYTkVSd2dhenBYWFpLQXBoYmdsOUVYWnNDYlZGLXZsOFdxTzdmMzAteHpxbHExbEVBeTZ2VXJCQUJ5V0cxdnhlXzBneUtYUHpvb3ZzMmkzRVhHM0oxM2NfU1E4OTZnNTNyTzN6WHZOUHMwbE1MRGRRUUFwTDg3cnI1djE0TjFkZjRYZUQzXzMteGtjdlZybmVReVJsNmNFTFc1YWVBczVCT3hnN1lJNjNyb1cyal8wa2l4WDhOLVA1WTlOYXJheGJhOEN1S1lYT3hUb3pJUzRTUFlObE5XZTNhRGZPbG9XUlF6ZEFjdlJZS3BRenNKSll4dElNeUhzRjVFMEx1TFpKRnJkNmtXYWxkVUFwYjc1NUZkY1c4eTBLNTJoS2tVVUdOdGpqZkxUOWkyUFJSUnVBc1NrVkt6dmVuNXcxNUM3VS1DVFlBTDg3Ukk4dHlDckFtbDhsUFR1UnVHd054dWx5MWdpVmx3YW5VdkxZazZaU2JSeGU5X3o0ZmhMTlk9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1[0m" 403 -
2023-10-17 21:29:37,600 root DEBUG Configured logging using dictionary
2023-10-17 21:29:37,639 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-17 21:29:37,639 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-17 21:29:37,640 werkzeug INFO  * Restarting with stat
2023-10-17 21:29:37,818 root DEBUG Configured logging using dictionary
2023-10-17 21:29:37,855 werkzeug WARNING  * Debugger is active!
2023-10-17 21:29:37,855 werkzeug INFO  * Debugger PIN: 506-049-290
2023-10-17 21:29:46,096 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 21:29:46,096 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 21:29:46,096 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 21:29:46,096 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 21:29:46,132 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 21:29:46,132 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 21:29:46,132 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 21:29:46,132 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 21:29:46,134 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:29:46,151 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 21:29:46,151 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:29:46,151 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 21:29:46,151 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:29:46 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACWVwmXYuEZZT9VZHxckjQXe2LWNbzQRJO4R_oBiNwiRSXhNK-aWgZY_75abwLWleW-NBMX4tqbLJCyhdEMAuPxZcIv-xamt9hdxQStVbtRtyfFChFfT1r_GpoDh7FtwiDOvvvHF_2jrdLgmeIlsixH0f5BqxRK_pJyu59U0FdyjAvBIXBZWTtsFZ-XtvRGv37-VrvDc_rFHabSz7Vtpb-DrjomkshSfPLnvnwUCBsHoDw3G6bqg1QAA-q5y2bZNvjAAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACWVwmXYuEZZT9VZHxckjQXe2LWNbzQRJO4R_oBiNwiRSXhNK-aWgZY_75abwLWleW-NBMX4tqbLJCyhdEMAuPxZcIv-xamt9hdxQStVbtRtyfFChFfT1r_GpoDh7FtwiDOvvvHF_2jrdLgmeIlsixH0f5BqxRK_pJyu59U0FdyjAvBIXBZWTtsFZ-XtvRGv37-VrvDc_rFHabSz7Vtpb-DrjomkshSfPLnvnwUCBsHoDw3G6bqg1QAA-q5y2bZNvjAAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 21:29:46,151 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:29:46,151 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:29:46,151 oidcrp.service DEBUG response format: json
2023-10-17 21:29:46,151 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 21:29:46,152 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 21:29:46,152 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 21:29:46,152 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 21:29:46,153 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 21:29:46,153 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:29:46,153 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:29:46,153 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:29:46,170 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 21:29:46,170 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "NmNzMTFRbnFhaTA5WXk3b01FbUVMQTItbGlaYm5ET3RoSF9GbXRVZ19KZw", "e": "AQAB", "n": "4rD9i4nY0uRdLm1sOjKwHyMEYdXCBQ0EEyUbYZK636JEHMXBN_ZJqNk0-X4qXheNYQPr7UJ4bWFOybVdeTS0AvNHZUtWOludhh88Uy6MqmTRf6laJcH9_YRiwo8Fv4SatCT5bjIcNsRnajljiHODzNDXg05IgM99nivf_QtxyoduqstUeb_qZnTYMarp4H-hVCaRgqM8-pGbPa43H5ERvshb2nRngU86PJ6N-LFZbxB0R_jQmnizKNDCfeKb9deEaZUYLKMpiXKs1yyk9bt3pbuDO5qE6AO5eo6Ag8_4k-JxfHqpzNnnLBwykSn2og8EgZHl0jrCCQRdxNBIecklww"}, {"kty": "EC", "use": "sig", "kid": "SnZlWG9KWVRqTGF5NFpEZGV3NmU0ZTg1clVubXM4aDl6bU9oQUstdEZzWQ", "crv": "P-256", "x": "zJFdC1y7yXOZHu0wxDhlUP6fHHaZ_NMIT7qpmhz-mIQ", "y": "jauvr5CVfzitDCxWroEDIoYjQdcaO-UJwKEN3koUfK0"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:29:46,170 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "NmNzMTFRbnFhaTA5WXk3b01FbUVMQTItbGlaYm5ET3RoSF9GbXRVZ19KZw", "e": "AQAB", "n": "4rD9i4nY0uRdLm1sOjKwHyMEYdXCBQ0EEyUbYZK636JEHMXBN_ZJqNk0-X4qXheNYQPr7UJ4bWFOybVdeTS0AvNHZUtWOludhh88Uy6MqmTRf6laJcH9_YRiwo8Fv4SatCT5bjIcNsRnajljiHODzNDXg05IgM99nivf_QtxyoduqstUeb_qZnTYMarp4H-hVCaRgqM8-pGbPa43H5ERvshb2nRngU86PJ6N-LFZbxB0R_jQmnizKNDCfeKb9deEaZUYLKMpiXKs1yyk9bt3pbuDO5qE6AO5eo6Ag8_4k-JxfHqpzNnnLBwykSn2og8EgZHl0jrCCQRdxNBIecklww"}, {"kty": "EC", "use": "sig", "kid": "SnZlWG9KWVRqTGF5NFpEZGV3NmU0ZTg1clVubXM4aDl6bU9oQUstdEZzWQ", "crv": "P-256", "x": "zJFdC1y7yXOZHu0wxDhlUP6fHHaZ_NMIT7qpmhz-mIQ", "y": "jauvr5CVfzitDCxWroEDIoYjQdcaO-UJwKEN3koUfK0"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:29:46,171 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'prompt': 'consent'}
2023-10-17 21:29:46,171 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 21:29:46,171 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 21:29:46,171 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 21:29:46,171 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'ex08bHuFYcHEnhCZMB5SPSrf', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'RI18yDqcOOndBnVh0XNTPS6bFBdTC54Z'}
2023-10-17 21:29:46,172 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'ex08bHuFYcHEnhCZMB5SPSrf', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'RI18yDqcOOndBnVh0XNTPS6bFBdTC54Z', 'code_challenge': '8XcEPm3ryl12Tqml8qpW2JFAw5ZfiJHHLhxVvEqPUoQ', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 21:29:46,172 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f81b558de50>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=ex08bHuFYcHEnhCZMB5SPSrf&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=RI18yDqcOOndBnVh0XNTPS6bFBdTC54Z&code_challenge=8XcEPm3ryl12Tqml8qpW2JFAw5ZfiJHHLhxVvEqPUoQ&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 21:29:46,172 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:29:46] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 21:29:55,215 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 21:29:55,215 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 21:29:55,215 oidcrp.service DEBUG response format: dict
2023-10-17 21:29:55,215 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 21:29:55,215 oidcrp.service DEBUG Initial response parsing => "{'state': 'RI18yDqcOOndBnVh0XNTPS6bFBdTC54Z', 'scope': 'profile openid offline_access', 'code': 'Z0FBQUFBQmxMdUN6UXhTMnlYUHdiamc2VFpEeXhDdnpZeExTUDU2LUJTQ2FWYi1oQUpjOEZ0MDFYckV2YTdHeHJmWXdXMEVPVTJsWEFHYkhRTk13RksyOVpBU3NrLVhEQmpyU3JoWEViLVBqOUVhc19PLUlWcnBlYnpBUU5DVWJkT3p1YUtkZXpINk0taWVpY0dYdzJvUGxqVC1MemQzM3NTV1E3bEpVaXVTTUFmclR6TVRHN00yM1BheUtvZXNhUDh6SG5oOHJ5YnBBT2JLeDl4OWtpd0hFd1JXaVNPa0Y3cFliOTFlVUJpcTZoY1p2XzM3S2lWY0xBcFVmaHJCWmZpa2V0U3hkS2ctVmxmaXducGZYR0dzSmdvV1JURkRxRVBwMTNieTdnanoteG9vVWpILTlwbV9kUGJtX2xuY2NfelVUYXJ6Tmc1VGx2WFFqeHlJam14MEJRZEtubGhzR1ZXd2I4UHJ2eldzdkpLeXhKRG1xMXZtOWwxSVMyS1p0OFJsMTcwYmxUM05ialVvTk16VnR6VC0zMGRKbThzT3pXQl9TU05hMFQ1QnFFNWZ5X1JsRHB4TkJRdHFyRU83R0d3SUtWd0dLdVB6YWkwc1pXQ3pLWW5yenM3eUFTWGFkaF9SSWg3VHFOSl9jWmFTdTVNNkgxWkZacnBkTkltaklLUFlZLThJME9UQjllYTFEdnVMWlhaQTBoOHdaWlZ0NmR4YkJRckRFNHNaQVc5RjJDNE9UM0g0RUJmZC10RDgyNmNQckdTSTc0U1YtWmJhbVB5WjJSM3lsYmFFLVlGVmlhR1AwaGV5eGppTnhFS0htdGJkSUI2QjFWdl9BMUkzYTllSDdBRl9QTWJuSUpTUG53em5uODd2VkdfSWZrcmhNalhsMzF2RWJHTWU0Ulc1SXk1VVFtMGc9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 21:29:55,215 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 21:29:55,215 oidcrp.rp_handler DEBUG Authz response: {'state': 'RI18yDqcOOndBnVh0XNTPS6bFBdTC54Z', 'scope': 'profile openid offline_access', 'code': 'Z0FBQUFBQmxMdUN6UXhTMnlYUHdiamc2VFpEeXhDdnpZeExTUDU2LUJTQ2FWYi1oQUpjOEZ0MDFYckV2YTdHeHJmWXdXMEVPVTJsWEFHYkhRTk13RksyOVpBU3NrLVhEQmpyU3JoWEViLVBqOUVhc19PLUlWcnBlYnpBUU5DVWJkT3p1YUtkZXpINk0taWVpY0dYdzJvUGxqVC1MemQzM3NTV1E3bEpVaXVTTUFmclR6TVRHN00yM1BheUtvZXNhUDh6SG5oOHJ5YnBBT2JLeDl4OWtpd0hFd1JXaVNPa0Y3cFliOTFlVUJpcTZoY1p2XzM3S2lWY0xBcFVmaHJCWmZpa2V0U3hkS2ctVmxmaXducGZYR0dzSmdvV1JURkRxRVBwMTNieTdnanoteG9vVWpILTlwbV9kUGJtX2xuY2NfelVUYXJ6Tmc1VGx2WFFqeHlJam14MEJRZEtubGhzR1ZXd2I4UHJ2eldzdkpLeXhKRG1xMXZtOWwxSVMyS1p0OFJsMTcwYmxUM05ialVvTk16VnR6VC0zMGRKbThzT3pXQl9TU05hMFQ1QnFFNWZ5X1JsRHB4TkJRdHFyRU83R0d3SUtWd0dLdVB6YWkwc1pXQ3pLWW5yenM3eUFTWGFkaF9SSWg3VHFOSl9jWmFTdTVNNkgxWkZacnBkTkltaklLUFlZLThJME9UQjllYTFEdnVMWlhaQTBoOHdaWlZ0NmR4YkJRckRFNHNaQVc5RjJDNE9UM0g0RUJmZC10RDgyNmNQckdTSTc0U1YtWmJhbVB5WjJSM3lsYmFFLVlGVmlhR1AwaGV5eGppTnhFS0htdGJkSUI2QjFWdl9BMUkzYTllSDdBRl9QTWJuSUpTUG53em5uODd2VkdfSWZrcmhNalhsMzF2RWJHTWU0Ulc1SXk1VVFtMGc9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 21:29:55,215 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 21:29:55,216 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 21:29:55,216 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMdUN6UXhTMnlYUHdiamc2VFpEeXhDdnpZeExTUDU2LUJTQ2FWYi1oQUpjOEZ0MDFYckV2YTdHeHJmWXdXMEVPVTJsWEFHYkhRTk13RksyOVpBU3NrLVhEQmpyU3JoWEViLVBqOUVhc19PLUlWcnBlYnpBUU5DVWJkT3p1YUtkZXpINk0taWVpY0dYdzJvUGxqVC1MemQzM3NTV1E3bEpVaXVTTUFmclR6TVRHN00yM1BheUtvZXNhUDh6SG5oOHJ5YnBBT2JLeDl4OWtpd0hFd1JXaVNPa0Y3cFliOTFlVUJpcTZoY1p2XzM3S2lWY0xBcFVmaHJCWmZpa2V0U3hkS2ctVmxmaXducGZYR0dzSmdvV1JURkRxRVBwMTNieTdnanoteG9vVWpILTlwbV9kUGJtX2xuY2NfelVUYXJ6Tmc1VGx2WFFqeHlJam14MEJRZEtubGhzR1ZXd2I4UHJ2eldzdkpLeXhKRG1xMXZtOWwxSVMyS1p0OFJsMTcwYmxUM05ialVvTk16VnR6VC0zMGRKbThzT3pXQl9TU05hMFQ1QnFFNWZ5X1JsRHB4TkJRdHFyRU83R0d3SUtWd0dLdVB6YWkwc1pXQ3pLWW5yenM3eUFTWGFkaF9SSWg3VHFOSl9jWmFTdTVNNkgxWkZacnBkTkltaklLUFlZLThJME9UQjllYTFEdnVMWlhaQTBoOHdaWlZ0NmR4YkJRckRFNHNaQVc5RjJDNE9UM0g0RUJmZC10RDgyNmNQckdTSTc0U1YtWmJhbVB5WjJSM3lsYmFFLVlGVmlhR1AwaGV5eGppTnhFS0htdGJkSUI2QjFWdl9BMUkzYTllSDdBRl9QTWJuSUpTUG53em5uODd2VkdfSWZrcmhNalhsMzF2RWJHTWU0Ulc1SXk1VVFtMGc9', 'state': 'RI18yDqcOOndBnVh0XNTPS6bFBdTC54Z', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY'}
2023-10-17 21:29:55,216 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'RI18yDqcOOndBnVh0XNTPS6bFBdTC54Z', 'code': 'Z0FBQUFBQmxMdUN6UXhTMnlYUHdiamc2VFpEeXhDdnpZeExTUDU2LUJTQ2FWYi1oQUpjOEZ0MDFYckV2YTdHeHJmWXdXMEVPVTJsWEFHYkhRTk13RksyOVpBU3NrLVhEQmpyU3JoWEViLVBqOUVhc19PLUlWcnBlYnpBUU5DVWJkT3p1YUtkZXpINk0taWVpY0dYdzJvUGxqVC1MemQzM3NTV1E3bEpVaXVTTUFmclR6TVRHN00yM1BheUtvZXNhUDh6SG5oOHJ5YnBBT2JLeDl4OWtpd0hFd1JXaVNPa0Y3cFliOTFlVUJpcTZoY1p2XzM3S2lWY0xBcFVmaHJCWmZpa2V0U3hkS2ctVmxmaXducGZYR0dzSmdvV1JURkRxRVBwMTNieTdnanoteG9vVWpILTlwbV9kUGJtX2xuY2NfelVUYXJ6Tmc1VGx2WFFqeHlJam14MEJRZEtubGhzR1ZXd2I4UHJ2eldzdkpLeXhKRG1xMXZtOWwxSVMyS1p0OFJsMTcwYmxUM05ialVvTk16VnR6VC0zMGRKbThzT3pXQl9TU05hMFQ1QnFFNWZ5X1JsRHB4TkJRdHFyRU83R0d3SUtWd0dLdVB6YWkwc1pXQ3pLWW5yenM3eUFTWGFkaF9SSWg3VHFOSl9jWmFTdTVNNkgxWkZacnBkTkltaklLUFlZLThJME9UQjllYTFEdnVMWlhaQTBoOHdaWlZ0NmR4YkJRckRFNHNaQVc5RjJDNE9UM0g0RUJmZC10RDgyNmNQckdTSTc0U1YtWmJhbVB5WjJSM3lsYmFFLVlGVmlhR1AwaGV5eGppTnhFS0htdGJkSUI2QjFWdl9BMUkzYTllSDdBRl9QTWJuSUpTUG53em5uODd2VkdfSWZrcmhNalhsMzF2RWJHTWU0Ulc1SXk1VVFtMGc9', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY', 'code_verifier': 'niC5vgTHrUgsWQqB0PPC0n8XYHpi2Yl92CnWHu25gjQK2NaZzHXCyKQGyOkJvYW6'}
2023-10-17 21:29:55,216 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 21:29:55,216 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f81b6c26990>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=RI18yDqcOOndBnVh0XNTPS6bFBdTC54Z&code=Z0FBQUFBQmxMdUN6UXhTMnlYUHdiamc2VFpEeXhDdnpZeExTUDU2LUJTQ2FWYi1oQUpjOEZ0MDFYckV2YTdHeHJmWXdXMEVPVTJsWEFHYkhRTk13RksyOVpBU3NrLVhEQmpyU3JoWEViLVBqOUVhc19PLUlWcnBlYnpBUU5DVWJkT3p1YUtkZXpINk0taWVpY0dYdzJvUGxqVC1MemQzM3NTV1E3bEpVaXVTTUFmclR6TVRHN00yM1BheUtvZXNhUDh6SG5oOHJ5YnBBT2JLeDl4OWtpd0hFd1JXaVNPa0Y3cFliOTFlVUJpcTZoY1p2XzM3S2lWY0xBcFVmaHJCWmZpa2V0U3hkS2ctVmxmaXducGZYR0dzSmdvV1JURkRxRVBwMTNieTdnanoteG9vVWpILTlwbV9kUGJtX2xuY2NfelVUYXJ6Tmc1VGx2WFFqeHlJam14MEJRZEtubGhzR1ZXd2I4UHJ2eldzdkpLeXhKRG1xMXZtOWwxSVMyS1p0OFJsMTcwYmxUM05ialVvTk16VnR6VC0zMGRKbThzT3pXQl9TU05hMFQ1QnFFNWZ5X1JsRHB4TkJRdHFyRU83R0d3SUtWd0dLdVB6YWkwc1pXQ3pLWW5yenM3eUFTWGFkaF9SSWg3VHFOSl9jWmFTdTVNNkgxWkZacnBkTkltaklLUFlZLThJME9UQjllYTFEdnVMWlhaQTBoOHdaWlZ0NmR4YkJRckRFNHNaQVc5RjJDNE9UM0g0RUJmZC10RDgyNmNQckdTSTc0U1YtWmJhbVB5WjJSM3lsYmFFLVlGVmlhR1AwaGV5eGppTnhFS0htdGJkSUI2QjFWdl9BMUkzYTllSDdBRl9QTWJuSUpTUG53em5uODd2VkdfSWZrcmhNalhsMzF2RWJHTWU0Ulc1SXk1VVFtMGc9&code_verifier=niC5vgTHrUgsWQqB0PPC0n8XYHpi2Yl92CnWHu25gjQK2NaZzHXCyKQGyOkJvYW6', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 21:29:55,216 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=RI18yDqcOOndBnVh0XNTPS6bFBdTC54Z&code=Z0FBQUFBQmxMdUN6UXhTMnlYUHdiamc2VFpEeXhDdnpZeExTUDU2LUJTQ2FWYi1oQUpjOEZ0MDFYckV2YTdHeHJmWXdXMEVPVTJsWEFHYkhRTk13RksyOVpBU3NrLVhEQmpyU3JoWEViLVBqOUVhc19PLUlWcnBlYnpBUU5DVWJkT3p1YUtkZXpINk0taWVpY0dYdzJvUGxqVC1MemQzM3NTV1E3bEpVaXVTTUFmclR6TVRHN00yM1BheUtvZXNhUDh6SG5oOHJ5YnBBT2JLeDl4OWtpd0hFd1JXaVNPa0Y3cFliOTFlVUJpcTZoY1p2XzM3S2lWY0xBcFVmaHJCWmZpa2V0U3hkS2ctVmxmaXducGZYR0dzSmdvV1JURkRxRVBwMTNieTdnanoteG9vVWpILTlwbV9kUGJtX2xuY2NfelVUYXJ6Tmc1VGx2WFFqeHlJam14MEJRZEtubGhzR1ZXd2I4UHJ2eldzdkpLeXhKRG1xMXZtOWwxSVMyS1p0OFJsMTcwYmxUM05ialVvTk16VnR6VC0zMGRKbThzT3pXQl9TU05hMFQ1QnFFNWZ5X1JsRHB4TkJRdHFyRU83R0d3SUtWd0dLdVB6YWkwc1pXQ3pLWW5yenM3eUFTWGFkaF9SSWg3VHFOSl9jWmFTdTVNNkgxWkZacnBkTkltaklLUFlZLThJME9UQjllYTFEdnVMWlhaQTBoOHdaWlZ0NmR4YkJRckRFNHNaQVc5RjJDNE9UM0g0RUJmZC10RDgyNmNQckdTSTc0U1YtWmJhbVB5WjJSM3lsYmFFLVlGVmlhR1AwaGV5eGppTnhFS0htdGJkSUI2QjFWdl9BMUkzYTllSDdBRl9QTWJuSUpTUG53em5uODd2VkdfSWZrcmhNalhsMzF2RWJHTWU0Ulc1SXk1VVFtMGc9&code_verifier=niC5vgTHrUgsWQqB0PPC0n8XYHpi2Yl92CnWHu25gjQK2NaZzHXCyKQGyOkJvYW6, https_args:{'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 21:29:55,217 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:29:55,355 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 403 None
2023-10-17 21:29:55,355 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:29:55,355 oidcrp.oauth2 ERROR Error response (403): {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:29:55,355 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:29:55 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACCaSwOS-udhxnA2BvqeViUK9-DTQ3JaLrhv8FT7jCbm5AVxbV72fKrCWnHADhRYQCe6rRnRcXME2W4REpN7gT8hKevXAKyw9PB505XerzmfWDJBGsDL3_k2WRlXPcZw5PtvwnfgTsQhLHfs66JQy7Nl7nqnKKKe6zk79xU-6CE7hc6kpjFz0V32_54qdJFAfHoteRQA2TPpwJgKpiVmvTHy5uQ_QooSXpWmABwC2RBvcyoIlHLd3aXFAAAAABBQtQppzP1nAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACCaSwOS-udhxnA2BvqeViUK9-DTQ3JaLrhv8FT7jCbm5AVxbV72fKrCWnHADhRYQCe6rRnRcXME2W4REpN7gT8hKevXAKyw9PB505XerzmfWDJBGsDL3_k2WRlXPcZw5PtvwnfgTsQhLHfs66JQy7Nl7nqnKKKe6zk79xU-6CE7hc6kpjFz0V32_54qdJFAfHoteRQA2TPpwJgKpiVmvTHy5uQ_QooSXpWmABwC2RBvcyoIlHLd3aXFAAAAABBQtQppzP1nAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure'}
2023-10-17 21:29:55,355 oidcrp.util DEBUG resp.txt: {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:29:55,355 oidcrp.service DEBUG response format: json
2023-10-17 21:29:55,355 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 21:29:55,355 oidcrp.service DEBUG Initial response parsing => "{'error': 'unauthorized_client'}"
2023-10-17 21:29:55,355 oidcrp.service DEBUG Error response: {'error': 'unauthorized_client'}
2023-10-17 21:29:55,357 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:29:55] "[31m[1mGET /authz_cb/satosa?state=RI18yDqcOOndBnVh0XNTPS6bFBdTC54Z&scope=profile+openid+offline_access&code=Z0FBQUFBQmxMdUN6UXhTMnlYUHdiamc2VFpEeXhDdnpZeExTUDU2LUJTQ2FWYi1oQUpjOEZ0MDFYckV2YTdHeHJmWXdXMEVPVTJsWEFHYkhRTk13RksyOVpBU3NrLVhEQmpyU3JoWEViLVBqOUVhc19PLUlWcnBlYnpBUU5DVWJkT3p1YUtkZXpINk0taWVpY0dYdzJvUGxqVC1MemQzM3NTV1E3bEpVaXVTTUFmclR6TVRHN00yM1BheUtvZXNhUDh6SG5oOHJ5YnBBT2JLeDl4OWtpd0hFd1JXaVNPa0Y3cFliOTFlVUJpcTZoY1p2XzM3S2lWY0xBcFVmaHJCWmZpa2V0U3hkS2ctVmxmaXducGZYR0dzSmdvV1JURkRxRVBwMTNieTdnanoteG9vVWpILTlwbV9kUGJtX2xuY2NfelVUYXJ6Tmc1VGx2WFFqeHlJam14MEJRZEtubGhzR1ZXd2I4UHJ2eldzdkpLeXhKRG1xMXZtOWwxSVMyS1p0OFJsMTcwYmxUM05ialVvTk16VnR6VC0zMGRKbThzT3pXQl9TU05hMFQ1QnFFNWZ5X1JsRHB4TkJRdHFyRU83R0d3SUtWd0dLdVB6YWkwc1pXQ3pLWW5yenM3eUFTWGFkaF9SSWg3VHFOSl9jWmFTdTVNNkgxWkZacnBkTkltaklLUFlZLThJME9UQjllYTFEdnVMWlhaQTBoOHdaWlZ0NmR4YkJRckRFNHNaQVc5RjJDNE9UM0g0RUJmZC10RDgyNmNQckdTSTc0U1YtWmJhbVB5WjJSM3lsYmFFLVlGVmlhR1AwaGV5eGppTnhFS0htdGJkSUI2QjFWdl9BMUkzYTllSDdBRl9QTWJuSUpTUG53em5uODd2VkdfSWZrcmhNalhsMzF2RWJHTWU0Ulc1SXk1VVFtMGc9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1[0m" 403 -
2023-10-17 21:32:23,651 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 21:32:23,651 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 21:32:23,651 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 21:32:23,651 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 21:32:23,684 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 21:32:23,684 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 21:32:23,684 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 21:32:23,684 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 21:32:23,685 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:32:23,707 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 21:32:23,708 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:32:23,708 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 21:32:23,708 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:32:23 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddADYaR172sJV38VE-15x0OLnpxDLaWcUo6ZbTVbWZfiJk01b6MZATe1tI5-B3_EfEqq7AFNbV7PfnaDyUu4d2DQzv8eTDqGVUk4h9dC_J1-fpvT6sGJ5mnEjCu07I3ao_pXI7fhzvEu57bpZ48zROcpUjqPhADMaGfDBcs0w_FCtcQKK142Df0Ycjl1nhxnQX94bxN5zTF4olwjRGQT9hNtD6-gSEmfAD4CsW9DLu3kaDuva0D_VqxgAAOHYXDDoSqoQAAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddADYaR172sJV38VE-15x0OLnpxDLaWcUo6ZbTVbWZfiJk01b6MZATe1tI5-B3_EfEqq7AFNbV7PfnaDyUu4d2DQzv8eTDqGVUk4h9dC_J1-fpvT6sGJ5mnEjCu07I3ao_pXI7fhzvEu57bpZ48zROcpUjqPhADMaGfDBcs0w_FCtcQKK142Df0Ycjl1nhxnQX94bxN5zTF4olwjRGQT9hNtD6-gSEmfAD4CsW9DLu3kaDuva0D_VqxgAAOHYXDDoSqoQAAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 21:32:23,708 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:32:23,708 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:32:23,708 oidcrp.service DEBUG response format: json
2023-10-17 21:32:23,708 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 21:32:23,708 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 21:32:23,708 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 21:32:23,709 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 21:32:23,709 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 21:32:23,709 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:32:23,709 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:32:23,709 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:32:23,727 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 21:32:23,728 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "WUJ0MmoydmRTckJiNEtBRFdOMXZsYkdobExyb1ZvZkphNlBOTmFuQ0t2dw", "e": "AQAB", "n": "xN-ksWJwMRRt6WB3Kj3sPC8ApCb4s_CKye7WFPo5MnsXZVpy9If80l6V20QWAfQV0M32H2MGK8Sz1nrInkZyfQmbVnUIP8vCmmsog-5hZLtESGLOOuCysSQGfANLoHCgknQKG_HpdgJknz7qoWd-0Q5b_Yi-XAqoR-7zYC-2hB-hVVGajKCYkUB-mk21LM1m2yILUj-p_RKueVEgmaKmjak7ViPIJRBgQGyM7KbtHu18lEZ6KzdfYVSUBr_-0E7m3g2XRc6MpVdXJA2M3BSxedR4EoP7zoEkcleKH1GyhNwrZCoKLYnSsilWc_XM0nQM3cWxZLyaaN_CfK8KOLk9yw"}, {"kty": "EC", "use": "sig", "kid": "ZVJPaUtHU2dTN2V2a1ktblVWNW1JaGk4aEctdkxjcGgwRnlOVnNkakpPSQ", "crv": "P-256", "x": "iyvncqEWyXyK_KuZE95_VaewELA8WcUHzhmn10fdvOY", "y": "aM5IeUArvVXIrnGik7OmZs24wCEOK_x0dDhGPKsSok8"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:32:23,728 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "WUJ0MmoydmRTckJiNEtBRFdOMXZsYkdobExyb1ZvZkphNlBOTmFuQ0t2dw", "e": "AQAB", "n": "xN-ksWJwMRRt6WB3Kj3sPC8ApCb4s_CKye7WFPo5MnsXZVpy9If80l6V20QWAfQV0M32H2MGK8Sz1nrInkZyfQmbVnUIP8vCmmsog-5hZLtESGLOOuCysSQGfANLoHCgknQKG_HpdgJknz7qoWd-0Q5b_Yi-XAqoR-7zYC-2hB-hVVGajKCYkUB-mk21LM1m2yILUj-p_RKueVEgmaKmjak7ViPIJRBgQGyM7KbtHu18lEZ6KzdfYVSUBr_-0E7m3g2XRc6MpVdXJA2M3BSxedR4EoP7zoEkcleKH1GyhNwrZCoKLYnSsilWc_XM0nQM3cWxZLyaaN_CfK8KOLk9yw"}, {"kty": "EC", "use": "sig", "kid": "ZVJPaUtHU2dTN2V2a1ktblVWNW1JaGk4aEctdkxjcGgwRnlOVnNkakpPSQ", "crv": "P-256", "x": "iyvncqEWyXyK_KuZE95_VaewELA8WcUHzhmn10fdvOY", "y": "aM5IeUArvVXIrnGik7OmZs24wCEOK_x0dDhGPKsSok8"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:32:23,728 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'prompt': 'consent'}
2023-10-17 21:32:23,729 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 21:32:23,729 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 21:32:23,729 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 21:32:23,729 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 's1HIXXG2RmikRAXIOBH9dyll', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'RQlT7khbyZRfgAs7uvu8uh7wfj2OPz2B'}
2023-10-17 21:32:23,729 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 's1HIXXG2RmikRAXIOBH9dyll', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'RQlT7khbyZRfgAs7uvu8uh7wfj2OPz2B', 'code_challenge': '-5TibwFpB8ggJPWJSVLXfkVm3Z8bhBbzzwMZ0yP2g70', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 21:32:23,729 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f81b43a67d0>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=s1HIXXG2RmikRAXIOBH9dyll&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=RQlT7khbyZRfgAs7uvu8uh7wfj2OPz2B&code_challenge=-5TibwFpB8ggJPWJSVLXfkVm3Z8bhBbzzwMZ0yP2g70&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 21:32:23,730 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:32:23] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 21:32:38,057 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 21:32:38,057 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 21:32:38,057 oidcrp.service DEBUG response format: dict
2023-10-17 21:32:38,057 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 21:32:38,057 oidcrp.service DEBUG Initial response parsing => "{'state': 'RQlT7khbyZRfgAs7uvu8uh7wfj2OPz2B', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxMdUZXQTNCVHF1dGtJTGdIS214YTdoUUpuZ2puZ0Y2a2ZjcmhsTFJXZzNNYi01VWQ3MHMwbDFDYm0tU2ZXWk9mcjUwOTFWNjJ3Z2gzaFAyVWlld1lpV1pMLUwzYnI5WExFRVRTTkhRT2QzTVhTUk9icHRGcDdDTE53a3U0VUxWQTJROU1VS2h4WU1FRHk0YlhTQlFXWm1WdXZINHU1eV80bktKbFJlVUlSUEdkcWxMdFdzRTF6WnFZOThhMWV1QW1ZTEN2U01EVFg1emIzQjFzcnI3S1QtUC1pX2ljZUo1RmVDRFRpV1N3UDZydlNuVjY3SkU2NzBmaFZxalNJb1ZmakFHVW1yaktXZEtHanhoMWdwbWNGLXFuSEVJX1NidGw3LTRqbkRNc0V4Q0txM3NJQmNpcE9JR1lSUzRyRm5SQTd2UE9pdHJiRWFXSGU4c25rMXNnZ3QyaVQ1elZ4WGJBazZPVXV3d1pwNlRrM3RCY1k5S0hONXJoTGhETENNQlNaSmJxT3VncHlZaGU3TDJYN3FQQUpkN1Q0RzJVWWsySmxzclQzQ0laSWM4cFFDVjhCN2lnc2ZLT2dPV2JOZzM2Qjl1LVBySGF3dHRUcVBBcHZQU1NmMzVwbzVQYlk1ZU1SaGR3MDJkTXFxN0VHTEQ3a3ppbFNCVjViWktXWFdMV1BLTWd6LXJLMzAzWHFZX1NyQjBSMkxTYk5ZRmpVR0sxTXhBQ2ZuN01UWVZOUTRPQWNTYlFFWkctNExtek1fME0tYTBTTUhSdDhWdEJUVC1SdC1UV2lSdVIxa1VPbC15NEVXR19idmVPOVNwMUZLLVlGcFdNTFZnUU9peU5zcjR2eXdFc3YyYWlJVE50S2c5RmZVdHFUOXdzSXBHR0w2Vnc3ZHpKZ0FEeTU5MEtWNWc9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 21:32:38,057 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 21:32:38,057 oidcrp.rp_handler DEBUG Authz response: {'state': 'RQlT7khbyZRfgAs7uvu8uh7wfj2OPz2B', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxMdUZXQTNCVHF1dGtJTGdIS214YTdoUUpuZ2puZ0Y2a2ZjcmhsTFJXZzNNYi01VWQ3MHMwbDFDYm0tU2ZXWk9mcjUwOTFWNjJ3Z2gzaFAyVWlld1lpV1pMLUwzYnI5WExFRVRTTkhRT2QzTVhTUk9icHRGcDdDTE53a3U0VUxWQTJROU1VS2h4WU1FRHk0YlhTQlFXWm1WdXZINHU1eV80bktKbFJlVUlSUEdkcWxMdFdzRTF6WnFZOThhMWV1QW1ZTEN2U01EVFg1emIzQjFzcnI3S1QtUC1pX2ljZUo1RmVDRFRpV1N3UDZydlNuVjY3SkU2NzBmaFZxalNJb1ZmakFHVW1yaktXZEtHanhoMWdwbWNGLXFuSEVJX1NidGw3LTRqbkRNc0V4Q0txM3NJQmNpcE9JR1lSUzRyRm5SQTd2UE9pdHJiRWFXSGU4c25rMXNnZ3QyaVQ1elZ4WGJBazZPVXV3d1pwNlRrM3RCY1k5S0hONXJoTGhETENNQlNaSmJxT3VncHlZaGU3TDJYN3FQQUpkN1Q0RzJVWWsySmxzclQzQ0laSWM4cFFDVjhCN2lnc2ZLT2dPV2JOZzM2Qjl1LVBySGF3dHRUcVBBcHZQU1NmMzVwbzVQYlk1ZU1SaGR3MDJkTXFxN0VHTEQ3a3ppbFNCVjViWktXWFdMV1BLTWd6LXJLMzAzWHFZX1NyQjBSMkxTYk5ZRmpVR0sxTXhBQ2ZuN01UWVZOUTRPQWNTYlFFWkctNExtek1fME0tYTBTTUhSdDhWdEJUVC1SdC1UV2lSdVIxa1VPbC15NEVXR19idmVPOVNwMUZLLVlGcFdNTFZnUU9peU5zcjR2eXdFc3YyYWlJVE50S2c5RmZVdHFUOXdzSXBHR0w2Vnc3ZHpKZ0FEeTU5MEtWNWc9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 21:32:38,057 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 21:32:38,058 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 21:32:38,058 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMdUZXQTNCVHF1dGtJTGdIS214YTdoUUpuZ2puZ0Y2a2ZjcmhsTFJXZzNNYi01VWQ3MHMwbDFDYm0tU2ZXWk9mcjUwOTFWNjJ3Z2gzaFAyVWlld1lpV1pMLUwzYnI5WExFRVRTTkhRT2QzTVhTUk9icHRGcDdDTE53a3U0VUxWQTJROU1VS2h4WU1FRHk0YlhTQlFXWm1WdXZINHU1eV80bktKbFJlVUlSUEdkcWxMdFdzRTF6WnFZOThhMWV1QW1ZTEN2U01EVFg1emIzQjFzcnI3S1QtUC1pX2ljZUo1RmVDRFRpV1N3UDZydlNuVjY3SkU2NzBmaFZxalNJb1ZmakFHVW1yaktXZEtHanhoMWdwbWNGLXFuSEVJX1NidGw3LTRqbkRNc0V4Q0txM3NJQmNpcE9JR1lSUzRyRm5SQTd2UE9pdHJiRWFXSGU4c25rMXNnZ3QyaVQ1elZ4WGJBazZPVXV3d1pwNlRrM3RCY1k5S0hONXJoTGhETENNQlNaSmJxT3VncHlZaGU3TDJYN3FQQUpkN1Q0RzJVWWsySmxzclQzQ0laSWM4cFFDVjhCN2lnc2ZLT2dPV2JOZzM2Qjl1LVBySGF3dHRUcVBBcHZQU1NmMzVwbzVQYlk1ZU1SaGR3MDJkTXFxN0VHTEQ3a3ppbFNCVjViWktXWFdMV1BLTWd6LXJLMzAzWHFZX1NyQjBSMkxTYk5ZRmpVR0sxTXhBQ2ZuN01UWVZOUTRPQWNTYlFFWkctNExtek1fME0tYTBTTUhSdDhWdEJUVC1SdC1UV2lSdVIxa1VPbC15NEVXR19idmVPOVNwMUZLLVlGcFdNTFZnUU9peU5zcjR2eXdFc3YyYWlJVE50S2c5RmZVdHFUOXdzSXBHR0w2Vnc3ZHpKZ0FEeTU5MEtWNWc9', 'state': 'RQlT7khbyZRfgAs7uvu8uh7wfj2OPz2B', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY'}
2023-10-17 21:32:38,058 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'RQlT7khbyZRfgAs7uvu8uh7wfj2OPz2B', 'code': 'Z0FBQUFBQmxMdUZXQTNCVHF1dGtJTGdIS214YTdoUUpuZ2puZ0Y2a2ZjcmhsTFJXZzNNYi01VWQ3MHMwbDFDYm0tU2ZXWk9mcjUwOTFWNjJ3Z2gzaFAyVWlld1lpV1pMLUwzYnI5WExFRVRTTkhRT2QzTVhTUk9icHRGcDdDTE53a3U0VUxWQTJROU1VS2h4WU1FRHk0YlhTQlFXWm1WdXZINHU1eV80bktKbFJlVUlSUEdkcWxMdFdzRTF6WnFZOThhMWV1QW1ZTEN2U01EVFg1emIzQjFzcnI3S1QtUC1pX2ljZUo1RmVDRFRpV1N3UDZydlNuVjY3SkU2NzBmaFZxalNJb1ZmakFHVW1yaktXZEtHanhoMWdwbWNGLXFuSEVJX1NidGw3LTRqbkRNc0V4Q0txM3NJQmNpcE9JR1lSUzRyRm5SQTd2UE9pdHJiRWFXSGU4c25rMXNnZ3QyaVQ1elZ4WGJBazZPVXV3d1pwNlRrM3RCY1k5S0hONXJoTGhETENNQlNaSmJxT3VncHlZaGU3TDJYN3FQQUpkN1Q0RzJVWWsySmxzclQzQ0laSWM4cFFDVjhCN2lnc2ZLT2dPV2JOZzM2Qjl1LVBySGF3dHRUcVBBcHZQU1NmMzVwbzVQYlk1ZU1SaGR3MDJkTXFxN0VHTEQ3a3ppbFNCVjViWktXWFdMV1BLTWd6LXJLMzAzWHFZX1NyQjBSMkxTYk5ZRmpVR0sxTXhBQ2ZuN01UWVZOUTRPQWNTYlFFWkctNExtek1fME0tYTBTTUhSdDhWdEJUVC1SdC1UV2lSdVIxa1VPbC15NEVXR19idmVPOVNwMUZLLVlGcFdNTFZnUU9peU5zcjR2eXdFc3YyYWlJVE50S2c5RmZVdHFUOXdzSXBHR0w2Vnc3ZHpKZ0FEeTU5MEtWNWc9', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY', 'code_verifier': 'fVMKt1brYnfqbl1CeBYV3F6repD8XhRAT9GouH2wy7em6QcWY7r4wnIqljhmT6nR'}
2023-10-17 21:32:38,058 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 21:32:38,058 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f81b43d8f50>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=RQlT7khbyZRfgAs7uvu8uh7wfj2OPz2B&code=Z0FBQUFBQmxMdUZXQTNCVHF1dGtJTGdIS214YTdoUUpuZ2puZ0Y2a2ZjcmhsTFJXZzNNYi01VWQ3MHMwbDFDYm0tU2ZXWk9mcjUwOTFWNjJ3Z2gzaFAyVWlld1lpV1pMLUwzYnI5WExFRVRTTkhRT2QzTVhTUk9icHRGcDdDTE53a3U0VUxWQTJROU1VS2h4WU1FRHk0YlhTQlFXWm1WdXZINHU1eV80bktKbFJlVUlSUEdkcWxMdFdzRTF6WnFZOThhMWV1QW1ZTEN2U01EVFg1emIzQjFzcnI3S1QtUC1pX2ljZUo1RmVDRFRpV1N3UDZydlNuVjY3SkU2NzBmaFZxalNJb1ZmakFHVW1yaktXZEtHanhoMWdwbWNGLXFuSEVJX1NidGw3LTRqbkRNc0V4Q0txM3NJQmNpcE9JR1lSUzRyRm5SQTd2UE9pdHJiRWFXSGU4c25rMXNnZ3QyaVQ1elZ4WGJBazZPVXV3d1pwNlRrM3RCY1k5S0hONXJoTGhETENNQlNaSmJxT3VncHlZaGU3TDJYN3FQQUpkN1Q0RzJVWWsySmxzclQzQ0laSWM4cFFDVjhCN2lnc2ZLT2dPV2JOZzM2Qjl1LVBySGF3dHRUcVBBcHZQU1NmMzVwbzVQYlk1ZU1SaGR3MDJkTXFxN0VHTEQ3a3ppbFNCVjViWktXWFdMV1BLTWd6LXJLMzAzWHFZX1NyQjBSMkxTYk5ZRmpVR0sxTXhBQ2ZuN01UWVZOUTRPQWNTYlFFWkctNExtek1fME0tYTBTTUhSdDhWdEJUVC1SdC1UV2lSdVIxa1VPbC15NEVXR19idmVPOVNwMUZLLVlGcFdNTFZnUU9peU5zcjR2eXdFc3YyYWlJVE50S2c5RmZVdHFUOXdzSXBHR0w2Vnc3ZHpKZ0FEeTU5MEtWNWc9&code_verifier=fVMKt1brYnfqbl1CeBYV3F6repD8XhRAT9GouH2wy7em6QcWY7r4wnIqljhmT6nR', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 21:32:38,058 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=RQlT7khbyZRfgAs7uvu8uh7wfj2OPz2B&code=Z0FBQUFBQmxMdUZXQTNCVHF1dGtJTGdIS214YTdoUUpuZ2puZ0Y2a2ZjcmhsTFJXZzNNYi01VWQ3MHMwbDFDYm0tU2ZXWk9mcjUwOTFWNjJ3Z2gzaFAyVWlld1lpV1pMLUwzYnI5WExFRVRTTkhRT2QzTVhTUk9icHRGcDdDTE53a3U0VUxWQTJROU1VS2h4WU1FRHk0YlhTQlFXWm1WdXZINHU1eV80bktKbFJlVUlSUEdkcWxMdFdzRTF6WnFZOThhMWV1QW1ZTEN2U01EVFg1emIzQjFzcnI3S1QtUC1pX2ljZUo1RmVDRFRpV1N3UDZydlNuVjY3SkU2NzBmaFZxalNJb1ZmakFHVW1yaktXZEtHanhoMWdwbWNGLXFuSEVJX1NidGw3LTRqbkRNc0V4Q0txM3NJQmNpcE9JR1lSUzRyRm5SQTd2UE9pdHJiRWFXSGU4c25rMXNnZ3QyaVQ1elZ4WGJBazZPVXV3d1pwNlRrM3RCY1k5S0hONXJoTGhETENNQlNaSmJxT3VncHlZaGU3TDJYN3FQQUpkN1Q0RzJVWWsySmxzclQzQ0laSWM4cFFDVjhCN2lnc2ZLT2dPV2JOZzM2Qjl1LVBySGF3dHRUcVBBcHZQU1NmMzVwbzVQYlk1ZU1SaGR3MDJkTXFxN0VHTEQ3a3ppbFNCVjViWktXWFdMV1BLTWd6LXJLMzAzWHFZX1NyQjBSMkxTYk5ZRmpVR0sxTXhBQ2ZuN01UWVZOUTRPQWNTYlFFWkctNExtek1fME0tYTBTTUhSdDhWdEJUVC1SdC1UV2lSdVIxa1VPbC15NEVXR19idmVPOVNwMUZLLVlGcFdNTFZnUU9peU5zcjR2eXdFc3YyYWlJVE50S2c5RmZVdHFUOXdzSXBHR0w2Vnc3ZHpKZ0FEeTU5MEtWNWc9&code_verifier=fVMKt1brYnfqbl1CeBYV3F6repD8XhRAT9GouH2wy7em6QcWY7r4wnIqljhmT6nR, https_args:{'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 21:32:38,058 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:32:38,192 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 403 None
2023-10-17 21:32:38,192 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:32:38,193 oidcrp.oauth2 ERROR Error response (403): {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:32:38,193 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:32:38 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALtdABsUAaNw8GNERKcl6mhqd0QyGviXgjlHC_Z-okVHcxL5w_6_PFDE7eJbs75EWURk0b_zYyv0NIWcvpOTF-9v6vvygVnGK3rGAOMX7yxUkRet3_K8OEd9OkMiFn06BMSWY_GVGxc-KTflOIjnqZaWQOgauRgID4GwtEDC0nEDOXmOUYEtW29YW9GC9GptpVb7KBWyVQIqk4BI-sszZ57hdvpm9AaWV2DSd1Ao31Wq28c6OqI4Aia9m0mWV1sAAMXncIaYVBMlAAHXAcABAADLVYGGscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALtdABsUAaNw8GNERKcl6mhqd0QyGviXgjlHC_Z-okVHcxL5w_6_PFDE7eJbs75EWURk0b_zYyv0NIWcvpOTF-9v6vvygVnGK3rGAOMX7yxUkRet3_K8OEd9OkMiFn06BMSWY_GVGxc-KTflOIjnqZaWQOgauRgID4GwtEDC0nEDOXmOUYEtW29YW9GC9GptpVb7KBWyVQIqk4BI-sszZ57hdvpm9AaWV2DSd1Ao31Wq28c6OqI4Aia9m0mWV1sAAMXncIaYVBMlAAHXAcABAADLVYGGscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure'}
2023-10-17 21:32:38,193 oidcrp.util DEBUG resp.txt: {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:32:38,193 oidcrp.service DEBUG response format: json
2023-10-17 21:32:38,193 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 21:32:38,193 oidcrp.service DEBUG Initial response parsing => "{'error': 'unauthorized_client'}"
2023-10-17 21:32:38,193 oidcrp.service DEBUG Error response: {'error': 'unauthorized_client'}
2023-10-17 21:32:38,194 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:32:38] "[31m[1mGET /authz_cb/satosa?state=RQlT7khbyZRfgAs7uvu8uh7wfj2OPz2B&scope=openid+offline_access+profile&code=Z0FBQUFBQmxMdUZXQTNCVHF1dGtJTGdIS214YTdoUUpuZ2puZ0Y2a2ZjcmhsTFJXZzNNYi01VWQ3MHMwbDFDYm0tU2ZXWk9mcjUwOTFWNjJ3Z2gzaFAyVWlld1lpV1pMLUwzYnI5WExFRVRTTkhRT2QzTVhTUk9icHRGcDdDTE53a3U0VUxWQTJROU1VS2h4WU1FRHk0YlhTQlFXWm1WdXZINHU1eV80bktKbFJlVUlSUEdkcWxMdFdzRTF6WnFZOThhMWV1QW1ZTEN2U01EVFg1emIzQjFzcnI3S1QtUC1pX2ljZUo1RmVDRFRpV1N3UDZydlNuVjY3SkU2NzBmaFZxalNJb1ZmakFHVW1yaktXZEtHanhoMWdwbWNGLXFuSEVJX1NidGw3LTRqbkRNc0V4Q0txM3NJQmNpcE9JR1lSUzRyRm5SQTd2UE9pdHJiRWFXSGU4c25rMXNnZ3QyaVQ1elZ4WGJBazZPVXV3d1pwNlRrM3RCY1k5S0hONXJoTGhETENNQlNaSmJxT3VncHlZaGU3TDJYN3FQQUpkN1Q0RzJVWWsySmxzclQzQ0laSWM4cFFDVjhCN2lnc2ZLT2dPV2JOZzM2Qjl1LVBySGF3dHRUcVBBcHZQU1NmMzVwbzVQYlk1ZU1SaGR3MDJkTXFxN0VHTEQ3a3ppbFNCVjViWktXWFdMV1BLTWd6LXJLMzAzWHFZX1NyQjBSMkxTYk5ZRmpVR0sxTXhBQ2ZuN01UWVZOUTRPQWNTYlFFWkctNExtek1fME0tYTBTTUhSdDhWdEJUVC1SdC1UV2lSdVIxa1VPbC15NEVXR19idmVPOVNwMUZLLVlGcFdNTFZnUU9peU5zcjR2eXdFc3YyYWlJVE50S2c5RmZVdHFUOXdzSXBHR0w2Vnc3ZHpKZ0FEeTU5MEtWNWc9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1[0m" 403 -
2023-10-17 21:35:20,568 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:35:20] "GET / HTTP/1.1" 200 -
2023-10-17 21:35:30,999 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 21:35:30,999 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 21:35:30,999 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 21:35:30,999 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 21:35:31,031 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 21:35:31,032 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 21:35:31,032 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 21:35:31,032 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 21:35:31,032 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:35:31,049 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 21:35:31,050 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:35:31,050 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 21:35:31,050 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:35:31 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACgbQsRyf3-qB_2A9CJVn1xYMMj7vGVqULx_QcoAcwSZWjSCA8MkRVEeRPhZI7YEHQw_aiJqHllH-ed82_s79jBDvha1ahzi5tw4EE-CBynItbmgDS8SG3LyszJQgzvlOkYWa2hNCems0-d_mMHhUYr3qwjfiOPlzMREIy9n61VMGhb7ZC4Y6RikG3JVGCe8YC5Z6qIdP8bRWjW3FzlPPe5NXr4aeS42a7hRWSaia6GzlIUOjPc7UUAATvUWmUJRan4AAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACgbQsRyf3-qB_2A9CJVn1xYMMj7vGVqULx_QcoAcwSZWjSCA8MkRVEeRPhZI7YEHQw_aiJqHllH-ed82_s79jBDvha1ahzi5tw4EE-CBynItbmgDS8SG3LyszJQgzvlOkYWa2hNCems0-d_mMHhUYr3qwjfiOPlzMREIy9n61VMGhb7ZC4Y6RikG3JVGCe8YC5Z6qIdP8bRWjW3FzlPPe5NXr4aeS42a7hRWSaia6GzlIUOjPc7UUAATvUWmUJRan4AAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 21:35:31,050 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:35:31,050 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 21:35:31,050 oidcrp.service DEBUG response format: json
2023-10-17 21:35:31,050 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 21:35:31,050 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 21:35:31,050 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 21:35:31,050 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 21:35:31,051 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 21:35:31,051 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:35:31,051 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:35:31,051 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:35:31,068 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 21:35:31,068 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "WUJ0MmoydmRTckJiNEtBRFdOMXZsYkdobExyb1ZvZkphNlBOTmFuQ0t2dw", "e": "AQAB", "n": "xN-ksWJwMRRt6WB3Kj3sPC8ApCb4s_CKye7WFPo5MnsXZVpy9If80l6V20QWAfQV0M32H2MGK8Sz1nrInkZyfQmbVnUIP8vCmmsog-5hZLtESGLOOuCysSQGfANLoHCgknQKG_HpdgJknz7qoWd-0Q5b_Yi-XAqoR-7zYC-2hB-hVVGajKCYkUB-mk21LM1m2yILUj-p_RKueVEgmaKmjak7ViPIJRBgQGyM7KbtHu18lEZ6KzdfYVSUBr_-0E7m3g2XRc6MpVdXJA2M3BSxedR4EoP7zoEkcleKH1GyhNwrZCoKLYnSsilWc_XM0nQM3cWxZLyaaN_CfK8KOLk9yw"}, {"kty": "EC", "use": "sig", "kid": "ZVJPaUtHU2dTN2V2a1ktblVWNW1JaGk4aEctdkxjcGgwRnlOVnNkakpPSQ", "crv": "P-256", "x": "iyvncqEWyXyK_KuZE95_VaewELA8WcUHzhmn10fdvOY", "y": "aM5IeUArvVXIrnGik7OmZs24wCEOK_x0dDhGPKsSok8"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:35:31,068 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "WUJ0MmoydmRTckJiNEtBRFdOMXZsYkdobExyb1ZvZkphNlBOTmFuQ0t2dw", "e": "AQAB", "n": "xN-ksWJwMRRt6WB3Kj3sPC8ApCb4s_CKye7WFPo5MnsXZVpy9If80l6V20QWAfQV0M32H2MGK8Sz1nrInkZyfQmbVnUIP8vCmmsog-5hZLtESGLOOuCysSQGfANLoHCgknQKG_HpdgJknz7qoWd-0Q5b_Yi-XAqoR-7zYC-2hB-hVVGajKCYkUB-mk21LM1m2yILUj-p_RKueVEgmaKmjak7ViPIJRBgQGyM7KbtHu18lEZ6KzdfYVSUBr_-0E7m3g2XRc6MpVdXJA2M3BSxedR4EoP7zoEkcleKH1GyhNwrZCoKLYnSsilWc_XM0nQM3cWxZLyaaN_CfK8KOLk9yw"}, {"kty": "EC", "use": "sig", "kid": "ZVJPaUtHU2dTN2V2a1ktblVWNW1JaGk4aEctdkxjcGgwRnlOVnNkakpPSQ", "crv": "P-256", "x": "iyvncqEWyXyK_KuZE95_VaewELA8WcUHzhmn10fdvOY", "y": "aM5IeUArvVXIrnGik7OmZs24wCEOK_x0dDhGPKsSok8"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 21:35:31,069 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'prompt': 'consent'}
2023-10-17 21:35:31,069 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 21:35:31,069 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 21:35:31,069 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 21:35:31,069 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'cZx80T7JzmLwl0rnQcVWFo6c', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'mumWuLrFykRcmSE3DVn6adYvB70O04vL'}
2023-10-17 21:35:31,069 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'cZx80T7JzmLwl0rnQcVWFo6c', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'mumWuLrFykRcmSE3DVn6adYvB70O04vL', 'code_challenge': '-G5aUrlHIFBdwPXeCYd9UYDDsbXeWDK8-ECiAYkVN3Q', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 21:35:31,070 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f81b43a6950>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=cZx80T7JzmLwl0rnQcVWFo6c&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=mumWuLrFykRcmSE3DVn6adYvB70O04vL&code_challenge=-G5aUrlHIFBdwPXeCYd9UYDDsbXeWDK8-ECiAYkVN3Q&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 21:35:31,070 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:35:31] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 21:35:51,567 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 21:35:51,567 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 21:35:51,567 oidcrp.service DEBUG response format: dict
2023-10-17 21:35:51,567 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 21:35:51,568 oidcrp.service DEBUG Initial response parsing => "{'state': 'mumWuLrFykRcmSE3DVn6adYvB70O04vL', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxMdUlYakE2OUE0WVRnNzkwbkpfNDdvMmpTTXRaV3NYQ3lRSzk0S2ZKcFp6cDhPNng5MTN5cko3Ui1teExYX0ZhVWZyM2I2b1BDRjQ3MjFOdE1JNzVxWDYyOW41X1JYVWRzcElxZzZqX3VqNGNkdFlXWklScUdQS2M0QjdEdlBmWnN4QzJsSTdXMm1icUNpeW9XZzdqeE1tbjByblFBc3lWdE5EbzI3UV9ZRExDZF8wa2M1Nno4VlVPdE9iTDB4SzVIak9MQTU4NGZJcEw2SFdRSklURVh4Sy1ram5STmNoSk0ybnpFXy1qT3ZNZzVBeUhaUDhuT2VaRGRtUU41UkZmZWMyZVQ4Q2NrR0txdnJRdWZxWkU2NlFPak1rNkU0bzNVLTUybE4tS2xDTDRRR0tDMEVPNzBncG5OSlpMZVpxb3BJXzdmRWJ4aDlnVFUwZkQ3Wl9tTHk0dE0wY3RJcnNnaU5lRXBhX0Fhc2FUbVRMMXlHUHE5X0ZUaFBuWmNRWVJtMEZucjBWQUdqakIyaXJvU1R3YXUtcEJRa0FYV3d2Q3E2UUZQNlQwT3hySjhQMVNRcXRIUWlYdGFEcU1YcmZTSS1oVDByS2pMdF92cFRycG1GcjBZMnhON081cmMyZUZJSDZTVlUzeWE3eFRSbnBHVGk1N2NfRXI3aDNnOGhwdDNqdXJ4RWRHakJldHpIc2taYkFMRjZnSjVRdVZHTlNYYmZweHB6eDNvY0ZaSVJiZ3dXWElzN3FrZHh3dlRPbVVuVTBNVDlzbV82MW1xZUpXMUFCbkVwMjdZOVRXYjd3SnZsX084UW5FWTdURHdUQUZRSE95X2dsQUx5VGEwdkNvbzdMUUdpRllCakkyOXplWWxsbWxOeHBBcFVTNWwxVjU1U3VaUlBPQWRjTXdSVTg9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 21:35:51,568 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 21:35:51,568 oidcrp.rp_handler DEBUG Authz response: {'state': 'mumWuLrFykRcmSE3DVn6adYvB70O04vL', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxMdUlYakE2OUE0WVRnNzkwbkpfNDdvMmpTTXRaV3NYQ3lRSzk0S2ZKcFp6cDhPNng5MTN5cko3Ui1teExYX0ZhVWZyM2I2b1BDRjQ3MjFOdE1JNzVxWDYyOW41X1JYVWRzcElxZzZqX3VqNGNkdFlXWklScUdQS2M0QjdEdlBmWnN4QzJsSTdXMm1icUNpeW9XZzdqeE1tbjByblFBc3lWdE5EbzI3UV9ZRExDZF8wa2M1Nno4VlVPdE9iTDB4SzVIak9MQTU4NGZJcEw2SFdRSklURVh4Sy1ram5STmNoSk0ybnpFXy1qT3ZNZzVBeUhaUDhuT2VaRGRtUU41UkZmZWMyZVQ4Q2NrR0txdnJRdWZxWkU2NlFPak1rNkU0bzNVLTUybE4tS2xDTDRRR0tDMEVPNzBncG5OSlpMZVpxb3BJXzdmRWJ4aDlnVFUwZkQ3Wl9tTHk0dE0wY3RJcnNnaU5lRXBhX0Fhc2FUbVRMMXlHUHE5X0ZUaFBuWmNRWVJtMEZucjBWQUdqakIyaXJvU1R3YXUtcEJRa0FYV3d2Q3E2UUZQNlQwT3hySjhQMVNRcXRIUWlYdGFEcU1YcmZTSS1oVDByS2pMdF92cFRycG1GcjBZMnhON081cmMyZUZJSDZTVlUzeWE3eFRSbnBHVGk1N2NfRXI3aDNnOGhwdDNqdXJ4RWRHakJldHpIc2taYkFMRjZnSjVRdVZHTlNYYmZweHB6eDNvY0ZaSVJiZ3dXWElzN3FrZHh3dlRPbVVuVTBNVDlzbV82MW1xZUpXMUFCbkVwMjdZOVRXYjd3SnZsX084UW5FWTdURHdUQUZRSE95X2dsQUx5VGEwdkNvbzdMUUdpRllCakkyOXplWWxsbWxOeHBBcFVTNWwxVjU1U3VaUlBPQWRjTXdSVTg9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 21:35:51,568 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 21:35:51,568 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 21:35:51,568 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMdUlYakE2OUE0WVRnNzkwbkpfNDdvMmpTTXRaV3NYQ3lRSzk0S2ZKcFp6cDhPNng5MTN5cko3Ui1teExYX0ZhVWZyM2I2b1BDRjQ3MjFOdE1JNzVxWDYyOW41X1JYVWRzcElxZzZqX3VqNGNkdFlXWklScUdQS2M0QjdEdlBmWnN4QzJsSTdXMm1icUNpeW9XZzdqeE1tbjByblFBc3lWdE5EbzI3UV9ZRExDZF8wa2M1Nno4VlVPdE9iTDB4SzVIak9MQTU4NGZJcEw2SFdRSklURVh4Sy1ram5STmNoSk0ybnpFXy1qT3ZNZzVBeUhaUDhuT2VaRGRtUU41UkZmZWMyZVQ4Q2NrR0txdnJRdWZxWkU2NlFPak1rNkU0bzNVLTUybE4tS2xDTDRRR0tDMEVPNzBncG5OSlpMZVpxb3BJXzdmRWJ4aDlnVFUwZkQ3Wl9tTHk0dE0wY3RJcnNnaU5lRXBhX0Fhc2FUbVRMMXlHUHE5X0ZUaFBuWmNRWVJtMEZucjBWQUdqakIyaXJvU1R3YXUtcEJRa0FYV3d2Q3E2UUZQNlQwT3hySjhQMVNRcXRIUWlYdGFEcU1YcmZTSS1oVDByS2pMdF92cFRycG1GcjBZMnhON081cmMyZUZJSDZTVlUzeWE3eFRSbnBHVGk1N2NfRXI3aDNnOGhwdDNqdXJ4RWRHakJldHpIc2taYkFMRjZnSjVRdVZHTlNYYmZweHB6eDNvY0ZaSVJiZ3dXWElzN3FrZHh3dlRPbVVuVTBNVDlzbV82MW1xZUpXMUFCbkVwMjdZOVRXYjd3SnZsX084UW5FWTdURHdUQUZRSE95X2dsQUx5VGEwdkNvbzdMUUdpRllCakkyOXplWWxsbWxOeHBBcFVTNWwxVjU1U3VaUlBPQWRjTXdSVTg9', 'state': 'mumWuLrFykRcmSE3DVn6adYvB70O04vL', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY'}
2023-10-17 21:35:51,568 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'mumWuLrFykRcmSE3DVn6adYvB70O04vL', 'code': 'Z0FBQUFBQmxMdUlYakE2OUE0WVRnNzkwbkpfNDdvMmpTTXRaV3NYQ3lRSzk0S2ZKcFp6cDhPNng5MTN5cko3Ui1teExYX0ZhVWZyM2I2b1BDRjQ3MjFOdE1JNzVxWDYyOW41X1JYVWRzcElxZzZqX3VqNGNkdFlXWklScUdQS2M0QjdEdlBmWnN4QzJsSTdXMm1icUNpeW9XZzdqeE1tbjByblFBc3lWdE5EbzI3UV9ZRExDZF8wa2M1Nno4VlVPdE9iTDB4SzVIak9MQTU4NGZJcEw2SFdRSklURVh4Sy1ram5STmNoSk0ybnpFXy1qT3ZNZzVBeUhaUDhuT2VaRGRtUU41UkZmZWMyZVQ4Q2NrR0txdnJRdWZxWkU2NlFPak1rNkU0bzNVLTUybE4tS2xDTDRRR0tDMEVPNzBncG5OSlpMZVpxb3BJXzdmRWJ4aDlnVFUwZkQ3Wl9tTHk0dE0wY3RJcnNnaU5lRXBhX0Fhc2FUbVRMMXlHUHE5X0ZUaFBuWmNRWVJtMEZucjBWQUdqakIyaXJvU1R3YXUtcEJRa0FYV3d2Q3E2UUZQNlQwT3hySjhQMVNRcXRIUWlYdGFEcU1YcmZTSS1oVDByS2pMdF92cFRycG1GcjBZMnhON081cmMyZUZJSDZTVlUzeWE3eFRSbnBHVGk1N2NfRXI3aDNnOGhwdDNqdXJ4RWRHakJldHpIc2taYkFMRjZnSjVRdVZHTlNYYmZweHB6eDNvY0ZaSVJiZ3dXWElzN3FrZHh3dlRPbVVuVTBNVDlzbV82MW1xZUpXMUFCbkVwMjdZOVRXYjd3SnZsX084UW5FWTdURHdUQUZRSE95X2dsQUx5VGEwdkNvbzdMUUdpRllCakkyOXplWWxsbWxOeHBBcFVTNWwxVjU1U3VaUlBPQWRjTXdSVTg9', 'client_secret': 'z3PCMmC1HZ1QmXeXGOQMJpWQNQynM4xY', 'code_verifier': 'BMGCitOKQ5Nmvc656XDWA2GxleuEB2vdsZxbNXTVDCXN1dKV9gkv7u6fYb9Z0hAF'}
2023-10-17 21:35:51,568 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 21:35:51,568 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f81b43ed890>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=mumWuLrFykRcmSE3DVn6adYvB70O04vL&code=Z0FBQUFBQmxMdUlYakE2OUE0WVRnNzkwbkpfNDdvMmpTTXRaV3NYQ3lRSzk0S2ZKcFp6cDhPNng5MTN5cko3Ui1teExYX0ZhVWZyM2I2b1BDRjQ3MjFOdE1JNzVxWDYyOW41X1JYVWRzcElxZzZqX3VqNGNkdFlXWklScUdQS2M0QjdEdlBmWnN4QzJsSTdXMm1icUNpeW9XZzdqeE1tbjByblFBc3lWdE5EbzI3UV9ZRExDZF8wa2M1Nno4VlVPdE9iTDB4SzVIak9MQTU4NGZJcEw2SFdRSklURVh4Sy1ram5STmNoSk0ybnpFXy1qT3ZNZzVBeUhaUDhuT2VaRGRtUU41UkZmZWMyZVQ4Q2NrR0txdnJRdWZxWkU2NlFPak1rNkU0bzNVLTUybE4tS2xDTDRRR0tDMEVPNzBncG5OSlpMZVpxb3BJXzdmRWJ4aDlnVFUwZkQ3Wl9tTHk0dE0wY3RJcnNnaU5lRXBhX0Fhc2FUbVRMMXlHUHE5X0ZUaFBuWmNRWVJtMEZucjBWQUdqakIyaXJvU1R3YXUtcEJRa0FYV3d2Q3E2UUZQNlQwT3hySjhQMVNRcXRIUWlYdGFEcU1YcmZTSS1oVDByS2pMdF92cFRycG1GcjBZMnhON081cmMyZUZJSDZTVlUzeWE3eFRSbnBHVGk1N2NfRXI3aDNnOGhwdDNqdXJ4RWRHakJldHpIc2taYkFMRjZnSjVRdVZHTlNYYmZweHB6eDNvY0ZaSVJiZ3dXWElzN3FrZHh3dlRPbVVuVTBNVDlzbV82MW1xZUpXMUFCbkVwMjdZOVRXYjd3SnZsX084UW5FWTdURHdUQUZRSE95X2dsQUx5VGEwdkNvbzdMUUdpRllCakkyOXplWWxsbWxOeHBBcFVTNWwxVjU1U3VaUlBPQWRjTXdSVTg9&code_verifier=BMGCitOKQ5Nmvc656XDWA2GxleuEB2vdsZxbNXTVDCXN1dKV9gkv7u6fYb9Z0hAF', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 21:35:51,568 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=mumWuLrFykRcmSE3DVn6adYvB70O04vL&code=Z0FBQUFBQmxMdUlYakE2OUE0WVRnNzkwbkpfNDdvMmpTTXRaV3NYQ3lRSzk0S2ZKcFp6cDhPNng5MTN5cko3Ui1teExYX0ZhVWZyM2I2b1BDRjQ3MjFOdE1JNzVxWDYyOW41X1JYVWRzcElxZzZqX3VqNGNkdFlXWklScUdQS2M0QjdEdlBmWnN4QzJsSTdXMm1icUNpeW9XZzdqeE1tbjByblFBc3lWdE5EbzI3UV9ZRExDZF8wa2M1Nno4VlVPdE9iTDB4SzVIak9MQTU4NGZJcEw2SFdRSklURVh4Sy1ram5STmNoSk0ybnpFXy1qT3ZNZzVBeUhaUDhuT2VaRGRtUU41UkZmZWMyZVQ4Q2NrR0txdnJRdWZxWkU2NlFPak1rNkU0bzNVLTUybE4tS2xDTDRRR0tDMEVPNzBncG5OSlpMZVpxb3BJXzdmRWJ4aDlnVFUwZkQ3Wl9tTHk0dE0wY3RJcnNnaU5lRXBhX0Fhc2FUbVRMMXlHUHE5X0ZUaFBuWmNRWVJtMEZucjBWQUdqakIyaXJvU1R3YXUtcEJRa0FYV3d2Q3E2UUZQNlQwT3hySjhQMVNRcXRIUWlYdGFEcU1YcmZTSS1oVDByS2pMdF92cFRycG1GcjBZMnhON081cmMyZUZJSDZTVlUzeWE3eFRSbnBHVGk1N2NfRXI3aDNnOGhwdDNqdXJ4RWRHakJldHpIc2taYkFMRjZnSjVRdVZHTlNYYmZweHB6eDNvY0ZaSVJiZ3dXWElzN3FrZHh3dlRPbVVuVTBNVDlzbV82MW1xZUpXMUFCbkVwMjdZOVRXYjd3SnZsX084UW5FWTdURHdUQUZRSE95X2dsQUx5VGEwdkNvbzdMUUdpRllCakkyOXplWWxsbWxOeHBBcFVTNWwxVjU1U3VaUlBPQWRjTXdSVTg9&code_verifier=BMGCitOKQ5Nmvc656XDWA2GxleuEB2vdsZxbNXTVDCXN1dKV9gkv7u6fYb9Z0hAF, https_args:{'Authorization': 'Basic and0X3Rlc3Q6ejNQQ01tQzFIWjFRbVhlWEdPUU1KcFdRTlF5bk00eFk=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 21:35:51,569 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 21:35:51,706 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 403 None
2023-10-17 21:35:51,706 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 21:35:51,706 oidcrp.oauth2 ERROR Error response (403): {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:35:51,706 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 19:35:51 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdACuMgidSr6uo0ZRFQQdaH7zmt_-eFWC3puYL1hX56ts0REDF7uHcz55E3XaBtooZYqaf5RMSnJCKCKq6kBjjri55vVOGAZ4bQYabCPSY5pUWFaRCm5uzpBKMU4wrNRuWRPIe6hpuP0-AyLf8TqnPxaIPMWSWnl4471lA5AdXbFQ1nGwnIoBR3pTjK_irjHqbYec8PH_3reOvxPv9J-ij22ifZEzTOAThYBJEJ20RHo7vcC3AgYtriWJOtgAAAHz-Qjn9J6IyAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdACuMgidSr6uo0ZRFQQdaH7zmt_-eFWC3puYL1hX56ts0REDF7uHcz55E3XaBtooZYqaf5RMSnJCKCKq6kBjjri55vVOGAZ4bQYabCPSY5pUWFaRCm5uzpBKMU4wrNRuWRPIe6hpuP0-AyLf8TqnPxaIPMWSWnl4471lA5AdXbFQ1nGwnIoBR3pTjK_irjHqbYec8PH_3reOvxPv9J-ij22ifZEzTOAThYBJEJ20RHo7vcC3AgYtriWJOtgAAAHz-Qjn9J6IyAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure'}
2023-10-17 21:35:51,706 oidcrp.util DEBUG resp.txt: {"error": "unauthorized_client", "error_description": ""}
2023-10-17 21:35:51,706 oidcrp.service DEBUG response format: json
2023-10-17 21:35:51,706 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 21:35:51,706 oidcrp.service DEBUG Initial response parsing => "{'error': 'unauthorized_client'}"
2023-10-17 21:35:51,706 oidcrp.service DEBUG Error response: {'error': 'unauthorized_client'}
2023-10-17 21:35:51,707 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 21:35:51] "[31m[1mGET /authz_cb/satosa?state=mumWuLrFykRcmSE3DVn6adYvB70O04vL&scope=openid+offline_access+profile&code=Z0FBQUFBQmxMdUlYakE2OUE0WVRnNzkwbkpfNDdvMmpTTXRaV3NYQ3lRSzk0S2ZKcFp6cDhPNng5MTN5cko3Ui1teExYX0ZhVWZyM2I2b1BDRjQ3MjFOdE1JNzVxWDYyOW41X1JYVWRzcElxZzZqX3VqNGNkdFlXWklScUdQS2M0QjdEdlBmWnN4QzJsSTdXMm1icUNpeW9XZzdqeE1tbjByblFBc3lWdE5EbzI3UV9ZRExDZF8wa2M1Nno4VlVPdE9iTDB4SzVIak9MQTU4NGZJcEw2SFdRSklURVh4Sy1ram5STmNoSk0ybnpFXy1qT3ZNZzVBeUhaUDhuT2VaRGRtUU41UkZmZWMyZVQ4Q2NrR0txdnJRdWZxWkU2NlFPak1rNkU0bzNVLTUybE4tS2xDTDRRR0tDMEVPNzBncG5OSlpMZVpxb3BJXzdmRWJ4aDlnVFUwZkQ3Wl9tTHk0dE0wY3RJcnNnaU5lRXBhX0Fhc2FUbVRMMXlHUHE5X0ZUaFBuWmNRWVJtMEZucjBWQUdqakIyaXJvU1R3YXUtcEJRa0FYV3d2Q3E2UUZQNlQwT3hySjhQMVNRcXRIUWlYdGFEcU1YcmZTSS1oVDByS2pMdF92cFRycG1GcjBZMnhON081cmMyZUZJSDZTVlUzeWE3eFRSbnBHVGk1N2NfRXI3aDNnOGhwdDNqdXJ4RWRHakJldHpIc2taYkFMRjZnSjVRdVZHTlNYYmZweHB6eDNvY0ZaSVJiZ3dXWElzN3FrZHh3dlRPbVVuVTBNVDlzbV82MW1xZUpXMUFCbkVwMjdZOVRXYjd3SnZsX084UW5FWTdURHdUQUZRSE95X2dsQUx5VGEwdkNvbzdMUUdpRllCakkyOXplWWxsbWxOeHBBcFVTNWwxVjU1U3VaUlBPQWRjTXdSVTg9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1[0m" 403 -
2023-10-17 22:02:09,940 root DEBUG Configured logging using dictionary
2023-10-17 22:02:09,981 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-17 22:02:09,981 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-17 22:02:09,981 werkzeug INFO  * Restarting with stat
2023-10-17 22:02:10,162 root DEBUG Configured logging using dictionary
2023-10-17 22:02:10,199 werkzeug WARNING  * Debugger is active!
2023-10-17 22:02:10,199 werkzeug INFO  * Debugger PIN: 506-049-290
2023-10-17 22:02:20,505 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:02:20] "GET / HTTP/1.1" 200 -
2023-10-17 22:02:23,530 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 22:02:23,530 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 22:02:23,530 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 22:02:23,530 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 22:02:23,571 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 22:02:23,571 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 22:02:23,571 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 22:02:23,571 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 22:02:23,573 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:02:23,590 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 22:02:23,590 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:02:23,590 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:02:23,591 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:02:23 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddACObSwVsUGoybY0XaEnAdDCh5cWeD5aveXuvy5ddpOHWZCJ1s_2HAvU8wz5ldJUkjll-wox8yP0OpF0hWAyULjWcv-6YmE7vyJVHuAba2GiTOqSE4F6k48zik23YH_Qy2JwViiixSMHKmNmU__-Vs5lU3mVEoMtoDTlmYI2g8Nb7DfJ5FljohGKKubDjEnrWLwsHVpAujQiWpnr9KDB14i2rYvXg3v15sjQ4Qj42BoJTl2g3-2IlAAAA4c9elMwG9m4AAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddACObSwVsUGoybY0XaEnAdDCh5cWeD5aveXuvy5ddpOHWZCJ1s_2HAvU8wz5ldJUkjll-wox8yP0OpF0hWAyULjWcv-6YmE7vyJVHuAba2GiTOqSE4F6k48zik23YH_Qy2JwViiixSMHKmNmU__-Vs5lU3mVEoMtoDTlmYI2g8Nb7DfJ5FljohGKKubDjEnrWLwsHVpAujQiWpnr9KDB14i2rYvXg3v15sjQ4Qj42BoJTl2g3-2IlAAAA4c9elMwG9m4AAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:02:23,591 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 22:02:23,591 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 22:02:23,591 oidcrp.service DEBUG response format: json
2023-10-17 22:02:23,591 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 22:02:23,591 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 22:02:23,591 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 22:02:23,591 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 22:02:23,592 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 22:02:23,592 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:02:23,592 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:02:23,592 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:02:23,608 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 22:02:23,608 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "WUJ0MmoydmRTckJiNEtBRFdOMXZsYkdobExyb1ZvZkphNlBOTmFuQ0t2dw", "e": "AQAB", "n": "xN-ksWJwMRRt6WB3Kj3sPC8ApCb4s_CKye7WFPo5MnsXZVpy9If80l6V20QWAfQV0M32H2MGK8Sz1nrInkZyfQmbVnUIP8vCmmsog-5hZLtESGLOOuCysSQGfANLoHCgknQKG_HpdgJknz7qoWd-0Q5b_Yi-XAqoR-7zYC-2hB-hVVGajKCYkUB-mk21LM1m2yILUj-p_RKueVEgmaKmjak7ViPIJRBgQGyM7KbtHu18lEZ6KzdfYVSUBr_-0E7m3g2XRc6MpVdXJA2M3BSxedR4EoP7zoEkcleKH1GyhNwrZCoKLYnSsilWc_XM0nQM3cWxZLyaaN_CfK8KOLk9yw"}, {"kty": "EC", "use": "sig", "kid": "ZVJPaUtHU2dTN2V2a1ktblVWNW1JaGk4aEctdkxjcGgwRnlOVnNkakpPSQ", "crv": "P-256", "x": "iyvncqEWyXyK_KuZE95_VaewELA8WcUHzhmn10fdvOY", "y": "aM5IeUArvVXIrnGik7OmZs24wCEOK_x0dDhGPKsSok8"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:02:23,608 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "WUJ0MmoydmRTckJiNEtBRFdOMXZsYkdobExyb1ZvZkphNlBOTmFuQ0t2dw", "e": "AQAB", "n": "xN-ksWJwMRRt6WB3Kj3sPC8ApCb4s_CKye7WFPo5MnsXZVpy9If80l6V20QWAfQV0M32H2MGK8Sz1nrInkZyfQmbVnUIP8vCmmsog-5hZLtESGLOOuCysSQGfANLoHCgknQKG_HpdgJknz7qoWd-0Q5b_Yi-XAqoR-7zYC-2hB-hVVGajKCYkUB-mk21LM1m2yILUj-p_RKueVEgmaKmjak7ViPIJRBgQGyM7KbtHu18lEZ6KzdfYVSUBr_-0E7m3g2XRc6MpVdXJA2M3BSxedR4EoP7zoEkcleKH1GyhNwrZCoKLYnSsilWc_XM0nQM3cWxZLyaaN_CfK8KOLk9yw"}, {"kty": "EC", "use": "sig", "kid": "ZVJPaUtHU2dTN2V2a1ktblVWNW1JaGk4aEctdkxjcGgwRnlOVnNkakpPSQ", "crv": "P-256", "x": "iyvncqEWyXyK_KuZE95_VaewELA8WcUHzhmn10fdvOY", "y": "aM5IeUArvVXIrnGik7OmZs24wCEOK_x0dDhGPKsSok8"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:02:23,609 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-17 22:02:23,609 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 22:02:23,609 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 22:02:23,609 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 22:02:23,610 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'lFYJYwYqJSkQrkEuZOuRxpaC', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'UzwJHrW7FFxwRgSgGql255WZD3q42qId'}
2023-10-17 22:02:23,610 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'lFYJYwYqJSkQrkEuZOuRxpaC', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'UzwJHrW7FFxwRgSgGql255WZD3q42qId', 'code_challenge': 'J9T_HGdUMKlItHt57jI8kmqob2UyPbTOyfnm5jQ0L0w', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 22:02:23,610 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f3836e46ed0>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=lFYJYwYqJSkQrkEuZOuRxpaC&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=UzwJHrW7FFxwRgSgGql255WZD3q42qId&code_challenge=J9T_HGdUMKlItHt57jI8kmqob2UyPbTOyfnm5jQ0L0w&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 22:02:23,610 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:02:23] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 22:02:34,417 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 22:02:34,417 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 22:02:34,417 oidcrp.service DEBUG response format: dict
2023-10-17 22:02:34,417 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 22:02:34,417 oidcrp.service DEBUG Initial response parsing => "{'state': 'UzwJHrW7FFxwRgSgGql255WZD3q42qId', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxMdWhhZV95WDBWQkJ5YzV2S1AzRG1DN1hHWEloMnNWMU1kWXpCQmIxTXZBOGZTbkQtR2FBTXdDdEx5VmJWS3JWUnN5ZC1FcmN0dlFDMF90ZHNoRGJFVC14UVJsN0hwdDByS1YzUkVhYjhYbW4weVVtam12NVdTX1ZDUnhHdXp2YVBMR0JFb0RjMXN2Uy1ILVpEeHZ1Yl84QzV5YWlobG1uTzRiUkFyVDlGcUY3UGpzRDVmZ282aWNqdUV2T1d4LUZqaGZCNnM5dWkweHlwSU9wY25UZy1oM3p5cjJRRFNmbzBONU85ME8xempxTVZvZEFqWlVJQ21aMnl1Wk9nMVR4TkttSE1wMS1LSUlQSU9qQjdoZVRzbTFMM3ptcFprR3lDM2NNWXlHVlJOVlV2Snd0RDhuazFFNjRvNC16TldocjJVQWd4eDVCV1FYSDVTOV9vWG8xeEhka3lhQk5wVkNFbGRKcll3NFVYREJVYnFfeDk4Y3JNUDUxX3padzhadzFkMTZtYTd4MDhYNUYweUI1US1JUGZQT0tITWRiQWVFVzBuNnRKRVFiQm5WWlpoWnVXd3pZbEF6UUpQNTQtMW5MSFFVYVA5QW4yZXNiaDlJNERFNTZKdXk0d2hRY2VkUkNza0hfVGF4UDVvS1Jnd05xZTktaDdGTXg0UUM0T25yblFnSENVZFVzbXZRN2Y1RWIyVFJTa3NKM0pQSTVmNkhyMEh6aE9sUEJsUWxNTTJTR3UtRURaMmxSMmQtakF0MlJIT3RPbmhEeGlFM25falYwLWJmNGJDNUh4YjBDcEU2UXdTRnJ2YlRoQWVmZnVVek1CbXdKb0JoMkZtc2JuQ2x1X2Q5U20wLUNXSkNqMGM2b0dYMmdyWmd4VHRMejNnYndvV0gtN1Y2Z3dYc1kzMjQ9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 22:02:34,417 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 22:02:34,417 oidcrp.rp_handler DEBUG Authz response: {'state': 'UzwJHrW7FFxwRgSgGql255WZD3q42qId', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxMdWhhZV95WDBWQkJ5YzV2S1AzRG1DN1hHWEloMnNWMU1kWXpCQmIxTXZBOGZTbkQtR2FBTXdDdEx5VmJWS3JWUnN5ZC1FcmN0dlFDMF90ZHNoRGJFVC14UVJsN0hwdDByS1YzUkVhYjhYbW4weVVtam12NVdTX1ZDUnhHdXp2YVBMR0JFb0RjMXN2Uy1ILVpEeHZ1Yl84QzV5YWlobG1uTzRiUkFyVDlGcUY3UGpzRDVmZ282aWNqdUV2T1d4LUZqaGZCNnM5dWkweHlwSU9wY25UZy1oM3p5cjJRRFNmbzBONU85ME8xempxTVZvZEFqWlVJQ21aMnl1Wk9nMVR4TkttSE1wMS1LSUlQSU9qQjdoZVRzbTFMM3ptcFprR3lDM2NNWXlHVlJOVlV2Snd0RDhuazFFNjRvNC16TldocjJVQWd4eDVCV1FYSDVTOV9vWG8xeEhka3lhQk5wVkNFbGRKcll3NFVYREJVYnFfeDk4Y3JNUDUxX3padzhadzFkMTZtYTd4MDhYNUYweUI1US1JUGZQT0tITWRiQWVFVzBuNnRKRVFiQm5WWlpoWnVXd3pZbEF6UUpQNTQtMW5MSFFVYVA5QW4yZXNiaDlJNERFNTZKdXk0d2hRY2VkUkNza0hfVGF4UDVvS1Jnd05xZTktaDdGTXg0UUM0T25yblFnSENVZFVzbXZRN2Y1RWIyVFJTa3NKM0pQSTVmNkhyMEh6aE9sUEJsUWxNTTJTR3UtRURaMmxSMmQtakF0MlJIT3RPbmhEeGlFM25falYwLWJmNGJDNUh4YjBDcEU2UXdTRnJ2YlRoQWVmZnVVek1CbXdKb0JoMkZtc2JuQ2x1X2Q5U20wLUNXSkNqMGM2b0dYMmdyWmd4VHRMejNnYndvV0gtN1Y2Z3dYc1kzMjQ9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 22:02:34,418 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 22:02:34,418 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 22:02:34,418 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMdWhhZV95WDBWQkJ5YzV2S1AzRG1DN1hHWEloMnNWMU1kWXpCQmIxTXZBOGZTbkQtR2FBTXdDdEx5VmJWS3JWUnN5ZC1FcmN0dlFDMF90ZHNoRGJFVC14UVJsN0hwdDByS1YzUkVhYjhYbW4weVVtam12NVdTX1ZDUnhHdXp2YVBMR0JFb0RjMXN2Uy1ILVpEeHZ1Yl84QzV5YWlobG1uTzRiUkFyVDlGcUY3UGpzRDVmZ282aWNqdUV2T1d4LUZqaGZCNnM5dWkweHlwSU9wY25UZy1oM3p5cjJRRFNmbzBONU85ME8xempxTVZvZEFqWlVJQ21aMnl1Wk9nMVR4TkttSE1wMS1LSUlQSU9qQjdoZVRzbTFMM3ptcFprR3lDM2NNWXlHVlJOVlV2Snd0RDhuazFFNjRvNC16TldocjJVQWd4eDVCV1FYSDVTOV9vWG8xeEhka3lhQk5wVkNFbGRKcll3NFVYREJVYnFfeDk4Y3JNUDUxX3padzhadzFkMTZtYTd4MDhYNUYweUI1US1JUGZQT0tITWRiQWVFVzBuNnRKRVFiQm5WWlpoWnVXd3pZbEF6UUpQNTQtMW5MSFFVYVA5QW4yZXNiaDlJNERFNTZKdXk0d2hRY2VkUkNza0hfVGF4UDVvS1Jnd05xZTktaDdGTXg0UUM0T25yblFnSENVZFVzbXZRN2Y1RWIyVFJTa3NKM0pQSTVmNkhyMEh6aE9sUEJsUWxNTTJTR3UtRURaMmxSMmQtakF0MlJIT3RPbmhEeGlFM25falYwLWJmNGJDNUh4YjBDcEU2UXdTRnJ2YlRoQWVmZnVVek1CbXdKb0JoMkZtc2JuQ2x1X2Q5U20wLUNXSkNqMGM2b0dYMmdyWmd4VHRMejNnYndvV0gtN1Y2Z3dYc1kzMjQ9', 'state': 'UzwJHrW7FFxwRgSgGql255WZD3q42qId', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-17 22:02:34,418 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'UzwJHrW7FFxwRgSgGql255WZD3q42qId', 'code': 'Z0FBQUFBQmxMdWhhZV95WDBWQkJ5YzV2S1AzRG1DN1hHWEloMnNWMU1kWXpCQmIxTXZBOGZTbkQtR2FBTXdDdEx5VmJWS3JWUnN5ZC1FcmN0dlFDMF90ZHNoRGJFVC14UVJsN0hwdDByS1YzUkVhYjhYbW4weVVtam12NVdTX1ZDUnhHdXp2YVBMR0JFb0RjMXN2Uy1ILVpEeHZ1Yl84QzV5YWlobG1uTzRiUkFyVDlGcUY3UGpzRDVmZ282aWNqdUV2T1d4LUZqaGZCNnM5dWkweHlwSU9wY25UZy1oM3p5cjJRRFNmbzBONU85ME8xempxTVZvZEFqWlVJQ21aMnl1Wk9nMVR4TkttSE1wMS1LSUlQSU9qQjdoZVRzbTFMM3ptcFprR3lDM2NNWXlHVlJOVlV2Snd0RDhuazFFNjRvNC16TldocjJVQWd4eDVCV1FYSDVTOV9vWG8xeEhka3lhQk5wVkNFbGRKcll3NFVYREJVYnFfeDk4Y3JNUDUxX3padzhadzFkMTZtYTd4MDhYNUYweUI1US1JUGZQT0tITWRiQWVFVzBuNnRKRVFiQm5WWlpoWnVXd3pZbEF6UUpQNTQtMW5MSFFVYVA5QW4yZXNiaDlJNERFNTZKdXk0d2hRY2VkUkNza0hfVGF4UDVvS1Jnd05xZTktaDdGTXg0UUM0T25yblFnSENVZFVzbXZRN2Y1RWIyVFJTa3NKM0pQSTVmNkhyMEh6aE9sUEJsUWxNTTJTR3UtRURaMmxSMmQtakF0MlJIT3RPbmhEeGlFM25falYwLWJmNGJDNUh4YjBDcEU2UXdTRnJ2YlRoQWVmZnVVek1CbXdKb0JoMkZtc2JuQ2x1X2Q5U20wLUNXSkNqMGM2b0dYMmdyWmd4VHRMejNnYndvV0gtN1Y2Z3dYc1kzMjQ9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'my7hO9qaaml4Xh1Qdp3Qw0rMaiHh5SSu4DE25TA6rwUku45gGGHRb2BDJ1EoxQg8'}
2023-10-17 22:02:34,418 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 22:02:34,418 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f38357ef4d0>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=UzwJHrW7FFxwRgSgGql255WZD3q42qId&code=Z0FBQUFBQmxMdWhhZV95WDBWQkJ5YzV2S1AzRG1DN1hHWEloMnNWMU1kWXpCQmIxTXZBOGZTbkQtR2FBTXdDdEx5VmJWS3JWUnN5ZC1FcmN0dlFDMF90ZHNoRGJFVC14UVJsN0hwdDByS1YzUkVhYjhYbW4weVVtam12NVdTX1ZDUnhHdXp2YVBMR0JFb0RjMXN2Uy1ILVpEeHZ1Yl84QzV5YWlobG1uTzRiUkFyVDlGcUY3UGpzRDVmZ282aWNqdUV2T1d4LUZqaGZCNnM5dWkweHlwSU9wY25UZy1oM3p5cjJRRFNmbzBONU85ME8xempxTVZvZEFqWlVJQ21aMnl1Wk9nMVR4TkttSE1wMS1LSUlQSU9qQjdoZVRzbTFMM3ptcFprR3lDM2NNWXlHVlJOVlV2Snd0RDhuazFFNjRvNC16TldocjJVQWd4eDVCV1FYSDVTOV9vWG8xeEhka3lhQk5wVkNFbGRKcll3NFVYREJVYnFfeDk4Y3JNUDUxX3padzhadzFkMTZtYTd4MDhYNUYweUI1US1JUGZQT0tITWRiQWVFVzBuNnRKRVFiQm5WWlpoWnVXd3pZbEF6UUpQNTQtMW5MSFFVYVA5QW4yZXNiaDlJNERFNTZKdXk0d2hRY2VkUkNza0hfVGF4UDVvS1Jnd05xZTktaDdGTXg0UUM0T25yblFnSENVZFVzbXZRN2Y1RWIyVFJTa3NKM0pQSTVmNkhyMEh6aE9sUEJsUWxNTTJTR3UtRURaMmxSMmQtakF0MlJIT3RPbmhEeGlFM25falYwLWJmNGJDNUh4YjBDcEU2UXdTRnJ2YlRoQWVmZnVVek1CbXdKb0JoMkZtc2JuQ2x1X2Q5U20wLUNXSkNqMGM2b0dYMmdyWmd4VHRMejNnYndvV0gtN1Y2Z3dYc1kzMjQ9&code_verifier=my7hO9qaaml4Xh1Qdp3Qw0rMaiHh5SSu4DE25TA6rwUku45gGGHRb2BDJ1EoxQg8', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 22:02:34,418 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=UzwJHrW7FFxwRgSgGql255WZD3q42qId&code=Z0FBQUFBQmxMdWhhZV95WDBWQkJ5YzV2S1AzRG1DN1hHWEloMnNWMU1kWXpCQmIxTXZBOGZTbkQtR2FBTXdDdEx5VmJWS3JWUnN5ZC1FcmN0dlFDMF90ZHNoRGJFVC14UVJsN0hwdDByS1YzUkVhYjhYbW4weVVtam12NVdTX1ZDUnhHdXp2YVBMR0JFb0RjMXN2Uy1ILVpEeHZ1Yl84QzV5YWlobG1uTzRiUkFyVDlGcUY3UGpzRDVmZ282aWNqdUV2T1d4LUZqaGZCNnM5dWkweHlwSU9wY25UZy1oM3p5cjJRRFNmbzBONU85ME8xempxTVZvZEFqWlVJQ21aMnl1Wk9nMVR4TkttSE1wMS1LSUlQSU9qQjdoZVRzbTFMM3ptcFprR3lDM2NNWXlHVlJOVlV2Snd0RDhuazFFNjRvNC16TldocjJVQWd4eDVCV1FYSDVTOV9vWG8xeEhka3lhQk5wVkNFbGRKcll3NFVYREJVYnFfeDk4Y3JNUDUxX3padzhadzFkMTZtYTd4MDhYNUYweUI1US1JUGZQT0tITWRiQWVFVzBuNnRKRVFiQm5WWlpoWnVXd3pZbEF6UUpQNTQtMW5MSFFVYVA5QW4yZXNiaDlJNERFNTZKdXk0d2hRY2VkUkNza0hfVGF4UDVvS1Jnd05xZTktaDdGTXg0UUM0T25yblFnSENVZFVzbXZRN2Y1RWIyVFJTa3NKM0pQSTVmNkhyMEh6aE9sUEJsUWxNTTJTR3UtRURaMmxSMmQtakF0MlJIT3RPbmhEeGlFM25falYwLWJmNGJDNUh4YjBDcEU2UXdTRnJ2YlRoQWVmZnVVek1CbXdKb0JoMkZtc2JuQ2x1X2Q5U20wLUNXSkNqMGM2b0dYMmdyWmd4VHRMejNnYndvV0gtN1Y2Z3dYc1kzMjQ9&code_verifier=my7hO9qaaml4Xh1Qdp3Qw0rMaiHh5SSu4DE25TA6rwUku45gGGHRb2BDJ1EoxQg8, https_args:{'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 22:02:34,419 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:02:34,564 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-17 22:02:34,564 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:02:34,564 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:02:34,565 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:02:34 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACISQiVZsuShWSiUAS2gl-ySACsYthvu9429zOrA2AQNTOR09TTjHVhr1pP3VHphMpKYtwy6YIF1sKdMuHikcTlogpJ-T6KRTar1FfGj9kqO_VQjzbO5SBJ5z7epi13ahOYgf-NtAgWIts-DFLXScTZwkRDtXrS4ykjAw1-3rHx-n3Vq14njwqxZQ3mtqhnNHB8H_ZJRDwT6YPJU7wvlzjU8h4-ywqvzO6xXLkTcc7tw6nTPYopCHeYApcq2D2Hyl5oAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACISQiVZsuShWSiUAS2gl-ySACsYthvu9429zOrA2AQNTOR09TTjHVhr1pP3VHphMpKYtwy6YIF1sKdMuHikcTlogpJ-T6KRTar1FfGj9kqO_VQjzbO5SBJ5z7epi13ahOYgf-NtAgWIts-DFLXScTZwkRDtXrS4ykjAw1-3rHx-n3Vq14njwqxZQ3mtqhnNHB8H_ZJRDwT6YPJU7wvlzjU8h4-ywqvzO6xXLkTcc7tw6nTPYopCHeYApcq2D2Hyl5oAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:02:34,565 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IlpWSlBhVXRIVTJkVE4yVjJhMWt0YmxWV05XMUphR2s0YUVjdGRreGpjR2d3Um5sT1ZuTmtha3BQU1EifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNTYwMTIzZTQ5MTM4NDAyNWJjZWM2ZjY3NTk1Yzc1YTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kV2hoVjIxTlJtMWhjM3BoYlhKT1lqRXpObnBST1RJNU5qWkZiekUyU1hKMGRXMU5aWGwxUVZkM1NqSnBiRUZWVHpGMmFXeGtNVmh1VmpCZmFrTnpTMlJhUVhFMVVIaEVNMUI1WVc1R1dFSnZRMnhRWlcxS1FUWlBNa2RCWWtZM2VEZHplbmN4VkhkRlYxZzVWMVZyWWs5WFNHSmZTRWRpWmxKNFRrUjZaMG81ZG01U2JXSm9kREZqU2xCM2VtcFpSbEpYY0ZSV1JIWnNRbkZVUVdZMlgyRnViMGhwVW5reE1EbGlOMDgwUTBoamJuVk1TM1UxU2pOdWNtSTFjMFZ6Y0UxWFMybzNTMEZEWTB3M1NsUjJhRXgyUm5vNFZWVXlXbFZ4U1dob01IWlJOMDEwZUd4eU5tRjRXWFJwTVZReE5ucFNjRWR2Y0RFeWQwRkhZM2N0TmtoaVNBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzI5NTQsICJleHAiOiAxNjk3NTc2NTU0fQ.iUWH9B6RZ2HV49AeiFGanAnMvnXH9PUkXio4-wTwxIXtWOXugq7o8uchY4yxDxgCrzgxI9iA4c3_d69jyoNL9g", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMdWhhZ2hZLWR4bXY0VWZURUVqdlZ0dFFSM04xRFdnb0cwY1RmdWRfUGJsM01jVUpvS3BEM01XZVJ6YzRtWTFpTE9oVVRKTlE4Q3p2LThON2dVTjdYcll6bUdtQ25tbDAzeWlWcVFBeUNPMUNaclAwT1lKSl9pX09vOFE5a0JsSFhyVUtGTzFKT3lhZHlxalBHTmItSXpqWGZsczFMd3FLWnkyNjR5SVdOdnZmYXRBaXhyU2FmOGJZWlBudmtUUHRyWXhGY0RHc05WQmdUbHRTeG9wNjBXaWlfSEh6bU1BQ0JaWjYxbkpoWEFiRlQwTEpwQnY3NlZQd29Vb3hpcklSanJHN2drd0V3anBJenZpNUxZcy1MeFh5TkI4OGFzRHNMekRDOFJlX3VvcE93RzNDV21DanJLTTROdDN2eFQ1X2g3UEdGM0RxR3lFbk9oMnVWRjFYRnVKZjdibHdxeW9DSGpNVVE1ZVhTaWZUUFB4bjQwcF84VnR3cVZmUHRxakFKbFBnc2NqR25QSGN1Vkp1QkdBcGtlTk9sUmp3UHRON19aTFo5VUFGUVdISzU5VWV4bkVnbG1nRmxBSUsya3hnUXhLM3M4Ml9GX2VGakZGTmdTUUtJX1h1MlhnMXp2M2ktMmVDSGljSWdNTG1iLWQyV0MyLVdJSnp0R0R6NnJHRl9fRzVUT0VzdHlPb2NNT3Z4VnlfRW1IcVFDREZWNl9oWHpsT0xMUlQ2OHlBM1hmRzZBNXVXc1NhOHNfOGJBdEN0WDFoRS1ub3lOWjVJNkFtdGJ0TG1zUjVRTWw0VGp1RF82SXZOSklXZ3h3bGNmWjJZek1VUjRoaVlKc2p0TFJNZGQtb09ObUJBSDZYcHJKZzdFRXJROEdrWUZTWXNHYnVXcWpBeVNHTWdnakFVZjg9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6IldVSjBNbW95ZG1SVGNrSmlORXRCUkZkT01YWnNZa2RvYkV4eWIxWnZaa3BoTmxCT1RtRnVRMHQyZHcifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFdoaFYyMU5SbTFoYzNwaGJYSk9ZakV6Tm5wUk9USTVOalpGYnpFMlNYSjBkVzFOWlhsMVFWZDNTakpwYkVGVlR6RjJhV3hrTVZodVZqQmZha056UzJSYVFYRTFVSGhFTTFCNVlXNUdXRUp2UTJ4UVpXMUtRVFpQTWtkQllrWTNlRGR6ZW5jeFZIZEZWMWc1VjFWcllrOVhTR0pmU0VkaVpsSjRUa1I2WjBvNWRtNVNiV0pvZERGalNsQjNlbXBaUmxKWGNGUldSSFpzUW5GVVFXWTJYMkZ1YjBocFVua3hNRGxpTjA4MFEwaGpiblZNUzNVMVNqTnVjbUkxYzBWemNFMVhTMm8zUzBGRFkwdzNTbFIyYUV4MlJubzRWVlV5V2xWeFNXaG9NSFpSTjAxMGVHeHlObUY0V1hScE1WUXhObnBTY0VkdmNERXlkMEZIWTNjdE5raGlTQT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzI5NTQsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiMWNkZWQ0NWQ2ZDI4MTFlZWI1ZTkwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogImxGWUpZd1lxSlNrUXJrRXVaT3VSeHBhQyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTcyOTU0LCAiZXhwIjogMTY5NzU3MzI1NCwgImF1ZCI6IFsiand0X3Rlc3QiXX0.GTKAGiYqg2A-F9B9T6E9kXIPrQJuftvDv7Gfa4II46uY3cFDdwtvbZKG4FHkEn-bH7fHGA69JjP7aJRhvbW7ltEKaNkcJTLKpeqqB87l3pX4HSc2JxXCrijeqPvmRzZLGKMikkiUSHPQN0DHpJVyr3F2QswtQOJfpD26o_yzXLf55jeaAgNQmYGgffdBUwL7CGg-fFUYQtzU3jEq0kbd9w1qNv2Cw0xM-4tO0usMl4bckClXtcF0OhrCItl9sWSIa01tC424nFwlhEISYtenzUaheGnv_4qxnweBR4NDLHnlrnTb7e83mgt9gKIe2x7IwuHlc1UGOAov6CP7MrFcLA"}
2023-10-17 22:02:34,565 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IlpWSlBhVXRIVTJkVE4yVjJhMWt0YmxWV05XMUphR2s0YUVjdGRreGpjR2d3Um5sT1ZuTmtha3BQU1EifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNTYwMTIzZTQ5MTM4NDAyNWJjZWM2ZjY3NTk1Yzc1YTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kV2hoVjIxTlJtMWhjM3BoYlhKT1lqRXpObnBST1RJNU5qWkZiekUyU1hKMGRXMU5aWGwxUVZkM1NqSnBiRUZWVHpGMmFXeGtNVmh1VmpCZmFrTnpTMlJhUVhFMVVIaEVNMUI1WVc1R1dFSnZRMnhRWlcxS1FUWlBNa2RCWWtZM2VEZHplbmN4VkhkRlYxZzVWMVZyWWs5WFNHSmZTRWRpWmxKNFRrUjZaMG81ZG01U2JXSm9kREZqU2xCM2VtcFpSbEpYY0ZSV1JIWnNRbkZVUVdZMlgyRnViMGhwVW5reE1EbGlOMDgwUTBoamJuVk1TM1UxU2pOdWNtSTFjMFZ6Y0UxWFMybzNTMEZEWTB3M1NsUjJhRXgyUm5vNFZWVXlXbFZ4U1dob01IWlJOMDEwZUd4eU5tRjRXWFJwTVZReE5ucFNjRWR2Y0RFeWQwRkhZM2N0TmtoaVNBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzI5NTQsICJleHAiOiAxNjk3NTc2NTU0fQ.iUWH9B6RZ2HV49AeiFGanAnMvnXH9PUkXio4-wTwxIXtWOXugq7o8uchY4yxDxgCrzgxI9iA4c3_d69jyoNL9g", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMdWhhZ2hZLWR4bXY0VWZURUVqdlZ0dFFSM04xRFdnb0cwY1RmdWRfUGJsM01jVUpvS3BEM01XZVJ6YzRtWTFpTE9oVVRKTlE4Q3p2LThON2dVTjdYcll6bUdtQ25tbDAzeWlWcVFBeUNPMUNaclAwT1lKSl9pX09vOFE5a0JsSFhyVUtGTzFKT3lhZHlxalBHTmItSXpqWGZsczFMd3FLWnkyNjR5SVdOdnZmYXRBaXhyU2FmOGJZWlBudmtUUHRyWXhGY0RHc05WQmdUbHRTeG9wNjBXaWlfSEh6bU1BQ0JaWjYxbkpoWEFiRlQwTEpwQnY3NlZQd29Vb3hpcklSanJHN2drd0V3anBJenZpNUxZcy1MeFh5TkI4OGFzRHNMekRDOFJlX3VvcE93RzNDV21DanJLTTROdDN2eFQ1X2g3UEdGM0RxR3lFbk9oMnVWRjFYRnVKZjdibHdxeW9DSGpNVVE1ZVhTaWZUUFB4bjQwcF84VnR3cVZmUHRxakFKbFBnc2NqR25QSGN1Vkp1QkdBcGtlTk9sUmp3UHRON19aTFo5VUFGUVdISzU5VWV4bkVnbG1nRmxBSUsya3hnUXhLM3M4Ml9GX2VGakZGTmdTUUtJX1h1MlhnMXp2M2ktMmVDSGljSWdNTG1iLWQyV0MyLVdJSnp0R0R6NnJHRl9fRzVUT0VzdHlPb2NNT3Z4VnlfRW1IcVFDREZWNl9oWHpsT0xMUlQ2OHlBM1hmRzZBNXVXc1NhOHNfOGJBdEN0WDFoRS1ub3lOWjVJNkFtdGJ0TG1zUjVRTWw0VGp1RF82SXZOSklXZ3h3bGNmWjJZek1VUjRoaVlKc2p0TFJNZGQtb09ObUJBSDZYcHJKZzdFRXJROEdrWUZTWXNHYnVXcWpBeVNHTWdnakFVZjg9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6IldVSjBNbW95ZG1SVGNrSmlORXRCUkZkT01YWnNZa2RvYkV4eWIxWnZaa3BoTmxCT1RtRnVRMHQyZHcifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFdoaFYyMU5SbTFoYzNwaGJYSk9ZakV6Tm5wUk9USTVOalpGYnpFMlNYSjBkVzFOWlhsMVFWZDNTakpwYkVGVlR6RjJhV3hrTVZodVZqQmZha056UzJSYVFYRTFVSGhFTTFCNVlXNUdXRUp2UTJ4UVpXMUtRVFpQTWtkQllrWTNlRGR6ZW5jeFZIZEZWMWc1VjFWcllrOVhTR0pmU0VkaVpsSjRUa1I2WjBvNWRtNVNiV0pvZERGalNsQjNlbXBaUmxKWGNGUldSSFpzUW5GVVFXWTJYMkZ1YjBocFVua3hNRGxpTjA4MFEwaGpiblZNUzNVMVNqTnVjbUkxYzBWemNFMVhTMm8zUzBGRFkwdzNTbFIyYUV4MlJubzRWVlV5V2xWeFNXaG9NSFpSTjAxMGVHeHlObUY0V1hScE1WUXhObnBTY0VkdmNERXlkMEZIWTNjdE5raGlTQT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzI5NTQsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiMWNkZWQ0NWQ2ZDI4MTFlZWI1ZTkwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogImxGWUpZd1lxSlNrUXJrRXVaT3VSeHBhQyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTcyOTU0LCAiZXhwIjogMTY5NzU3MzI1NCwgImF1ZCI6IFsiand0X3Rlc3QiXX0.GTKAGiYqg2A-F9B9T6E9kXIPrQJuftvDv7Gfa4II46uY3cFDdwtvbZKG4FHkEn-bH7fHGA69JjP7aJRhvbW7ltEKaNkcJTLKpeqqB87l3pX4HSc2JxXCrijeqPvmRzZLGKMikkiUSHPQN0DHpJVyr3F2QswtQOJfpD26o_yzXLf55jeaAgNQmYGgffdBUwL7CGg-fFUYQtzU3jEq0kbd9w1qNv2Cw0xM-4tO0usMl4bckClXtcF0OhrCItl9sWSIa01tC424nFwlhEISYtenzUaheGnv_4qxnweBR4NDLHnlrnTb7e83mgt9gKIe2x7IwuHlc1UGOAov6CP7MrFcLA"}
2023-10-17 22:02:34,565 oidcrp.service DEBUG response format: json
2023-10-17 22:02:34,565 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 22:02:34,565 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IlpWSlBhVXRIVTJkVE4yVjJhMWt0YmxWV05XMUphR2s0YUVjdGRreGpjR2d3Um5sT1ZuTmtha3BQU1EifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNTYwMTIzZTQ5MTM4NDAyNWJjZWM2ZjY3NTk1Yzc1YTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kV2hoVjIxTlJtMWhjM3BoYlhKT1lqRXpObnBST1RJNU5qWkZiekUyU1hKMGRXMU5aWGwxUVZkM1NqSnBiRUZWVHpGMmFXeGtNVmh1VmpCZmFrTnpTMlJhUVhFMVVIaEVNMUI1WVc1R1dFSnZRMnhRWlcxS1FUWlBNa2RCWWtZM2VEZHplbmN4VkhkRlYxZzVWMVZyWWs5WFNHSmZTRWRpWmxKNFRrUjZaMG81ZG01U2JXSm9kREZqU2xCM2VtcFpSbEpYY0ZSV1JIWnNRbkZVUVdZMlgyRnViMGhwVW5reE1EbGlOMDgwUTBoamJuVk1TM1UxU2pOdWNtSTFjMFZ6Y0UxWFMybzNTMEZEWTB3M1NsUjJhRXgyUm5vNFZWVXlXbFZ4U1dob01IWlJOMDEwZUd4eU5tRjRXWFJwTVZReE5ucFNjRWR2Y0RFeWQwRkhZM2N0TmtoaVNBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzI5NTQsICJleHAiOiAxNjk3NTc2NTU0fQ.iUWH9B6RZ2HV49AeiFGanAnMvnXH9PUkXio4-wTwxIXtWOXugq7o8uchY4yxDxgCrzgxI9iA4c3_d69jyoNL9g', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxMdWhhZ2hZLWR4bXY0VWZURUVqdlZ0dFFSM04xRFdnb0cwY1RmdWRfUGJsM01jVUpvS3BEM01XZVJ6YzRtWTFpTE9oVVRKTlE4Q3p2LThON2dVTjdYcll6bUdtQ25tbDAzeWlWcVFBeUNPMUNaclAwT1lKSl9pX09vOFE5a0JsSFhyVUtGTzFKT3lhZHlxalBHTmItSXpqWGZsczFMd3FLWnkyNjR5SVdOdnZmYXRBaXhyU2FmOGJZWlBudmtUUHRyWXhGY0RHc05WQmdUbHRTeG9wNjBXaWlfSEh6bU1BQ0JaWjYxbkpoWEFiRlQwTEpwQnY3NlZQd29Vb3hpcklSanJHN2drd0V3anBJenZpNUxZcy1MeFh5TkI4OGFzRHNMekRDOFJlX3VvcE93RzNDV21DanJLTTROdDN2eFQ1X2g3UEdGM0RxR3lFbk9oMnVWRjFYRnVKZjdibHdxeW9DSGpNVVE1ZVhTaWZUUFB4bjQwcF84VnR3cVZmUHRxakFKbFBnc2NqR25QSGN1Vkp1QkdBcGtlTk9sUmp3UHRON19aTFo5VUFGUVdISzU5VWV4bkVnbG1nRmxBSUsya3hnUXhLM3M4Ml9GX2VGakZGTmdTUUtJX1h1MlhnMXp2M2ktMmVDSGljSWdNTG1iLWQyV0MyLVdJSnp0R0R6NnJHRl9fRzVUT0VzdHlPb2NNT3Z4VnlfRW1IcVFDREZWNl9oWHpsT0xMUlQ2OHlBM1hmRzZBNXVXc1NhOHNfOGJBdEN0WDFoRS1ub3lOWjVJNkFtdGJ0TG1zUjVRTWw0VGp1RF82SXZOSklXZ3h3bGNmWjJZek1VUjRoaVlKc2p0TFJNZGQtb09ObUJBSDZYcHJKZzdFRXJROEdrWUZTWXNHYnVXcWpBeVNHTWdnakFVZjg9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6IldVSjBNbW95ZG1SVGNrSmlORXRCUkZkT01YWnNZa2RvYkV4eWIxWnZaa3BoTmxCT1RtRnVRMHQyZHcifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFdoaFYyMU5SbTFoYzNwaGJYSk9ZakV6Tm5wUk9USTVOalpGYnpFMlNYSjBkVzFOWlhsMVFWZDNTakpwYkVGVlR6RjJhV3hrTVZodVZqQmZha056UzJSYVFYRTFVSGhFTTFCNVlXNUdXRUp2UTJ4UVpXMUtRVFpQTWtkQllrWTNlRGR6ZW5jeFZIZEZWMWc1VjFWcllrOVhTR0pmU0VkaVpsSjRUa1I2WjBvNWRtNVNiV0pvZERGalNsQjNlbXBaUmxKWGNGUldSSFpzUW5GVVFXWTJYMkZ1YjBocFVua3hNRGxpTjA4MFEwaGpiblZNUzNVMVNqTnVjbUkxYzBWemNFMVhTMm8zUzBGRFkwdzNTbFIyYUV4MlJubzRWVlV5V2xWeFNXaG9NSFpSTjAxMGVHeHlObUY0V1hScE1WUXhObnBTY0VkdmNERXlkMEZIWTNjdE5raGlTQT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzI5NTQsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiMWNkZWQ0NWQ2ZDI4MTFlZWI1ZTkwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogImxGWUpZd1lxSlNrUXJrRXVaT3VSeHBhQyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTcyOTU0LCAiZXhwIjogMTY5NzU3MzI1NCwgImF1ZCI6IFsiand0X3Rlc3QiXX0.GTKAGiYqg2A-F9B9T6E9kXIPrQJuftvDv7Gfa4II46uY3cFDdwtvbZKG4FHkEn-bH7fHGA69JjP7aJRhvbW7ltEKaNkcJTLKpeqqB87l3pX4HSc2JxXCrijeqPvmRzZLGKMikkiUSHPQN0DHpJVyr3F2QswtQOJfpD26o_yzXLf55jeaAgNQmYGgffdBUwL7CGg-fFUYQtzU3jEq0kbd9w1qNv2Cw0xM-4tO0usMl4bckClXtcF0OhrCItl9sWSIa01tC424nFwlhEISYtenzUaheGnv_4qxnweBR4NDLHnlrnTb7e83mgt9gKIe2x7IwuHlc1UGOAov6CP7MrFcLA'}"
2023-10-17 22:02:34,565 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-17 22:02:34,565 oidcmsg.message DEBUG Raw JSON: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdWhhV21NRm1hc3phbXJOYjEzNnpROTI5NjZFbzE2SXJ0dW1NZXl1QVd3SjJpbEFVTzF2aWxkMVhuVjBfakNzS2RaQXE1UHhEM1B5YW5GWEJvQ2xQZW1KQTZPMkdBYkY3eDdzencxVHdFV1g5V1VrYk9XSGJfSEdiZlJ4TkR6Z0o5dm5SbWJodDFjSlB3empZRlJXcFRWRHZsQnFUQWY2X2Fub0hpUnkxMDliN080Q0hjbnVMS3U1SjNucmI1c0VzcE1XS2o3S0FDY0w3SlR2aEx2Rno4VVUyWlVxSWhoMHZRN010eGxyNmF4WXRpMVQxNnpScEdvcDEyd0FHY3ctNkhiSA==', 'auth_time': 1697572954, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '1cded45d6d2811eeb5e90242ac170004', 'client_id': 'jwt_test', 'nonce': 'lFYJYwYqJSkQrkEuZOuRxpaC', 'iss': 'https://satosa.idem.it', 'iat': 1697572954, 'exp': 1697573254, 'aud': ['jwt_test']}
2023-10-17 22:02:34,565 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'WUJ0MmoydmRTckJiNEtBRFdOMXZsYkdobExyb1ZvZkphNlBOTmFuQ0t2dw'}
2023-10-17 22:02:34,565 cryptojwt.key_jar DEBUG Key summary for https://satosa.idem.it: RSA:sig:WUJ0MmoydmRTckJiNEtBRFdOMXZsYkdobExyb1ZvZkphNlBOTmFuQ0t2dw, EC:sig:ZVJPaUtHU2dTN2V2a1ktblVWNW1JaGk4aEctdkxjcGgwRnlOVnNkakpPSQ
2023-10-17 22:02:34,565 oidcmsg.message DEBUG Found signing key.
2023-10-17 22:02:34,565 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-17 22:02:34,566 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=WUJ0MmoydmRTckJiNEtBRFdOMXZsYkdobExyb1ZvZkphNlBOTmFuQ0t2dw and use=
2023-10-17 22:02:34,566 cryptojwt.jwx DEBUG Picked: kid:WUJ0MmoydmRTckJiNEtBRFdOMXZsYkdobExyb1ZvZkphNlBOTmFuQ0t2dw, use:sig, kty:RSA
2023-10-17 22:02:34,566 cryptojwt.jws.jws DEBUG Verified message using key with kid=WUJ0MmoydmRTckJiNEtBRFdOMXZsYkdobExyb1ZvZkphNlBOTmFuQ0t2dw
2023-10-17 22:02:34,566 oidcmsg.oidc INFO Verified id_token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdWhhV21NRm1hc3phbXJOYjEzNnpROTI5NjZFbzE2SXJ0dW1NZXl1QVd3SjJpbEFVTzF2aWxkMVhuVjBfakNzS2RaQXE1UHhEM1B5YW5GWEJvQ2xQZW1KQTZPMkdBYkY3eDdzencxVHdFV1g5V1VrYk9XSGJfSEdiZlJ4TkR6Z0o5dm5SbWJodDFjSlB3empZRlJXcFRWRHZsQnFUQWY2X2Fub0hpUnkxMDliN080Q0hjbnVMS3U1SjNucmI1c0VzcE1XS2o3S0FDY0w3SlR2aEx2Rno4VVUyWlVxSWhoMHZRN010eGxyNmF4WXRpMVQxNnpScEdvcDEyd0FHY3ctNkhiSA==', 'auth_time': 1697572954, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '1cded45d6d2811eeb5e90242ac170004', 'client_id': 'jwt_test', 'nonce': 'lFYJYwYqJSkQrkEuZOuRxpaC', 'iss': 'https://satosa.idem.it', 'iat': 1697572954, 'exp': 1697573254, 'aud': ['jwt_test']}
2023-10-17 22:02:34,567 oidcrp.rp_handler DEBUG ID Token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdWhhV21NRm1hc3phbXJOYjEzNnpROTI5NjZFbzE2SXJ0dW1NZXl1QVd3SjJpbEFVTzF2aWxkMVhuVjBfakNzS2RaQXE1UHhEM1B5YW5GWEJvQ2xQZW1KQTZPMkdBYkY3eDdzencxVHdFV1g5V1VrYk9XSGJfSEdiZlJ4TkR6Z0o5dm5SbWJodDFjSlB3empZRlJXcFRWRHZsQnFUQWY2X2Fub0hpUnkxMDliN080Q0hjbnVMS3U1SjNucmI1c0VzcE1XS2o3S0FDY0w3SlR2aEx2Rno4VVUyWlVxSWhoMHZRN010eGxyNmF4WXRpMVQxNnpScEdvcDEyd0FHY3ctNkhiSA==', 'auth_time': 1697572954, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '1cded45d6d2811eeb5e90242ac170004', 'client_id': 'jwt_test', 'nonce': 'lFYJYwYqJSkQrkEuZOuRxpaC', 'iss': 'https://satosa.idem.it', 'iat': 1697572954, 'exp': 1697573254, 'aud': ['jwt_test']}
2023-10-17 22:02:34,567 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-17 22:02:34,567 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IlpWSlBhVXRIVTJkVE4yVjJhMWt0YmxWV05XMUphR2s0YUVjdGRreGpjR2d3Um5sT1ZuTmtha3BQU1EifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNTYwMTIzZTQ5MTM4NDAyNWJjZWM2ZjY3NTk1Yzc1YTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kV2hoVjIxTlJtMWhjM3BoYlhKT1lqRXpObnBST1RJNU5qWkZiekUyU1hKMGRXMU5aWGwxUVZkM1NqSnBiRUZWVHpGMmFXeGtNVmh1VmpCZmFrTnpTMlJhUVhFMVVIaEVNMUI1WVc1R1dFSnZRMnhRWlcxS1FUWlBNa2RCWWtZM2VEZHplbmN4VkhkRlYxZzVWMVZyWWs5WFNHSmZTRWRpWmxKNFRrUjZaMG81ZG01U2JXSm9kREZqU2xCM2VtcFpSbEpYY0ZSV1JIWnNRbkZVUVdZMlgyRnViMGhwVW5reE1EbGlOMDgwUTBoamJuVk1TM1UxU2pOdWNtSTFjMFZ6Y0UxWFMybzNTMEZEWTB3M1NsUjJhRXgyUm5vNFZWVXlXbFZ4U1dob01IWlJOMDEwZUd4eU5tRjRXWFJwTVZReE5ucFNjRWR2Y0RFeWQwRkhZM2N0TmtoaVNBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzI5NTQsICJleHAiOiAxNjk3NTc2NTU0fQ.iUWH9B6RZ2HV49AeiFGanAnMvnXH9PUkXio4-wTwxIXtWOXugq7o8uchY4yxDxgCrzgxI9iA4c3_d69jyoNL9g'}
2023-10-17 22:02:34,567 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-17 22:02:34,567 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f38361d2450>, 'url': 'https://satosa.idem.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IlpWSlBhVXRIVTJkVE4yVjJhMWt0YmxWV05XMUphR2s0YUVjdGRreGpjR2d3Um5sT1ZuTmtha3BQU1EifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNTYwMTIzZTQ5MTM4NDAyNWJjZWM2ZjY3NTk1Yzc1YTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kV2hoVjIxTlJtMWhjM3BoYlhKT1lqRXpObnBST1RJNU5qWkZiekUyU1hKMGRXMU5aWGwxUVZkM1NqSnBiRUZWVHpGMmFXeGtNVmh1VmpCZmFrTnpTMlJhUVhFMVVIaEVNMUI1WVc1R1dFSnZRMnhRWlcxS1FUWlBNa2RCWWtZM2VEZHplbmN4VkhkRlYxZzVWMVZyWWs5WFNHSmZTRWRpWmxKNFRrUjZaMG81ZG01U2JXSm9kREZqU2xCM2VtcFpSbEpYY0ZSV1JIWnNRbkZVUVdZMlgyRnViMGhwVW5reE1EbGlOMDgwUTBoamJuVk1TM1UxU2pOdWNtSTFjMFZ6Y0UxWFMybzNTMEZEWTB3M1NsUjJhRXgyUm5vNFZWVXlXbFZ4U1dob01IWlJOMDEwZUd4eU5tRjRXWFJwTVZReE5ucFNjRWR2Y0RFeWQwRkhZM2N0TmtoaVNBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzI5NTQsICJleHAiOiAxNjk3NTc2NTU0fQ.iUWH9B6RZ2HV49AeiFGanAnMvnXH9PUkXio4-wTwxIXtWOXugq7o8uchY4yxDxgCrzgxI9iA4c3_d69jyoNL9g'}}
2023-10-17 22:02:34,567 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IlpWSlBhVXRIVTJkVE4yVjJhMWt0YmxWV05XMUphR2s0YUVjdGRreGpjR2d3Um5sT1ZuTmtha3BQU1EifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNTYwMTIzZTQ5MTM4NDAyNWJjZWM2ZjY3NTk1Yzc1YTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kV2hoVjIxTlJtMWhjM3BoYlhKT1lqRXpObnBST1RJNU5qWkZiekUyU1hKMGRXMU5aWGwxUVZkM1NqSnBiRUZWVHpGMmFXeGtNVmh1VmpCZmFrTnpTMlJhUVhFMVVIaEVNMUI1WVc1R1dFSnZRMnhRWlcxS1FUWlBNa2RCWWtZM2VEZHplbmN4VkhkRlYxZzVWMVZyWWs5WFNHSmZTRWRpWmxKNFRrUjZaMG81ZG01U2JXSm9kREZqU2xCM2VtcFpSbEpYY0ZSV1JIWnNRbkZVUVdZMlgyRnViMGhwVW5reE1EbGlOMDgwUTBoamJuVk1TM1UxU2pOdWNtSTFjMFZ6Y0UxWFMybzNTMEZEWTB3M1NsUjJhRXgyUm5vNFZWVXlXbFZ4U1dob01IWlJOMDEwZUd4eU5tRjRXWFJwTVZReE5ucFNjRWR2Y0RFeWQwRkhZM2N0TmtoaVNBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzI5NTQsICJleHAiOiAxNjk3NTc2NTU0fQ.iUWH9B6RZ2HV49AeiFGanAnMvnXH9PUkXio4-wTwxIXtWOXugq7o8uchY4yxDxgCrzgxI9iA4c3_d69jyoNL9g'}
2023-10-17 22:02:34,568 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:02:34,730 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-17 22:02:34,731 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:02:34,731 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:02:34,731 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:02:34 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdADsUgwYjddZ-ZCx3PB7BSmmF36kbJa7ePAy2rr2UdoMWwX1-TBie6it_NPw7SnNiOsFtZIgPMNzWMYGpJ6HVd-8M_zByk1O6EKDUgZODwQXRrV9R-b1MF6k6kbM4Ri4yQiI-06CIBdNk91ZSEwZUpVgK0fk3VbBhtFBHVjjsjnDtWkSQtid-u9nGNoVFa-ZXDlwBX0fl9S7xRLPCb5kmRoT2K7DK5wYqrNVxQ72oXOcW9dXGR7h_LvO9RQAAALkDwpkwT2aQAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdADsUgwYjddZ-ZCx3PB7BSmmF36kbJa7ePAy2rr2UdoMWwX1-TBie6it_NPw7SnNiOsFtZIgPMNzWMYGpJ6HVd-8M_zByk1O6EKDUgZODwQXRrV9R-b1MF6k6kbM4Ri4yQiI-06CIBdNk91ZSEwZUpVgK0fk3VbBhtFBHVjjsjnDtWkSQtid-u9nGNoVFa-ZXDlwBX0fl9S7xRLPCb5kmRoT2K7DK5wYqrNVxQ72oXOcW9dXGR7h_LvO9RQAAALkDwpkwT2aQAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:02:34,731 oidcrp.util DEBUG resp.txt: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-17 22:02:34,731 oidcrp.oauth2 DEBUG Successful response: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-17 22:02:34,731 oidcrp.service DEBUG response format: json
2023-10-17 22:02:34,731 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-17 22:02:34,731 oidcrp.service DEBUG Initial response parsing => "{'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}"
2023-10-17 22:02:34,731 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-17 22:02:34,732 oidcrp.rp_handler DEBUG UserInfo: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}
2023-10-17 22:02:34,734 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:02:34] "GET /authz_cb/satosa?state=UzwJHrW7FFxwRgSgGql255WZD3q42qId&scope=openid+offline_access+profile&code=Z0FBQUFBQmxMdWhhZV95WDBWQkJ5YzV2S1AzRG1DN1hHWEloMnNWMU1kWXpCQmIxTXZBOGZTbkQtR2FBTXdDdEx5VmJWS3JWUnN5ZC1FcmN0dlFDMF90ZHNoRGJFVC14UVJsN0hwdDByS1YzUkVhYjhYbW4weVVtam12NVdTX1ZDUnhHdXp2YVBMR0JFb0RjMXN2Uy1ILVpEeHZ1Yl84QzV5YWlobG1uTzRiUkFyVDlGcUY3UGpzRDVmZ282aWNqdUV2T1d4LUZqaGZCNnM5dWkweHlwSU9wY25UZy1oM3p5cjJRRFNmbzBONU85ME8xempxTVZvZEFqWlVJQ21aMnl1Wk9nMVR4TkttSE1wMS1LSUlQSU9qQjdoZVRzbTFMM3ptcFprR3lDM2NNWXlHVlJOVlV2Snd0RDhuazFFNjRvNC16TldocjJVQWd4eDVCV1FYSDVTOV9vWG8xeEhka3lhQk5wVkNFbGRKcll3NFVYREJVYnFfeDk4Y3JNUDUxX3padzhadzFkMTZtYTd4MDhYNUYweUI1US1JUGZQT0tITWRiQWVFVzBuNnRKRVFiQm5WWlpoWnVXd3pZbEF6UUpQNTQtMW5MSFFVYVA5QW4yZXNiaDlJNERFNTZKdXk0d2hRY2VkUkNza0hfVGF4UDVvS1Jnd05xZTktaDdGTXg0UUM0T25yblFnSENVZFVzbXZRN2Y1RWIyVFJTa3NKM0pQSTVmNkhyMEh6aE9sUEJsUWxNTTJTR3UtRURaMmxSMmQtakF0MlJIT3RPbmhEeGlFM25falYwLWJmNGJDNUh4YjBDcEU2UXdTRnJ2YlRoQWVmZnVVek1CbXdKb0JoMkZtc2JuQ2x1X2Q5U20wLUNXSkNqMGM2b0dYMmdyWmd4VHRMejNnYndvV0gtN1Y2Z3dYc1kzMjQ9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1" 200 -
2023-10-17 22:06:06,660 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:06:06] "GET / HTTP/1.1" 200 -
2023-10-17 22:08:15,086 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 22:08:15,086 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 22:08:15,087 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 22:08:15,087 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 22:08:15,128 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 22:08:15,128 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 22:08:15,128 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 22:08:15,128 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 22:08:15,129 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:08:15,151 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 22:08:15,152 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:08:15,152 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:08:15,152 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:08:15 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdACGcgocB6xW9J62JLI31EjODkx5ADdKkQ7tfcLWwlVSU0EltUD8r3dgAi3iVN6eWEioHV5XohTVpS7rj9wsyCZNyWpVVU_hz0TVcGEpfG3QLRP9UkDaz9Na5fFQjGrr0n3UccfuH-wMxQeQCwQwGcneWIZQLislhb_nEZeNpYqlmwnpdG5A-DLD9nfmgQSPPCWCyy_BYPxisV04US_EQlk6yg15u052LOUa7m223CxUNvp_3zpGF-A4soAAAAOD_RLWQrbKNAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdACGcgocB6xW9J62JLI31EjODkx5ADdKkQ7tfcLWwlVSU0EltUD8r3dgAi3iVN6eWEioHV5XohTVpS7rj9wsyCZNyWpVVU_hz0TVcGEpfG3QLRP9UkDaz9Na5fFQjGrr0n3UccfuH-wMxQeQCwQwGcneWIZQLislhb_nEZeNpYqlmwnpdG5A-DLD9nfmgQSPPCWCyy_BYPxisV04US_EQlk6yg15u052LOUa7m223CxUNvp_3zpGF-A4soAAAAOD_RLWQrbKNAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:08:15,152 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 22:08:15,152 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 22:08:15,152 oidcrp.service DEBUG response format: json
2023-10-17 22:08:15,152 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 22:08:15,152 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 22:08:15,152 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 22:08:15,153 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 22:08:15,153 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 22:08:15,153 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:08:15,153 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:08:15,154 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:08:15,175 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 22:08:15,176 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:08:15,176 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:08:15,176 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-17 22:08:15,177 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 22:08:15,177 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 22:08:15,177 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 22:08:15,177 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'R4mllEmItM03VWj9dvKn8lg1', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'S6BS19bueFDvlQay0snZKnc33S3hLvgC'}
2023-10-17 22:08:15,177 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'R4mllEmItM03VWj9dvKn8lg1', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'S6BS19bueFDvlQay0snZKnc33S3hLvgC', 'code_challenge': 'tsRNNcs3WeqE7bMDYp_7xug6u1ZiqmKlCkmD9g-7vII', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 22:08:15,177 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f38345bfd90>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=R4mllEmItM03VWj9dvKn8lg1&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=S6BS19bueFDvlQay0snZKnc33S3hLvgC&code_challenge=tsRNNcs3WeqE7bMDYp_7xug6u1ZiqmKlCkmD9g-7vII&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 22:08:15,178 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:08:15] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 22:08:23,096 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 22:08:23,096 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 22:08:23,096 oidcrp.service DEBUG response format: dict
2023-10-17 22:08:23,096 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 22:08:23,096 oidcrp.service DEBUG Initial response parsing => "{'state': 'S6BS19bueFDvlQay0snZKnc33S3hLvgC', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxMdW0zMENJOVQ1RWdSU2dBTUlWMDk5bTNQU2dIVGVBRi1WZ2czTGFrYWhsWThRVUhuTmpNY2YzUVdNR1J0R25IcXV4Ql92WVFtck9kbDR1TUlsQkJVSEtVVmZjTzIxaEFXSm5GVkZKc0NaRGhZOVVZRTFBaTBGZ1BxOGhsNmNBU0x4Rm5LdGNXb1RTX3BrX1pKcjhtQVJzUmRrcklVUXRva3FqLWFrWFIwc3BKVEJpZDhkb1ZUNTNKbHZqM0RydXdEN2Z1ak5lQVpzdzM1cVMteHpYQllpbFZxSnA5Q2g0dFBZanJzNEY1UjhaZk1RYlJKS2JkTUVxRE5JeEhMQnMxMUxmMDNRODhIcFI4OEJtNHNwMkQ2b2lWNUo2WDJWZTFuR1JBUUdNbE1CNDlsbmhOM0R3Sy1fbFBNR2EzdnQxd3ZmRDF5WVMwTjZYdjQ1R1FmNmNXckxVV2ViOWF2M05FWmhIMjFSSEtFeW50eWJyVkY0MC1vYTBEcjVqMnQ1N1BzcXZUd2J1OFA1MERIcVVDM3k3ZzdUOFpkcHFBc3dlUnk2ZDNRVEdkU1V4UWQyTzVSU0otME05Q09UMVFHNkxhNTdEdHBDWlNDM1ZGNklnY241Qk8wMkdYcGUwUGNaNTNPZlFlSEFKWUNrTW5ONWVwOWh0Q2Y3bnJRZTJJRF9JTXZUX1VHVDNWdG1XejFMQXd1QUhnRjRYRWNLTHpPU3dVUkh0WTJtM0xkMjM1WVpOaEJEOTNxZ2FwWWN1NDBxMDViaVh1M19pVXdVVldrQVFaeVdYZVRKOVVEcWpPeEVtem1KMXJhZjV3cjNiWVdnMXpYZ0sxT05jdXRzSVBmaV90SjhpUXMtOXpzdTJJaXBpeW5jb0RlMlJ5a3Rqb3VqTGxoWVI3WEdtUHBMbzIwU0U9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 22:08:23,096 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 22:08:23,096 oidcrp.rp_handler DEBUG Authz response: {'state': 'S6BS19bueFDvlQay0snZKnc33S3hLvgC', 'scope': 'openid offline_access profile', 'code': 'Z0FBQUFBQmxMdW0zMENJOVQ1RWdSU2dBTUlWMDk5bTNQU2dIVGVBRi1WZ2czTGFrYWhsWThRVUhuTmpNY2YzUVdNR1J0R25IcXV4Ql92WVFtck9kbDR1TUlsQkJVSEtVVmZjTzIxaEFXSm5GVkZKc0NaRGhZOVVZRTFBaTBGZ1BxOGhsNmNBU0x4Rm5LdGNXb1RTX3BrX1pKcjhtQVJzUmRrcklVUXRva3FqLWFrWFIwc3BKVEJpZDhkb1ZUNTNKbHZqM0RydXdEN2Z1ak5lQVpzdzM1cVMteHpYQllpbFZxSnA5Q2g0dFBZanJzNEY1UjhaZk1RYlJKS2JkTUVxRE5JeEhMQnMxMUxmMDNRODhIcFI4OEJtNHNwMkQ2b2lWNUo2WDJWZTFuR1JBUUdNbE1CNDlsbmhOM0R3Sy1fbFBNR2EzdnQxd3ZmRDF5WVMwTjZYdjQ1R1FmNmNXckxVV2ViOWF2M05FWmhIMjFSSEtFeW50eWJyVkY0MC1vYTBEcjVqMnQ1N1BzcXZUd2J1OFA1MERIcVVDM3k3ZzdUOFpkcHFBc3dlUnk2ZDNRVEdkU1V4UWQyTzVSU0otME05Q09UMVFHNkxhNTdEdHBDWlNDM1ZGNklnY241Qk8wMkdYcGUwUGNaNTNPZlFlSEFKWUNrTW5ONWVwOWh0Q2Y3bnJRZTJJRF9JTXZUX1VHVDNWdG1XejFMQXd1QUhnRjRYRWNLTHpPU3dVUkh0WTJtM0xkMjM1WVpOaEJEOTNxZ2FwWWN1NDBxMDViaVh1M19pVXdVVldrQVFaeVdYZVRKOVVEcWpPeEVtem1KMXJhZjV3cjNiWVdnMXpYZ0sxT05jdXRzSVBmaV90SjhpUXMtOXpzdTJJaXBpeW5jb0RlMlJ5a3Rqb3VqTGxoWVI3WEdtUHBMbzIwU0U9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 22:08:23,096 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 22:08:23,096 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 22:08:23,096 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMdW0zMENJOVQ1RWdSU2dBTUlWMDk5bTNQU2dIVGVBRi1WZ2czTGFrYWhsWThRVUhuTmpNY2YzUVdNR1J0R25IcXV4Ql92WVFtck9kbDR1TUlsQkJVSEtVVmZjTzIxaEFXSm5GVkZKc0NaRGhZOVVZRTFBaTBGZ1BxOGhsNmNBU0x4Rm5LdGNXb1RTX3BrX1pKcjhtQVJzUmRrcklVUXRva3FqLWFrWFIwc3BKVEJpZDhkb1ZUNTNKbHZqM0RydXdEN2Z1ak5lQVpzdzM1cVMteHpYQllpbFZxSnA5Q2g0dFBZanJzNEY1UjhaZk1RYlJKS2JkTUVxRE5JeEhMQnMxMUxmMDNRODhIcFI4OEJtNHNwMkQ2b2lWNUo2WDJWZTFuR1JBUUdNbE1CNDlsbmhOM0R3Sy1fbFBNR2EzdnQxd3ZmRDF5WVMwTjZYdjQ1R1FmNmNXckxVV2ViOWF2M05FWmhIMjFSSEtFeW50eWJyVkY0MC1vYTBEcjVqMnQ1N1BzcXZUd2J1OFA1MERIcVVDM3k3ZzdUOFpkcHFBc3dlUnk2ZDNRVEdkU1V4UWQyTzVSU0otME05Q09UMVFHNkxhNTdEdHBDWlNDM1ZGNklnY241Qk8wMkdYcGUwUGNaNTNPZlFlSEFKWUNrTW5ONWVwOWh0Q2Y3bnJRZTJJRF9JTXZUX1VHVDNWdG1XejFMQXd1QUhnRjRYRWNLTHpPU3dVUkh0WTJtM0xkMjM1WVpOaEJEOTNxZ2FwWWN1NDBxMDViaVh1M19pVXdVVldrQVFaeVdYZVRKOVVEcWpPeEVtem1KMXJhZjV3cjNiWVdnMXpYZ0sxT05jdXRzSVBmaV90SjhpUXMtOXpzdTJJaXBpeW5jb0RlMlJ5a3Rqb3VqTGxoWVI3WEdtUHBMbzIwU0U9', 'state': 'S6BS19bueFDvlQay0snZKnc33S3hLvgC', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-17 22:08:23,097 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'S6BS19bueFDvlQay0snZKnc33S3hLvgC', 'code': 'Z0FBQUFBQmxMdW0zMENJOVQ1RWdSU2dBTUlWMDk5bTNQU2dIVGVBRi1WZ2czTGFrYWhsWThRVUhuTmpNY2YzUVdNR1J0R25IcXV4Ql92WVFtck9kbDR1TUlsQkJVSEtVVmZjTzIxaEFXSm5GVkZKc0NaRGhZOVVZRTFBaTBGZ1BxOGhsNmNBU0x4Rm5LdGNXb1RTX3BrX1pKcjhtQVJzUmRrcklVUXRva3FqLWFrWFIwc3BKVEJpZDhkb1ZUNTNKbHZqM0RydXdEN2Z1ak5lQVpzdzM1cVMteHpYQllpbFZxSnA5Q2g0dFBZanJzNEY1UjhaZk1RYlJKS2JkTUVxRE5JeEhMQnMxMUxmMDNRODhIcFI4OEJtNHNwMkQ2b2lWNUo2WDJWZTFuR1JBUUdNbE1CNDlsbmhOM0R3Sy1fbFBNR2EzdnQxd3ZmRDF5WVMwTjZYdjQ1R1FmNmNXckxVV2ViOWF2M05FWmhIMjFSSEtFeW50eWJyVkY0MC1vYTBEcjVqMnQ1N1BzcXZUd2J1OFA1MERIcVVDM3k3ZzdUOFpkcHFBc3dlUnk2ZDNRVEdkU1V4UWQyTzVSU0otME05Q09UMVFHNkxhNTdEdHBDWlNDM1ZGNklnY241Qk8wMkdYcGUwUGNaNTNPZlFlSEFKWUNrTW5ONWVwOWh0Q2Y3bnJRZTJJRF9JTXZUX1VHVDNWdG1XejFMQXd1QUhnRjRYRWNLTHpPU3dVUkh0WTJtM0xkMjM1WVpOaEJEOTNxZ2FwWWN1NDBxMDViaVh1M19pVXdVVldrQVFaeVdYZVRKOVVEcWpPeEVtem1KMXJhZjV3cjNiWVdnMXpYZ0sxT05jdXRzSVBmaV90SjhpUXMtOXpzdTJJaXBpeW5jb0RlMlJ5a3Rqb3VqTGxoWVI3WEdtUHBMbzIwU0U9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'QqKQaVkM5Lo3MF7fKGQownpWbS0tLwuoB9h4hNQM3RVdoxxntbmNqhkFZtwmkM4z'}
2023-10-17 22:08:23,097 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 22:08:23,097 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f3836e472d0>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=S6BS19bueFDvlQay0snZKnc33S3hLvgC&code=Z0FBQUFBQmxMdW0zMENJOVQ1RWdSU2dBTUlWMDk5bTNQU2dIVGVBRi1WZ2czTGFrYWhsWThRVUhuTmpNY2YzUVdNR1J0R25IcXV4Ql92WVFtck9kbDR1TUlsQkJVSEtVVmZjTzIxaEFXSm5GVkZKc0NaRGhZOVVZRTFBaTBGZ1BxOGhsNmNBU0x4Rm5LdGNXb1RTX3BrX1pKcjhtQVJzUmRrcklVUXRva3FqLWFrWFIwc3BKVEJpZDhkb1ZUNTNKbHZqM0RydXdEN2Z1ak5lQVpzdzM1cVMteHpYQllpbFZxSnA5Q2g0dFBZanJzNEY1UjhaZk1RYlJKS2JkTUVxRE5JeEhMQnMxMUxmMDNRODhIcFI4OEJtNHNwMkQ2b2lWNUo2WDJWZTFuR1JBUUdNbE1CNDlsbmhOM0R3Sy1fbFBNR2EzdnQxd3ZmRDF5WVMwTjZYdjQ1R1FmNmNXckxVV2ViOWF2M05FWmhIMjFSSEtFeW50eWJyVkY0MC1vYTBEcjVqMnQ1N1BzcXZUd2J1OFA1MERIcVVDM3k3ZzdUOFpkcHFBc3dlUnk2ZDNRVEdkU1V4UWQyTzVSU0otME05Q09UMVFHNkxhNTdEdHBDWlNDM1ZGNklnY241Qk8wMkdYcGUwUGNaNTNPZlFlSEFKWUNrTW5ONWVwOWh0Q2Y3bnJRZTJJRF9JTXZUX1VHVDNWdG1XejFMQXd1QUhnRjRYRWNLTHpPU3dVUkh0WTJtM0xkMjM1WVpOaEJEOTNxZ2FwWWN1NDBxMDViaVh1M19pVXdVVldrQVFaeVdYZVRKOVVEcWpPeEVtem1KMXJhZjV3cjNiWVdnMXpYZ0sxT05jdXRzSVBmaV90SjhpUXMtOXpzdTJJaXBpeW5jb0RlMlJ5a3Rqb3VqTGxoWVI3WEdtUHBMbzIwU0U9&code_verifier=QqKQaVkM5Lo3MF7fKGQownpWbS0tLwuoB9h4hNQM3RVdoxxntbmNqhkFZtwmkM4z', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 22:08:23,097 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=S6BS19bueFDvlQay0snZKnc33S3hLvgC&code=Z0FBQUFBQmxMdW0zMENJOVQ1RWdSU2dBTUlWMDk5bTNQU2dIVGVBRi1WZ2czTGFrYWhsWThRVUhuTmpNY2YzUVdNR1J0R25IcXV4Ql92WVFtck9kbDR1TUlsQkJVSEtVVmZjTzIxaEFXSm5GVkZKc0NaRGhZOVVZRTFBaTBGZ1BxOGhsNmNBU0x4Rm5LdGNXb1RTX3BrX1pKcjhtQVJzUmRrcklVUXRva3FqLWFrWFIwc3BKVEJpZDhkb1ZUNTNKbHZqM0RydXdEN2Z1ak5lQVpzdzM1cVMteHpYQllpbFZxSnA5Q2g0dFBZanJzNEY1UjhaZk1RYlJKS2JkTUVxRE5JeEhMQnMxMUxmMDNRODhIcFI4OEJtNHNwMkQ2b2lWNUo2WDJWZTFuR1JBUUdNbE1CNDlsbmhOM0R3Sy1fbFBNR2EzdnQxd3ZmRDF5WVMwTjZYdjQ1R1FmNmNXckxVV2ViOWF2M05FWmhIMjFSSEtFeW50eWJyVkY0MC1vYTBEcjVqMnQ1N1BzcXZUd2J1OFA1MERIcVVDM3k3ZzdUOFpkcHFBc3dlUnk2ZDNRVEdkU1V4UWQyTzVSU0otME05Q09UMVFHNkxhNTdEdHBDWlNDM1ZGNklnY241Qk8wMkdYcGUwUGNaNTNPZlFlSEFKWUNrTW5ONWVwOWh0Q2Y3bnJRZTJJRF9JTXZUX1VHVDNWdG1XejFMQXd1QUhnRjRYRWNLTHpPU3dVUkh0WTJtM0xkMjM1WVpOaEJEOTNxZ2FwWWN1NDBxMDViaVh1M19pVXdVVldrQVFaeVdYZVRKOVVEcWpPeEVtem1KMXJhZjV3cjNiWVdnMXpYZ0sxT05jdXRzSVBmaV90SjhpUXMtOXpzdTJJaXBpeW5jb0RlMlJ5a3Rqb3VqTGxoWVI3WEdtUHBMbzIwU0U9&code_verifier=QqKQaVkM5Lo3MF7fKGQownpWbS0tLwuoB9h4hNQM3RVdoxxntbmNqhkFZtwmkM4z, https_args:{'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 22:08:23,097 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:08:23,243 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-17 22:08:23,243 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:08:23,243 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:08:23,243 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:08:23 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACKQhf_BRc1pFr0El5Lz2i_1haX86zsv-ku22MWEf6Z7HiOu-nX5SRolfUFoQ6FcfoNRIkOU8dnEiXWxqCSWqwzoTN8n5zAQMLolt2UHptvVClVrC937V772RhCAmvCtAey06WfeDHjjcxjMGt-Csmxf1yZ-wCY0k4ID5y1xC3uFDxlOUODlwa4AmszZFzRyU8DmOs9aSX62083vmbydP_mGfmaTPO6axy-0MuB7Aasw3GMHjy7D_myEAAAAAAuURO7wj_l1AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACKQhf_BRc1pFr0El5Lz2i_1haX86zsv-ku22MWEf6Z7HiOu-nX5SRolfUFoQ6FcfoNRIkOU8dnEiXWxqCSWqwzoTN8n5zAQMLolt2UHptvVClVrC937V772RhCAmvCtAey06WfeDHjjcxjMGt-Csmxf1yZ-wCY0k4ID5y1xC3uFDxlOUODlwa4AmszZFzRyU8DmOs9aSX62083vmbydP_mGfmaTPO6axy-0MuB7Aasw3GMHjy7D_myEAAAAAAuURO7wj_l1AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:08:23,243 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNzIyZGM5ZGYxYjMzNDRmZGE4ZDJmNDY0MWJhYTEyMTEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVzB6ZVRsdllWQjJORVJHYkVveVREWnFhRFpuVG5wUFZHZDRaRE5tZEhwaFVXWkxTM2MyZGxWQlRFdHdkV1JLTlhaS1NEQjRWMnBaVDBwMmFGRTRkMHB5TmsxWlJGTTFVbXRaUWxKcmFXdFhZM0paUXkweExVaExVa3BrWW1wTlNrNXZNbWhWYWxKV2JreFNOa293TUhOdmJHcEZka0p1YkZWUlNUQjFkMHAwZUZOMFNHZDVWbWR4VERKVmVFOU9ibmRNYUdscGMyVnRhVUZVTFRGdlVUaEthazE0WkRoUVpVTkJVVzltUlRoWlNGQjNjMHBFVFU5MlRVVk1SSGhKVjFGeGRIcEJORmhDYjBGMGExaEtaV1F0VkRJMk1GTTRWRWRxWlRkT01VbGxTMXBGVkhsM1kxSlhSRFJYWDFOU09GTmpVRk55WWtvd1kxZERlbFF4Y25SeGFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzMzMDMsICJleHAiOiAxNjk3NTc2OTAzfQ.2Vfa6jqCj_UyP7pvBZCO4jqxIZFIASJPxuvrio8eEDPPSfU-GIsO16m1NM6hPrhLOQ-yT_3nExAPBZI5ZG3uVw", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMdW0zdWVHQ0VJV3NDODQ0MmFMbnZjTjRjVGRyQzNVbzV3WlhHZ1NuV3cxRzhRdTJBdm5FcjJZSXFSZTZ3Z084aHFKZ0dWUVVPS0czdTRTVGEyVExXbjFDUXJVaGdZT0tRTUVTRllfcndaelRhZkE2SjZnZjd1eGJDWEFESVdocktFLTlPMjlqMGJKZFU5cDRwcG5rQlRGenNpRVB3WFJuanI5cjBpUkI0VXZtUFFNM2R0dklwRk84SGJnbGk4aWZUdXNvN2IwX3kyWVpPUEJpYm9semxqRjByTW5Ea2dfbzZnbjk1dXBDV19kaXdXa0RGTEpRZUY2NzEzYTJabVlpVU53RlVMZ3V6NjlrX0JhQ3ZPczBtNFdGcnd6SExlZ080VjFlVEN3QTVfOG5yVVI4TEJpT1doV21EcXVNUThVZUk0WDFTRzFVSWhGai1LMGM4MGYxaUpfS2pOdjFYdTNkOVR5Ty1oVkdITDY5REVrSXd5WG9YTVZpRDFxdFJ1U0VHRmJIMkRYRDlxYVlDbDdNSEhnckhreU1nZDlBTTRnWGZ6YnFZUi1EZklQcEZoYWRBY2JiSFNIRzQ3REFIVUtaN1hiTElYa1FOQUJYbGtkTldNUzdJZ0F2VlROTlpSd0R4U2l5UWVLaFZCa1czWTlIcW9vZmNwZG55Z3IxNkZsd096bl8zYldQeXJjSjV0aUVmamZ1Zmt5SG8zYVh5azg1QXBHLUxXWkU3dTNVRFk4cHVYU3Y5aERHMEJqa2VBRDNxQ0NhZkxoSjhCN0pfV1pnclFSTTloWVl6T2pWM3JjbTBmeDVtU1BUR3ByblNpZU92WmgxeDZrQUxDUnVlSTVKZ3JyMGZyWmtkMUFYb2cyVHhocm1CVFE5R1pVTG1zQVFhMFN5ekVIU1l5RklYVnM9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFcwemVUbHZZVkIyTkVSR2JFb3lURFpxYURablRucFBWR2Q0WkRObWRIcGhVV1pMUzNjMmRsVkJURXR3ZFdSS05YWktTREI0VjJwWlQwcDJhRkU0ZDBweU5rMVpSRk0xVW10WlFsSnJhV3RYWTNKWlF5MHhMVWhMVWtwa1ltcE5TazV2TW1oVmFsSldia3hTTmtvd01ITnZiR3BGZGtKdWJGVlJTVEIxZDBwMGVGTjBTR2Q1Vm1keFRESlZlRTlPYm5kTWFHbHBjMlZ0YVVGVUxURnZVVGhLYWsxNFpEaFFaVU5CVVc5bVJUaFpTRkIzYzBwRVRVOTJUVVZNUkhoSlYxRnhkSHBCTkZoQ2IwRjBhMWhLWldRdFZESTJNRk00VkVkcVpUZE9NVWxsUzFwRlZIbDNZMUpYUkRSWFgxTlNPRk5qVUZOeVlrb3dZMWREZWxReGNuUnhhQT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzMzMDMsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiZWNiMmZjMDA2ZDI4MTFlZThkZGYwMjQyYWMxNzAwMDUiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIlI0bWxsRW1JdE0wM1ZXajlkdktuOGxnMSIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTczMzAzLCAiZXhwIjogMTY5NzU3MzYwMywgImF1ZCI6IFsiand0X3Rlc3QiXX0.Ogfmy4WcCReI2p5s9igrrtp3s1McyKss4TvWoL4nmU1x4kPC-BnuwMb8zQZcqiPCbIXt4UHE38LZHcu1MpxbFzj7_xidhtZaJe1Fjktq5NTviN4b9id53ua5KXTzP98ZvbpOH_wuQb6E-tvAAuDImA1MoeJ3d1IDEbjKo-JeK_3t91YaKh48fJbNvHEJeNQuorqeIqlv2ASZCoo13L9X4MstrVRmtvgVAFrTFTgriQRXIoC2D8Glt1paMNlFD3pag5vnFQDPhk3r-8uE20MMMLGZaK_AsW-aO7jdN4IQJkafqFPhiExj6HAvWJeT5vTNcnuUZgj35QTtjVzuRfcdQw"}
2023-10-17 22:08:23,243 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNzIyZGM5ZGYxYjMzNDRmZGE4ZDJmNDY0MWJhYTEyMTEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVzB6ZVRsdllWQjJORVJHYkVveVREWnFhRFpuVG5wUFZHZDRaRE5tZEhwaFVXWkxTM2MyZGxWQlRFdHdkV1JLTlhaS1NEQjRWMnBaVDBwMmFGRTRkMHB5TmsxWlJGTTFVbXRaUWxKcmFXdFhZM0paUXkweExVaExVa3BrWW1wTlNrNXZNbWhWYWxKV2JreFNOa293TUhOdmJHcEZka0p1YkZWUlNUQjFkMHAwZUZOMFNHZDVWbWR4VERKVmVFOU9ibmRNYUdscGMyVnRhVUZVTFRGdlVUaEthazE0WkRoUVpVTkJVVzltUlRoWlNGQjNjMHBFVFU5MlRVVk1SSGhKVjFGeGRIcEJORmhDYjBGMGExaEtaV1F0VkRJMk1GTTRWRWRxWlRkT01VbGxTMXBGVkhsM1kxSlhSRFJYWDFOU09GTmpVRk55WWtvd1kxZERlbFF4Y25SeGFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzMzMDMsICJleHAiOiAxNjk3NTc2OTAzfQ.2Vfa6jqCj_UyP7pvBZCO4jqxIZFIASJPxuvrio8eEDPPSfU-GIsO16m1NM6hPrhLOQ-yT_3nExAPBZI5ZG3uVw", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMdW0zdWVHQ0VJV3NDODQ0MmFMbnZjTjRjVGRyQzNVbzV3WlhHZ1NuV3cxRzhRdTJBdm5FcjJZSXFSZTZ3Z084aHFKZ0dWUVVPS0czdTRTVGEyVExXbjFDUXJVaGdZT0tRTUVTRllfcndaelRhZkE2SjZnZjd1eGJDWEFESVdocktFLTlPMjlqMGJKZFU5cDRwcG5rQlRGenNpRVB3WFJuanI5cjBpUkI0VXZtUFFNM2R0dklwRk84SGJnbGk4aWZUdXNvN2IwX3kyWVpPUEJpYm9semxqRjByTW5Ea2dfbzZnbjk1dXBDV19kaXdXa0RGTEpRZUY2NzEzYTJabVlpVU53RlVMZ3V6NjlrX0JhQ3ZPczBtNFdGcnd6SExlZ080VjFlVEN3QTVfOG5yVVI4TEJpT1doV21EcXVNUThVZUk0WDFTRzFVSWhGai1LMGM4MGYxaUpfS2pOdjFYdTNkOVR5Ty1oVkdITDY5REVrSXd5WG9YTVZpRDFxdFJ1U0VHRmJIMkRYRDlxYVlDbDdNSEhnckhreU1nZDlBTTRnWGZ6YnFZUi1EZklQcEZoYWRBY2JiSFNIRzQ3REFIVUtaN1hiTElYa1FOQUJYbGtkTldNUzdJZ0F2VlROTlpSd0R4U2l5UWVLaFZCa1czWTlIcW9vZmNwZG55Z3IxNkZsd096bl8zYldQeXJjSjV0aUVmamZ1Zmt5SG8zYVh5azg1QXBHLUxXWkU3dTNVRFk4cHVYU3Y5aERHMEJqa2VBRDNxQ0NhZkxoSjhCN0pfV1pnclFSTTloWVl6T2pWM3JjbTBmeDVtU1BUR3ByblNpZU92WmgxeDZrQUxDUnVlSTVKZ3JyMGZyWmtkMUFYb2cyVHhocm1CVFE5R1pVTG1zQVFhMFN5ekVIU1l5RklYVnM9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFcwemVUbHZZVkIyTkVSR2JFb3lURFpxYURablRucFBWR2Q0WkRObWRIcGhVV1pMUzNjMmRsVkJURXR3ZFdSS05YWktTREI0VjJwWlQwcDJhRkU0ZDBweU5rMVpSRk0xVW10WlFsSnJhV3RYWTNKWlF5MHhMVWhMVWtwa1ltcE5TazV2TW1oVmFsSldia3hTTmtvd01ITnZiR3BGZGtKdWJGVlJTVEIxZDBwMGVGTjBTR2Q1Vm1keFRESlZlRTlPYm5kTWFHbHBjMlZ0YVVGVUxURnZVVGhLYWsxNFpEaFFaVU5CVVc5bVJUaFpTRkIzYzBwRVRVOTJUVVZNUkhoSlYxRnhkSHBCTkZoQ2IwRjBhMWhLWldRdFZESTJNRk00VkVkcVpUZE9NVWxsUzFwRlZIbDNZMUpYUkRSWFgxTlNPRk5qVUZOeVlrb3dZMWREZWxReGNuUnhhQT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzMzMDMsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiZWNiMmZjMDA2ZDI4MTFlZThkZGYwMjQyYWMxNzAwMDUiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIlI0bWxsRW1JdE0wM1ZXajlkdktuOGxnMSIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTczMzAzLCAiZXhwIjogMTY5NzU3MzYwMywgImF1ZCI6IFsiand0X3Rlc3QiXX0.Ogfmy4WcCReI2p5s9igrrtp3s1McyKss4TvWoL4nmU1x4kPC-BnuwMb8zQZcqiPCbIXt4UHE38LZHcu1MpxbFzj7_xidhtZaJe1Fjktq5NTviN4b9id53ua5KXTzP98ZvbpOH_wuQb6E-tvAAuDImA1MoeJ3d1IDEbjKo-JeK_3t91YaKh48fJbNvHEJeNQuorqeIqlv2ASZCoo13L9X4MstrVRmtvgVAFrTFTgriQRXIoC2D8Glt1paMNlFD3pag5vnFQDPhk3r-8uE20MMMLGZaK_AsW-aO7jdN4IQJkafqFPhiExj6HAvWJeT5vTNcnuUZgj35QTtjVzuRfcdQw"}
2023-10-17 22:08:23,243 oidcrp.service DEBUG response format: json
2023-10-17 22:08:23,243 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 22:08:23,243 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNzIyZGM5ZGYxYjMzNDRmZGE4ZDJmNDY0MWJhYTEyMTEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVzB6ZVRsdllWQjJORVJHYkVveVREWnFhRFpuVG5wUFZHZDRaRE5tZEhwaFVXWkxTM2MyZGxWQlRFdHdkV1JLTlhaS1NEQjRWMnBaVDBwMmFGRTRkMHB5TmsxWlJGTTFVbXRaUWxKcmFXdFhZM0paUXkweExVaExVa3BrWW1wTlNrNXZNbWhWYWxKV2JreFNOa293TUhOdmJHcEZka0p1YkZWUlNUQjFkMHAwZUZOMFNHZDVWbWR4VERKVmVFOU9ibmRNYUdscGMyVnRhVUZVTFRGdlVUaEthazE0WkRoUVpVTkJVVzltUlRoWlNGQjNjMHBFVFU5MlRVVk1SSGhKVjFGeGRIcEJORmhDYjBGMGExaEtaV1F0VkRJMk1GTTRWRWRxWlRkT01VbGxTMXBGVkhsM1kxSlhSRFJYWDFOU09GTmpVRk55WWtvd1kxZERlbFF4Y25SeGFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzMzMDMsICJleHAiOiAxNjk3NTc2OTAzfQ.2Vfa6jqCj_UyP7pvBZCO4jqxIZFIASJPxuvrio8eEDPPSfU-GIsO16m1NM6hPrhLOQ-yT_3nExAPBZI5ZG3uVw', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxMdW0zdWVHQ0VJV3NDODQ0MmFMbnZjTjRjVGRyQzNVbzV3WlhHZ1NuV3cxRzhRdTJBdm5FcjJZSXFSZTZ3Z084aHFKZ0dWUVVPS0czdTRTVGEyVExXbjFDUXJVaGdZT0tRTUVTRllfcndaelRhZkE2SjZnZjd1eGJDWEFESVdocktFLTlPMjlqMGJKZFU5cDRwcG5rQlRGenNpRVB3WFJuanI5cjBpUkI0VXZtUFFNM2R0dklwRk84SGJnbGk4aWZUdXNvN2IwX3kyWVpPUEJpYm9semxqRjByTW5Ea2dfbzZnbjk1dXBDV19kaXdXa0RGTEpRZUY2NzEzYTJabVlpVU53RlVMZ3V6NjlrX0JhQ3ZPczBtNFdGcnd6SExlZ080VjFlVEN3QTVfOG5yVVI4TEJpT1doV21EcXVNUThVZUk0WDFTRzFVSWhGai1LMGM4MGYxaUpfS2pOdjFYdTNkOVR5Ty1oVkdITDY5REVrSXd5WG9YTVZpRDFxdFJ1U0VHRmJIMkRYRDlxYVlDbDdNSEhnckhreU1nZDlBTTRnWGZ6YnFZUi1EZklQcEZoYWRBY2JiSFNIRzQ3REFIVUtaN1hiTElYa1FOQUJYbGtkTldNUzdJZ0F2VlROTlpSd0R4U2l5UWVLaFZCa1czWTlIcW9vZmNwZG55Z3IxNkZsd096bl8zYldQeXJjSjV0aUVmamZ1Zmt5SG8zYVh5azg1QXBHLUxXWkU3dTNVRFk4cHVYU3Y5aERHMEJqa2VBRDNxQ0NhZkxoSjhCN0pfV1pnclFSTTloWVl6T2pWM3JjbTBmeDVtU1BUR3ByblNpZU92WmgxeDZrQUxDUnVlSTVKZ3JyMGZyWmtkMUFYb2cyVHhocm1CVFE5R1pVTG1zQVFhMFN5ekVIU1l5RklYVnM9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFcwemVUbHZZVkIyTkVSR2JFb3lURFpxYURablRucFBWR2Q0WkRObWRIcGhVV1pMUzNjMmRsVkJURXR3ZFdSS05YWktTREI0VjJwWlQwcDJhRkU0ZDBweU5rMVpSRk0xVW10WlFsSnJhV3RYWTNKWlF5MHhMVWhMVWtwa1ltcE5TazV2TW1oVmFsSldia3hTTmtvd01ITnZiR3BGZGtKdWJGVlJTVEIxZDBwMGVGTjBTR2Q1Vm1keFRESlZlRTlPYm5kTWFHbHBjMlZ0YVVGVUxURnZVVGhLYWsxNFpEaFFaVU5CVVc5bVJUaFpTRkIzYzBwRVRVOTJUVVZNUkhoSlYxRnhkSHBCTkZoQ2IwRjBhMWhLWldRdFZESTJNRk00VkVkcVpUZE9NVWxsUzFwRlZIbDNZMUpYUkRSWFgxTlNPRk5qVUZOeVlrb3dZMWREZWxReGNuUnhhQT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzMzMDMsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiZWNiMmZjMDA2ZDI4MTFlZThkZGYwMjQyYWMxNzAwMDUiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIlI0bWxsRW1JdE0wM1ZXajlkdktuOGxnMSIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTczMzAzLCAiZXhwIjogMTY5NzU3MzYwMywgImF1ZCI6IFsiand0X3Rlc3QiXX0.Ogfmy4WcCReI2p5s9igrrtp3s1McyKss4TvWoL4nmU1x4kPC-BnuwMb8zQZcqiPCbIXt4UHE38LZHcu1MpxbFzj7_xidhtZaJe1Fjktq5NTviN4b9id53ua5KXTzP98ZvbpOH_wuQb6E-tvAAuDImA1MoeJ3d1IDEbjKo-JeK_3t91YaKh48fJbNvHEJeNQuorqeIqlv2ASZCoo13L9X4MstrVRmtvgVAFrTFTgriQRXIoC2D8Glt1paMNlFD3pag5vnFQDPhk3r-8uE20MMMLGZaK_AsW-aO7jdN4IQJkafqFPhiExj6HAvWJeT5vTNcnuUZgj35QTtjVzuRfcdQw'}"
2023-10-17 22:08:23,243 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-17 22:08:23,244 oidcmsg.message DEBUG Raw JSON: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdW0zeTlvYVB2NERGbEoyTDZqaDZnTnpPVGd4ZDNmdHphUWZLS3c2dlVBTEtwdWRKNXZKSDB4V2pZT0p2aFE4d0pyNk1ZRFM1UmtZQlJraWtXY3JZQy0xLUhLUkpkYmpNSk5vMmhValJWbkxSNkowMHNvbGpFdkJubFVRSTB1d0p0eFN0SGd5VmdxTDJVeE9ObndMaGlpc2VtaUFULTFvUThKak14ZDhQZUNBUW9mRThZSFB3c0pETU92TUVMRHhJV1FxdHpBNFhCb0F0a1hKZWQtVDI2MFM4VEdqZTdOMUllS1pFVHl3Y1JXRDRXX1NSOFNjUFNyYkowY1dDelQxcnRxaA==', 'auth_time': 1697573303, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'ecb2fc006d2811ee8ddf0242ac170005', 'client_id': 'jwt_test', 'nonce': 'R4mllEmItM03VWj9dvKn8lg1', 'iss': 'https://satosa.idem.it', 'iat': 1697573303, 'exp': 1697573603, 'aud': ['jwt_test']}
2023-10-17 22:08:23,244 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA'}
2023-10-17 22:08:23,244 cryptojwt.key_jar DEBUG Key summary for https://satosa.idem.it: RSA:sig:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, EC:sig:LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw
2023-10-17 22:08:23,244 oidcmsg.message DEBUG Found signing key.
2023-10-17 22:08:23,244 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-17 22:08:23,244 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA and use=
2023-10-17 22:08:23,244 cryptojwt.jwx DEBUG Picked: kid:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, use:sig, kty:RSA
2023-10-17 22:08:23,244 cryptojwt.jws.jws DEBUG Verified message using key with kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA
2023-10-17 22:08:23,244 oidcmsg.oidc INFO Verified id_token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdW0zeTlvYVB2NERGbEoyTDZqaDZnTnpPVGd4ZDNmdHphUWZLS3c2dlVBTEtwdWRKNXZKSDB4V2pZT0p2aFE4d0pyNk1ZRFM1UmtZQlJraWtXY3JZQy0xLUhLUkpkYmpNSk5vMmhValJWbkxSNkowMHNvbGpFdkJubFVRSTB1d0p0eFN0SGd5VmdxTDJVeE9ObndMaGlpc2VtaUFULTFvUThKak14ZDhQZUNBUW9mRThZSFB3c0pETU92TUVMRHhJV1FxdHpBNFhCb0F0a1hKZWQtVDI2MFM4VEdqZTdOMUllS1pFVHl3Y1JXRDRXX1NSOFNjUFNyYkowY1dDelQxcnRxaA==', 'auth_time': 1697573303, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'ecb2fc006d2811ee8ddf0242ac170005', 'client_id': 'jwt_test', 'nonce': 'R4mllEmItM03VWj9dvKn8lg1', 'iss': 'https://satosa.idem.it', 'iat': 1697573303, 'exp': 1697573603, 'aud': ['jwt_test']}
2023-10-17 22:08:23,245 oidcrp.rp_handler DEBUG ID Token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdW0zeTlvYVB2NERGbEoyTDZqaDZnTnpPVGd4ZDNmdHphUWZLS3c2dlVBTEtwdWRKNXZKSDB4V2pZT0p2aFE4d0pyNk1ZRFM1UmtZQlJraWtXY3JZQy0xLUhLUkpkYmpNSk5vMmhValJWbkxSNkowMHNvbGpFdkJubFVRSTB1d0p0eFN0SGd5VmdxTDJVeE9ObndMaGlpc2VtaUFULTFvUThKak14ZDhQZUNBUW9mRThZSFB3c0pETU92TUVMRHhJV1FxdHpBNFhCb0F0a1hKZWQtVDI2MFM4VEdqZTdOMUllS1pFVHl3Y1JXRDRXX1NSOFNjUFNyYkowY1dDelQxcnRxaA==', 'auth_time': 1697573303, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': 'ecb2fc006d2811ee8ddf0242ac170005', 'client_id': 'jwt_test', 'nonce': 'R4mllEmItM03VWj9dvKn8lg1', 'iss': 'https://satosa.idem.it', 'iat': 1697573303, 'exp': 1697573603, 'aud': ['jwt_test']}
2023-10-17 22:08:23,245 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-17 22:08:23,245 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNzIyZGM5ZGYxYjMzNDRmZGE4ZDJmNDY0MWJhYTEyMTEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVzB6ZVRsdllWQjJORVJHYkVveVREWnFhRFpuVG5wUFZHZDRaRE5tZEhwaFVXWkxTM2MyZGxWQlRFdHdkV1JLTlhaS1NEQjRWMnBaVDBwMmFGRTRkMHB5TmsxWlJGTTFVbXRaUWxKcmFXdFhZM0paUXkweExVaExVa3BrWW1wTlNrNXZNbWhWYWxKV2JreFNOa293TUhOdmJHcEZka0p1YkZWUlNUQjFkMHAwZUZOMFNHZDVWbWR4VERKVmVFOU9ibmRNYUdscGMyVnRhVUZVTFRGdlVUaEthazE0WkRoUVpVTkJVVzltUlRoWlNGQjNjMHBFVFU5MlRVVk1SSGhKVjFGeGRIcEJORmhDYjBGMGExaEtaV1F0VkRJMk1GTTRWRWRxWlRkT01VbGxTMXBGVkhsM1kxSlhSRFJYWDFOU09GTmpVRk55WWtvd1kxZERlbFF4Y25SeGFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzMzMDMsICJleHAiOiAxNjk3NTc2OTAzfQ.2Vfa6jqCj_UyP7pvBZCO4jqxIZFIASJPxuvrio8eEDPPSfU-GIsO16m1NM6hPrhLOQ-yT_3nExAPBZI5ZG3uVw'}
2023-10-17 22:08:23,245 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-17 22:08:23,245 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f38345a28d0>, 'url': 'https://satosa.idem.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNzIyZGM5ZGYxYjMzNDRmZGE4ZDJmNDY0MWJhYTEyMTEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVzB6ZVRsdllWQjJORVJHYkVveVREWnFhRFpuVG5wUFZHZDRaRE5tZEhwaFVXWkxTM2MyZGxWQlRFdHdkV1JLTlhaS1NEQjRWMnBaVDBwMmFGRTRkMHB5TmsxWlJGTTFVbXRaUWxKcmFXdFhZM0paUXkweExVaExVa3BrWW1wTlNrNXZNbWhWYWxKV2JreFNOa293TUhOdmJHcEZka0p1YkZWUlNUQjFkMHAwZUZOMFNHZDVWbWR4VERKVmVFOU9ibmRNYUdscGMyVnRhVUZVTFRGdlVUaEthazE0WkRoUVpVTkJVVzltUlRoWlNGQjNjMHBFVFU5MlRVVk1SSGhKVjFGeGRIcEJORmhDYjBGMGExaEtaV1F0VkRJMk1GTTRWRWRxWlRkT01VbGxTMXBGVkhsM1kxSlhSRFJYWDFOU09GTmpVRk55WWtvd1kxZERlbFF4Y25SeGFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzMzMDMsICJleHAiOiAxNjk3NTc2OTAzfQ.2Vfa6jqCj_UyP7pvBZCO4jqxIZFIASJPxuvrio8eEDPPSfU-GIsO16m1NM6hPrhLOQ-yT_3nExAPBZI5ZG3uVw'}}
2023-10-17 22:08:23,246 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNzIyZGM5ZGYxYjMzNDRmZGE4ZDJmNDY0MWJhYTEyMTEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVzB6ZVRsdllWQjJORVJHYkVveVREWnFhRFpuVG5wUFZHZDRaRE5tZEhwaFVXWkxTM2MyZGxWQlRFdHdkV1JLTlhaS1NEQjRWMnBaVDBwMmFGRTRkMHB5TmsxWlJGTTFVbXRaUWxKcmFXdFhZM0paUXkweExVaExVa3BrWW1wTlNrNXZNbWhWYWxKV2JreFNOa293TUhOdmJHcEZka0p1YkZWUlNUQjFkMHAwZUZOMFNHZDVWbWR4VERKVmVFOU9ibmRNYUdscGMyVnRhVUZVTFRGdlVUaEthazE0WkRoUVpVTkJVVzltUlRoWlNGQjNjMHBFVFU5MlRVVk1SSGhKVjFGeGRIcEJORmhDYjBGMGExaEtaV1F0VkRJMk1GTTRWRWRxWlRkT01VbGxTMXBGVkhsM1kxSlhSRFJYWDFOU09GTmpVRk55WWtvd1kxZERlbFF4Y25SeGFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzMzMDMsICJleHAiOiAxNjk3NTc2OTAzfQ.2Vfa6jqCj_UyP7pvBZCO4jqxIZFIASJPxuvrio8eEDPPSfU-GIsO16m1NM6hPrhLOQ-yT_3nExAPBZI5ZG3uVw'}
2023-10-17 22:08:23,246 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:08:23,393 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-17 22:08:23,393 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:08:23,393 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:08:23,393 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:08:23 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADsMRedjvn6XZehz71kw5NoCCAplITBqEdPvTUBRanTogX5RRdo6twIcQyuYIHgRF7ADEDLy8EantQYbBWH_Ru-pwDWCKGBa0jRKzTPILcriTV28GQShIkduklFrdQOQ0EDwxou53bcH002G-3e9WqBco_AVwrAhtGJDCFJB1IQXCdgGOfjeosNeo2xutCnhLJwQjT0Jw_Vc5TGBMH6xJ8lKa8y8pSbqLUs2aBl89MFCv447rf_o3JgAAAAAAEM6XCtt8mM2AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADsMRedjvn6XZehz71kw5NoCCAplITBqEdPvTUBRanTogX5RRdo6twIcQyuYIHgRF7ADEDLy8EantQYbBWH_Ru-pwDWCKGBa0jRKzTPILcriTV28GQShIkduklFrdQOQ0EDwxou53bcH002G-3e9WqBco_AVwrAhtGJDCFJB1IQXCdgGOfjeosNeo2xutCnhLJwQjT0Jw_Vc5TGBMH6xJ8lKa8y8pSbqLUs2aBl89MFCv447rf_o3JgAAAAAAEM6XCtt8mM2AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:08:23,393 oidcrp.util DEBUG resp.txt: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-17 22:08:23,393 oidcrp.oauth2 DEBUG Successful response: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-17 22:08:23,393 oidcrp.service DEBUG response format: json
2023-10-17 22:08:23,393 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-17 22:08:23,393 oidcrp.service DEBUG Initial response parsing => "{'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}"
2023-10-17 22:08:23,394 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-17 22:08:23,394 oidcrp.rp_handler DEBUG UserInfo: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}
2023-10-17 22:08:23,395 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:08:23] "GET /authz_cb/satosa?state=S6BS19bueFDvlQay0snZKnc33S3hLvgC&scope=openid+offline_access+profile&code=Z0FBQUFBQmxMdW0zMENJOVQ1RWdSU2dBTUlWMDk5bTNQU2dIVGVBRi1WZ2czTGFrYWhsWThRVUhuTmpNY2YzUVdNR1J0R25IcXV4Ql92WVFtck9kbDR1TUlsQkJVSEtVVmZjTzIxaEFXSm5GVkZKc0NaRGhZOVVZRTFBaTBGZ1BxOGhsNmNBU0x4Rm5LdGNXb1RTX3BrX1pKcjhtQVJzUmRrcklVUXRva3FqLWFrWFIwc3BKVEJpZDhkb1ZUNTNKbHZqM0RydXdEN2Z1ak5lQVpzdzM1cVMteHpYQllpbFZxSnA5Q2g0dFBZanJzNEY1UjhaZk1RYlJKS2JkTUVxRE5JeEhMQnMxMUxmMDNRODhIcFI4OEJtNHNwMkQ2b2lWNUo2WDJWZTFuR1JBUUdNbE1CNDlsbmhOM0R3Sy1fbFBNR2EzdnQxd3ZmRDF5WVMwTjZYdjQ1R1FmNmNXckxVV2ViOWF2M05FWmhIMjFSSEtFeW50eWJyVkY0MC1vYTBEcjVqMnQ1N1BzcXZUd2J1OFA1MERIcVVDM3k3ZzdUOFpkcHFBc3dlUnk2ZDNRVEdkU1V4UWQyTzVSU0otME05Q09UMVFHNkxhNTdEdHBDWlNDM1ZGNklnY241Qk8wMkdYcGUwUGNaNTNPZlFlSEFKWUNrTW5ONWVwOWh0Q2Y3bnJRZTJJRF9JTXZUX1VHVDNWdG1XejFMQXd1QUhnRjRYRWNLTHpPU3dVUkh0WTJtM0xkMjM1WVpOaEJEOTNxZ2FwWWN1NDBxMDViaVh1M19pVXdVVldrQVFaeVdYZVRKOVVEcWpPeEVtem1KMXJhZjV3cjNiWVdnMXpYZ0sxT05jdXRzSVBmaV90SjhpUXMtOXpzdTJJaXBpeW5jb0RlMlJ5a3Rqb3VqTGxoWVI3WEdtUHBMbzIwU0U9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1" 200 -
2023-10-17 22:17:27,837 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 22:17:27,838 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 22:17:27,838 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 22:17:27,838 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 22:17:27,873 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 22:17:27,873 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 22:17:27,873 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 22:17:27,873 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 22:17:27,873 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:17:27,897 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 22:17:27,897 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:17:27,897 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:17:27,897 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:17:27 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdACcVyvsliUbqR2luId4OaD2zD3kNAd_4lakL9mwyi_k46RBFSM7-cDIQhY0AG9rL5XAJYooriNhQqomhulDIF7a-i_GdlkptQ5e1t-2NCBAoVz-oAvaxinXe-8_K68A9R0vdBAfh3Pnh_OK0WJsL6Aa5-4FzDdTYYBcCF50PWa1xWw7Dule8cjuFWBz9idgRKzFtWa6Y3hNNMaOwuFGSU49nflhSDKXqb1gfpIsQtGz1TdFNyWyfhqPOkAAAADU9KT3unfgkAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdACcVyvsliUbqR2luId4OaD2zD3kNAd_4lakL9mwyi_k46RBFSM7-cDIQhY0AG9rL5XAJYooriNhQqomhulDIF7a-i_GdlkptQ5e1t-2NCBAoVz-oAvaxinXe-8_K68A9R0vdBAfh3Pnh_OK0WJsL6Aa5-4FzDdTYYBcCF50PWa1xWw7Dule8cjuFWBz9idgRKzFtWa6Y3hNNMaOwuFGSU49nflhSDKXqb1gfpIsQtGz1TdFNyWyfhqPOkAAAADU9KT3unfgkAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:17:27,897 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 22:17:27,897 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 22:17:27,897 oidcrp.service DEBUG response format: json
2023-10-17 22:17:27,897 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 22:17:27,897 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 22:17:27,897 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 22:17:27,898 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 22:17:27,898 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 22:17:27,898 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:17:27,898 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:17:27,899 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:17:27,917 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 22:17:27,917 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "e": "AQAB", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:17:27,917 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "e": "AQAB", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:17:27,918 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-17 22:17:27,918 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 22:17:27,918 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 22:17:27,918 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 22:17:27,918 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': '0Pun5lXtEj5YdjfluHl7ISjH', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'ixCs7LTz24AjSbWWmiIT0lfX18VvEq1B'}
2023-10-17 22:17:27,918 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': '0Pun5lXtEj5YdjfluHl7ISjH', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'ixCs7LTz24AjSbWWmiIT0lfX18VvEq1B', 'code_challenge': 'N-cCniJ1ZtdoG2wFwSskuawYfyhkxAPlFjlf4zbceFE', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 22:17:27,919 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f38345e7e50>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=0Pun5lXtEj5YdjfluHl7ISjH&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=ixCs7LTz24AjSbWWmiIT0lfX18VvEq1B&code_challenge=N-cCniJ1ZtdoG2wFwSskuawYfyhkxAPlFjlf4zbceFE&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 22:17:27,919 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:17:27] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 22:17:37,493 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 22:17:37,494 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 22:17:37,494 oidcrp.service DEBUG response format: dict
2023-10-17 22:17:37,494 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 22:17:37,494 oidcrp.service DEBUG Initial response parsing => "{'state': 'ixCs7LTz24AjSbWWmiIT0lfX18VvEq1B', 'scope': 'offline_access profile openid', 'code': 'Z0FBQUFBQmxMdXZoOVoyTm9VLVNzMTlqemkyYzFKUEYyRFUyODhGWm5ON3JFbXBHRVNXVzNNVTRVNGRUUFNSajFqdkRXYUFpMnlKQVp5Y0lCa2FpTG4xZnVnWGxNU1d2X2VydGM0Uk5jWkdja2w2S0Q5OGR6MVRDTDgweHdQWGx2LTdQZ040V1VmZVNYUTZINFhMYllfWkNndmR5dllHR2pjQlpoYUJjWXRpbFNZQmdBamhvRC1uQl9sQUJrV1J4NXNSZzRtN3FmMjNobVNyYy1aU3R3cVdwSUdCdGc2QTBCUmJob3ByWTlrTnlINWFQbW1ONS10VWRpaVo0d2lEMHBvZi1mdU1kQ3NTOVVtRDE2UWVYUVczaTRlZlB2Si1UVDc5UmpUc043clMzM3pmTVNPdEpmRTlfWHhnbS0tdTcxQkN3RFoxcWtJamM2SklpMlhkU3F2Nms2Y0V3aXJGcTQyeXdDSVdfX05SdzYxdEFIYnY1OUtPajRldVVmS1B5dV9hUU5mR2xVdnJHakwwOUlRTTdQbkxYb1J2RUV3ajRkTWFsamVZTmU4SlNQOWVyY0xtSHhRSzJIcFE2b3prdm9fa3cybXpNalZ5cHZOcExtbnBDYkxSMUtnbURWeW02cGhqbDlZY01Gc3kwMms0dWdxMGZHR3E5YmJHX3FYaU5zMS0yeDNKWS1rS1RXX3cxbzY1VU03OS1wZ251Vk50OXZzc09aem5DRy1DTUxOTE1MRGNxZk5RNjJKejFtY0FNZHlGUHQzbWZkRnZwbjc1ZFM2eS1IMVZOdE92SUdGekl4Qm5fU3RzdGoxTUQ1dzFTU1JJSHdSaE16OUlEdHN6YXQ1clZLMTExVFJES1oyOEl5Qk8zXzc0TFd3bXJmUnB2X2JkcE5xVVNzRUhaeFFMTkFSQUtuQjA9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 22:17:37,494 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 22:17:37,494 oidcrp.rp_handler DEBUG Authz response: {'state': 'ixCs7LTz24AjSbWWmiIT0lfX18VvEq1B', 'scope': 'offline_access profile openid', 'code': 'Z0FBQUFBQmxMdXZoOVoyTm9VLVNzMTlqemkyYzFKUEYyRFUyODhGWm5ON3JFbXBHRVNXVzNNVTRVNGRUUFNSajFqdkRXYUFpMnlKQVp5Y0lCa2FpTG4xZnVnWGxNU1d2X2VydGM0Uk5jWkdja2w2S0Q5OGR6MVRDTDgweHdQWGx2LTdQZ040V1VmZVNYUTZINFhMYllfWkNndmR5dllHR2pjQlpoYUJjWXRpbFNZQmdBamhvRC1uQl9sQUJrV1J4NXNSZzRtN3FmMjNobVNyYy1aU3R3cVdwSUdCdGc2QTBCUmJob3ByWTlrTnlINWFQbW1ONS10VWRpaVo0d2lEMHBvZi1mdU1kQ3NTOVVtRDE2UWVYUVczaTRlZlB2Si1UVDc5UmpUc043clMzM3pmTVNPdEpmRTlfWHhnbS0tdTcxQkN3RFoxcWtJamM2SklpMlhkU3F2Nms2Y0V3aXJGcTQyeXdDSVdfX05SdzYxdEFIYnY1OUtPajRldVVmS1B5dV9hUU5mR2xVdnJHakwwOUlRTTdQbkxYb1J2RUV3ajRkTWFsamVZTmU4SlNQOWVyY0xtSHhRSzJIcFE2b3prdm9fa3cybXpNalZ5cHZOcExtbnBDYkxSMUtnbURWeW02cGhqbDlZY01Gc3kwMms0dWdxMGZHR3E5YmJHX3FYaU5zMS0yeDNKWS1rS1RXX3cxbzY1VU03OS1wZ251Vk50OXZzc09aem5DRy1DTUxOTE1MRGNxZk5RNjJKejFtY0FNZHlGUHQzbWZkRnZwbjc1ZFM2eS1IMVZOdE92SUdGekl4Qm5fU3RzdGoxTUQ1dzFTU1JJSHdSaE16OUlEdHN6YXQ1clZLMTExVFJES1oyOEl5Qk8zXzc0TFd3bXJmUnB2X2JkcE5xVVNzRUhaeFFMTkFSQUtuQjA9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 22:17:37,494 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 22:17:37,494 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 22:17:37,494 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMdXZoOVoyTm9VLVNzMTlqemkyYzFKUEYyRFUyODhGWm5ON3JFbXBHRVNXVzNNVTRVNGRUUFNSajFqdkRXYUFpMnlKQVp5Y0lCa2FpTG4xZnVnWGxNU1d2X2VydGM0Uk5jWkdja2w2S0Q5OGR6MVRDTDgweHdQWGx2LTdQZ040V1VmZVNYUTZINFhMYllfWkNndmR5dllHR2pjQlpoYUJjWXRpbFNZQmdBamhvRC1uQl9sQUJrV1J4NXNSZzRtN3FmMjNobVNyYy1aU3R3cVdwSUdCdGc2QTBCUmJob3ByWTlrTnlINWFQbW1ONS10VWRpaVo0d2lEMHBvZi1mdU1kQ3NTOVVtRDE2UWVYUVczaTRlZlB2Si1UVDc5UmpUc043clMzM3pmTVNPdEpmRTlfWHhnbS0tdTcxQkN3RFoxcWtJamM2SklpMlhkU3F2Nms2Y0V3aXJGcTQyeXdDSVdfX05SdzYxdEFIYnY1OUtPajRldVVmS1B5dV9hUU5mR2xVdnJHakwwOUlRTTdQbkxYb1J2RUV3ajRkTWFsamVZTmU4SlNQOWVyY0xtSHhRSzJIcFE2b3prdm9fa3cybXpNalZ5cHZOcExtbnBDYkxSMUtnbURWeW02cGhqbDlZY01Gc3kwMms0dWdxMGZHR3E5YmJHX3FYaU5zMS0yeDNKWS1rS1RXX3cxbzY1VU03OS1wZ251Vk50OXZzc09aem5DRy1DTUxOTE1MRGNxZk5RNjJKejFtY0FNZHlGUHQzbWZkRnZwbjc1ZFM2eS1IMVZOdE92SUdGekl4Qm5fU3RzdGoxTUQ1dzFTU1JJSHdSaE16OUlEdHN6YXQ1clZLMTExVFJES1oyOEl5Qk8zXzc0TFd3bXJmUnB2X2JkcE5xVVNzRUhaeFFMTkFSQUtuQjA9', 'state': 'ixCs7LTz24AjSbWWmiIT0lfX18VvEq1B', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-17 22:17:37,495 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'ixCs7LTz24AjSbWWmiIT0lfX18VvEq1B', 'code': 'Z0FBQUFBQmxMdXZoOVoyTm9VLVNzMTlqemkyYzFKUEYyRFUyODhGWm5ON3JFbXBHRVNXVzNNVTRVNGRUUFNSajFqdkRXYUFpMnlKQVp5Y0lCa2FpTG4xZnVnWGxNU1d2X2VydGM0Uk5jWkdja2w2S0Q5OGR6MVRDTDgweHdQWGx2LTdQZ040V1VmZVNYUTZINFhMYllfWkNndmR5dllHR2pjQlpoYUJjWXRpbFNZQmdBamhvRC1uQl9sQUJrV1J4NXNSZzRtN3FmMjNobVNyYy1aU3R3cVdwSUdCdGc2QTBCUmJob3ByWTlrTnlINWFQbW1ONS10VWRpaVo0d2lEMHBvZi1mdU1kQ3NTOVVtRDE2UWVYUVczaTRlZlB2Si1UVDc5UmpUc043clMzM3pmTVNPdEpmRTlfWHhnbS0tdTcxQkN3RFoxcWtJamM2SklpMlhkU3F2Nms2Y0V3aXJGcTQyeXdDSVdfX05SdzYxdEFIYnY1OUtPajRldVVmS1B5dV9hUU5mR2xVdnJHakwwOUlRTTdQbkxYb1J2RUV3ajRkTWFsamVZTmU4SlNQOWVyY0xtSHhRSzJIcFE2b3prdm9fa3cybXpNalZ5cHZOcExtbnBDYkxSMUtnbURWeW02cGhqbDlZY01Gc3kwMms0dWdxMGZHR3E5YmJHX3FYaU5zMS0yeDNKWS1rS1RXX3cxbzY1VU03OS1wZ251Vk50OXZzc09aem5DRy1DTUxOTE1MRGNxZk5RNjJKejFtY0FNZHlGUHQzbWZkRnZwbjc1ZFM2eS1IMVZOdE92SUdGekl4Qm5fU3RzdGoxTUQ1dzFTU1JJSHdSaE16OUlEdHN6YXQ1clZLMTExVFJES1oyOEl5Qk8zXzc0TFd3bXJmUnB2X2JkcE5xVVNzRUhaeFFMTkFSQUtuQjA9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'zjBPWPCu9y2PbTkcogvDSuaHeh3NBEZ1pb7mCouyXAFSILfZeGoiioi7Ms9uk73i'}
2023-10-17 22:17:37,495 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 22:17:37,495 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f38345f9450>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=ixCs7LTz24AjSbWWmiIT0lfX18VvEq1B&code=Z0FBQUFBQmxMdXZoOVoyTm9VLVNzMTlqemkyYzFKUEYyRFUyODhGWm5ON3JFbXBHRVNXVzNNVTRVNGRUUFNSajFqdkRXYUFpMnlKQVp5Y0lCa2FpTG4xZnVnWGxNU1d2X2VydGM0Uk5jWkdja2w2S0Q5OGR6MVRDTDgweHdQWGx2LTdQZ040V1VmZVNYUTZINFhMYllfWkNndmR5dllHR2pjQlpoYUJjWXRpbFNZQmdBamhvRC1uQl9sQUJrV1J4NXNSZzRtN3FmMjNobVNyYy1aU3R3cVdwSUdCdGc2QTBCUmJob3ByWTlrTnlINWFQbW1ONS10VWRpaVo0d2lEMHBvZi1mdU1kQ3NTOVVtRDE2UWVYUVczaTRlZlB2Si1UVDc5UmpUc043clMzM3pmTVNPdEpmRTlfWHhnbS0tdTcxQkN3RFoxcWtJamM2SklpMlhkU3F2Nms2Y0V3aXJGcTQyeXdDSVdfX05SdzYxdEFIYnY1OUtPajRldVVmS1B5dV9hUU5mR2xVdnJHakwwOUlRTTdQbkxYb1J2RUV3ajRkTWFsamVZTmU4SlNQOWVyY0xtSHhRSzJIcFE2b3prdm9fa3cybXpNalZ5cHZOcExtbnBDYkxSMUtnbURWeW02cGhqbDlZY01Gc3kwMms0dWdxMGZHR3E5YmJHX3FYaU5zMS0yeDNKWS1rS1RXX3cxbzY1VU03OS1wZ251Vk50OXZzc09aem5DRy1DTUxOTE1MRGNxZk5RNjJKejFtY0FNZHlGUHQzbWZkRnZwbjc1ZFM2eS1IMVZOdE92SUdGekl4Qm5fU3RzdGoxTUQ1dzFTU1JJSHdSaE16OUlEdHN6YXQ1clZLMTExVFJES1oyOEl5Qk8zXzc0TFd3bXJmUnB2X2JkcE5xVVNzRUhaeFFMTkFSQUtuQjA9&code_verifier=zjBPWPCu9y2PbTkcogvDSuaHeh3NBEZ1pb7mCouyXAFSILfZeGoiioi7Ms9uk73i', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 22:17:37,495 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=ixCs7LTz24AjSbWWmiIT0lfX18VvEq1B&code=Z0FBQUFBQmxMdXZoOVoyTm9VLVNzMTlqemkyYzFKUEYyRFUyODhGWm5ON3JFbXBHRVNXVzNNVTRVNGRUUFNSajFqdkRXYUFpMnlKQVp5Y0lCa2FpTG4xZnVnWGxNU1d2X2VydGM0Uk5jWkdja2w2S0Q5OGR6MVRDTDgweHdQWGx2LTdQZ040V1VmZVNYUTZINFhMYllfWkNndmR5dllHR2pjQlpoYUJjWXRpbFNZQmdBamhvRC1uQl9sQUJrV1J4NXNSZzRtN3FmMjNobVNyYy1aU3R3cVdwSUdCdGc2QTBCUmJob3ByWTlrTnlINWFQbW1ONS10VWRpaVo0d2lEMHBvZi1mdU1kQ3NTOVVtRDE2UWVYUVczaTRlZlB2Si1UVDc5UmpUc043clMzM3pmTVNPdEpmRTlfWHhnbS0tdTcxQkN3RFoxcWtJamM2SklpMlhkU3F2Nms2Y0V3aXJGcTQyeXdDSVdfX05SdzYxdEFIYnY1OUtPajRldVVmS1B5dV9hUU5mR2xVdnJHakwwOUlRTTdQbkxYb1J2RUV3ajRkTWFsamVZTmU4SlNQOWVyY0xtSHhRSzJIcFE2b3prdm9fa3cybXpNalZ5cHZOcExtbnBDYkxSMUtnbURWeW02cGhqbDlZY01Gc3kwMms0dWdxMGZHR3E5YmJHX3FYaU5zMS0yeDNKWS1rS1RXX3cxbzY1VU03OS1wZ251Vk50OXZzc09aem5DRy1DTUxOTE1MRGNxZk5RNjJKejFtY0FNZHlGUHQzbWZkRnZwbjc1ZFM2eS1IMVZOdE92SUdGekl4Qm5fU3RzdGoxTUQ1dzFTU1JJSHdSaE16OUlEdHN6YXQ1clZLMTExVFJES1oyOEl5Qk8zXzc0TFd3bXJmUnB2X2JkcE5xVVNzRUhaeFFMTkFSQUtuQjA9&code_verifier=zjBPWPCu9y2PbTkcogvDSuaHeh3NBEZ1pb7mCouyXAFSILfZeGoiioi7Ms9uk73i, https_args:{'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 22:17:37,495 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:17:37,641 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-17 22:17:37,641 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:17:37,642 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:17:37,642 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:17:37 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldABaTiQMCwOe8awxunSXjm2_-rRIhlcasp8BeDmmn74PmpG7qRcIlsHneCmodYb1j_bAO5bq5gOp9zfjXtLIXM_pAdVrXkEk6AaJPyItUI7hxLSnJr8QootGnvzTekzs3bIh_pwwChPVPMnUVY5M1ei-0nSQQtgURQ4_TgI5kY8_DzEz69D_lQD-QUtXk2xMDU-QuJml7XGI6m1I4a_aR2eHWALRZe0jRmCjQmOJADcOaFRFLKk-Zy7qgAAAAAEApollOpe4-AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldABaTiQMCwOe8awxunSXjm2_-rRIhlcasp8BeDmmn74PmpG7qRcIlsHneCmodYb1j_bAO5bq5gOp9zfjXtLIXM_pAdVrXkEk6AaJPyItUI7hxLSnJr8QootGnvzTekzs3bIh_pwwChPVPMnUVY5M1ei-0nSQQtgURQ4_TgI5kY8_DzEz69D_lQD-QUtXk2xMDU-QuJml7XGI6m1I4a_aR2eHWALRZe0jRmCjQmOJADcOaFRFLKk-Zy7qgAAAAAEApollOpe4-AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:17:37,642 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiYzAyMzhhNmI2ZTg3NDU3Y2EyMjE5YTcyMmU1ZGJhN2YiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWFpvVEhFeFRIUjNjVlJyZHpkSWR6bDBTRE54TFZCeWNqQjNPR2hhY1hJelUzRlplbGczZFdnM2JFVkJjelpaVG1aMU1IcFJWME00Wmw5eWIxTXpVa0ZzZW01WFJtOWpWMlYxVm1sQmIySnBUVWhpUVhWSGJuaHFOR1F6YmpscFNrVm5hMVpaUldoRlQwWnlRMVpKYjFack9GSmZlRFJWZEZCR1JuQnFWbXhNTVcxTk16RndVMjkzWlZoS05rbHdiVVJWYTNoNU5HMVpjRXBHWlV4a05VdGhiMjluU0VST1kyUXhYM3BNY0Rod1UydGFNRXd3WDJWNlpWOVBURkpuV1ZsdGIzTm9jRkF6TkZBNVlubG5TR1ozUzJWeGFtVjZRM052YUhWeFJWWTVUVlJhVEUxUFNWQjBPVEJQVGtKQ1ptcFlRV1Z2UkdkUVVIQkNOMUUzYmxkblZnPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM4NTcsICJleHAiOiAxNjk3NTc3NDU3fQ.9E_Tc4ewRNRr1bDLdBwV6XRV7-9kxxj9T8Ma1SuxMMwPIa9Nnohu64zO-YLjk-CLVTJJz8qxb6vWCfctu8qqrg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMdXZoQ3loVi1ZWXdGMUI1cE5QUnFTTVQtTUIxNGpKNldBc19sQk10QzJGb2drYzVpN09HR09uN0NCN2hkRWxLeEEwd1p1akZPYmQ1V2ZjWTIyZ2dJMmNJUUsyZm5KY3Z6SGtRODhNcE1MUDMwOWF5S0lBWllTYU5ENVgxUVl5LTZXMUhNczB5TjFra3ZyR0lzVzIydVl2UmhwRkN3Y0FoVUU2RzhyQmVuTG1VRllZVmJ5VExQU0liVms5Tmo2R25TRllZV01iTkhYUG40OEdJSEJIbHNsU3Q2dkxES1FKb0RFaGpfU1NZcFJZMUVGNWF2LXg3QXZzM3dVT1NEUFNzaDB0N0pvLThTU3JjNWNaVEQtc0ZOcmx5eXk5RjlidkpxTElOQ2k5aDJ6YXd2S09DLXFTOVF4OWN6cDhzMDF4MjdQSENKVi00Q3RBTUVFcWVHQ1F0NWhfVnJ1NERIMG1pWXVxcV9RdThwYldDNjVEUE10cGpjRF9BMWM1MHI1TDBIZkxaU25nbzlZaVVYVFdTOWVPdmZmVnNLUXlNNnYzSW5fTnVoSkttRFQxSzJpRVNrWjJHQTVZaEIxem5BVVlYd0lnbVBxLVc0UDFzU2MyM0RaN3FaS2FkLUQzZXZvSk5RQ0RaVmNkMC15cWdUclowbmlBZ2ZFbWZSVFlZR0Q2dmRZOUhZTndscU05dFlzSm1KbzZkMUxOQnRiMDQtSDhibWNDZnJvOXAteVF2QzZNa0ROclJoZ0RuNENkMzh1Z0l0TDBlODFGdEhqZHo5QlVyNkJzT1Vjb0Q4R0wyel9ScWlrQXdTcDVsLTlQUTA3a0c0ODBkQUJlWG82MGpIajhSNTloM0xLTWJoNGhhMVNBZ3FDRWs0NWxlQVZzZGg5VUwyNE4zTWgxZnVkRGhFQWc9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFhab1RIRXhUSFIzY1ZScmR6ZElkemwwU0ROeExWQnljakIzT0doYWNYSXpVM0ZaZWxnM2RXZzNiRVZCY3paWlRtWjFNSHBSVjBNNFpsOXliMU16VWtGc2VtNVhSbTlqVjJWMVZtbEJiMkpwVFVoaVFYVkhibmhxTkdRemJqbHBTa1ZuYTFaWlJXaEZUMFp5UTFaSmIxWnJPRkpmZURSVmRGQkdSbkJxVm14TU1XMU5NekZ3VTI5M1pWaEtOa2x3YlVSVmEzaDVORzFaY0VwR1pVeGtOVXRoYjI5blNFUk9ZMlF4WDNwTWNEaHdVMnRhTUV3d1gyVjZaVjlQVEZKbldWbHRiM05vY0ZBek5GQTVZbmxuU0daM1MyVnhhbVY2UTNOdmFIVnhSVlk1VFZSYVRFMVBTVkIwT1RCUFRrSkNabXBZUVdWdlJHZFFVSEJDTjFFM2JsZG5WZz09IiwgImF1dGhfdGltZSI6IDE2OTc1NzM4NTcsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiMzcyNTdjODI2ZDJhMTFlZTkwZGUwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIjBQdW41bFh0RWo1WWRqZmx1SGw3SVNqSCIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTczODU3LCAiZXhwIjogMTY5NzU3NDE1NywgImF1ZCI6IFsiand0X3Rlc3QiXX0.ZFRyN5OhasO809YC00-hM9cqYLl14qLlQDgw5I4XRXTIh9PFFNKlYmLyAlNR2gY1e1AZSgYCIYuo0dsIeEzt_lmbam7cMwDnxWiQWF-RhILSojhYJgCTFhbZ76nJdp2QCoIIoy1-wX8V5dpEOQi9z3CwtKFAZfeMC7jtw93oikwcx8GxAwlI2-E5Cpk6CB4RvjrJjgp3J1COCNZSrv4aKnbwbWJ_qK8iPfY3TTlbrp7SmlG4ByRWfKmgesSZ9z7cFkhRlgBRQPnt51sYyVWrSw0ZzsT7msGjThC-6qg1KtmLh2zlQXT9qTsq30ngMIt9yhUo0dLQDCt5NYAUmiFyRg"}
2023-10-17 22:17:37,642 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiYzAyMzhhNmI2ZTg3NDU3Y2EyMjE5YTcyMmU1ZGJhN2YiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWFpvVEhFeFRIUjNjVlJyZHpkSWR6bDBTRE54TFZCeWNqQjNPR2hhY1hJelUzRlplbGczZFdnM2JFVkJjelpaVG1aMU1IcFJWME00Wmw5eWIxTXpVa0ZzZW01WFJtOWpWMlYxVm1sQmIySnBUVWhpUVhWSGJuaHFOR1F6YmpscFNrVm5hMVpaUldoRlQwWnlRMVpKYjFack9GSmZlRFJWZEZCR1JuQnFWbXhNTVcxTk16RndVMjkzWlZoS05rbHdiVVJWYTNoNU5HMVpjRXBHWlV4a05VdGhiMjluU0VST1kyUXhYM3BNY0Rod1UydGFNRXd3WDJWNlpWOVBURkpuV1ZsdGIzTm9jRkF6TkZBNVlubG5TR1ozUzJWeGFtVjZRM052YUhWeFJWWTVUVlJhVEUxUFNWQjBPVEJQVGtKQ1ptcFlRV1Z2UkdkUVVIQkNOMUUzYmxkblZnPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM4NTcsICJleHAiOiAxNjk3NTc3NDU3fQ.9E_Tc4ewRNRr1bDLdBwV6XRV7-9kxxj9T8Ma1SuxMMwPIa9Nnohu64zO-YLjk-CLVTJJz8qxb6vWCfctu8qqrg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMdXZoQ3loVi1ZWXdGMUI1cE5QUnFTTVQtTUIxNGpKNldBc19sQk10QzJGb2drYzVpN09HR09uN0NCN2hkRWxLeEEwd1p1akZPYmQ1V2ZjWTIyZ2dJMmNJUUsyZm5KY3Z6SGtRODhNcE1MUDMwOWF5S0lBWllTYU5ENVgxUVl5LTZXMUhNczB5TjFra3ZyR0lzVzIydVl2UmhwRkN3Y0FoVUU2RzhyQmVuTG1VRllZVmJ5VExQU0liVms5Tmo2R25TRllZV01iTkhYUG40OEdJSEJIbHNsU3Q2dkxES1FKb0RFaGpfU1NZcFJZMUVGNWF2LXg3QXZzM3dVT1NEUFNzaDB0N0pvLThTU3JjNWNaVEQtc0ZOcmx5eXk5RjlidkpxTElOQ2k5aDJ6YXd2S09DLXFTOVF4OWN6cDhzMDF4MjdQSENKVi00Q3RBTUVFcWVHQ1F0NWhfVnJ1NERIMG1pWXVxcV9RdThwYldDNjVEUE10cGpjRF9BMWM1MHI1TDBIZkxaU25nbzlZaVVYVFdTOWVPdmZmVnNLUXlNNnYzSW5fTnVoSkttRFQxSzJpRVNrWjJHQTVZaEIxem5BVVlYd0lnbVBxLVc0UDFzU2MyM0RaN3FaS2FkLUQzZXZvSk5RQ0RaVmNkMC15cWdUclowbmlBZ2ZFbWZSVFlZR0Q2dmRZOUhZTndscU05dFlzSm1KbzZkMUxOQnRiMDQtSDhibWNDZnJvOXAteVF2QzZNa0ROclJoZ0RuNENkMzh1Z0l0TDBlODFGdEhqZHo5QlVyNkJzT1Vjb0Q4R0wyel9ScWlrQXdTcDVsLTlQUTA3a0c0ODBkQUJlWG82MGpIajhSNTloM0xLTWJoNGhhMVNBZ3FDRWs0NWxlQVZzZGg5VUwyNE4zTWgxZnVkRGhFQWc9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFhab1RIRXhUSFIzY1ZScmR6ZElkemwwU0ROeExWQnljakIzT0doYWNYSXpVM0ZaZWxnM2RXZzNiRVZCY3paWlRtWjFNSHBSVjBNNFpsOXliMU16VWtGc2VtNVhSbTlqVjJWMVZtbEJiMkpwVFVoaVFYVkhibmhxTkdRemJqbHBTa1ZuYTFaWlJXaEZUMFp5UTFaSmIxWnJPRkpmZURSVmRGQkdSbkJxVm14TU1XMU5NekZ3VTI5M1pWaEtOa2x3YlVSVmEzaDVORzFaY0VwR1pVeGtOVXRoYjI5blNFUk9ZMlF4WDNwTWNEaHdVMnRhTUV3d1gyVjZaVjlQVEZKbldWbHRiM05vY0ZBek5GQTVZbmxuU0daM1MyVnhhbVY2UTNOdmFIVnhSVlk1VFZSYVRFMVBTVkIwT1RCUFRrSkNabXBZUVdWdlJHZFFVSEJDTjFFM2JsZG5WZz09IiwgImF1dGhfdGltZSI6IDE2OTc1NzM4NTcsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiMzcyNTdjODI2ZDJhMTFlZTkwZGUwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIjBQdW41bFh0RWo1WWRqZmx1SGw3SVNqSCIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTczODU3LCAiZXhwIjogMTY5NzU3NDE1NywgImF1ZCI6IFsiand0X3Rlc3QiXX0.ZFRyN5OhasO809YC00-hM9cqYLl14qLlQDgw5I4XRXTIh9PFFNKlYmLyAlNR2gY1e1AZSgYCIYuo0dsIeEzt_lmbam7cMwDnxWiQWF-RhILSojhYJgCTFhbZ76nJdp2QCoIIoy1-wX8V5dpEOQi9z3CwtKFAZfeMC7jtw93oikwcx8GxAwlI2-E5Cpk6CB4RvjrJjgp3J1COCNZSrv4aKnbwbWJ_qK8iPfY3TTlbrp7SmlG4ByRWfKmgesSZ9z7cFkhRlgBRQPnt51sYyVWrSw0ZzsT7msGjThC-6qg1KtmLh2zlQXT9qTsq30ngMIt9yhUo0dLQDCt5NYAUmiFyRg"}
2023-10-17 22:17:37,642 oidcrp.service DEBUG response format: json
2023-10-17 22:17:37,642 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 22:17:37,642 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiYzAyMzhhNmI2ZTg3NDU3Y2EyMjE5YTcyMmU1ZGJhN2YiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWFpvVEhFeFRIUjNjVlJyZHpkSWR6bDBTRE54TFZCeWNqQjNPR2hhY1hJelUzRlplbGczZFdnM2JFVkJjelpaVG1aMU1IcFJWME00Wmw5eWIxTXpVa0ZzZW01WFJtOWpWMlYxVm1sQmIySnBUVWhpUVhWSGJuaHFOR1F6YmpscFNrVm5hMVpaUldoRlQwWnlRMVpKYjFack9GSmZlRFJWZEZCR1JuQnFWbXhNTVcxTk16RndVMjkzWlZoS05rbHdiVVJWYTNoNU5HMVpjRXBHWlV4a05VdGhiMjluU0VST1kyUXhYM3BNY0Rod1UydGFNRXd3WDJWNlpWOVBURkpuV1ZsdGIzTm9jRkF6TkZBNVlubG5TR1ozUzJWeGFtVjZRM052YUhWeFJWWTVUVlJhVEUxUFNWQjBPVEJQVGtKQ1ptcFlRV1Z2UkdkUVVIQkNOMUUzYmxkblZnPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM4NTcsICJleHAiOiAxNjk3NTc3NDU3fQ.9E_Tc4ewRNRr1bDLdBwV6XRV7-9kxxj9T8Ma1SuxMMwPIa9Nnohu64zO-YLjk-CLVTJJz8qxb6vWCfctu8qqrg', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxMdXZoQ3loVi1ZWXdGMUI1cE5QUnFTTVQtTUIxNGpKNldBc19sQk10QzJGb2drYzVpN09HR09uN0NCN2hkRWxLeEEwd1p1akZPYmQ1V2ZjWTIyZ2dJMmNJUUsyZm5KY3Z6SGtRODhNcE1MUDMwOWF5S0lBWllTYU5ENVgxUVl5LTZXMUhNczB5TjFra3ZyR0lzVzIydVl2UmhwRkN3Y0FoVUU2RzhyQmVuTG1VRllZVmJ5VExQU0liVms5Tmo2R25TRllZV01iTkhYUG40OEdJSEJIbHNsU3Q2dkxES1FKb0RFaGpfU1NZcFJZMUVGNWF2LXg3QXZzM3dVT1NEUFNzaDB0N0pvLThTU3JjNWNaVEQtc0ZOcmx5eXk5RjlidkpxTElOQ2k5aDJ6YXd2S09DLXFTOVF4OWN6cDhzMDF4MjdQSENKVi00Q3RBTUVFcWVHQ1F0NWhfVnJ1NERIMG1pWXVxcV9RdThwYldDNjVEUE10cGpjRF9BMWM1MHI1TDBIZkxaU25nbzlZaVVYVFdTOWVPdmZmVnNLUXlNNnYzSW5fTnVoSkttRFQxSzJpRVNrWjJHQTVZaEIxem5BVVlYd0lnbVBxLVc0UDFzU2MyM0RaN3FaS2FkLUQzZXZvSk5RQ0RaVmNkMC15cWdUclowbmlBZ2ZFbWZSVFlZR0Q2dmRZOUhZTndscU05dFlzSm1KbzZkMUxOQnRiMDQtSDhibWNDZnJvOXAteVF2QzZNa0ROclJoZ0RuNENkMzh1Z0l0TDBlODFGdEhqZHo5QlVyNkJzT1Vjb0Q4R0wyel9ScWlrQXdTcDVsLTlQUTA3a0c0ODBkQUJlWG82MGpIajhSNTloM0xLTWJoNGhhMVNBZ3FDRWs0NWxlQVZzZGg5VUwyNE4zTWgxZnVkRGhFQWc9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFhab1RIRXhUSFIzY1ZScmR6ZElkemwwU0ROeExWQnljakIzT0doYWNYSXpVM0ZaZWxnM2RXZzNiRVZCY3paWlRtWjFNSHBSVjBNNFpsOXliMU16VWtGc2VtNVhSbTlqVjJWMVZtbEJiMkpwVFVoaVFYVkhibmhxTkdRemJqbHBTa1ZuYTFaWlJXaEZUMFp5UTFaSmIxWnJPRkpmZURSVmRGQkdSbkJxVm14TU1XMU5NekZ3VTI5M1pWaEtOa2x3YlVSVmEzaDVORzFaY0VwR1pVeGtOVXRoYjI5blNFUk9ZMlF4WDNwTWNEaHdVMnRhTUV3d1gyVjZaVjlQVEZKbldWbHRiM05vY0ZBek5GQTVZbmxuU0daM1MyVnhhbVY2UTNOdmFIVnhSVlk1VFZSYVRFMVBTVkIwT1RCUFRrSkNabXBZUVdWdlJHZFFVSEJDTjFFM2JsZG5WZz09IiwgImF1dGhfdGltZSI6IDE2OTc1NzM4NTcsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiMzcyNTdjODI2ZDJhMTFlZTkwZGUwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIjBQdW41bFh0RWo1WWRqZmx1SGw3SVNqSCIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTczODU3LCAiZXhwIjogMTY5NzU3NDE1NywgImF1ZCI6IFsiand0X3Rlc3QiXX0.ZFRyN5OhasO809YC00-hM9cqYLl14qLlQDgw5I4XRXTIh9PFFNKlYmLyAlNR2gY1e1AZSgYCIYuo0dsIeEzt_lmbam7cMwDnxWiQWF-RhILSojhYJgCTFhbZ76nJdp2QCoIIoy1-wX8V5dpEOQi9z3CwtKFAZfeMC7jtw93oikwcx8GxAwlI2-E5Cpk6CB4RvjrJjgp3J1COCNZSrv4aKnbwbWJ_qK8iPfY3TTlbrp7SmlG4ByRWfKmgesSZ9z7cFkhRlgBRQPnt51sYyVWrSw0ZzsT7msGjThC-6qg1KtmLh2zlQXT9qTsq30ngMIt9yhUo0dLQDCt5NYAUmiFyRg'}"
2023-10-17 22:17:37,642 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-17 22:17:37,642 oidcmsg.message DEBUG Raw JSON: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdXZoTHExTHR3cVRrdzdIdzl0SDNxLVBycjB3OGhacXIzU3FZelg3dWg3bEVBczZZTmZ1MHpRV0M4Zl9yb1MzUkFsem5XRm9jV2V1VmlBb2JpTUhiQXVHbnhqNGQzbjlpSkVna1ZZRWhFT0ZyQ1ZJb1ZrOFJfeDRVdFBGRnBqVmxMMW1NMzFwU293ZVhKNklwbURVa3h5NG1ZcEpGZUxkNUthb29nSEROY2QxX3pMcDhwU2taMEwwX2V6ZV9PTFJnWVltb3NocFAzNFA5YnlnSGZ3S2VxamV6Q3NvaHVxRVY5TVRaTE1PSVB0OTBPTkJCZmpYQWVvRGdQUHBCN1E3bldnVg==', 'auth_time': 1697573857, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '37257c826d2a11ee90de0242ac170004', 'client_id': 'jwt_test', 'nonce': '0Pun5lXtEj5YdjfluHl7ISjH', 'iss': 'https://satosa.idem.it', 'iat': 1697573857, 'exp': 1697574157, 'aud': ['jwt_test']}
2023-10-17 22:17:37,642 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA'}
2023-10-17 22:17:37,642 cryptojwt.key_jar DEBUG Key summary for https://satosa.idem.it: RSA:sig:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, EC:sig:LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw
2023-10-17 22:17:37,642 oidcmsg.message DEBUG Found signing key.
2023-10-17 22:17:37,642 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-17 22:17:37,642 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA and use=
2023-10-17 22:17:37,642 cryptojwt.jwx DEBUG Picked: kid:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, use:sig, kty:RSA
2023-10-17 22:17:37,643 cryptojwt.jws.jws DEBUG Verified message using key with kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA
2023-10-17 22:17:37,643 oidcmsg.oidc INFO Verified id_token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdXZoTHExTHR3cVRrdzdIdzl0SDNxLVBycjB3OGhacXIzU3FZelg3dWg3bEVBczZZTmZ1MHpRV0M4Zl9yb1MzUkFsem5XRm9jV2V1VmlBb2JpTUhiQXVHbnhqNGQzbjlpSkVna1ZZRWhFT0ZyQ1ZJb1ZrOFJfeDRVdFBGRnBqVmxMMW1NMzFwU293ZVhKNklwbURVa3h5NG1ZcEpGZUxkNUthb29nSEROY2QxX3pMcDhwU2taMEwwX2V6ZV9PTFJnWVltb3NocFAzNFA5YnlnSGZ3S2VxamV6Q3NvaHVxRVY5TVRaTE1PSVB0OTBPTkJCZmpYQWVvRGdQUHBCN1E3bldnVg==', 'auth_time': 1697573857, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '37257c826d2a11ee90de0242ac170004', 'client_id': 'jwt_test', 'nonce': '0Pun5lXtEj5YdjfluHl7ISjH', 'iss': 'https://satosa.idem.it', 'iat': 1697573857, 'exp': 1697574157, 'aud': ['jwt_test']}
2023-10-17 22:17:37,644 oidcrp.rp_handler DEBUG ID Token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdXZoTHExTHR3cVRrdzdIdzl0SDNxLVBycjB3OGhacXIzU3FZelg3dWg3bEVBczZZTmZ1MHpRV0M4Zl9yb1MzUkFsem5XRm9jV2V1VmlBb2JpTUhiQXVHbnhqNGQzbjlpSkVna1ZZRWhFT0ZyQ1ZJb1ZrOFJfeDRVdFBGRnBqVmxMMW1NMzFwU293ZVhKNklwbURVa3h5NG1ZcEpGZUxkNUthb29nSEROY2QxX3pMcDhwU2taMEwwX2V6ZV9PTFJnWVltb3NocFAzNFA5YnlnSGZ3S2VxamV6Q3NvaHVxRVY5TVRaTE1PSVB0OTBPTkJCZmpYQWVvRGdQUHBCN1E3bldnVg==', 'auth_time': 1697573857, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '37257c826d2a11ee90de0242ac170004', 'client_id': 'jwt_test', 'nonce': '0Pun5lXtEj5YdjfluHl7ISjH', 'iss': 'https://satosa.idem.it', 'iat': 1697573857, 'exp': 1697574157, 'aud': ['jwt_test']}
2023-10-17 22:17:37,644 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-17 22:17:37,644 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiYzAyMzhhNmI2ZTg3NDU3Y2EyMjE5YTcyMmU1ZGJhN2YiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWFpvVEhFeFRIUjNjVlJyZHpkSWR6bDBTRE54TFZCeWNqQjNPR2hhY1hJelUzRlplbGczZFdnM2JFVkJjelpaVG1aMU1IcFJWME00Wmw5eWIxTXpVa0ZzZW01WFJtOWpWMlYxVm1sQmIySnBUVWhpUVhWSGJuaHFOR1F6YmpscFNrVm5hMVpaUldoRlQwWnlRMVpKYjFack9GSmZlRFJWZEZCR1JuQnFWbXhNTVcxTk16RndVMjkzWlZoS05rbHdiVVJWYTNoNU5HMVpjRXBHWlV4a05VdGhiMjluU0VST1kyUXhYM3BNY0Rod1UydGFNRXd3WDJWNlpWOVBURkpuV1ZsdGIzTm9jRkF6TkZBNVlubG5TR1ozUzJWeGFtVjZRM052YUhWeFJWWTVUVlJhVEUxUFNWQjBPVEJQVGtKQ1ptcFlRV1Z2UkdkUVVIQkNOMUUzYmxkblZnPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM4NTcsICJleHAiOiAxNjk3NTc3NDU3fQ.9E_Tc4ewRNRr1bDLdBwV6XRV7-9kxxj9T8Ma1SuxMMwPIa9Nnohu64zO-YLjk-CLVTJJz8qxb6vWCfctu8qqrg'}
2023-10-17 22:17:37,644 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-17 22:17:37,644 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f38345f9a90>, 'url': 'https://satosa.idem.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiYzAyMzhhNmI2ZTg3NDU3Y2EyMjE5YTcyMmU1ZGJhN2YiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWFpvVEhFeFRIUjNjVlJyZHpkSWR6bDBTRE54TFZCeWNqQjNPR2hhY1hJelUzRlplbGczZFdnM2JFVkJjelpaVG1aMU1IcFJWME00Wmw5eWIxTXpVa0ZzZW01WFJtOWpWMlYxVm1sQmIySnBUVWhpUVhWSGJuaHFOR1F6YmpscFNrVm5hMVpaUldoRlQwWnlRMVpKYjFack9GSmZlRFJWZEZCR1JuQnFWbXhNTVcxTk16RndVMjkzWlZoS05rbHdiVVJWYTNoNU5HMVpjRXBHWlV4a05VdGhiMjluU0VST1kyUXhYM3BNY0Rod1UydGFNRXd3WDJWNlpWOVBURkpuV1ZsdGIzTm9jRkF6TkZBNVlubG5TR1ozUzJWeGFtVjZRM052YUhWeFJWWTVUVlJhVEUxUFNWQjBPVEJQVGtKQ1ptcFlRV1Z2UkdkUVVIQkNOMUUzYmxkblZnPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM4NTcsICJleHAiOiAxNjk3NTc3NDU3fQ.9E_Tc4ewRNRr1bDLdBwV6XRV7-9kxxj9T8Ma1SuxMMwPIa9Nnohu64zO-YLjk-CLVTJJz8qxb6vWCfctu8qqrg'}}
2023-10-17 22:17:37,644 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiYzAyMzhhNmI2ZTg3NDU3Y2EyMjE5YTcyMmU1ZGJhN2YiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWFpvVEhFeFRIUjNjVlJyZHpkSWR6bDBTRE54TFZCeWNqQjNPR2hhY1hJelUzRlplbGczZFdnM2JFVkJjelpaVG1aMU1IcFJWME00Wmw5eWIxTXpVa0ZzZW01WFJtOWpWMlYxVm1sQmIySnBUVWhpUVhWSGJuaHFOR1F6YmpscFNrVm5hMVpaUldoRlQwWnlRMVpKYjFack9GSmZlRFJWZEZCR1JuQnFWbXhNTVcxTk16RndVMjkzWlZoS05rbHdiVVJWYTNoNU5HMVpjRXBHWlV4a05VdGhiMjluU0VST1kyUXhYM3BNY0Rod1UydGFNRXd3WDJWNlpWOVBURkpuV1ZsdGIzTm9jRkF6TkZBNVlubG5TR1ozUzJWeGFtVjZRM052YUhWeFJWWTVUVlJhVEUxUFNWQjBPVEJQVGtKQ1ptcFlRV1Z2UkdkUVVIQkNOMUUzYmxkblZnPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM4NTcsICJleHAiOiAxNjk3NTc3NDU3fQ.9E_Tc4ewRNRr1bDLdBwV6XRV7-9kxxj9T8Ma1SuxMMwPIa9Nnohu64zO-YLjk-CLVTJJz8qxb6vWCfctu8qqrg'}
2023-10-17 22:17:37,644 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:17:37,803 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-17 22:17:37,803 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:17:37,803 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:17:37,803 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:17:37 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADgQRoQjmqmutoandQyjByQJ5WzClhC7QX_RtfQMkXksoV_fe3eWw9PhmorNITJ9vSV6MrA6pTvWJimzOvxLOAYF6Avaij7FGh8DWZ8ctQZkU5cEMma_JEzukj3GB8hcXEck3-bxzCsdkYWg8OETtndxcixlnwJUxS7kHp8mYYH09DffUyoNjNV4g6q_L2zRa0ko6hlQYh5SZK4C3Drkq1c4yof2082FIJOTE4BMTAZod-Ba3xyD-OwWAAAAAF6BOpmohja7AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldADgQRoQjmqmutoandQyjByQJ5WzClhC7QX_RtfQMkXksoV_fe3eWw9PhmorNITJ9vSV6MrA6pTvWJimzOvxLOAYF6Avaij7FGh8DWZ8ctQZkU5cEMma_JEzukj3GB8hcXEck3-bxzCsdkYWg8OETtndxcixlnwJUxS7kHp8mYYH09DffUyoNjNV4g6q_L2zRa0ko6hlQYh5SZK4C3Drkq1c4yof2082FIJOTE4BMTAZod-Ba3xyD-OwWAAAAAF6BOpmohja7AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:17:37,803 oidcrp.util DEBUG resp.txt: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-17 22:17:37,803 oidcrp.oauth2 DEBUG Successful response: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-17 22:17:37,803 oidcrp.service DEBUG response format: json
2023-10-17 22:17:37,803 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-17 22:17:37,803 oidcrp.service DEBUG Initial response parsing => "{'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}"
2023-10-17 22:17:37,803 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-17 22:17:37,804 oidcrp.rp_handler DEBUG UserInfo: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}
2023-10-17 22:17:37,805 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:17:37] "GET /authz_cb/satosa?state=ixCs7LTz24AjSbWWmiIT0lfX18VvEq1B&scope=offline_access+profile+openid&code=Z0FBQUFBQmxMdXZoOVoyTm9VLVNzMTlqemkyYzFKUEYyRFUyODhGWm5ON3JFbXBHRVNXVzNNVTRVNGRUUFNSajFqdkRXYUFpMnlKQVp5Y0lCa2FpTG4xZnVnWGxNU1d2X2VydGM0Uk5jWkdja2w2S0Q5OGR6MVRDTDgweHdQWGx2LTdQZ040V1VmZVNYUTZINFhMYllfWkNndmR5dllHR2pjQlpoYUJjWXRpbFNZQmdBamhvRC1uQl9sQUJrV1J4NXNSZzRtN3FmMjNobVNyYy1aU3R3cVdwSUdCdGc2QTBCUmJob3ByWTlrTnlINWFQbW1ONS10VWRpaVo0d2lEMHBvZi1mdU1kQ3NTOVVtRDE2UWVYUVczaTRlZlB2Si1UVDc5UmpUc043clMzM3pmTVNPdEpmRTlfWHhnbS0tdTcxQkN3RFoxcWtJamM2SklpMlhkU3F2Nms2Y0V3aXJGcTQyeXdDSVdfX05SdzYxdEFIYnY1OUtPajRldVVmS1B5dV9hUU5mR2xVdnJHakwwOUlRTTdQbkxYb1J2RUV3ajRkTWFsamVZTmU4SlNQOWVyY0xtSHhRSzJIcFE2b3prdm9fa3cybXpNalZ5cHZOcExtbnBDYkxSMUtnbURWeW02cGhqbDlZY01Gc3kwMms0dWdxMGZHR3E5YmJHX3FYaU5zMS0yeDNKWS1rS1RXX3cxbzY1VU03OS1wZ251Vk50OXZzc09aem5DRy1DTUxOTE1MRGNxZk5RNjJKejFtY0FNZHlGUHQzbWZkRnZwbjc1ZFM2eS1IMVZOdE92SUdGekl4Qm5fU3RzdGoxTUQ1dzFTU1JJSHdSaE16OUlEdHN6YXQ1clZLMTExVFJES1oyOEl5Qk8zXzc0TFd3bXJmUnB2X2JkcE5xVVNzRUhaeFFMTkFSQUtuQjA9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1" 200 -
2023-10-17 22:18:05,901 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 22:18:05,901 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 22:18:05,901 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 22:18:05,901 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 22:18:05,942 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 22:18:05,942 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 22:18:05,942 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 22:18:05,943 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 22:18:05,943 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:18:05,959 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 22:18:05,960 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:18:05,960 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:18:05,960 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:18:05 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdAC-WShRB_4oTQJomII6gh39whygPBO_2DBmMxU18EpoFRMj3qKlSMoMQFjN2IpVRENlmDlxcIikBaiCdvEPnYpNQrGne7kBNX6dXrNwzFf53E16VJUigsg7MfGJdNvAGUuJMLBVlC5Id28zIreq4ZQUC-pqZ0QSEn5LAUkJhk8DjubJleCsEDynDIYhepL1Qt6KlE3sYCo_FwKnId_CndlB3d0mijfG9Nk9fXKjv8_7LwPz3cjghL-YA1A2AXl1MWC0AAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdAC-WShRB_4oTQJomII6gh39whygPBO_2DBmMxU18EpoFRMj3qKlSMoMQFjN2IpVRENlmDlxcIikBaiCdvEPnYpNQrGne7kBNX6dXrNwzFf53E16VJUigsg7MfGJdNvAGUuJMLBVlC5Id28zIreq4ZQUC-pqZ0QSEn5LAUkJhk8DjubJleCsEDynDIYhepL1Qt6KlE3sYCo_FwKnId_CndlB3d0mijfG9Nk9fXKjv8_7LwPz3cjghL-YA1A2AXl1MWC0AAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:18:05,960 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 22:18:05,960 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 22:18:05,960 oidcrp.service DEBUG response format: json
2023-10-17 22:18:05,960 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 22:18:05,960 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 22:18:05,960 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 22:18:05,961 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 22:18:05,961 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 22:18:05,961 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:18:05,961 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:18:05,962 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:18:05,979 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 22:18:05,979 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "e": "AQAB", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:18:05,979 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "e": "AQAB", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:18:05,980 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-17 22:18:05,980 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 22:18:05,980 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 22:18:05,980 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 22:18:05,980 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'WET0OfgnVzTPE8l3Q7XRGZgK', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'k6C4ODvGBlJqFDu9RhW7xUce825XTYjg'}
2023-10-17 22:18:05,980 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'WET0OfgnVzTPE8l3Q7XRGZgK', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'k6C4ODvGBlJqFDu9RhW7xUce825XTYjg', 'code_challenge': 'L3g-GN17-cHkidsM332Atrc1auYm3C3hBTy45VDQOAM', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 22:18:05,980 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f38345df490>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=WET0OfgnVzTPE8l3Q7XRGZgK&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=k6C4ODvGBlJqFDu9RhW7xUce825XTYjg&code_challenge=L3g-GN17-cHkidsM332Atrc1auYm3C3hBTy45VDQOAM&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 22:18:05,981 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:18:05] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 22:18:24,140 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 22:18:24,140 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 22:18:24,140 oidcrp.service DEBUG response format: dict
2023-10-17 22:18:24,140 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 22:18:24,140 oidcrp.service DEBUG Initial response parsing => "{'state': 'k6C4ODvGBlJqFDu9RhW7xUce825XTYjg', 'scope': 'offline_access profile openid', 'code': 'Z0FBQUFBQmxMdXdRWmUzY1Q3ZkhzTFlHVEJwazVaVTdGa0xlXzcyWVZuX2lvWDhpbDdsUWVuX3dsUlc0MTBVeE5PS2NGSGZrQWZoRnhzZTV1WWc1T3p0bURhUUQ1V1RYa0pkc2FUdmJYa1daN1QzdnBzQUNRS3RxVHExVlh4dGlQaWRyVUZJYnVjRVRWQ25uRE1TLTgwNGdfSEdxMGVOQ2NRcDJPdzBCc0kwUnp6Q0tOMzNoNVlfZHZUOW8tSWltckc3Nm5tODYyZ0xtZXNMNWZWeWR1RXB1R2Q3SUxaWURVbkZVbW4yQ3VQdTlsR2N3NjlXb2t3c3lMZ3dPLWIxY2hEbjBIUVBJa2hweE1nMEFFbXdOUkVMRDd1UXZkYld6U2NreVY2bmdqWFV4S21Cd0ZRV1lGRVFZQngwb25uWktkMk9iUlh6Z1NGZWtBNml3bGQwTEVidGZSX1NOZFRxZVV2YUNXUE5FelpNUHRLaFNJUUl1Yzc0ejU4VWRxdk1nM2dqUXRvQjZ0QmRKN1hIT1o5d0RhejRBMk4yN0lDeXZpRjk1NmFvTzItdFBPVXQ4Sll0bWlaTTJlWjJNdk55M1lOS2pRZVRuRDE3TC1jN2N4YnE1SlpycnRQamFjNDJDbDFhSGNWamRKNXQwTzF5a3FtUFhsMVBWN2lGUWFtUV9udVAwcTZYVjZob1BkTllYeFpadlpzV3EzbW5xMkQxbW9SWXYtS1FpTl9aelZXZTBkY1p4YklHSDE0bGY3TWdxWmsxNlJfMFFWUzFaZGs2Ul9UdURrdkY5RGVjdnFrMzBtT3ppbXRTVEFrTmtHakpxdlQyTVptcUQzbGVMNXlIaERnOU9lZ0FxNUZHVDBpY2VlMU9meW5oTkZKeVU5S05Vby0yVV9RQ0ZhNnU0QjR6TjB2TTJQdGM9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 22:18:24,140 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 22:18:24,141 oidcrp.rp_handler DEBUG Authz response: {'state': 'k6C4ODvGBlJqFDu9RhW7xUce825XTYjg', 'scope': 'offline_access profile openid', 'code': 'Z0FBQUFBQmxMdXdRWmUzY1Q3ZkhzTFlHVEJwazVaVTdGa0xlXzcyWVZuX2lvWDhpbDdsUWVuX3dsUlc0MTBVeE5PS2NGSGZrQWZoRnhzZTV1WWc1T3p0bURhUUQ1V1RYa0pkc2FUdmJYa1daN1QzdnBzQUNRS3RxVHExVlh4dGlQaWRyVUZJYnVjRVRWQ25uRE1TLTgwNGdfSEdxMGVOQ2NRcDJPdzBCc0kwUnp6Q0tOMzNoNVlfZHZUOW8tSWltckc3Nm5tODYyZ0xtZXNMNWZWeWR1RXB1R2Q3SUxaWURVbkZVbW4yQ3VQdTlsR2N3NjlXb2t3c3lMZ3dPLWIxY2hEbjBIUVBJa2hweE1nMEFFbXdOUkVMRDd1UXZkYld6U2NreVY2bmdqWFV4S21Cd0ZRV1lGRVFZQngwb25uWktkMk9iUlh6Z1NGZWtBNml3bGQwTEVidGZSX1NOZFRxZVV2YUNXUE5FelpNUHRLaFNJUUl1Yzc0ejU4VWRxdk1nM2dqUXRvQjZ0QmRKN1hIT1o5d0RhejRBMk4yN0lDeXZpRjk1NmFvTzItdFBPVXQ4Sll0bWlaTTJlWjJNdk55M1lOS2pRZVRuRDE3TC1jN2N4YnE1SlpycnRQamFjNDJDbDFhSGNWamRKNXQwTzF5a3FtUFhsMVBWN2lGUWFtUV9udVAwcTZYVjZob1BkTllYeFpadlpzV3EzbW5xMkQxbW9SWXYtS1FpTl9aelZXZTBkY1p4YklHSDE0bGY3TWdxWmsxNlJfMFFWUzFaZGs2Ul9UdURrdkY5RGVjdnFrMzBtT3ppbXRTVEFrTmtHakpxdlQyTVptcUQzbGVMNXlIaERnOU9lZ0FxNUZHVDBpY2VlMU9meW5oTkZKeVU5S05Vby0yVV9RQ0ZhNnU0QjR6TjB2TTJQdGM9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 22:18:24,141 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 22:18:24,141 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 22:18:24,141 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMdXdRWmUzY1Q3ZkhzTFlHVEJwazVaVTdGa0xlXzcyWVZuX2lvWDhpbDdsUWVuX3dsUlc0MTBVeE5PS2NGSGZrQWZoRnhzZTV1WWc1T3p0bURhUUQ1V1RYa0pkc2FUdmJYa1daN1QzdnBzQUNRS3RxVHExVlh4dGlQaWRyVUZJYnVjRVRWQ25uRE1TLTgwNGdfSEdxMGVOQ2NRcDJPdzBCc0kwUnp6Q0tOMzNoNVlfZHZUOW8tSWltckc3Nm5tODYyZ0xtZXNMNWZWeWR1RXB1R2Q3SUxaWURVbkZVbW4yQ3VQdTlsR2N3NjlXb2t3c3lMZ3dPLWIxY2hEbjBIUVBJa2hweE1nMEFFbXdOUkVMRDd1UXZkYld6U2NreVY2bmdqWFV4S21Cd0ZRV1lGRVFZQngwb25uWktkMk9iUlh6Z1NGZWtBNml3bGQwTEVidGZSX1NOZFRxZVV2YUNXUE5FelpNUHRLaFNJUUl1Yzc0ejU4VWRxdk1nM2dqUXRvQjZ0QmRKN1hIT1o5d0RhejRBMk4yN0lDeXZpRjk1NmFvTzItdFBPVXQ4Sll0bWlaTTJlWjJNdk55M1lOS2pRZVRuRDE3TC1jN2N4YnE1SlpycnRQamFjNDJDbDFhSGNWamRKNXQwTzF5a3FtUFhsMVBWN2lGUWFtUV9udVAwcTZYVjZob1BkTllYeFpadlpzV3EzbW5xMkQxbW9SWXYtS1FpTl9aelZXZTBkY1p4YklHSDE0bGY3TWdxWmsxNlJfMFFWUzFaZGs2Ul9UdURrdkY5RGVjdnFrMzBtT3ppbXRTVEFrTmtHakpxdlQyTVptcUQzbGVMNXlIaERnOU9lZ0FxNUZHVDBpY2VlMU9meW5oTkZKeVU5S05Vby0yVV9RQ0ZhNnU0QjR6TjB2TTJQdGM9', 'state': 'k6C4ODvGBlJqFDu9RhW7xUce825XTYjg', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-17 22:18:24,141 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'k6C4ODvGBlJqFDu9RhW7xUce825XTYjg', 'code': 'Z0FBQUFBQmxMdXdRWmUzY1Q3ZkhzTFlHVEJwazVaVTdGa0xlXzcyWVZuX2lvWDhpbDdsUWVuX3dsUlc0MTBVeE5PS2NGSGZrQWZoRnhzZTV1WWc1T3p0bURhUUQ1V1RYa0pkc2FUdmJYa1daN1QzdnBzQUNRS3RxVHExVlh4dGlQaWRyVUZJYnVjRVRWQ25uRE1TLTgwNGdfSEdxMGVOQ2NRcDJPdzBCc0kwUnp6Q0tOMzNoNVlfZHZUOW8tSWltckc3Nm5tODYyZ0xtZXNMNWZWeWR1RXB1R2Q3SUxaWURVbkZVbW4yQ3VQdTlsR2N3NjlXb2t3c3lMZ3dPLWIxY2hEbjBIUVBJa2hweE1nMEFFbXdOUkVMRDd1UXZkYld6U2NreVY2bmdqWFV4S21Cd0ZRV1lGRVFZQngwb25uWktkMk9iUlh6Z1NGZWtBNml3bGQwTEVidGZSX1NOZFRxZVV2YUNXUE5FelpNUHRLaFNJUUl1Yzc0ejU4VWRxdk1nM2dqUXRvQjZ0QmRKN1hIT1o5d0RhejRBMk4yN0lDeXZpRjk1NmFvTzItdFBPVXQ4Sll0bWlaTTJlWjJNdk55M1lOS2pRZVRuRDE3TC1jN2N4YnE1SlpycnRQamFjNDJDbDFhSGNWamRKNXQwTzF5a3FtUFhsMVBWN2lGUWFtUV9udVAwcTZYVjZob1BkTllYeFpadlpzV3EzbW5xMkQxbW9SWXYtS1FpTl9aelZXZTBkY1p4YklHSDE0bGY3TWdxWmsxNlJfMFFWUzFaZGs2Ul9UdURrdkY5RGVjdnFrMzBtT3ppbXRTVEFrTmtHakpxdlQyTVptcUQzbGVMNXlIaERnOU9lZ0FxNUZHVDBpY2VlMU9meW5oTkZKeVU5S05Vby0yVV9RQ0ZhNnU0QjR6TjB2TTJQdGM9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': '77ideImq8ryGCNzFc0TqNKDpBEdaKYfAbiCTYJLW2Pt34LkWgH60H8nf62uaoAgV'}
2023-10-17 22:18:24,141 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 22:18:24,141 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f3834600f50>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=k6C4ODvGBlJqFDu9RhW7xUce825XTYjg&code=Z0FBQUFBQmxMdXdRWmUzY1Q3ZkhzTFlHVEJwazVaVTdGa0xlXzcyWVZuX2lvWDhpbDdsUWVuX3dsUlc0MTBVeE5PS2NGSGZrQWZoRnhzZTV1WWc1T3p0bURhUUQ1V1RYa0pkc2FUdmJYa1daN1QzdnBzQUNRS3RxVHExVlh4dGlQaWRyVUZJYnVjRVRWQ25uRE1TLTgwNGdfSEdxMGVOQ2NRcDJPdzBCc0kwUnp6Q0tOMzNoNVlfZHZUOW8tSWltckc3Nm5tODYyZ0xtZXNMNWZWeWR1RXB1R2Q3SUxaWURVbkZVbW4yQ3VQdTlsR2N3NjlXb2t3c3lMZ3dPLWIxY2hEbjBIUVBJa2hweE1nMEFFbXdOUkVMRDd1UXZkYld6U2NreVY2bmdqWFV4S21Cd0ZRV1lGRVFZQngwb25uWktkMk9iUlh6Z1NGZWtBNml3bGQwTEVidGZSX1NOZFRxZVV2YUNXUE5FelpNUHRLaFNJUUl1Yzc0ejU4VWRxdk1nM2dqUXRvQjZ0QmRKN1hIT1o5d0RhejRBMk4yN0lDeXZpRjk1NmFvTzItdFBPVXQ4Sll0bWlaTTJlWjJNdk55M1lOS2pRZVRuRDE3TC1jN2N4YnE1SlpycnRQamFjNDJDbDFhSGNWamRKNXQwTzF5a3FtUFhsMVBWN2lGUWFtUV9udVAwcTZYVjZob1BkTllYeFpadlpzV3EzbW5xMkQxbW9SWXYtS1FpTl9aelZXZTBkY1p4YklHSDE0bGY3TWdxWmsxNlJfMFFWUzFaZGs2Ul9UdURrdkY5RGVjdnFrMzBtT3ppbXRTVEFrTmtHakpxdlQyTVptcUQzbGVMNXlIaERnOU9lZ0FxNUZHVDBpY2VlMU9meW5oTkZKeVU5S05Vby0yVV9RQ0ZhNnU0QjR6TjB2TTJQdGM9&code_verifier=77ideImq8ryGCNzFc0TqNKDpBEdaKYfAbiCTYJLW2Pt34LkWgH60H8nf62uaoAgV', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 22:18:24,141 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=k6C4ODvGBlJqFDu9RhW7xUce825XTYjg&code=Z0FBQUFBQmxMdXdRWmUzY1Q3ZkhzTFlHVEJwazVaVTdGa0xlXzcyWVZuX2lvWDhpbDdsUWVuX3dsUlc0MTBVeE5PS2NGSGZrQWZoRnhzZTV1WWc1T3p0bURhUUQ1V1RYa0pkc2FUdmJYa1daN1QzdnBzQUNRS3RxVHExVlh4dGlQaWRyVUZJYnVjRVRWQ25uRE1TLTgwNGdfSEdxMGVOQ2NRcDJPdzBCc0kwUnp6Q0tOMzNoNVlfZHZUOW8tSWltckc3Nm5tODYyZ0xtZXNMNWZWeWR1RXB1R2Q3SUxaWURVbkZVbW4yQ3VQdTlsR2N3NjlXb2t3c3lMZ3dPLWIxY2hEbjBIUVBJa2hweE1nMEFFbXdOUkVMRDd1UXZkYld6U2NreVY2bmdqWFV4S21Cd0ZRV1lGRVFZQngwb25uWktkMk9iUlh6Z1NGZWtBNml3bGQwTEVidGZSX1NOZFRxZVV2YUNXUE5FelpNUHRLaFNJUUl1Yzc0ejU4VWRxdk1nM2dqUXRvQjZ0QmRKN1hIT1o5d0RhejRBMk4yN0lDeXZpRjk1NmFvTzItdFBPVXQ4Sll0bWlaTTJlWjJNdk55M1lOS2pRZVRuRDE3TC1jN2N4YnE1SlpycnRQamFjNDJDbDFhSGNWamRKNXQwTzF5a3FtUFhsMVBWN2lGUWFtUV9udVAwcTZYVjZob1BkTllYeFpadlpzV3EzbW5xMkQxbW9SWXYtS1FpTl9aelZXZTBkY1p4YklHSDE0bGY3TWdxWmsxNlJfMFFWUzFaZGs2Ul9UdURrdkY5RGVjdnFrMzBtT3ppbXRTVEFrTmtHakpxdlQyTVptcUQzbGVMNXlIaERnOU9lZ0FxNUZHVDBpY2VlMU9meW5oTkZKeVU5S05Vby0yVV9RQ0ZhNnU0QjR6TjB2TTJQdGM9&code_verifier=77ideImq8ryGCNzFc0TqNKDpBEdaKYfAbiCTYJLW2Pt34LkWgH60H8nf62uaoAgV, https_args:{'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 22:18:24,142 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:18:24,285 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-17 22:18:24,285 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:18:24,286 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:18:24,286 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:18:24 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALtdACgZS0bNd54V1RwTC1N_EkJH7IDTfag46jsIxLxXEt-qw_fPXnPfQ2QbzR7UNgrapcqPgme6ahLpWnr0O2bTD-KZ1_qkln2_1DwIztoJZK0oodUV4fKTesRqfn7N0lU6MsQC-zVi9j1uh-me7vLOwIZgcBGpXAbxYB52y7qpNHgL6NVK5qqS47LLijIQxaMIa4VlKKZ9FPdQ868Cf0qZXBMmz3t9lakmmosq5KGNd9PRIUWHLrEweFamcB8AAPSdBXZyLW7mAAHXAcABAADLVYGGscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALtdACgZS0bNd54V1RwTC1N_EkJH7IDTfag46jsIxLxXEt-qw_fPXnPfQ2QbzR7UNgrapcqPgme6ahLpWnr0O2bTD-KZ1_qkln2_1DwIztoJZK0oodUV4fKTesRqfn7N0lU6MsQC-zVi9j1uh-me7vLOwIZgcBGpXAbxYB52y7qpNHgL6NVK5qqS47LLijIQxaMIa4VlKKZ9FPdQ868Cf0qZXBMmz3t9lakmmosq5KGNd9PRIUWHLrEweFamcB8AAPSdBXZyLW7mAAHXAcABAADLVYGGscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:18:24,286 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNmQ3OGFiMjA4YzM0NGU1NjgxMWEwNTUzYzE4ZjczMGQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWGRSVmpFemQzTlVVbWg1WmtKb00wODJjalJRWVdkU1prSTBhbGxsZGs1bmFIbHVibTE1VTNsWVZWbDJWVTh5ZVdKNk1uSTNSRWxYYkhOeGVEVm9hbko1VWxjemVub3RSMUJaUTNBMldrZDRlVEJJYkRBeVpqTm5kV28xTFZCS1R5MDVWRlphUjI5R1RYaFFXbTlLUkdOelZtUlZlVE4yVUdaMVVEQk5VMnN6TW5aaloyMUpiVGd4T1VreGVVNHpkMVF0VkdONmRtSlFZekp6ZURWTWVEWkZVVUUzWTFCSVJHbDNlbFF4V0dObFlqaEVNSEYxTmxJelNtTlViRll5UmtkdU5XWlNka1pUVEY5SFdFZG9hbkZrVWpac1MxRTRUMHhrYlhWWVIzcHRSSFZoYmtOZlFqWjVVSFZEVkdrelpVbFFVMGhvVmpoalFtNTJReTE0ZGkxbWNRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM5MDQsICJleHAiOiAxNjk3NTc3NTA0fQ.6tnqhDu9_dxR1ezQQHDZhEv29CPmiA35iAd12aBtHg_NyNmBLWGsaLEsFlxGm2eh3LpRA8fbdIzVEFuCbQxKsA", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMdXdRVHhIRDczYVpxMWEtZW1CdXFrejFMY0xPc05kbnlyZFF3NFJueEJxMG0xdlR1ZEJLQ1JaYS1XVVg5MGpIZzdKLWdiUW0tMTRacXg5YUFRc3R4VXV2T3VjcTBMa2ZxNWptRjF4NGFwRUo4MDd0M3ZzSXBNbGJtVFJZTGV3ek13b2ZqVklVSjRJRDVQMjNjcDBISXRHN0lGeVF3TGJHRXlGWFI5am1hREpmWjNlemdnNkpCODJKQTNrcmdJbFIyVGZRR1I3b0lTaEVfOHEtRFZLOV9YSEEwZHhkaV9YV3g1TFB1TG1LTmVTdGcwVDlPb29hV0l1TkxhSkhFRi1CTThBQzF6OGZrNnJYV01YNmhqRDlkV3BEblJRS2JGTHlQZTFNVzgyaFF2UEx2eXQwWHBpOFBXWW5zN1pFUHQ1V3ZqX0h3dFZLN0N5aGJHSmplRWFqM2FmaEFVRFhlX1M2cWtsdW9KaFBWSHY0dmMyYzJ3SG5wZ295YVk2QTU2NUlDa3pCaGVJU2ItcW9pNlpHc0xRMnkzOTIwQkpzd2FzN0N5YmJ1YmVoRFFBQXYyZ3pLVVZvelhtMXgxaVhxbHJ4VUUzR0VidVV0UjV2eUR1VzNWYjlzM1dVRmNGazFEUURmVWo0SmNwWkpKWUM1cFJSMjVhWE5kZkxCeTd5OHJ2bXRUSUNIaEJHMENZb0xfTlBYRVpNeTVBUkVFbnEyc210eGRLd01ja2xpS3R1VXpGVWE3WFRFRV9tb3JOcm9Eb3BVUjdLTEV3eVVLc1Y5U1FPOGpsRGNGNlpTd1lTX3BkY2NTYWFPeUdPWFI0Y0Z2dlNmWHpDWHFLT1R4RXREUGo5RnAxTjZXUDkxY0Jpd0pldV80bjRjU2xtNTk3d1ZqX1lOTlNmV015SzRUeDAtY1k9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFhkUlZqRXpkM05VVW1oNVprSm9NMDgyY2pSUVlXZFNaa0kwYWxsbGRrNW5hSGx1Ym0xNVUzbFlWVmwyVlU4eWVXSjZNbkkzUkVsWGJITnhlRFZvYW5KNVVsY3plbm90UjFCWlEzQTJXa2Q0ZVRCSWJEQXlaak5uZFdvMUxWQktUeTA1VkZaYVIyOUdUWGhRV205S1JHTnpWbVJWZVROMlVHWjFVREJOVTJzek1uWmpaMjFKYlRneE9Va3hlVTR6ZDFRdFZHTjZkbUpRWXpKemVEVk1lRFpGVVVFM1kxQklSR2wzZWxReFdHTmxZamhFTUhGMU5sSXpTbU5VYkZZeVJrZHVOV1pTZGtaVFRGOUhXRWRvYW5Ga1VqWnNTMUU0VDB4a2JYVllSM3B0UkhWaGJrTmZRalo1VUhWRFZHa3paVWxRVTBob1ZqaGpRbTUyUXkxNGRpMW1jUT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzM5MDQsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiNTJmMmQ5ZDc2ZDJhMTFlZThkYWEwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIldFVDBPZmduVnpUUEU4bDNRN1hSR1pnSyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTczOTA0LCAiZXhwIjogMTY5NzU3NDIwNCwgImF1ZCI6IFsiand0X3Rlc3QiXX0.M_x76s3PDA9X5W9ihiX6vz8qscHjnIpkt2c-gVpSmYzgdfgbkfU878RycSYNDKA9_w8-JjRmZHsJCFGvS3VtX3ORzAokdo_dgfLzgCzuxxiA8wr9NBzuBtcB1XCwbEr9KP8uP4Z_FbNKD1spVz7AXdQVKxHisJis8x3xyUii50yAjV-YEAnAh6F79HSIW9oY-IdXrUiKehQ9DvJSjWOS8vA9xlt0k18zCgrEFlqIuJCqjAOSokp3DpsEQzI6Ka12VP8aPBonOCeAwcBbH8n9rhUYFPgQMgsDtMwACsh8TKqSAzxXoIDo_UJMR6_NT2QRerv4jN-tHpgmbv9hgaITKQ"}
2023-10-17 22:18:24,286 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNmQ3OGFiMjA4YzM0NGU1NjgxMWEwNTUzYzE4ZjczMGQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWGRSVmpFemQzTlVVbWg1WmtKb00wODJjalJRWVdkU1prSTBhbGxsZGs1bmFIbHVibTE1VTNsWVZWbDJWVTh5ZVdKNk1uSTNSRWxYYkhOeGVEVm9hbko1VWxjemVub3RSMUJaUTNBMldrZDRlVEJJYkRBeVpqTm5kV28xTFZCS1R5MDVWRlphUjI5R1RYaFFXbTlLUkdOelZtUlZlVE4yVUdaMVVEQk5VMnN6TW5aaloyMUpiVGd4T1VreGVVNHpkMVF0VkdONmRtSlFZekp6ZURWTWVEWkZVVUUzWTFCSVJHbDNlbFF4V0dObFlqaEVNSEYxTmxJelNtTlViRll5UmtkdU5XWlNka1pUVEY5SFdFZG9hbkZrVWpac1MxRTRUMHhrYlhWWVIzcHRSSFZoYmtOZlFqWjVVSFZEVkdrelpVbFFVMGhvVmpoalFtNTJReTE0ZGkxbWNRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM5MDQsICJleHAiOiAxNjk3NTc3NTA0fQ.6tnqhDu9_dxR1ezQQHDZhEv29CPmiA35iAd12aBtHg_NyNmBLWGsaLEsFlxGm2eh3LpRA8fbdIzVEFuCbQxKsA", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMdXdRVHhIRDczYVpxMWEtZW1CdXFrejFMY0xPc05kbnlyZFF3NFJueEJxMG0xdlR1ZEJLQ1JaYS1XVVg5MGpIZzdKLWdiUW0tMTRacXg5YUFRc3R4VXV2T3VjcTBMa2ZxNWptRjF4NGFwRUo4MDd0M3ZzSXBNbGJtVFJZTGV3ek13b2ZqVklVSjRJRDVQMjNjcDBISXRHN0lGeVF3TGJHRXlGWFI5am1hREpmWjNlemdnNkpCODJKQTNrcmdJbFIyVGZRR1I3b0lTaEVfOHEtRFZLOV9YSEEwZHhkaV9YV3g1TFB1TG1LTmVTdGcwVDlPb29hV0l1TkxhSkhFRi1CTThBQzF6OGZrNnJYV01YNmhqRDlkV3BEblJRS2JGTHlQZTFNVzgyaFF2UEx2eXQwWHBpOFBXWW5zN1pFUHQ1V3ZqX0h3dFZLN0N5aGJHSmplRWFqM2FmaEFVRFhlX1M2cWtsdW9KaFBWSHY0dmMyYzJ3SG5wZ295YVk2QTU2NUlDa3pCaGVJU2ItcW9pNlpHc0xRMnkzOTIwQkpzd2FzN0N5YmJ1YmVoRFFBQXYyZ3pLVVZvelhtMXgxaVhxbHJ4VUUzR0VidVV0UjV2eUR1VzNWYjlzM1dVRmNGazFEUURmVWo0SmNwWkpKWUM1cFJSMjVhWE5kZkxCeTd5OHJ2bXRUSUNIaEJHMENZb0xfTlBYRVpNeTVBUkVFbnEyc210eGRLd01ja2xpS3R1VXpGVWE3WFRFRV9tb3JOcm9Eb3BVUjdLTEV3eVVLc1Y5U1FPOGpsRGNGNlpTd1lTX3BkY2NTYWFPeUdPWFI0Y0Z2dlNmWHpDWHFLT1R4RXREUGo5RnAxTjZXUDkxY0Jpd0pldV80bjRjU2xtNTk3d1ZqX1lOTlNmV015SzRUeDAtY1k9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFhkUlZqRXpkM05VVW1oNVprSm9NMDgyY2pSUVlXZFNaa0kwYWxsbGRrNW5hSGx1Ym0xNVUzbFlWVmwyVlU4eWVXSjZNbkkzUkVsWGJITnhlRFZvYW5KNVVsY3plbm90UjFCWlEzQTJXa2Q0ZVRCSWJEQXlaak5uZFdvMUxWQktUeTA1VkZaYVIyOUdUWGhRV205S1JHTnpWbVJWZVROMlVHWjFVREJOVTJzek1uWmpaMjFKYlRneE9Va3hlVTR6ZDFRdFZHTjZkbUpRWXpKemVEVk1lRFpGVVVFM1kxQklSR2wzZWxReFdHTmxZamhFTUhGMU5sSXpTbU5VYkZZeVJrZHVOV1pTZGtaVFRGOUhXRWRvYW5Ga1VqWnNTMUU0VDB4a2JYVllSM3B0UkhWaGJrTmZRalo1VUhWRFZHa3paVWxRVTBob1ZqaGpRbTUyUXkxNGRpMW1jUT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzM5MDQsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiNTJmMmQ5ZDc2ZDJhMTFlZThkYWEwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIldFVDBPZmduVnpUUEU4bDNRN1hSR1pnSyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTczOTA0LCAiZXhwIjogMTY5NzU3NDIwNCwgImF1ZCI6IFsiand0X3Rlc3QiXX0.M_x76s3PDA9X5W9ihiX6vz8qscHjnIpkt2c-gVpSmYzgdfgbkfU878RycSYNDKA9_w8-JjRmZHsJCFGvS3VtX3ORzAokdo_dgfLzgCzuxxiA8wr9NBzuBtcB1XCwbEr9KP8uP4Z_FbNKD1spVz7AXdQVKxHisJis8x3xyUii50yAjV-YEAnAh6F79HSIW9oY-IdXrUiKehQ9DvJSjWOS8vA9xlt0k18zCgrEFlqIuJCqjAOSokp3DpsEQzI6Ka12VP8aPBonOCeAwcBbH8n9rhUYFPgQMgsDtMwACsh8TKqSAzxXoIDo_UJMR6_NT2QRerv4jN-tHpgmbv9hgaITKQ"}
2023-10-17 22:18:24,286 oidcrp.service DEBUG response format: json
2023-10-17 22:18:24,286 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 22:18:24,286 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNmQ3OGFiMjA4YzM0NGU1NjgxMWEwNTUzYzE4ZjczMGQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWGRSVmpFemQzTlVVbWg1WmtKb00wODJjalJRWVdkU1prSTBhbGxsZGs1bmFIbHVibTE1VTNsWVZWbDJWVTh5ZVdKNk1uSTNSRWxYYkhOeGVEVm9hbko1VWxjemVub3RSMUJaUTNBMldrZDRlVEJJYkRBeVpqTm5kV28xTFZCS1R5MDVWRlphUjI5R1RYaFFXbTlLUkdOelZtUlZlVE4yVUdaMVVEQk5VMnN6TW5aaloyMUpiVGd4T1VreGVVNHpkMVF0VkdONmRtSlFZekp6ZURWTWVEWkZVVUUzWTFCSVJHbDNlbFF4V0dObFlqaEVNSEYxTmxJelNtTlViRll5UmtkdU5XWlNka1pUVEY5SFdFZG9hbkZrVWpac1MxRTRUMHhrYlhWWVIzcHRSSFZoYmtOZlFqWjVVSFZEVkdrelpVbFFVMGhvVmpoalFtNTJReTE0ZGkxbWNRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM5MDQsICJleHAiOiAxNjk3NTc3NTA0fQ.6tnqhDu9_dxR1ezQQHDZhEv29CPmiA35iAd12aBtHg_NyNmBLWGsaLEsFlxGm2eh3LpRA8fbdIzVEFuCbQxKsA', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxMdXdRVHhIRDczYVpxMWEtZW1CdXFrejFMY0xPc05kbnlyZFF3NFJueEJxMG0xdlR1ZEJLQ1JaYS1XVVg5MGpIZzdKLWdiUW0tMTRacXg5YUFRc3R4VXV2T3VjcTBMa2ZxNWptRjF4NGFwRUo4MDd0M3ZzSXBNbGJtVFJZTGV3ek13b2ZqVklVSjRJRDVQMjNjcDBISXRHN0lGeVF3TGJHRXlGWFI5am1hREpmWjNlemdnNkpCODJKQTNrcmdJbFIyVGZRR1I3b0lTaEVfOHEtRFZLOV9YSEEwZHhkaV9YV3g1TFB1TG1LTmVTdGcwVDlPb29hV0l1TkxhSkhFRi1CTThBQzF6OGZrNnJYV01YNmhqRDlkV3BEblJRS2JGTHlQZTFNVzgyaFF2UEx2eXQwWHBpOFBXWW5zN1pFUHQ1V3ZqX0h3dFZLN0N5aGJHSmplRWFqM2FmaEFVRFhlX1M2cWtsdW9KaFBWSHY0dmMyYzJ3SG5wZ295YVk2QTU2NUlDa3pCaGVJU2ItcW9pNlpHc0xRMnkzOTIwQkpzd2FzN0N5YmJ1YmVoRFFBQXYyZ3pLVVZvelhtMXgxaVhxbHJ4VUUzR0VidVV0UjV2eUR1VzNWYjlzM1dVRmNGazFEUURmVWo0SmNwWkpKWUM1cFJSMjVhWE5kZkxCeTd5OHJ2bXRUSUNIaEJHMENZb0xfTlBYRVpNeTVBUkVFbnEyc210eGRLd01ja2xpS3R1VXpGVWE3WFRFRV9tb3JOcm9Eb3BVUjdLTEV3eVVLc1Y5U1FPOGpsRGNGNlpTd1lTX3BkY2NTYWFPeUdPWFI0Y0Z2dlNmWHpDWHFLT1R4RXREUGo5RnAxTjZXUDkxY0Jpd0pldV80bjRjU2xtNTk3d1ZqX1lOTlNmV015SzRUeDAtY1k9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFhkUlZqRXpkM05VVW1oNVprSm9NMDgyY2pSUVlXZFNaa0kwYWxsbGRrNW5hSGx1Ym0xNVUzbFlWVmwyVlU4eWVXSjZNbkkzUkVsWGJITnhlRFZvYW5KNVVsY3plbm90UjFCWlEzQTJXa2Q0ZVRCSWJEQXlaak5uZFdvMUxWQktUeTA1VkZaYVIyOUdUWGhRV205S1JHTnpWbVJWZVROMlVHWjFVREJOVTJzek1uWmpaMjFKYlRneE9Va3hlVTR6ZDFRdFZHTjZkbUpRWXpKemVEVk1lRFpGVVVFM1kxQklSR2wzZWxReFdHTmxZamhFTUhGMU5sSXpTbU5VYkZZeVJrZHVOV1pTZGtaVFRGOUhXRWRvYW5Ga1VqWnNTMUU0VDB4a2JYVllSM3B0UkhWaGJrTmZRalo1VUhWRFZHa3paVWxRVTBob1ZqaGpRbTUyUXkxNGRpMW1jUT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzM5MDQsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiNTJmMmQ5ZDc2ZDJhMTFlZThkYWEwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIldFVDBPZmduVnpUUEU4bDNRN1hSR1pnSyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTczOTA0LCAiZXhwIjogMTY5NzU3NDIwNCwgImF1ZCI6IFsiand0X3Rlc3QiXX0.M_x76s3PDA9X5W9ihiX6vz8qscHjnIpkt2c-gVpSmYzgdfgbkfU878RycSYNDKA9_w8-JjRmZHsJCFGvS3VtX3ORzAokdo_dgfLzgCzuxxiA8wr9NBzuBtcB1XCwbEr9KP8uP4Z_FbNKD1spVz7AXdQVKxHisJis8x3xyUii50yAjV-YEAnAh6F79HSIW9oY-IdXrUiKehQ9DvJSjWOS8vA9xlt0k18zCgrEFlqIuJCqjAOSokp3DpsEQzI6Ka12VP8aPBonOCeAwcBbH8n9rhUYFPgQMgsDtMwACsh8TKqSAzxXoIDo_UJMR6_NT2QRerv4jN-tHpgmbv9hgaITKQ'}"
2023-10-17 22:18:24,286 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-17 22:18:24,286 oidcmsg.message DEBUG Raw JSON: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdXdRVjEzd3NUUmh5ZkJoM082cjRQYWdSZkI0allldk5naHlubm15U3lYVVl2VU8yeWJ6MnI3RElXbHNxeDVoanJ5UlczenotR1BZQ3A2Wkd4eTBIbDAyZjNndWo1LVBKTy05VFZaR29GTXhQWm9KRGNzVmRVeTN2UGZ1UDBNU2szMnZjZ21JbTgxOUkxeU4zd1QtVGN6dmJQYzJzeDVMeDZFUUE3Y1BIRGl3elQxWGNlYjhEMHF1NlIzSmNUbFYyRkduNWZSdkZTTF9HWEdoanFkUjZsS1E4T0xkbXVYR3ptRHVhbkNfQjZ5UHVDVGkzZUlQU0hoVjhjQm52Qy14di1mcQ==', 'auth_time': 1697573904, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '52f2d9d76d2a11ee8daa0242ac170004', 'client_id': 'jwt_test', 'nonce': 'WET0OfgnVzTPE8l3Q7XRGZgK', 'iss': 'https://satosa.idem.it', 'iat': 1697573904, 'exp': 1697574204, 'aud': ['jwt_test']}
2023-10-17 22:18:24,286 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA'}
2023-10-17 22:18:24,286 cryptojwt.key_jar DEBUG Key summary for https://satosa.idem.it: RSA:sig:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, EC:sig:LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw
2023-10-17 22:18:24,286 oidcmsg.message DEBUG Found signing key.
2023-10-17 22:18:24,286 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-17 22:18:24,286 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA and use=
2023-10-17 22:18:24,286 cryptojwt.jwx DEBUG Picked: kid:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, use:sig, kty:RSA
2023-10-17 22:18:24,286 cryptojwt.jws.jws DEBUG Verified message using key with kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA
2023-10-17 22:18:24,287 oidcmsg.oidc INFO Verified id_token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdXdRVjEzd3NUUmh5ZkJoM082cjRQYWdSZkI0allldk5naHlubm15U3lYVVl2VU8yeWJ6MnI3RElXbHNxeDVoanJ5UlczenotR1BZQ3A2Wkd4eTBIbDAyZjNndWo1LVBKTy05VFZaR29GTXhQWm9KRGNzVmRVeTN2UGZ1UDBNU2szMnZjZ21JbTgxOUkxeU4zd1QtVGN6dmJQYzJzeDVMeDZFUUE3Y1BIRGl3elQxWGNlYjhEMHF1NlIzSmNUbFYyRkduNWZSdkZTTF9HWEdoanFkUjZsS1E4T0xkbXVYR3ptRHVhbkNfQjZ5UHVDVGkzZUlQU0hoVjhjQm52Qy14di1mcQ==', 'auth_time': 1697573904, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '52f2d9d76d2a11ee8daa0242ac170004', 'client_id': 'jwt_test', 'nonce': 'WET0OfgnVzTPE8l3Q7XRGZgK', 'iss': 'https://satosa.idem.it', 'iat': 1697573904, 'exp': 1697574204, 'aud': ['jwt_test']}
2023-10-17 22:18:24,287 oidcrp.rp_handler DEBUG ID Token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdXdRVjEzd3NUUmh5ZkJoM082cjRQYWdSZkI0allldk5naHlubm15U3lYVVl2VU8yeWJ6MnI3RElXbHNxeDVoanJ5UlczenotR1BZQ3A2Wkd4eTBIbDAyZjNndWo1LVBKTy05VFZaR29GTXhQWm9KRGNzVmRVeTN2UGZ1UDBNU2szMnZjZ21JbTgxOUkxeU4zd1QtVGN6dmJQYzJzeDVMeDZFUUE3Y1BIRGl3elQxWGNlYjhEMHF1NlIzSmNUbFYyRkduNWZSdkZTTF9HWEdoanFkUjZsS1E4T0xkbXVYR3ptRHVhbkNfQjZ5UHVDVGkzZUlQU0hoVjhjQm52Qy14di1mcQ==', 'auth_time': 1697573904, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '52f2d9d76d2a11ee8daa0242ac170004', 'client_id': 'jwt_test', 'nonce': 'WET0OfgnVzTPE8l3Q7XRGZgK', 'iss': 'https://satosa.idem.it', 'iat': 1697573904, 'exp': 1697574204, 'aud': ['jwt_test']}
2023-10-17 22:18:24,287 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-17 22:18:24,288 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNmQ3OGFiMjA4YzM0NGU1NjgxMWEwNTUzYzE4ZjczMGQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWGRSVmpFemQzTlVVbWg1WmtKb00wODJjalJRWVdkU1prSTBhbGxsZGs1bmFIbHVibTE1VTNsWVZWbDJWVTh5ZVdKNk1uSTNSRWxYYkhOeGVEVm9hbko1VWxjemVub3RSMUJaUTNBMldrZDRlVEJJYkRBeVpqTm5kV28xTFZCS1R5MDVWRlphUjI5R1RYaFFXbTlLUkdOelZtUlZlVE4yVUdaMVVEQk5VMnN6TW5aaloyMUpiVGd4T1VreGVVNHpkMVF0VkdONmRtSlFZekp6ZURWTWVEWkZVVUUzWTFCSVJHbDNlbFF4V0dObFlqaEVNSEYxTmxJelNtTlViRll5UmtkdU5XWlNka1pUVEY5SFdFZG9hbkZrVWpac1MxRTRUMHhrYlhWWVIzcHRSSFZoYmtOZlFqWjVVSFZEVkdrelpVbFFVMGhvVmpoalFtNTJReTE0ZGkxbWNRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM5MDQsICJleHAiOiAxNjk3NTc3NTA0fQ.6tnqhDu9_dxR1ezQQHDZhEv29CPmiA35iAd12aBtHg_NyNmBLWGsaLEsFlxGm2eh3LpRA8fbdIzVEFuCbQxKsA'}
2023-10-17 22:18:24,288 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-17 22:18:24,288 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f38357df110>, 'url': 'https://satosa.idem.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNmQ3OGFiMjA4YzM0NGU1NjgxMWEwNTUzYzE4ZjczMGQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWGRSVmpFemQzTlVVbWg1WmtKb00wODJjalJRWVdkU1prSTBhbGxsZGs1bmFIbHVibTE1VTNsWVZWbDJWVTh5ZVdKNk1uSTNSRWxYYkhOeGVEVm9hbko1VWxjemVub3RSMUJaUTNBMldrZDRlVEJJYkRBeVpqTm5kV28xTFZCS1R5MDVWRlphUjI5R1RYaFFXbTlLUkdOelZtUlZlVE4yVUdaMVVEQk5VMnN6TW5aaloyMUpiVGd4T1VreGVVNHpkMVF0VkdONmRtSlFZekp6ZURWTWVEWkZVVUUzWTFCSVJHbDNlbFF4V0dObFlqaEVNSEYxTmxJelNtTlViRll5UmtkdU5XWlNka1pUVEY5SFdFZG9hbkZrVWpac1MxRTRUMHhrYlhWWVIzcHRSSFZoYmtOZlFqWjVVSFZEVkdrelpVbFFVMGhvVmpoalFtNTJReTE0ZGkxbWNRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM5MDQsICJleHAiOiAxNjk3NTc3NTA0fQ.6tnqhDu9_dxR1ezQQHDZhEv29CPmiA35iAd12aBtHg_NyNmBLWGsaLEsFlxGm2eh3LpRA8fbdIzVEFuCbQxKsA'}}
2023-10-17 22:18:24,288 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNmQ3OGFiMjA4YzM0NGU1NjgxMWEwNTUzYzE4ZjczMGQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kWGRSVmpFemQzTlVVbWg1WmtKb00wODJjalJRWVdkU1prSTBhbGxsZGs1bmFIbHVibTE1VTNsWVZWbDJWVTh5ZVdKNk1uSTNSRWxYYkhOeGVEVm9hbko1VWxjemVub3RSMUJaUTNBMldrZDRlVEJJYkRBeVpqTm5kV28xTFZCS1R5MDVWRlphUjI5R1RYaFFXbTlLUkdOelZtUlZlVE4yVUdaMVVEQk5VMnN6TW5aaloyMUpiVGd4T1VreGVVNHpkMVF0VkdONmRtSlFZekp6ZURWTWVEWkZVVUUzWTFCSVJHbDNlbFF4V0dObFlqaEVNSEYxTmxJelNtTlViRll5UmtkdU5XWlNka1pUVEY5SFdFZG9hbkZrVWpac1MxRTRUMHhrYlhWWVIzcHRSSFZoYmtOZlFqWjVVSFZEVkdrelpVbFFVMGhvVmpoalFtNTJReTE0ZGkxbWNRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzM5MDQsICJleHAiOiAxNjk3NTc3NTA0fQ.6tnqhDu9_dxR1ezQQHDZhEv29CPmiA35iAd12aBtHg_NyNmBLWGsaLEsFlxGm2eh3LpRA8fbdIzVEFuCbQxKsA'}
2023-10-17 22:18:24,288 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:18:24,424 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-17 22:18:24,424 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:18:24,425 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:18:24,425 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:18:24 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACwVShHf3R-axrvdfrfNVlggbCjuIjmpgbdnQ8rcudvnvWgWWvNGloDxnP9T3O2YLc98_TX6Em19iVmQ3XLpdCt4MVMFqoSQiTZrypVTkFNs5tTjN0xE1ogWunrOGRmqrl3iy2UGhdZAJZmaaMIq1XsbF4wkvJrn9zuJR5UCBr7hKphQmZLoa6uGZNSDxtnIncRnKV1EwZ9nYCtdSK3qBPgdbW4OUEdXjG0JQz8C6vzvVPzE19ViQgAAqNqHabZ_JDUAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACwVShHf3R-axrvdfrfNVlggbCjuIjmpgbdnQ8rcudvnvWgWWvNGloDxnP9T3O2YLc98_TX6Em19iVmQ3XLpdCt4MVMFqoSQiTZrypVTkFNs5tTjN0xE1ogWunrOGRmqrl3iy2UGhdZAJZmaaMIq1XsbF4wkvJrn9zuJR5UCBr7hKphQmZLoa6uGZNSDxtnIncRnKV1EwZ9nYCtdSK3qBPgdbW4OUEdXjG0JQz8C6vzvVPzE19ViQgAAqNqHabZ_JDUAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:18:24,425 oidcrp.util DEBUG resp.txt: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-17 22:18:24,425 oidcrp.oauth2 DEBUG Successful response: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-17 22:18:24,425 oidcrp.service DEBUG response format: json
2023-10-17 22:18:24,425 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-17 22:18:24,425 oidcrp.service DEBUG Initial response parsing => "{'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}"
2023-10-17 22:18:24,425 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-17 22:18:24,426 oidcrp.rp_handler DEBUG UserInfo: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}
2023-10-17 22:18:24,426 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:18:24] "GET /authz_cb/satosa?state=k6C4ODvGBlJqFDu9RhW7xUce825XTYjg&scope=offline_access+profile+openid&code=Z0FBQUFBQmxMdXdRWmUzY1Q3ZkhzTFlHVEJwazVaVTdGa0xlXzcyWVZuX2lvWDhpbDdsUWVuX3dsUlc0MTBVeE5PS2NGSGZrQWZoRnhzZTV1WWc1T3p0bURhUUQ1V1RYa0pkc2FUdmJYa1daN1QzdnBzQUNRS3RxVHExVlh4dGlQaWRyVUZJYnVjRVRWQ25uRE1TLTgwNGdfSEdxMGVOQ2NRcDJPdzBCc0kwUnp6Q0tOMzNoNVlfZHZUOW8tSWltckc3Nm5tODYyZ0xtZXNMNWZWeWR1RXB1R2Q3SUxaWURVbkZVbW4yQ3VQdTlsR2N3NjlXb2t3c3lMZ3dPLWIxY2hEbjBIUVBJa2hweE1nMEFFbXdOUkVMRDd1UXZkYld6U2NreVY2bmdqWFV4S21Cd0ZRV1lGRVFZQngwb25uWktkMk9iUlh6Z1NGZWtBNml3bGQwTEVidGZSX1NOZFRxZVV2YUNXUE5FelpNUHRLaFNJUUl1Yzc0ejU4VWRxdk1nM2dqUXRvQjZ0QmRKN1hIT1o5d0RhejRBMk4yN0lDeXZpRjk1NmFvTzItdFBPVXQ4Sll0bWlaTTJlWjJNdk55M1lOS2pRZVRuRDE3TC1jN2N4YnE1SlpycnRQamFjNDJDbDFhSGNWamRKNXQwTzF5a3FtUFhsMVBWN2lGUWFtUV9udVAwcTZYVjZob1BkTllYeFpadlpzV3EzbW5xMkQxbW9SWXYtS1FpTl9aelZXZTBkY1p4YklHSDE0bGY3TWdxWmsxNlJfMFFWUzFaZGs2Ul9UdURrdkY5RGVjdnFrMzBtT3ppbXRTVEFrTmtHakpxdlQyTVptcUQzbGVMNXlIaERnOU9lZ0FxNUZHVDBpY2VlMU9meW5oTkZKeVU5S05Vby0yVV9RQ0ZhNnU0QjR6TjB2TTJQdGM9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1" 200 -
2023-10-17 22:24:12,972 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:24:12] "GET / HTTP/1.1" 200 -
2023-10-17 22:24:21,401 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-17 22:24:21,401 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-17 22:24:21,401 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-17 22:24:21,401 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-17 22:24:21,433 oidcrp.rp_handler DEBUG Get provider info
2023-10-17 22:24:21,433 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-17 22:24:21,433 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-17 22:24:21,433 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-17 22:24:21,433 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:24:21,456 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-17 22:24:21,456 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:24:21,456 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:24:21,456 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:24:21 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldABiTSKdDXsIM2MeAA8vV9Gm41X-dDFLdBMbMzZafjyLpJE4vgdu8mEAw1GrddYL6rluojVkSzTXNbmvkmoGRuM56T5W8VLQiJ-1qF8fgKaP46xUpitT0UT1YRLaOFTvmMUHP7jHgFAfavkTPxDXC4akSYqqC4-IxNnrKOtzUnWG6SwMvhC25D_5qFv9P2qAQHYH2N4pH52DqyXRfqpWpzGcJtIcD1O9dAAWzk9y1epk0GwangDQ-SXIAAAAAAGyxPMyAGCQoAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldABiTSKdDXsIM2MeAA8vV9Gm41X-dDFLdBMbMzZafjyLpJE4vgdu8mEAw1GrddYL6rluojVkSzTXNbmvkmoGRuM56T5W8VLQiJ-1qF8fgKaP46xUpitT0UT1YRLaOFTvmMUHP7jHgFAfavkTPxDXC4akSYqqC4-IxNnrKOtzUnWG6SwMvhC25D_5qFv9P2qAQHYH2N4pH52DqyXRfqpWpzGcJtIcD1O9dAAWzk9y1epk0GwangDQ-SXIAAAAAAGyxPMyAGCQoAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:24:21,456 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 22:24:21,456 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-17 22:24:21,457 oidcrp.service DEBUG response format: json
2023-10-17 22:24:21,457 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-17 22:24:21,457 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-17 22:24:21,457 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-17 22:24:21,457 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-17 22:24:21,458 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-17 22:24:21,458 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:24:21,458 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:24:21,458 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:24:21,480 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-17 22:24:21,480 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:24:21,480 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-17 22:24:21,481 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-17 22:24:21,481 oidcrp.rp_handler DEBUG Do client registration
2023-10-17 22:24:21,481 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-17 22:24:21,481 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-17 22:24:21,481 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'wkNrJiip7RHHQ3Teh2rdFIJG', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'Jfh9yUXZ1M4aQlLCkPNY8tpUSGD4Z7yE'}
2023-10-17 22:24:21,482 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'wkNrJiip7RHHQ3Teh2rdFIJG', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'Jfh9yUXZ1M4aQlLCkPNY8tpUSGD4Z7yE', 'code_challenge': 'gsuKn4psGFwRapclsiofBkib6tATY8ERx-6umfg_smc', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-17 22:24:21,482 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f3836e47510>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=wkNrJiip7RHHQ3Teh2rdFIJG&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=Jfh9yUXZ1M4aQlLCkPNY8tpUSGD4Z7yE&code_challenge=gsuKn4psGFwRapclsiofBkib6tATY8ERx-6umfg_smc&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-17 22:24:21,482 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:24:21] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-17 22:24:33,884 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-17 22:24:33,884 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-17 22:24:33,884 oidcrp.service DEBUG response format: dict
2023-10-17 22:24:33,885 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-17 22:24:33,885 oidcrp.service DEBUG Initial response parsing => "{'state': 'Jfh9yUXZ1M4aQlLCkPNY8tpUSGD4Z7yE', 'scope': 'openid profile offline_access', 'code': 'Z0FBQUFBQmxMdTJCR3BGazBaVTY5TEQwSEdLSnk5N0NtWFRxSW5lYjE5Zm95MzdqYjRaWVRnY0dPRDdqUkR4YXdqYnZmX09oVjI0dlVrMDFtTmpYVVNOTFdQeHNncEg4LTI1bW90eFp6dzF4M0p1amk0dnY3QXEzTXZsalYwVGFhNUJlS3RoT2FEV2ZjQ3FOTURta1lMU21VTi12eER2QW9TeVlXV19EM3VOMjBCRXhYWjc4YmdiMmVIblVPSmw1ejl5aXM4MzFIYkozbGU4VF9nM2Q4bDJUcUR0MFZydXE3MDZCNzRTak85SVY5cFdWTW1BSGFfajJxc2tlQTdCNXF4anhNeDYxd2ZhLXR0cTh2WUhvY3FLUU5MNU9YZURmeDhWWmNfeGJjSnF2dlNyUG4taTc5VDk1TnVYZlhLZHFxcjlKOGlvcDM0ZVprR2FzenVVeXpSMDREWkpQTkFtWEFYa2tkc2hhLXpTS0U2ZkdpVkwwNEd2MGVKV3ZydmNjVll6Z3ZvS25pWDR4NEZzYWM2aGNXaXBjUHRMYlRfQU83REZZbTl6Sk9OczNrSWxndzBzekdLVm1vWUZsN0thOHpkck9FR1IxcjVJd3hhU29LSGRiZm0wdkFSN0lJU2hTN0xITDk4YXVwZV9kaGpzdmQyTURXQXk3WWFMczRrbHVvVWhLcHNaWk5FakQxY2NMVzA2VEEwSFZvTG14TlpuOWlzV0t1bUI3V1F0Z3QxYzFRcWN2TkxqV0piVGhNUzZocnZrRzFaYjM4V2kxcHlPSTdiVHA3ZFl5VVhwdElfZURkdmlweTR5SjdoazlLRV9GM2VlQkVqbGRUQktEQzJHVmdfT1c2M0RVNFFJUF92ZmNiZmlUeS1USi1TSzBoWTFZVEFoYS1qbzZ4SVhadHp0RUx6d3plZmM9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-17 22:24:33,885 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-17 22:24:33,885 oidcrp.rp_handler DEBUG Authz response: {'state': 'Jfh9yUXZ1M4aQlLCkPNY8tpUSGD4Z7yE', 'scope': 'openid profile offline_access', 'code': 'Z0FBQUFBQmxMdTJCR3BGazBaVTY5TEQwSEdLSnk5N0NtWFRxSW5lYjE5Zm95MzdqYjRaWVRnY0dPRDdqUkR4YXdqYnZmX09oVjI0dlVrMDFtTmpYVVNOTFdQeHNncEg4LTI1bW90eFp6dzF4M0p1amk0dnY3QXEzTXZsalYwVGFhNUJlS3RoT2FEV2ZjQ3FOTURta1lMU21VTi12eER2QW9TeVlXV19EM3VOMjBCRXhYWjc4YmdiMmVIblVPSmw1ejl5aXM4MzFIYkozbGU4VF9nM2Q4bDJUcUR0MFZydXE3MDZCNzRTak85SVY5cFdWTW1BSGFfajJxc2tlQTdCNXF4anhNeDYxd2ZhLXR0cTh2WUhvY3FLUU5MNU9YZURmeDhWWmNfeGJjSnF2dlNyUG4taTc5VDk1TnVYZlhLZHFxcjlKOGlvcDM0ZVprR2FzenVVeXpSMDREWkpQTkFtWEFYa2tkc2hhLXpTS0U2ZkdpVkwwNEd2MGVKV3ZydmNjVll6Z3ZvS25pWDR4NEZzYWM2aGNXaXBjUHRMYlRfQU83REZZbTl6Sk9OczNrSWxndzBzekdLVm1vWUZsN0thOHpkck9FR1IxcjVJd3hhU29LSGRiZm0wdkFSN0lJU2hTN0xITDk4YXVwZV9kaGpzdmQyTURXQXk3WWFMczRrbHVvVWhLcHNaWk5FakQxY2NMVzA2VEEwSFZvTG14TlpuOWlzV0t1bUI3V1F0Z3QxYzFRcWN2TkxqV0piVGhNUzZocnZrRzFaYjM4V2kxcHlPSTdiVHA3ZFl5VVhwdElfZURkdmlweTR5SjdoazlLRV9GM2VlQkVqbGRUQktEQzJHVmdfT1c2M0RVNFFJUF92ZmNiZmlUeS1USi1TSzBoWTFZVEFoYS1qbzZ4SVhadHp0RUx6d3plZmM9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-17 22:24:33,885 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-17 22:24:33,885 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-17 22:24:33,885 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMdTJCR3BGazBaVTY5TEQwSEdLSnk5N0NtWFRxSW5lYjE5Zm95MzdqYjRaWVRnY0dPRDdqUkR4YXdqYnZmX09oVjI0dlVrMDFtTmpYVVNOTFdQeHNncEg4LTI1bW90eFp6dzF4M0p1amk0dnY3QXEzTXZsalYwVGFhNUJlS3RoT2FEV2ZjQ3FOTURta1lMU21VTi12eER2QW9TeVlXV19EM3VOMjBCRXhYWjc4YmdiMmVIblVPSmw1ejl5aXM4MzFIYkozbGU4VF9nM2Q4bDJUcUR0MFZydXE3MDZCNzRTak85SVY5cFdWTW1BSGFfajJxc2tlQTdCNXF4anhNeDYxd2ZhLXR0cTh2WUhvY3FLUU5MNU9YZURmeDhWWmNfeGJjSnF2dlNyUG4taTc5VDk1TnVYZlhLZHFxcjlKOGlvcDM0ZVprR2FzenVVeXpSMDREWkpQTkFtWEFYa2tkc2hhLXpTS0U2ZkdpVkwwNEd2MGVKV3ZydmNjVll6Z3ZvS25pWDR4NEZzYWM2aGNXaXBjUHRMYlRfQU83REZZbTl6Sk9OczNrSWxndzBzekdLVm1vWUZsN0thOHpkck9FR1IxcjVJd3hhU29LSGRiZm0wdkFSN0lJU2hTN0xITDk4YXVwZV9kaGpzdmQyTURXQXk3WWFMczRrbHVvVWhLcHNaWk5FakQxY2NMVzA2VEEwSFZvTG14TlpuOWlzV0t1bUI3V1F0Z3QxYzFRcWN2TkxqV0piVGhNUzZocnZrRzFaYjM4V2kxcHlPSTdiVHA3ZFl5VVhwdElfZURkdmlweTR5SjdoazlLRV9GM2VlQkVqbGRUQktEQzJHVmdfT1c2M0RVNFFJUF92ZmNiZmlUeS1USi1TSzBoWTFZVEFoYS1qbzZ4SVhadHp0RUx6d3plZmM9', 'state': 'Jfh9yUXZ1M4aQlLCkPNY8tpUSGD4Z7yE', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-17 22:24:33,885 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'Jfh9yUXZ1M4aQlLCkPNY8tpUSGD4Z7yE', 'code': 'Z0FBQUFBQmxMdTJCR3BGazBaVTY5TEQwSEdLSnk5N0NtWFRxSW5lYjE5Zm95MzdqYjRaWVRnY0dPRDdqUkR4YXdqYnZmX09oVjI0dlVrMDFtTmpYVVNOTFdQeHNncEg4LTI1bW90eFp6dzF4M0p1amk0dnY3QXEzTXZsalYwVGFhNUJlS3RoT2FEV2ZjQ3FOTURta1lMU21VTi12eER2QW9TeVlXV19EM3VOMjBCRXhYWjc4YmdiMmVIblVPSmw1ejl5aXM4MzFIYkozbGU4VF9nM2Q4bDJUcUR0MFZydXE3MDZCNzRTak85SVY5cFdWTW1BSGFfajJxc2tlQTdCNXF4anhNeDYxd2ZhLXR0cTh2WUhvY3FLUU5MNU9YZURmeDhWWmNfeGJjSnF2dlNyUG4taTc5VDk1TnVYZlhLZHFxcjlKOGlvcDM0ZVprR2FzenVVeXpSMDREWkpQTkFtWEFYa2tkc2hhLXpTS0U2ZkdpVkwwNEd2MGVKV3ZydmNjVll6Z3ZvS25pWDR4NEZzYWM2aGNXaXBjUHRMYlRfQU83REZZbTl6Sk9OczNrSWxndzBzekdLVm1vWUZsN0thOHpkck9FR1IxcjVJd3hhU29LSGRiZm0wdkFSN0lJU2hTN0xITDk4YXVwZV9kaGpzdmQyTURXQXk3WWFMczRrbHVvVWhLcHNaWk5FakQxY2NMVzA2VEEwSFZvTG14TlpuOWlzV0t1bUI3V1F0Z3QxYzFRcWN2TkxqV0piVGhNUzZocnZrRzFaYjM4V2kxcHlPSTdiVHA3ZFl5VVhwdElfZURkdmlweTR5SjdoazlLRV9GM2VlQkVqbGRUQktEQzJHVmdfT1c2M0RVNFFJUF92ZmNiZmlUeS1USi1TSzBoWTFZVEFoYS1qbzZ4SVhadHp0RUx6d3plZmM9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'yl3uuW0Q9Mu6q2Y4bCTINBELGRMh6Fm0xn2SQdBtfjRUpFBfjpHTQuv9SKydyKXh'}
2023-10-17 22:24:33,885 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-17 22:24:33,885 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f38357ef990>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=Jfh9yUXZ1M4aQlLCkPNY8tpUSGD4Z7yE&code=Z0FBQUFBQmxMdTJCR3BGazBaVTY5TEQwSEdLSnk5N0NtWFRxSW5lYjE5Zm95MzdqYjRaWVRnY0dPRDdqUkR4YXdqYnZmX09oVjI0dlVrMDFtTmpYVVNOTFdQeHNncEg4LTI1bW90eFp6dzF4M0p1amk0dnY3QXEzTXZsalYwVGFhNUJlS3RoT2FEV2ZjQ3FOTURta1lMU21VTi12eER2QW9TeVlXV19EM3VOMjBCRXhYWjc4YmdiMmVIblVPSmw1ejl5aXM4MzFIYkozbGU4VF9nM2Q4bDJUcUR0MFZydXE3MDZCNzRTak85SVY5cFdWTW1BSGFfajJxc2tlQTdCNXF4anhNeDYxd2ZhLXR0cTh2WUhvY3FLUU5MNU9YZURmeDhWWmNfeGJjSnF2dlNyUG4taTc5VDk1TnVYZlhLZHFxcjlKOGlvcDM0ZVprR2FzenVVeXpSMDREWkpQTkFtWEFYa2tkc2hhLXpTS0U2ZkdpVkwwNEd2MGVKV3ZydmNjVll6Z3ZvS25pWDR4NEZzYWM2aGNXaXBjUHRMYlRfQU83REZZbTl6Sk9OczNrSWxndzBzekdLVm1vWUZsN0thOHpkck9FR1IxcjVJd3hhU29LSGRiZm0wdkFSN0lJU2hTN0xITDk4YXVwZV9kaGpzdmQyTURXQXk3WWFMczRrbHVvVWhLcHNaWk5FakQxY2NMVzA2VEEwSFZvTG14TlpuOWlzV0t1bUI3V1F0Z3QxYzFRcWN2TkxqV0piVGhNUzZocnZrRzFaYjM4V2kxcHlPSTdiVHA3ZFl5VVhwdElfZURkdmlweTR5SjdoazlLRV9GM2VlQkVqbGRUQktEQzJHVmdfT1c2M0RVNFFJUF92ZmNiZmlUeS1USi1TSzBoWTFZVEFoYS1qbzZ4SVhadHp0RUx6d3plZmM9&code_verifier=yl3uuW0Q9Mu6q2Y4bCTINBELGRMh6Fm0xn2SQdBtfjRUpFBfjpHTQuv9SKydyKXh', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-17 22:24:33,885 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=Jfh9yUXZ1M4aQlLCkPNY8tpUSGD4Z7yE&code=Z0FBQUFBQmxMdTJCR3BGazBaVTY5TEQwSEdLSnk5N0NtWFRxSW5lYjE5Zm95MzdqYjRaWVRnY0dPRDdqUkR4YXdqYnZmX09oVjI0dlVrMDFtTmpYVVNOTFdQeHNncEg4LTI1bW90eFp6dzF4M0p1amk0dnY3QXEzTXZsalYwVGFhNUJlS3RoT2FEV2ZjQ3FOTURta1lMU21VTi12eER2QW9TeVlXV19EM3VOMjBCRXhYWjc4YmdiMmVIblVPSmw1ejl5aXM4MzFIYkozbGU4VF9nM2Q4bDJUcUR0MFZydXE3MDZCNzRTak85SVY5cFdWTW1BSGFfajJxc2tlQTdCNXF4anhNeDYxd2ZhLXR0cTh2WUhvY3FLUU5MNU9YZURmeDhWWmNfeGJjSnF2dlNyUG4taTc5VDk1TnVYZlhLZHFxcjlKOGlvcDM0ZVprR2FzenVVeXpSMDREWkpQTkFtWEFYa2tkc2hhLXpTS0U2ZkdpVkwwNEd2MGVKV3ZydmNjVll6Z3ZvS25pWDR4NEZzYWM2aGNXaXBjUHRMYlRfQU83REZZbTl6Sk9OczNrSWxndzBzekdLVm1vWUZsN0thOHpkck9FR1IxcjVJd3hhU29LSGRiZm0wdkFSN0lJU2hTN0xITDk4YXVwZV9kaGpzdmQyTURXQXk3WWFMczRrbHVvVWhLcHNaWk5FakQxY2NMVzA2VEEwSFZvTG14TlpuOWlzV0t1bUI3V1F0Z3QxYzFRcWN2TkxqV0piVGhNUzZocnZrRzFaYjM4V2kxcHlPSTdiVHA3ZFl5VVhwdElfZURkdmlweTR5SjdoazlLRV9GM2VlQkVqbGRUQktEQzJHVmdfT1c2M0RVNFFJUF92ZmNiZmlUeS1USi1TSzBoWTFZVEFoYS1qbzZ4SVhadHp0RUx6d3plZmM9&code_verifier=yl3uuW0Q9Mu6q2Y4bCTINBELGRMh6Fm0xn2SQdBtfjRUpFBfjpHTQuv9SKydyKXh, https_args:{'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-17 22:24:33,886 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:24:34,054 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-17 22:24:34,055 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:24:34,055 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:24:34,055 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:24:34 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldABgdyOMxw7YHseM43-cP3W3fpdTUSqAVtyeeiqy4n3ogbZmODOLPV3bwJJhVg5qxqKmH5Sw8_wzu6D2PzgKZigfSTkiTpH8fdK4gTgMYpn43cE12X2T_et3JudBLVkPZgKSuGFrbUqg8CdkHqipvF_KeHOGkJ93w29YDzhtETdhWaOM8EY8noRgG9KHQyMEk646JlLj2HAig6RclryBqfEPuZJ1WSwlDZrvoNIDf9L3ywgmsk5I4cynQAAAAAPpJQHa5ON7PAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldABgdyOMxw7YHseM43-cP3W3fpdTUSqAVtyeeiqy4n3ogbZmODOLPV3bwJJhVg5qxqKmH5Sw8_wzu6D2PzgKZigfSTkiTpH8fdK4gTgMYpn43cE12X2T_et3JudBLVkPZgKSuGFrbUqg8CdkHqipvF_KeHOGkJ93w29YDzhtETdhWaOM8EY8noRgG9KHQyMEk646JlLj2HAig6RclryBqfEPuZJ1WSwlDZrvoNIDf9L3ywgmsk5I4cynQAAAAAPpJQHa5ON7PAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:24:34,055 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNDNiNTc4OWU5YjBkNDVlMzkxMTUyYzA2NTgxYTQxN2IiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVEpDY21KRVZsOW9lRTF6V1VWbE0xSmtSUzFrUVRCb09IQkNXQzFvVjIxQ2VISmpURnBLTTNoSk9GQnhkakpyTFRjd1pGcDJlRUk1VW5CTlNYRjBVbFpmVUVKUlNEZzRRUzF1WmtkbmFXRTViM0pVWTJaeVJtWkNkak5MV1RWd1VHcDBialJQYkZKdlpHOVNWazl2V1ZWU2REUXhjR2xsZDB4WFVqTkVVWFJoZDBreVFUazRObU5tVDJ4S1kwcFNXWEJNVG01RGNFUTNPVmROT1dwRE9UZEhObXA0UzFKZlZWSXdaazEzVGtOQk5UTldVR05OYzNaamFuaHpRV3BETXpWNFExWm1XVlpvZEcwM2NGTlplVkZ2TlhWa1VucHVXVnBrYUY5Uk5uZDFZMjFuYkhGWk5XbHRNVk5tYkhsVk4yNHlZamhsZUhGaVFtdHhPR3BYUWpVdFZBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzQyNzQsICJleHAiOiAxNjk3NTc3ODc0fQ.TjDU5tGf9Im5XZ9maqw4RTMkVxYceV6kd_YEwX9LBmRe-o5_5Mq6JJCEb_tung3sjDoqoS-HhIam5_7HDGqlYg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMdTJDMG5ZUXpCaTdONU9sZXdkd1NaMzZVWDFpRmdzUEI4eWQ2QmVBMXYzbmZnWFZTRmtPOVRXblRFb3NEUzdVaGhRWDI4Snd0T2FaVnEzOE5fUzVDX1UzbWtVNVY2ZXpsWHAwX2ZORXVsUURybDhXOTBkNGhlby1pbGpMbXllM0ozZVZuMjVBS2xidWdkWVVtWVFTc2hmaFJuNVRYN1A0NmwydW41QW5Oa2dreVVFdGVDaThoZFVoWjU5aHE2Qzd5RWVqcDR4bFdvNlFOWjVTXzRNcHliNDAxdFl2SGJwZm1fTmdmV3I1R3VoVGR6NG1GNkRld1FxQW4tVlo5QzQ4dVRtTXltVEExLUFUWW93c2c3cldldW9NQmRMRnlPdE9NZFZxd3JkQ29XcHJfX1ZRa0tqbVVacEFKelhmWHItVno4ZVFHNDZ6alRwVkhmNUdjU29EcjRYQ2w1ZVMyR1lXSk56Wms3b05kbWR4XzVuNzJLNVZ4aHdWV1lBWG50akwyYlI0dDlQS2R1M1ppaEx2eVJEMWpVc0tHdjFHbEowampqR2tKa3hvVUwycXI3Ul9LXzRyMWI0SzhNRkxOV0NQRTJGekVNd0N4dWxhaWJGYTJmRkQtbFphWHNwRVJwMGhJdmZQSmRiYUtqSWZ4Vkd2RE9rUHBDWXBrMGRvTHlJclI2WXFvNGhyQkpScnpKVm5fbzIwSDBsN0JkRFd2Skx6UVlEVFhpZ2QtR0d5WTF4MHdRRDJ1bU9ZR2pjYkM4cmVNTUxvSjdnRXBPTS1PZXNvaDlNdDJIeENUTDRyNWNjbUhFNldnTmtoLWRRWFZ6NnZ5X3JhR1RkSGl3aFQ1VmVtbTFLZW5DQ1dKcDFmVjRpSGJ4SGs5djBlRG1MOXluekZ2WXFFalhLTjZOQzRUcEU9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFRKQ2NtSkVWbDlvZUUxeldVVmxNMUprUlMxa1FUQm9PSEJDV0Mxb1YyMUNlSEpqVEZwS00zaEpPRkJ4ZGpKckxUY3daRnAyZUVJNVVuQk5TWEYwVWxaZlVFSlJTRGc0UVMxdVprZG5hV0U1YjNKVVkyWnlSbVpDZGpOTFdUVndVR3AwYmpSUGJGSnZaRzlTVms5dldWVlNkRFF4Y0dsbGQweFhVak5FVVhSaGQwa3lRVGs0Tm1ObVQyeEtZMHBTV1hCTVRtNURjRVEzT1ZkTk9XcERPVGRITm1wNFMxSmZWVkl3WmsxM1RrTkJOVE5XVUdOTmMzWmphbmh6UVdwRE16VjRRMVptV1Zab2RHMDNjRk5aZVZGdk5YVmtVbnB1V1Zwa2FGOVJObmQxWTIxbmJIRlpOV2x0TVZObWJIbFZOMjR5WWpobGVIRmlRbXR4T0dwWFFqVXRWQT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzQyNzMsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiMmY1OGI1NzY2ZDJiMTFlZWE2NmUwMjQyYWMxNzAwMDUiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIndrTnJKaWlwN1JISFEzVGVoMnJkRklKRyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTc0Mjc0LCAiZXhwIjogMTY5NzU3NDU3NCwgImF1ZCI6IFsiand0X3Rlc3QiXX0.XKtPDh7QneisoP5ds8BLsuO64JyQVXbXhMO5QqsROWqtTaLYPVyM5ofXKGVb7J4pYj3vy9q7qM77IFHUd7Now5iecUQHaDRnOACS2rApy40_Mzjbronf3-IVRHRvPuNVSIvH6fcbWTRMw074yAuEGDIQc8BvqrKS0we3N9_uZndLKD1QpeMaSimM7IIERXvSqMt3T-pt6Dfw1RmKYi13uQKeCdnyRT3k8-_bU5Z7HBa5DITiaHSxUHeg1hu9-Zlew6dI46jBiEATXP5zvcZvHPCAXJeuVPW2s3TYNirOH5VMA1aE5jcJF1yOjr5ehLP5VA8grgAGjmwnar5X1DF79w"}
2023-10-17 22:24:34,055 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNDNiNTc4OWU5YjBkNDVlMzkxMTUyYzA2NTgxYTQxN2IiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVEpDY21KRVZsOW9lRTF6V1VWbE0xSmtSUzFrUVRCb09IQkNXQzFvVjIxQ2VISmpURnBLTTNoSk9GQnhkakpyTFRjd1pGcDJlRUk1VW5CTlNYRjBVbFpmVUVKUlNEZzRRUzF1WmtkbmFXRTViM0pVWTJaeVJtWkNkak5MV1RWd1VHcDBialJQYkZKdlpHOVNWazl2V1ZWU2REUXhjR2xsZDB4WFVqTkVVWFJoZDBreVFUazRObU5tVDJ4S1kwcFNXWEJNVG01RGNFUTNPVmROT1dwRE9UZEhObXA0UzFKZlZWSXdaazEzVGtOQk5UTldVR05OYzNaamFuaHpRV3BETXpWNFExWm1XVlpvZEcwM2NGTlplVkZ2TlhWa1VucHVXVnBrYUY5Uk5uZDFZMjFuYkhGWk5XbHRNVk5tYkhsVk4yNHlZamhsZUhGaVFtdHhPR3BYUWpVdFZBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzQyNzQsICJleHAiOiAxNjk3NTc3ODc0fQ.TjDU5tGf9Im5XZ9maqw4RTMkVxYceV6kd_YEwX9LBmRe-o5_5Mq6JJCEb_tung3sjDoqoS-HhIam5_7HDGqlYg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMdTJDMG5ZUXpCaTdONU9sZXdkd1NaMzZVWDFpRmdzUEI4eWQ2QmVBMXYzbmZnWFZTRmtPOVRXblRFb3NEUzdVaGhRWDI4Snd0T2FaVnEzOE5fUzVDX1UzbWtVNVY2ZXpsWHAwX2ZORXVsUURybDhXOTBkNGhlby1pbGpMbXllM0ozZVZuMjVBS2xidWdkWVVtWVFTc2hmaFJuNVRYN1A0NmwydW41QW5Oa2dreVVFdGVDaThoZFVoWjU5aHE2Qzd5RWVqcDR4bFdvNlFOWjVTXzRNcHliNDAxdFl2SGJwZm1fTmdmV3I1R3VoVGR6NG1GNkRld1FxQW4tVlo5QzQ4dVRtTXltVEExLUFUWW93c2c3cldldW9NQmRMRnlPdE9NZFZxd3JkQ29XcHJfX1ZRa0tqbVVacEFKelhmWHItVno4ZVFHNDZ6alRwVkhmNUdjU29EcjRYQ2w1ZVMyR1lXSk56Wms3b05kbWR4XzVuNzJLNVZ4aHdWV1lBWG50akwyYlI0dDlQS2R1M1ppaEx2eVJEMWpVc0tHdjFHbEowampqR2tKa3hvVUwycXI3Ul9LXzRyMWI0SzhNRkxOV0NQRTJGekVNd0N4dWxhaWJGYTJmRkQtbFphWHNwRVJwMGhJdmZQSmRiYUtqSWZ4Vkd2RE9rUHBDWXBrMGRvTHlJclI2WXFvNGhyQkpScnpKVm5fbzIwSDBsN0JkRFd2Skx6UVlEVFhpZ2QtR0d5WTF4MHdRRDJ1bU9ZR2pjYkM4cmVNTUxvSjdnRXBPTS1PZXNvaDlNdDJIeENUTDRyNWNjbUhFNldnTmtoLWRRWFZ6NnZ5X3JhR1RkSGl3aFQ1VmVtbTFLZW5DQ1dKcDFmVjRpSGJ4SGs5djBlRG1MOXluekZ2WXFFalhLTjZOQzRUcEU9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFRKQ2NtSkVWbDlvZUUxeldVVmxNMUprUlMxa1FUQm9PSEJDV0Mxb1YyMUNlSEpqVEZwS00zaEpPRkJ4ZGpKckxUY3daRnAyZUVJNVVuQk5TWEYwVWxaZlVFSlJTRGc0UVMxdVprZG5hV0U1YjNKVVkyWnlSbVpDZGpOTFdUVndVR3AwYmpSUGJGSnZaRzlTVms5dldWVlNkRFF4Y0dsbGQweFhVak5FVVhSaGQwa3lRVGs0Tm1ObVQyeEtZMHBTV1hCTVRtNURjRVEzT1ZkTk9XcERPVGRITm1wNFMxSmZWVkl3WmsxM1RrTkJOVE5XVUdOTmMzWmphbmh6UVdwRE16VjRRMVptV1Zab2RHMDNjRk5aZVZGdk5YVmtVbnB1V1Zwa2FGOVJObmQxWTIxbmJIRlpOV2x0TVZObWJIbFZOMjR5WWpobGVIRmlRbXR4T0dwWFFqVXRWQT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzQyNzMsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiMmY1OGI1NzY2ZDJiMTFlZWE2NmUwMjQyYWMxNzAwMDUiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIndrTnJKaWlwN1JISFEzVGVoMnJkRklKRyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTc0Mjc0LCAiZXhwIjogMTY5NzU3NDU3NCwgImF1ZCI6IFsiand0X3Rlc3QiXX0.XKtPDh7QneisoP5ds8BLsuO64JyQVXbXhMO5QqsROWqtTaLYPVyM5ofXKGVb7J4pYj3vy9q7qM77IFHUd7Now5iecUQHaDRnOACS2rApy40_Mzjbronf3-IVRHRvPuNVSIvH6fcbWTRMw074yAuEGDIQc8BvqrKS0we3N9_uZndLKD1QpeMaSimM7IIERXvSqMt3T-pt6Dfw1RmKYi13uQKeCdnyRT3k8-_bU5Z7HBa5DITiaHSxUHeg1hu9-Zlew6dI46jBiEATXP5zvcZvHPCAXJeuVPW2s3TYNirOH5VMA1aE5jcJF1yOjr5ehLP5VA8grgAGjmwnar5X1DF79w"}
2023-10-17 22:24:34,055 oidcrp.service DEBUG response format: json
2023-10-17 22:24:34,055 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-17 22:24:34,055 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNDNiNTc4OWU5YjBkNDVlMzkxMTUyYzA2NTgxYTQxN2IiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVEpDY21KRVZsOW9lRTF6V1VWbE0xSmtSUzFrUVRCb09IQkNXQzFvVjIxQ2VISmpURnBLTTNoSk9GQnhkakpyTFRjd1pGcDJlRUk1VW5CTlNYRjBVbFpmVUVKUlNEZzRRUzF1WmtkbmFXRTViM0pVWTJaeVJtWkNkak5MV1RWd1VHcDBialJQYkZKdlpHOVNWazl2V1ZWU2REUXhjR2xsZDB4WFVqTkVVWFJoZDBreVFUazRObU5tVDJ4S1kwcFNXWEJNVG01RGNFUTNPVmROT1dwRE9UZEhObXA0UzFKZlZWSXdaazEzVGtOQk5UTldVR05OYzNaamFuaHpRV3BETXpWNFExWm1XVlpvZEcwM2NGTlplVkZ2TlhWa1VucHVXVnBrYUY5Uk5uZDFZMjFuYkhGWk5XbHRNVk5tYkhsVk4yNHlZamhsZUhGaVFtdHhPR3BYUWpVdFZBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzQyNzQsICJleHAiOiAxNjk3NTc3ODc0fQ.TjDU5tGf9Im5XZ9maqw4RTMkVxYceV6kd_YEwX9LBmRe-o5_5Mq6JJCEb_tung3sjDoqoS-HhIam5_7HDGqlYg', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxMdTJDMG5ZUXpCaTdONU9sZXdkd1NaMzZVWDFpRmdzUEI4eWQ2QmVBMXYzbmZnWFZTRmtPOVRXblRFb3NEUzdVaGhRWDI4Snd0T2FaVnEzOE5fUzVDX1UzbWtVNVY2ZXpsWHAwX2ZORXVsUURybDhXOTBkNGhlby1pbGpMbXllM0ozZVZuMjVBS2xidWdkWVVtWVFTc2hmaFJuNVRYN1A0NmwydW41QW5Oa2dreVVFdGVDaThoZFVoWjU5aHE2Qzd5RWVqcDR4bFdvNlFOWjVTXzRNcHliNDAxdFl2SGJwZm1fTmdmV3I1R3VoVGR6NG1GNkRld1FxQW4tVlo5QzQ4dVRtTXltVEExLUFUWW93c2c3cldldW9NQmRMRnlPdE9NZFZxd3JkQ29XcHJfX1ZRa0tqbVVacEFKelhmWHItVno4ZVFHNDZ6alRwVkhmNUdjU29EcjRYQ2w1ZVMyR1lXSk56Wms3b05kbWR4XzVuNzJLNVZ4aHdWV1lBWG50akwyYlI0dDlQS2R1M1ppaEx2eVJEMWpVc0tHdjFHbEowampqR2tKa3hvVUwycXI3Ul9LXzRyMWI0SzhNRkxOV0NQRTJGekVNd0N4dWxhaWJGYTJmRkQtbFphWHNwRVJwMGhJdmZQSmRiYUtqSWZ4Vkd2RE9rUHBDWXBrMGRvTHlJclI2WXFvNGhyQkpScnpKVm5fbzIwSDBsN0JkRFd2Skx6UVlEVFhpZ2QtR0d5WTF4MHdRRDJ1bU9ZR2pjYkM4cmVNTUxvSjdnRXBPTS1PZXNvaDlNdDJIeENUTDRyNWNjbUhFNldnTmtoLWRRWFZ6NnZ5X3JhR1RkSGl3aFQ1VmVtbTFLZW5DQ1dKcDFmVjRpSGJ4SGs5djBlRG1MOXluekZ2WXFFalhLTjZOQzRUcEU9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNZFRKQ2NtSkVWbDlvZUUxeldVVmxNMUprUlMxa1FUQm9PSEJDV0Mxb1YyMUNlSEpqVEZwS00zaEpPRkJ4ZGpKckxUY3daRnAyZUVJNVVuQk5TWEYwVWxaZlVFSlJTRGc0UVMxdVprZG5hV0U1YjNKVVkyWnlSbVpDZGpOTFdUVndVR3AwYmpSUGJGSnZaRzlTVms5dldWVlNkRFF4Y0dsbGQweFhVak5FVVhSaGQwa3lRVGs0Tm1ObVQyeEtZMHBTV1hCTVRtNURjRVEzT1ZkTk9XcERPVGRITm1wNFMxSmZWVkl3WmsxM1RrTkJOVE5XVUdOTmMzWmphbmh6UVdwRE16VjRRMVptV1Zab2RHMDNjRk5aZVZGdk5YVmtVbnB1V1Zwa2FGOVJObmQxWTIxbmJIRlpOV2x0TVZObWJIbFZOMjR5WWpobGVIRmlRbXR4T0dwWFFqVXRWQT09IiwgImF1dGhfdGltZSI6IDE2OTc1NzQyNzMsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiMmY1OGI1NzY2ZDJiMTFlZWE2NmUwMjQyYWMxNzAwMDUiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIndrTnJKaWlwN1JISFEzVGVoMnJkRklKRyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NTc0Mjc0LCAiZXhwIjogMTY5NzU3NDU3NCwgImF1ZCI6IFsiand0X3Rlc3QiXX0.XKtPDh7QneisoP5ds8BLsuO64JyQVXbXhMO5QqsROWqtTaLYPVyM5ofXKGVb7J4pYj3vy9q7qM77IFHUd7Now5iecUQHaDRnOACS2rApy40_Mzjbronf3-IVRHRvPuNVSIvH6fcbWTRMw074yAuEGDIQc8BvqrKS0we3N9_uZndLKD1QpeMaSimM7IIERXvSqMt3T-pt6Dfw1RmKYi13uQKeCdnyRT3k8-_bU5Z7HBa5DITiaHSxUHeg1hu9-Zlew6dI46jBiEATXP5zvcZvHPCAXJeuVPW2s3TYNirOH5VMA1aE5jcJF1yOjr5ehLP5VA8grgAGjmwnar5X1DF79w'}"
2023-10-17 22:24:34,055 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-17 22:24:34,055 oidcmsg.message DEBUG Raw JSON: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdTJCcmJEVl9oeE1zWUVlM1JkRS1kQTBoOHBCWC1oV21CeHJjTFpKM3hJOFBxdjJrLTcwZFp2eEI5UnBNSXF0UlZfUEJRSDg4QS1uZkdnaWE5b3JUY2ZyRmZCdjNLWTVwUGp0bjRPbFJvZG9SVk9vWVVSdDQxcGlld0xXUjNEUXRhd0kyQTk4NmNmT2xKY0pSWXBMTm5DcEQ3OVdNOWpDOTdHNmp4S1JfVVIwZk13TkNBNTNWUGNNc3ZjanhzQWpDMzV4Q1ZmWVZodG03cFNZeVFvNXVkUnpuWVpkaF9RNnd1Y21nbHFZNWltMVNmbHlVN24yYjhleHFiQmtxOGpXQjUtVA==', 'auth_time': 1697574273, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '2f58b5766d2b11eea66e0242ac170005', 'client_id': 'jwt_test', 'nonce': 'wkNrJiip7RHHQ3Teh2rdFIJG', 'iss': 'https://satosa.idem.it', 'iat': 1697574274, 'exp': 1697574574, 'aud': ['jwt_test']}
2023-10-17 22:24:34,055 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA'}
2023-10-17 22:24:34,055 cryptojwt.key_jar DEBUG Key summary for https://satosa.idem.it: RSA:sig:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, EC:sig:LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw
2023-10-17 22:24:34,055 oidcmsg.message DEBUG Found signing key.
2023-10-17 22:24:34,055 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-17 22:24:34,055 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA and use=
2023-10-17 22:24:34,055 cryptojwt.jwx DEBUG Picked: kid:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, use:sig, kty:RSA
2023-10-17 22:24:34,056 cryptojwt.jws.jws DEBUG Verified message using key with kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA
2023-10-17 22:24:34,056 oidcmsg.oidc INFO Verified id_token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdTJCcmJEVl9oeE1zWUVlM1JkRS1kQTBoOHBCWC1oV21CeHJjTFpKM3hJOFBxdjJrLTcwZFp2eEI5UnBNSXF0UlZfUEJRSDg4QS1uZkdnaWE5b3JUY2ZyRmZCdjNLWTVwUGp0bjRPbFJvZG9SVk9vWVVSdDQxcGlld0xXUjNEUXRhd0kyQTk4NmNmT2xKY0pSWXBMTm5DcEQ3OVdNOWpDOTdHNmp4S1JfVVIwZk13TkNBNTNWUGNNc3ZjanhzQWpDMzV4Q1ZmWVZodG03cFNZeVFvNXVkUnpuWVpkaF9RNnd1Y21nbHFZNWltMVNmbHlVN24yYjhleHFiQmtxOGpXQjUtVA==', 'auth_time': 1697574273, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '2f58b5766d2b11eea66e0242ac170005', 'client_id': 'jwt_test', 'nonce': 'wkNrJiip7RHHQ3Teh2rdFIJG', 'iss': 'https://satosa.idem.it', 'iat': 1697574274, 'exp': 1697574574, 'aud': ['jwt_test']}
2023-10-17 22:24:34,056 oidcrp.rp_handler DEBUG ID Token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMdTJCcmJEVl9oeE1zWUVlM1JkRS1kQTBoOHBCWC1oV21CeHJjTFpKM3hJOFBxdjJrLTcwZFp2eEI5UnBNSXF0UlZfUEJRSDg4QS1uZkdnaWE5b3JUY2ZyRmZCdjNLWTVwUGp0bjRPbFJvZG9SVk9vWVVSdDQxcGlld0xXUjNEUXRhd0kyQTk4NmNmT2xKY0pSWXBMTm5DcEQ3OVdNOWpDOTdHNmp4S1JfVVIwZk13TkNBNTNWUGNNc3ZjanhzQWpDMzV4Q1ZmWVZodG03cFNZeVFvNXVkUnpuWVpkaF9RNnd1Y21nbHFZNWltMVNmbHlVN24yYjhleHFiQmtxOGpXQjUtVA==', 'auth_time': 1697574273, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '2f58b5766d2b11eea66e0242ac170005', 'client_id': 'jwt_test', 'nonce': 'wkNrJiip7RHHQ3Teh2rdFIJG', 'iss': 'https://satosa.idem.it', 'iat': 1697574274, 'exp': 1697574574, 'aud': ['jwt_test']}
2023-10-17 22:24:34,056 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-17 22:24:34,057 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNDNiNTc4OWU5YjBkNDVlMzkxMTUyYzA2NTgxYTQxN2IiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVEpDY21KRVZsOW9lRTF6V1VWbE0xSmtSUzFrUVRCb09IQkNXQzFvVjIxQ2VISmpURnBLTTNoSk9GQnhkakpyTFRjd1pGcDJlRUk1VW5CTlNYRjBVbFpmVUVKUlNEZzRRUzF1WmtkbmFXRTViM0pVWTJaeVJtWkNkak5MV1RWd1VHcDBialJQYkZKdlpHOVNWazl2V1ZWU2REUXhjR2xsZDB4WFVqTkVVWFJoZDBreVFUazRObU5tVDJ4S1kwcFNXWEJNVG01RGNFUTNPVmROT1dwRE9UZEhObXA0UzFKZlZWSXdaazEzVGtOQk5UTldVR05OYzNaamFuaHpRV3BETXpWNFExWm1XVlpvZEcwM2NGTlplVkZ2TlhWa1VucHVXVnBrYUY5Uk5uZDFZMjFuYkhGWk5XbHRNVk5tYkhsVk4yNHlZamhsZUhGaVFtdHhPR3BYUWpVdFZBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzQyNzQsICJleHAiOiAxNjk3NTc3ODc0fQ.TjDU5tGf9Im5XZ9maqw4RTMkVxYceV6kd_YEwX9LBmRe-o5_5Mq6JJCEb_tung3sjDoqoS-HhIam5_7HDGqlYg'}
2023-10-17 22:24:34,057 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-17 22:24:34,057 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f38345dee90>, 'url': 'https://satosa.idem.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNDNiNTc4OWU5YjBkNDVlMzkxMTUyYzA2NTgxYTQxN2IiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVEpDY21KRVZsOW9lRTF6V1VWbE0xSmtSUzFrUVRCb09IQkNXQzFvVjIxQ2VISmpURnBLTTNoSk9GQnhkakpyTFRjd1pGcDJlRUk1VW5CTlNYRjBVbFpmVUVKUlNEZzRRUzF1WmtkbmFXRTViM0pVWTJaeVJtWkNkak5MV1RWd1VHcDBialJQYkZKdlpHOVNWazl2V1ZWU2REUXhjR2xsZDB4WFVqTkVVWFJoZDBreVFUazRObU5tVDJ4S1kwcFNXWEJNVG01RGNFUTNPVmROT1dwRE9UZEhObXA0UzFKZlZWSXdaazEzVGtOQk5UTldVR05OYzNaamFuaHpRV3BETXpWNFExWm1XVlpvZEcwM2NGTlplVkZ2TlhWa1VucHVXVnBrYUY5Uk5uZDFZMjFuYkhGWk5XbHRNVk5tYkhsVk4yNHlZamhsZUhGaVFtdHhPR3BYUWpVdFZBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzQyNzQsICJleHAiOiAxNjk3NTc3ODc0fQ.TjDU5tGf9Im5XZ9maqw4RTMkVxYceV6kd_YEwX9LBmRe-o5_5Mq6JJCEb_tung3sjDoqoS-HhIam5_7HDGqlYg'}}
2023-10-17 22:24:34,057 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNDNiNTc4OWU5YjBkNDVlMzkxMTUyYzA2NTgxYTQxN2IiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1kVEpDY21KRVZsOW9lRTF6V1VWbE0xSmtSUzFrUVRCb09IQkNXQzFvVjIxQ2VISmpURnBLTTNoSk9GQnhkakpyTFRjd1pGcDJlRUk1VW5CTlNYRjBVbFpmVUVKUlNEZzRRUzF1WmtkbmFXRTViM0pVWTJaeVJtWkNkak5MV1RWd1VHcDBialJQYkZKdlpHOVNWazl2V1ZWU2REUXhjR2xsZDB4WFVqTkVVWFJoZDBreVFUazRObU5tVDJ4S1kwcFNXWEJNVG01RGNFUTNPVmROT1dwRE9UZEhObXA0UzFKZlZWSXdaazEzVGtOQk5UTldVR05OYzNaamFuaHpRV3BETXpWNFExWm1XVlpvZEcwM2NGTlplVkZ2TlhWa1VucHVXVnBrYUY5Uk5uZDFZMjFuYkhGWk5XbHRNVk5tYkhsVk4yNHlZamhsZUhGaVFtdHhPR3BYUWpVdFZBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc1NzQyNzQsICJleHAiOiAxNjk3NTc3ODc0fQ.TjDU5tGf9Im5XZ9maqw4RTMkVxYceV6kd_YEwX9LBmRe-o5_5Mq6JJCEb_tung3sjDoqoS-HhIam5_7HDGqlYg'}
2023-10-17 22:24:34,057 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-17 22:24:34,199 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-17 22:24:34,199 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-17 22:24:34,199 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-17 22:24:34,199 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Tue, 17 Oct 2023 20:24:34 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdADiVhgfPIBcVhTNiWlq071Xxdpl8l6hiNi9rV3JUX0IPllPDcpOgzvrv1vByC1uWxXnmJ1XemS134DivNIhnk_cTtRbsVFW6Am4AYFW3_55ioG6pF7DEZUgd4-s4hEq9bQEQcKoJp613BlR-pD6_RKJqgy1T0jYT0dEDs4jKO0WpmjMhUEBaD9XI1MHj4tbK4lvRAmtKSV1AInTh_dmPtHAlN8P4--ElrFBGA9Fk23S_Zwhf_ZlXfXphJwAAACyrVwCFJFxhAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdADiVhgfPIBcVhTNiWlq071Xxdpl8l6hiNi9rV3JUX0IPllPDcpOgzvrv1vByC1uWxXnmJ1XemS134DivNIhnk_cTtRbsVFW6Am4AYFW3_55ioG6pF7DEZUgd4-s4hEq9bQEQcKoJp613BlR-pD6_RKJqgy1T0jYT0dEDs4jKO0WpmjMhUEBaD9XI1MHj4tbK4lvRAmtKSV1AInTh_dmPtHAlN8P4--ElrFBGA9Fk23S_Zwhf_ZlXfXphJwAAACyrVwCFJFxhAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-17 22:24:34,199 oidcrp.util DEBUG resp.txt: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-17 22:24:34,199 oidcrp.oauth2 DEBUG Successful response: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-17 22:24:34,199 oidcrp.service DEBUG response format: json
2023-10-17 22:24:34,199 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-17 22:24:34,199 oidcrp.service DEBUG Initial response parsing => "{'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}"
2023-10-17 22:24:34,199 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-17 22:24:34,200 oidcrp.rp_handler DEBUG UserInfo: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}
2023-10-17 22:24:34,201 werkzeug INFO 127.0.0.1 - - [17/Oct/2023 22:24:34] "GET /authz_cb/satosa?state=Jfh9yUXZ1M4aQlLCkPNY8tpUSGD4Z7yE&scope=openid+profile+offline_access&code=Z0FBQUFBQmxMdTJCR3BGazBaVTY5TEQwSEdLSnk5N0NtWFRxSW5lYjE5Zm95MzdqYjRaWVRnY0dPRDdqUkR4YXdqYnZmX09oVjI0dlVrMDFtTmpYVVNOTFdQeHNncEg4LTI1bW90eFp6dzF4M0p1amk0dnY3QXEzTXZsalYwVGFhNUJlS3RoT2FEV2ZjQ3FOTURta1lMU21VTi12eER2QW9TeVlXV19EM3VOMjBCRXhYWjc4YmdiMmVIblVPSmw1ejl5aXM4MzFIYkozbGU4VF9nM2Q4bDJUcUR0MFZydXE3MDZCNzRTak85SVY5cFdWTW1BSGFfajJxc2tlQTdCNXF4anhNeDYxd2ZhLXR0cTh2WUhvY3FLUU5MNU9YZURmeDhWWmNfeGJjSnF2dlNyUG4taTc5VDk1TnVYZlhLZHFxcjlKOGlvcDM0ZVprR2FzenVVeXpSMDREWkpQTkFtWEFYa2tkc2hhLXpTS0U2ZkdpVkwwNEd2MGVKV3ZydmNjVll6Z3ZvS25pWDR4NEZzYWM2aGNXaXBjUHRMYlRfQU83REZZbTl6Sk9OczNrSWxndzBzekdLVm1vWUZsN0thOHpkck9FR1IxcjVJd3hhU29LSGRiZm0wdkFSN0lJU2hTN0xITDk4YXVwZV9kaGpzdmQyTURXQXk3WWFMczRrbHVvVWhLcHNaWk5FakQxY2NMVzA2VEEwSFZvTG14TlpuOWlzV0t1bUI3V1F0Z3QxYzFRcWN2TkxqV0piVGhNUzZocnZrRzFaYjM4V2kxcHlPSTdiVHA3ZFl5VVhwdElfZURkdmlweTR5SjdoazlLRV9GM2VlQkVqbGRUQktEQzJHVmdfT1c2M0RVNFFJUF92ZmNiZmlUeS1USi1TSzBoWTFZVEFoYS1qbzZ4SVhadHp0RUx6d3plZmM9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1" 200 -
2023-10-18 10:42:15,392 root DEBUG Configured logging using dictionary
2023-10-18 10:42:15,436 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-18 10:42:15,436 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-18 10:42:15,436 werkzeug INFO  * Restarting with stat
2023-10-18 10:42:15,619 root DEBUG Configured logging using dictionary
2023-10-18 10:42:15,658 werkzeug WARNING  * Debugger is active!
2023-10-18 10:42:15,658 werkzeug INFO  * Debugger PIN: 491-689-569
2023-10-18 10:42:23,218 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 10:42:23] "GET / HTTP/1.1" 200 -
2023-10-18 10:42:27,078 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-18 10:42:27,079 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-18 10:42:27,079 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-18 10:42:27,079 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-18 10:42:27,124 oidcrp.rp_handler DEBUG Get provider info
2023-10-18 10:42:27,124 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-18 10:42:27,124 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-18 10:42:27,124 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-18 10:42:27,126 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 10:42:27,145 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-18 10:42:27,146 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 10:42:27,146 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 10:42:27,146 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 08:42:27 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdABwbQiMik7jC2c2uAvfSha3hwqb6i0bG9GJ1qWXPoP88KIUp4Rhnn-O2rNGG3u1qB2o4j87KFwHlfAp4WVg_d4Kqpqx170K_U5wyXE4eS00NFQALQMJmhTnDPRfMHry-OBRJCXdtYcXJ-maLXHvm47NWyz5vcytlgpUfVvh0alOoNI13LdW36pkgxaSKxCryMY9rtV70Pg-Enmo83vNT5EggGnL8xbhEuWRpB5RtglCnxgtSMnwU29qdPQAAAKjj9vkFE-FIAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdABwbQiMik7jC2c2uAvfSha3hwqb6i0bG9GJ1qWXPoP88KIUp4Rhnn-O2rNGG3u1qB2o4j87KFwHlfAp4WVg_d4Kqpqx170K_U5wyXE4eS00NFQALQMJmhTnDPRfMHry-OBRJCXdtYcXJ-maLXHvm47NWyz5vcytlgpUfVvh0alOoNI13LdW36pkgxaSKxCryMY9rtV70Pg-Enmo83vNT5EggGnL8xbhEuWRpB5RtglCnxgtSMnwU29qdPQAAAKjj9vkFE-FIAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 10:42:27,146 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-18 10:42:27,146 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-18 10:42:27,146 oidcrp.service DEBUG response format: json
2023-10-18 10:42:27,146 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-18 10:42:27,146 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-18 10:42:27,146 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-18 10:42:27,147 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-18 10:42:27,147 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-18 10:42:27,147 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 10:42:27,147 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-18 10:42:27,147 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 10:42:27,170 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-18 10:42:27,171 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 10:42:27,171 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 10:42:27,172 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-18 10:42:27,172 oidcrp.rp_handler DEBUG Do client registration
2023-10-18 10:42:27,172 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-18 10:42:27,172 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-18 10:42:27,172 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access'], 'response_type': 'code', 'nonce': 'u37DsTaWnIRu8IX2Mah9MGJJ', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': '6TI9yBwBCg6Ir30jKocZl4Xe9upxJnZS'}
2023-10-18 10:42:27,172 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access', 'response_type': 'code', 'nonce': 'u37DsTaWnIRu8IX2Mah9MGJJ', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': '6TI9yBwBCg6Ir30jKocZl4Xe9upxJnZS', 'code_challenge': 'I2zlzevW1MzCes1mXtzK-zXoQMjVuS67LHVB0eQq65k', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-18 10:42:27,173 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7faad2fc2f90>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access&response_type=code&nonce=u37DsTaWnIRu8IX2Mah9MGJJ&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=6TI9yBwBCg6Ir30jKocZl4Xe9upxJnZS&code_challenge=I2zlzevW1MzCes1mXtzK-zXoQMjVuS67LHVB0eQq65k&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-18 10:42:27,173 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 10:42:27] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-18 10:42:36,867 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-18 10:42:36,867 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-18 10:42:36,867 oidcrp.service DEBUG response format: dict
2023-10-18 10:42:36,867 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-18 10:42:36,867 oidcrp.service DEBUG Initial response parsing => "{'state': '6TI9yBwBCg6Ir30jKocZl4Xe9upxJnZS', 'scope': 'profile openid offline_access', 'code': 'Z0FBQUFBQmxMNXA4RjF6cW1TTnVORTEyQlg4Ynk2Z0FRM25NdzFkeThCWGVKZ1VhbWh0Z3kxbHRYRjJMcGJYMXY4ZlZrU2UwYnh4N0J3VW5LQ1NIYnV4S3FwZTZSaDUyNS1ranZrZFQxbVdidWFvd2E3WUhHMmZRSVpPb1VkRW9qS1luaWN0bjhkNEJBdHJrX0dzekZQbmo5RzhfLTlacE84VHhxd2ZiZnpGajNlZlJDV0dnSFFndVNabEVnbUFKWGhxekdMWkN0bVB2T1o1M0pIT0hxbEtKQ3MzclVMLVJNNDdQd1hvVTRwVEtHVFlIcE9HVFZZcDlQX2t6Z2tIS3pMbkZnRVB6NnZYMHctQjNQVVF6VE0xWmY1TmtmbDE4bE5sZ2NtM1p2dFZFNTJkRDFXenJZQ3dkQ3V4SG9FZW8zRUFNcHpXeWNfdkhzQlkxWFVOcEg2SFdpenhMbnRtTy1OODRKcjlrdjNYSnVGcEF5Nmp3cmdmYTZvVi1rWHBmeVoxU1pPSDF0UnlGSXJ0aGNmR1BsNnRMYUljeENxa1BSek1JS3pfa0hsRF8xTDg4ckdZbUl4MTdya3dtWl9pV3FtOE44ZUxZSHY1Zm1XRVNWSXR3Y1IwX21MTlh2WTNTM3U1U1pvYjZSLThmWm56a3I5UXlJQ2JTRHRWM2UzM2xuVHJhTGRFT19pRXl5MzA1ZzVRTGRvTW96U1VBX1JuZkRPNV9mRTJuTzRkRi1tTmg0S3BheVpmMWMzMm1JaHRFakhrN0ZiUGVscE51dWlEeEw4X0EydDJRdXVXOUx4eVFNMU5XQTc3N1lKUHNLN3QxeVp6dFg4ZW82cDEtRWcyc3ROZGhFcEJQRnpGV0gxdGVLdF9xOTdNODBaMDFtOFYwWGw3NU05cExxXzFIX3pxN3BlanF4b1U9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-18 10:42:36,867 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-18 10:42:36,867 oidcrp.rp_handler DEBUG Authz response: {'state': '6TI9yBwBCg6Ir30jKocZl4Xe9upxJnZS', 'scope': 'profile openid offline_access', 'code': 'Z0FBQUFBQmxMNXA4RjF6cW1TTnVORTEyQlg4Ynk2Z0FRM25NdzFkeThCWGVKZ1VhbWh0Z3kxbHRYRjJMcGJYMXY4ZlZrU2UwYnh4N0J3VW5LQ1NIYnV4S3FwZTZSaDUyNS1ranZrZFQxbVdidWFvd2E3WUhHMmZRSVpPb1VkRW9qS1luaWN0bjhkNEJBdHJrX0dzekZQbmo5RzhfLTlacE84VHhxd2ZiZnpGajNlZlJDV0dnSFFndVNabEVnbUFKWGhxekdMWkN0bVB2T1o1M0pIT0hxbEtKQ3MzclVMLVJNNDdQd1hvVTRwVEtHVFlIcE9HVFZZcDlQX2t6Z2tIS3pMbkZnRVB6NnZYMHctQjNQVVF6VE0xWmY1TmtmbDE4bE5sZ2NtM1p2dFZFNTJkRDFXenJZQ3dkQ3V4SG9FZW8zRUFNcHpXeWNfdkhzQlkxWFVOcEg2SFdpenhMbnRtTy1OODRKcjlrdjNYSnVGcEF5Nmp3cmdmYTZvVi1rWHBmeVoxU1pPSDF0UnlGSXJ0aGNmR1BsNnRMYUljeENxa1BSek1JS3pfa0hsRF8xTDg4ckdZbUl4MTdya3dtWl9pV3FtOE44ZUxZSHY1Zm1XRVNWSXR3Y1IwX21MTlh2WTNTM3U1U1pvYjZSLThmWm56a3I5UXlJQ2JTRHRWM2UzM2xuVHJhTGRFT19pRXl5MzA1ZzVRTGRvTW96U1VBX1JuZkRPNV9mRTJuTzRkRi1tTmg0S3BheVpmMWMzMm1JaHRFakhrN0ZiUGVscE51dWlEeEw4X0EydDJRdXVXOUx4eVFNMU5XQTc3N1lKUHNLN3QxeVp6dFg4ZW82cDEtRWcyc3ROZGhFcEJQRnpGV0gxdGVLdF9xOTdNODBaMDFtOFYwWGw3NU05cExxXzFIX3pxN3BlanF4b1U9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-18 10:42:36,867 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-18 10:42:36,867 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-18 10:42:36,867 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMNXA4RjF6cW1TTnVORTEyQlg4Ynk2Z0FRM25NdzFkeThCWGVKZ1VhbWh0Z3kxbHRYRjJMcGJYMXY4ZlZrU2UwYnh4N0J3VW5LQ1NIYnV4S3FwZTZSaDUyNS1ranZrZFQxbVdidWFvd2E3WUhHMmZRSVpPb1VkRW9qS1luaWN0bjhkNEJBdHJrX0dzekZQbmo5RzhfLTlacE84VHhxd2ZiZnpGajNlZlJDV0dnSFFndVNabEVnbUFKWGhxekdMWkN0bVB2T1o1M0pIT0hxbEtKQ3MzclVMLVJNNDdQd1hvVTRwVEtHVFlIcE9HVFZZcDlQX2t6Z2tIS3pMbkZnRVB6NnZYMHctQjNQVVF6VE0xWmY1TmtmbDE4bE5sZ2NtM1p2dFZFNTJkRDFXenJZQ3dkQ3V4SG9FZW8zRUFNcHpXeWNfdkhzQlkxWFVOcEg2SFdpenhMbnRtTy1OODRKcjlrdjNYSnVGcEF5Nmp3cmdmYTZvVi1rWHBmeVoxU1pPSDF0UnlGSXJ0aGNmR1BsNnRMYUljeENxa1BSek1JS3pfa0hsRF8xTDg4ckdZbUl4MTdya3dtWl9pV3FtOE44ZUxZSHY1Zm1XRVNWSXR3Y1IwX21MTlh2WTNTM3U1U1pvYjZSLThmWm56a3I5UXlJQ2JTRHRWM2UzM2xuVHJhTGRFT19pRXl5MzA1ZzVRTGRvTW96U1VBX1JuZkRPNV9mRTJuTzRkRi1tTmg0S3BheVpmMWMzMm1JaHRFakhrN0ZiUGVscE51dWlEeEw4X0EydDJRdXVXOUx4eVFNMU5XQTc3N1lKUHNLN3QxeVp6dFg4ZW82cDEtRWcyc3ROZGhFcEJQRnpGV0gxdGVLdF9xOTdNODBaMDFtOFYwWGw3NU05cExxXzFIX3pxN3BlanF4b1U9', 'state': '6TI9yBwBCg6Ir30jKocZl4Xe9upxJnZS', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-18 10:42:36,868 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': '6TI9yBwBCg6Ir30jKocZl4Xe9upxJnZS', 'code': 'Z0FBQUFBQmxMNXA4RjF6cW1TTnVORTEyQlg4Ynk2Z0FRM25NdzFkeThCWGVKZ1VhbWh0Z3kxbHRYRjJMcGJYMXY4ZlZrU2UwYnh4N0J3VW5LQ1NIYnV4S3FwZTZSaDUyNS1ranZrZFQxbVdidWFvd2E3WUhHMmZRSVpPb1VkRW9qS1luaWN0bjhkNEJBdHJrX0dzekZQbmo5RzhfLTlacE84VHhxd2ZiZnpGajNlZlJDV0dnSFFndVNabEVnbUFKWGhxekdMWkN0bVB2T1o1M0pIT0hxbEtKQ3MzclVMLVJNNDdQd1hvVTRwVEtHVFlIcE9HVFZZcDlQX2t6Z2tIS3pMbkZnRVB6NnZYMHctQjNQVVF6VE0xWmY1TmtmbDE4bE5sZ2NtM1p2dFZFNTJkRDFXenJZQ3dkQ3V4SG9FZW8zRUFNcHpXeWNfdkhzQlkxWFVOcEg2SFdpenhMbnRtTy1OODRKcjlrdjNYSnVGcEF5Nmp3cmdmYTZvVi1rWHBmeVoxU1pPSDF0UnlGSXJ0aGNmR1BsNnRMYUljeENxa1BSek1JS3pfa0hsRF8xTDg4ckdZbUl4MTdya3dtWl9pV3FtOE44ZUxZSHY1Zm1XRVNWSXR3Y1IwX21MTlh2WTNTM3U1U1pvYjZSLThmWm56a3I5UXlJQ2JTRHRWM2UzM2xuVHJhTGRFT19pRXl5MzA1ZzVRTGRvTW96U1VBX1JuZkRPNV9mRTJuTzRkRi1tTmg0S3BheVpmMWMzMm1JaHRFakhrN0ZiUGVscE51dWlEeEw4X0EydDJRdXVXOUx4eVFNMU5XQTc3N1lKUHNLN3QxeVp6dFg4ZW82cDEtRWcyc3ROZGhFcEJQRnpGV0gxdGVLdF9xOTdNODBaMDFtOFYwWGw3NU05cExxXzFIX3pxN3BlanF4b1U9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'KG73hgW2ulFeBEeB8yWmIq2j7gnj74LWbO2LRsHApu2sPGKaFsqmVeAqqCBZlEdG'}
2023-10-18 10:42:36,868 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-18 10:42:36,868 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7faad1d26ad0>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=6TI9yBwBCg6Ir30jKocZl4Xe9upxJnZS&code=Z0FBQUFBQmxMNXA4RjF6cW1TTnVORTEyQlg4Ynk2Z0FRM25NdzFkeThCWGVKZ1VhbWh0Z3kxbHRYRjJMcGJYMXY4ZlZrU2UwYnh4N0J3VW5LQ1NIYnV4S3FwZTZSaDUyNS1ranZrZFQxbVdidWFvd2E3WUhHMmZRSVpPb1VkRW9qS1luaWN0bjhkNEJBdHJrX0dzekZQbmo5RzhfLTlacE84VHhxd2ZiZnpGajNlZlJDV0dnSFFndVNabEVnbUFKWGhxekdMWkN0bVB2T1o1M0pIT0hxbEtKQ3MzclVMLVJNNDdQd1hvVTRwVEtHVFlIcE9HVFZZcDlQX2t6Z2tIS3pMbkZnRVB6NnZYMHctQjNQVVF6VE0xWmY1TmtmbDE4bE5sZ2NtM1p2dFZFNTJkRDFXenJZQ3dkQ3V4SG9FZW8zRUFNcHpXeWNfdkhzQlkxWFVOcEg2SFdpenhMbnRtTy1OODRKcjlrdjNYSnVGcEF5Nmp3cmdmYTZvVi1rWHBmeVoxU1pPSDF0UnlGSXJ0aGNmR1BsNnRMYUljeENxa1BSek1JS3pfa0hsRF8xTDg4ckdZbUl4MTdya3dtWl9pV3FtOE44ZUxZSHY1Zm1XRVNWSXR3Y1IwX21MTlh2WTNTM3U1U1pvYjZSLThmWm56a3I5UXlJQ2JTRHRWM2UzM2xuVHJhTGRFT19pRXl5MzA1ZzVRTGRvTW96U1VBX1JuZkRPNV9mRTJuTzRkRi1tTmg0S3BheVpmMWMzMm1JaHRFakhrN0ZiUGVscE51dWlEeEw4X0EydDJRdXVXOUx4eVFNMU5XQTc3N1lKUHNLN3QxeVp6dFg4ZW82cDEtRWcyc3ROZGhFcEJQRnpGV0gxdGVLdF9xOTdNODBaMDFtOFYwWGw3NU05cExxXzFIX3pxN3BlanF4b1U9&code_verifier=KG73hgW2ulFeBEeB8yWmIq2j7gnj74LWbO2LRsHApu2sPGKaFsqmVeAqqCBZlEdG', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-18 10:42:36,868 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=6TI9yBwBCg6Ir30jKocZl4Xe9upxJnZS&code=Z0FBQUFBQmxMNXA4RjF6cW1TTnVORTEyQlg4Ynk2Z0FRM25NdzFkeThCWGVKZ1VhbWh0Z3kxbHRYRjJMcGJYMXY4ZlZrU2UwYnh4N0J3VW5LQ1NIYnV4S3FwZTZSaDUyNS1ranZrZFQxbVdidWFvd2E3WUhHMmZRSVpPb1VkRW9qS1luaWN0bjhkNEJBdHJrX0dzekZQbmo5RzhfLTlacE84VHhxd2ZiZnpGajNlZlJDV0dnSFFndVNabEVnbUFKWGhxekdMWkN0bVB2T1o1M0pIT0hxbEtKQ3MzclVMLVJNNDdQd1hvVTRwVEtHVFlIcE9HVFZZcDlQX2t6Z2tIS3pMbkZnRVB6NnZYMHctQjNQVVF6VE0xWmY1TmtmbDE4bE5sZ2NtM1p2dFZFNTJkRDFXenJZQ3dkQ3V4SG9FZW8zRUFNcHpXeWNfdkhzQlkxWFVOcEg2SFdpenhMbnRtTy1OODRKcjlrdjNYSnVGcEF5Nmp3cmdmYTZvVi1rWHBmeVoxU1pPSDF0UnlGSXJ0aGNmR1BsNnRMYUljeENxa1BSek1JS3pfa0hsRF8xTDg4ckdZbUl4MTdya3dtWl9pV3FtOE44ZUxZSHY1Zm1XRVNWSXR3Y1IwX21MTlh2WTNTM3U1U1pvYjZSLThmWm56a3I5UXlJQ2JTRHRWM2UzM2xuVHJhTGRFT19pRXl5MzA1ZzVRTGRvTW96U1VBX1JuZkRPNV9mRTJuTzRkRi1tTmg0S3BheVpmMWMzMm1JaHRFakhrN0ZiUGVscE51dWlEeEw4X0EydDJRdXVXOUx4eVFNMU5XQTc3N1lKUHNLN3QxeVp6dFg4ZW82cDEtRWcyc3ROZGhFcEJQRnpGV0gxdGVLdF9xOTdNODBaMDFtOFYwWGw3NU05cExxXzFIX3pxN3BlanF4b1U9&code_verifier=KG73hgW2ulFeBEeB8yWmIq2j7gnj74LWbO2LRsHApu2sPGKaFsqmVeAqqCBZlEdG, https_args:{'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-18 10:42:36,868 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 10:42:37,015 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-18 10:42:37,015 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 10:42:37,015 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 10:42:37,015 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 08:42:37 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddACGSgwKBK0GA6YMkUtXLO--qE9L0ZQV5sQu5QMHoOsY_IlgSoKRs2qzyfHanoPWzf1kR2nj8WlW_BdozH6I30r_GCgaQMY2luSlzgJY2qH9IrdS-BgGmFJUzDIBMVgi7cKxNb3ikn9OIB5U01o80-y2OnjE4qGrXjMrdsjg-cAGsjvCA24lqIL7a-XgORH-LVQKXX9hqwymkj34EAZLO1ugcVkV6im4d304hSndms4X1k3quhxzWzQAAG9bTbqwzB_QAAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddACGSgwKBK0GA6YMkUtXLO--qE9L0ZQV5sQu5QMHoOsY_IlgSoKRs2qzyfHanoPWzf1kR2nj8WlW_BdozH6I30r_GCgaQMY2luSlzgJY2qH9IrdS-BgGmFJUzDIBMVgi7cKxNb3ikn9OIB5U01o80-y2OnjE4qGrXjMrdsjg-cAGsjvCA24lqIL7a-XgORH-LVQKXX9hqwymkj34EAZLO1ugcVkV6im4d304hSndms4X1k3quhxzWzQAAG9bTbqwzB_QAAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 10:42:37,015 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiODQ3NTg4OTE4ODZhNGU5NDgwZGEyMWI0OWRhMTQzMjkiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OWEE0VW5Fd2NrbHJXRW8yV1VoVGNteE1hMDFXVkRkalJ5MTFjMmRCWVdRMVJsSmxWSGx3U3poeGIyWk1PVEJpTWs1YVZEVlpRMnd4Y1RVNFdrWXhiMlpzWWtGT1VHbzRSMVpIY1RBMmFTMVBNM0pEVjJObWRWQnBaVVV4WWs5emJUUXpWbWt0UVVoV2RFMWhabTgzY0hoRVFXUnNVSHBVY0VFelpWVnBSbVpwTW5oTGVUZFhUWFZvTnpGTk0yc3RTbmN3Y21KRE5rOU5WSE5yUXpGTVFsZFVVemczUm1OcWNtWkhNRmwyWkROdVMxaFNhMnhOZWxSM1pHMUpSVVZmUWpKUU0xQXhkazA1YzFoUGRYbDZZV2RqZEhKdlZtRkZlRlpRZEdwSVJucFRUMFpZWVRaV1dsSlRkR1pEVW5wdGNtZERlRFp1UVRONFVrNXBjbUZvVjBJeE9RPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MTg1NTcsICJleHAiOiAxNjk3NjIyMTU3fQ.vLDSo89zdKBC-oBmiDV2TioFSc6C9ns135RoduwA33Nzr7pxMLm_db7GGhTRhxL5p2tNKpep9bYH0UaxIUaVFA", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMNXA5akxRc0Z0ZWdpaFh2Z2JQUHNHR1lQOEY0WUVTZjJQOUEyOXFhZVNERGVjTWxhSlpNZGFIbjRvdjhXQnZ0Ymo4cDAtVU40OXdVbHNBMWwzOHJabFVYOGNURW1Rdm9qWTM1SXU1NUlZLWxCNDZRQXpkeFp2b1h0NUFfamN3clc5eUZ4dDBRWjBkeUFadGROekZLVF9yc1VvblMtaHJSZjJTeXVpS1RiMlRhZTZNYmpwVG5BZ0J6Skszcm82MnVuSE5WdTVjTndBRGVHRmV1UDktWkZzbElxdUN0OGdrTUl3MG9jeUlQemt2S21QZG80MzVGeFR0RDVrNkJ4Z3NCcHdmVXJTaHlMdV8tTEQwR3Nxcmt1aUxzdjlOaG9xcndGS0gtY3N3QlczU29jZl9Qb2V0MlNETkFEa2pOS1BDZVk4eG5CM1BLNFhXZkN0UlBKdVkteW0tTkF0eDFOT2ZKeUpqdHo1VWgxVnlfRnN0RzFONk9HVmJjeW1lb3g1OFBkUzlfSDdlSURjaXNULXFIQV9jc0dHUzJCZXpqVWZsaHZpMmVXX2dVMmR2NGN5OGJSQVBLVEE0NURtdUVfWTZpYkNBR0c1Ni14UUx3aGhiV2cwZVdtTVhRWVU1bXh3ZzBQNC0tdTdjbHYyOTVHdlNSVkN1UUhWRkpwTmZHaE93b1FkSnFXQXV6VDlFSUlFYlpRd1lhNUNyWXo2eVZRcF9wclZ1WjNLUXd0NEE5ZWVUVHBPZEJTZ3JJQWNaN05sZzhxV241cTdscGE1cGI0am9DZUxqNVIycmphMldGeUl5QzJjREN0SndwcEtMMWpyRFBYZ2V3NWRJYWI4X2FDQl9BbEZZOUNyOTc2LWlacHhBSEVrYkJVclo0X2tmWXE2WWZlRFBFbVhla3NhWjRRWFU9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTlhBNFVuRXdja2xyV0VvMldVaFRjbXhNYTAxV1ZEZGpSeTExYzJkQllXUTFSbEpsVkhsd1N6aHhiMlpNT1RCaU1rNWFWRFZaUTJ3eGNUVTRXa1l4YjJac1lrRk9VR280UjFaSGNUQTJhUzFQTTNKRFYyTm1kVkJwWlVVeFlrOXpiVFF6Vm1rdFFVaFdkRTFoWm04M2NIaEVRV1JzVUhwVWNFRXpaVlZwUm1acE1uaExlVGRYVFhWb056Rk5NMnN0U25jd2NtSkROazlOVkhOclF6Rk1RbGRVVXpnM1JtTnFjbVpITUZsMlpETnVTMWhTYTJ4TmVsUjNaRzFKUlVWZlFqSlFNMUF4ZGswNWMxaFBkWGw2WVdkamRISnZWbUZGZUZaUWRHcElSbnBUVDBaWVlUWldXbEpUZEdaRFVucHRjbWREZURadVFUTjRVazVwY21Gb1YwSXhPUT09IiwgImF1dGhfdGltZSI6IDE2OTc2MTg1NTYsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiNGEwYzg0ZmU2ZDkyMTFlZWI4MTAwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogInUzN0RzVGFXbklSdThJWDJNYWg5TUdKSiIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjE4NTU3LCAiZXhwIjogMTY5NzYxODg1NywgImF1ZCI6IFsiand0X3Rlc3QiXX0.JlOxwxGxQubwB5SZnn1Qd0yDGI1o69oQr_rAyDms1KPT0avIxQqPFXYk-jcBx__CPDsoyOIeppbK9HY1kTo_cuOwqCsnoJF3LSq8_EgV3o21qrUXwnAtIqE3c5wbPpMGVytxnKucxEMRmK6M7mD1BHhutWfqpe83FPtAXiICSRllqnc2WgPb0vdcBf3JxnsCsds-GooYfHHA-UDJgFoQtPmwh2GM2pS4l8lbLkw_A2EwA2uINHmPASnmb3DTLtP3X7voJl9v6t7ngoE_FK7kac91Khh-iHhqzoPZca26lLU_33-W7CsOHpdNQD-59kp23V4JwZ6DA45oeBrjCGFqZg"}
2023-10-18 10:42:37,015 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiODQ3NTg4OTE4ODZhNGU5NDgwZGEyMWI0OWRhMTQzMjkiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OWEE0VW5Fd2NrbHJXRW8yV1VoVGNteE1hMDFXVkRkalJ5MTFjMmRCWVdRMVJsSmxWSGx3U3poeGIyWk1PVEJpTWs1YVZEVlpRMnd4Y1RVNFdrWXhiMlpzWWtGT1VHbzRSMVpIY1RBMmFTMVBNM0pEVjJObWRWQnBaVVV4WWs5emJUUXpWbWt0UVVoV2RFMWhabTgzY0hoRVFXUnNVSHBVY0VFelpWVnBSbVpwTW5oTGVUZFhUWFZvTnpGTk0yc3RTbmN3Y21KRE5rOU5WSE5yUXpGTVFsZFVVemczUm1OcWNtWkhNRmwyWkROdVMxaFNhMnhOZWxSM1pHMUpSVVZmUWpKUU0xQXhkazA1YzFoUGRYbDZZV2RqZEhKdlZtRkZlRlpRZEdwSVJucFRUMFpZWVRaV1dsSlRkR1pEVW5wdGNtZERlRFp1UVRONFVrNXBjbUZvVjBJeE9RPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MTg1NTcsICJleHAiOiAxNjk3NjIyMTU3fQ.vLDSo89zdKBC-oBmiDV2TioFSc6C9ns135RoduwA33Nzr7pxMLm_db7GGhTRhxL5p2tNKpep9bYH0UaxIUaVFA", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMNXA5akxRc0Z0ZWdpaFh2Z2JQUHNHR1lQOEY0WUVTZjJQOUEyOXFhZVNERGVjTWxhSlpNZGFIbjRvdjhXQnZ0Ymo4cDAtVU40OXdVbHNBMWwzOHJabFVYOGNURW1Rdm9qWTM1SXU1NUlZLWxCNDZRQXpkeFp2b1h0NUFfamN3clc5eUZ4dDBRWjBkeUFadGROekZLVF9yc1VvblMtaHJSZjJTeXVpS1RiMlRhZTZNYmpwVG5BZ0J6Skszcm82MnVuSE5WdTVjTndBRGVHRmV1UDktWkZzbElxdUN0OGdrTUl3MG9jeUlQemt2S21QZG80MzVGeFR0RDVrNkJ4Z3NCcHdmVXJTaHlMdV8tTEQwR3Nxcmt1aUxzdjlOaG9xcndGS0gtY3N3QlczU29jZl9Qb2V0MlNETkFEa2pOS1BDZVk4eG5CM1BLNFhXZkN0UlBKdVkteW0tTkF0eDFOT2ZKeUpqdHo1VWgxVnlfRnN0RzFONk9HVmJjeW1lb3g1OFBkUzlfSDdlSURjaXNULXFIQV9jc0dHUzJCZXpqVWZsaHZpMmVXX2dVMmR2NGN5OGJSQVBLVEE0NURtdUVfWTZpYkNBR0c1Ni14UUx3aGhiV2cwZVdtTVhRWVU1bXh3ZzBQNC0tdTdjbHYyOTVHdlNSVkN1UUhWRkpwTmZHaE93b1FkSnFXQXV6VDlFSUlFYlpRd1lhNUNyWXo2eVZRcF9wclZ1WjNLUXd0NEE5ZWVUVHBPZEJTZ3JJQWNaN05sZzhxV241cTdscGE1cGI0am9DZUxqNVIycmphMldGeUl5QzJjREN0SndwcEtMMWpyRFBYZ2V3NWRJYWI4X2FDQl9BbEZZOUNyOTc2LWlacHhBSEVrYkJVclo0X2tmWXE2WWZlRFBFbVhla3NhWjRRWFU9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTlhBNFVuRXdja2xyV0VvMldVaFRjbXhNYTAxV1ZEZGpSeTExYzJkQllXUTFSbEpsVkhsd1N6aHhiMlpNT1RCaU1rNWFWRFZaUTJ3eGNUVTRXa1l4YjJac1lrRk9VR280UjFaSGNUQTJhUzFQTTNKRFYyTm1kVkJwWlVVeFlrOXpiVFF6Vm1rdFFVaFdkRTFoWm04M2NIaEVRV1JzVUhwVWNFRXpaVlZwUm1acE1uaExlVGRYVFhWb056Rk5NMnN0U25jd2NtSkROazlOVkhOclF6Rk1RbGRVVXpnM1JtTnFjbVpITUZsMlpETnVTMWhTYTJ4TmVsUjNaRzFKUlVWZlFqSlFNMUF4ZGswNWMxaFBkWGw2WVdkamRISnZWbUZGZUZaUWRHcElSbnBUVDBaWVlUWldXbEpUZEdaRFVucHRjbWREZURadVFUTjRVazVwY21Gb1YwSXhPUT09IiwgImF1dGhfdGltZSI6IDE2OTc2MTg1NTYsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiNGEwYzg0ZmU2ZDkyMTFlZWI4MTAwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogInUzN0RzVGFXbklSdThJWDJNYWg5TUdKSiIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjE4NTU3LCAiZXhwIjogMTY5NzYxODg1NywgImF1ZCI6IFsiand0X3Rlc3QiXX0.JlOxwxGxQubwB5SZnn1Qd0yDGI1o69oQr_rAyDms1KPT0avIxQqPFXYk-jcBx__CPDsoyOIeppbK9HY1kTo_cuOwqCsnoJF3LSq8_EgV3o21qrUXwnAtIqE3c5wbPpMGVytxnKucxEMRmK6M7mD1BHhutWfqpe83FPtAXiICSRllqnc2WgPb0vdcBf3JxnsCsds-GooYfHHA-UDJgFoQtPmwh2GM2pS4l8lbLkw_A2EwA2uINHmPASnmb3DTLtP3X7voJl9v6t7ngoE_FK7kac91Khh-iHhqzoPZca26lLU_33-W7CsOHpdNQD-59kp23V4JwZ6DA45oeBrjCGFqZg"}
2023-10-18 10:42:37,015 oidcrp.service DEBUG response format: json
2023-10-18 10:42:37,015 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-18 10:42:37,015 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiODQ3NTg4OTE4ODZhNGU5NDgwZGEyMWI0OWRhMTQzMjkiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OWEE0VW5Fd2NrbHJXRW8yV1VoVGNteE1hMDFXVkRkalJ5MTFjMmRCWVdRMVJsSmxWSGx3U3poeGIyWk1PVEJpTWs1YVZEVlpRMnd4Y1RVNFdrWXhiMlpzWWtGT1VHbzRSMVpIY1RBMmFTMVBNM0pEVjJObWRWQnBaVVV4WWs5emJUUXpWbWt0UVVoV2RFMWhabTgzY0hoRVFXUnNVSHBVY0VFelpWVnBSbVpwTW5oTGVUZFhUWFZvTnpGTk0yc3RTbmN3Y21KRE5rOU5WSE5yUXpGTVFsZFVVemczUm1OcWNtWkhNRmwyWkROdVMxaFNhMnhOZWxSM1pHMUpSVVZmUWpKUU0xQXhkazA1YzFoUGRYbDZZV2RqZEhKdlZtRkZlRlpRZEdwSVJucFRUMFpZWVRaV1dsSlRkR1pEVW5wdGNtZERlRFp1UVRONFVrNXBjbUZvVjBJeE9RPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MTg1NTcsICJleHAiOiAxNjk3NjIyMTU3fQ.vLDSo89zdKBC-oBmiDV2TioFSc6C9ns135RoduwA33Nzr7pxMLm_db7GGhTRhxL5p2tNKpep9bYH0UaxIUaVFA', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxMNXA5akxRc0Z0ZWdpaFh2Z2JQUHNHR1lQOEY0WUVTZjJQOUEyOXFhZVNERGVjTWxhSlpNZGFIbjRvdjhXQnZ0Ymo4cDAtVU40OXdVbHNBMWwzOHJabFVYOGNURW1Rdm9qWTM1SXU1NUlZLWxCNDZRQXpkeFp2b1h0NUFfamN3clc5eUZ4dDBRWjBkeUFadGROekZLVF9yc1VvblMtaHJSZjJTeXVpS1RiMlRhZTZNYmpwVG5BZ0J6Skszcm82MnVuSE5WdTVjTndBRGVHRmV1UDktWkZzbElxdUN0OGdrTUl3MG9jeUlQemt2S21QZG80MzVGeFR0RDVrNkJ4Z3NCcHdmVXJTaHlMdV8tTEQwR3Nxcmt1aUxzdjlOaG9xcndGS0gtY3N3QlczU29jZl9Qb2V0MlNETkFEa2pOS1BDZVk4eG5CM1BLNFhXZkN0UlBKdVkteW0tTkF0eDFOT2ZKeUpqdHo1VWgxVnlfRnN0RzFONk9HVmJjeW1lb3g1OFBkUzlfSDdlSURjaXNULXFIQV9jc0dHUzJCZXpqVWZsaHZpMmVXX2dVMmR2NGN5OGJSQVBLVEE0NURtdUVfWTZpYkNBR0c1Ni14UUx3aGhiV2cwZVdtTVhRWVU1bXh3ZzBQNC0tdTdjbHYyOTVHdlNSVkN1UUhWRkpwTmZHaE93b1FkSnFXQXV6VDlFSUlFYlpRd1lhNUNyWXo2eVZRcF9wclZ1WjNLUXd0NEE5ZWVUVHBPZEJTZ3JJQWNaN05sZzhxV241cTdscGE1cGI0am9DZUxqNVIycmphMldGeUl5QzJjREN0SndwcEtMMWpyRFBYZ2V3NWRJYWI4X2FDQl9BbEZZOUNyOTc2LWlacHhBSEVrYkJVclo0X2tmWXE2WWZlRFBFbVhla3NhWjRRWFU9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTlhBNFVuRXdja2xyV0VvMldVaFRjbXhNYTAxV1ZEZGpSeTExYzJkQllXUTFSbEpsVkhsd1N6aHhiMlpNT1RCaU1rNWFWRFZaUTJ3eGNUVTRXa1l4YjJac1lrRk9VR280UjFaSGNUQTJhUzFQTTNKRFYyTm1kVkJwWlVVeFlrOXpiVFF6Vm1rdFFVaFdkRTFoWm04M2NIaEVRV1JzVUhwVWNFRXpaVlZwUm1acE1uaExlVGRYVFhWb056Rk5NMnN0U25jd2NtSkROazlOVkhOclF6Rk1RbGRVVXpnM1JtTnFjbVpITUZsMlpETnVTMWhTYTJ4TmVsUjNaRzFKUlVWZlFqSlFNMUF4ZGswNWMxaFBkWGw2WVdkamRISnZWbUZGZUZaUWRHcElSbnBUVDBaWVlUWldXbEpUZEdaRFVucHRjbWREZURadVFUTjRVazVwY21Gb1YwSXhPUT09IiwgImF1dGhfdGltZSI6IDE2OTc2MTg1NTYsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIl0sICJqdGkiOiAiNGEwYzg0ZmU2ZDkyMTFlZWI4MTAwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogInUzN0RzVGFXbklSdThJWDJNYWg5TUdKSiIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjE4NTU3LCAiZXhwIjogMTY5NzYxODg1NywgImF1ZCI6IFsiand0X3Rlc3QiXX0.JlOxwxGxQubwB5SZnn1Qd0yDGI1o69oQr_rAyDms1KPT0avIxQqPFXYk-jcBx__CPDsoyOIeppbK9HY1kTo_cuOwqCsnoJF3LSq8_EgV3o21qrUXwnAtIqE3c5wbPpMGVytxnKucxEMRmK6M7mD1BHhutWfqpe83FPtAXiICSRllqnc2WgPb0vdcBf3JxnsCsds-GooYfHHA-UDJgFoQtPmwh2GM2pS4l8lbLkw_A2EwA2uINHmPASnmb3DTLtP3X7voJl9v6t7ngoE_FK7kac91Khh-iHhqzoPZca26lLU_33-W7CsOHpdNQD-59kp23V4JwZ6DA45oeBrjCGFqZg'}"
2023-10-18 10:42:37,016 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-18 10:42:37,016 oidcmsg.message DEBUG Raw JSON: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMNXA4UnEwcklrWEo2WUhTcmxMa01WVDdjRy11c2dBYWQ1RlJlVHlwSzhxb2ZMOTBiMk5aVDVZQ2wxcTU4WkYxb2ZsYkFOUGo4R1ZHcTA2aS1PM3JDV2NmdVBpZUUxYk9zbTQzVmktQUhWdE1hZm83cHhEQWRsUHpUcEEzZVVpRmZpMnhLeTdXTXVoNzFNM2stSncwcmJDNk9NVHNrQzFMQldUUzg3RmNqcmZHMFl2ZDNuS1hSa2xNelR3ZG1JRUVfQjJQM1Axdk05c1hPdXl6YWdjdHJvVmFFeFZQdGpIRnpTT0ZYYTZWWlJTdGZDUnptcmdDeDZuQTN4Uk5pcmFoV0IxOQ==', 'auth_time': 1697618556, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '4a0c84fe6d9211eeb8100242ac170004', 'client_id': 'jwt_test', 'nonce': 'u37DsTaWnIRu8IX2Mah9MGJJ', 'iss': 'https://satosa.idem.it', 'iat': 1697618557, 'exp': 1697618857, 'aud': ['jwt_test']}
2023-10-18 10:42:37,016 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA'}
2023-10-18 10:42:37,016 cryptojwt.key_jar DEBUG Key summary for https://satosa.idem.it: RSA:sig:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, EC:sig:LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw
2023-10-18 10:42:37,016 oidcmsg.message DEBUG Found signing key.
2023-10-18 10:42:37,016 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-18 10:42:37,016 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA and use=
2023-10-18 10:42:37,016 cryptojwt.jwx DEBUG Picked: kid:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, use:sig, kty:RSA
2023-10-18 10:42:37,016 cryptojwt.jws.jws DEBUG Verified message using key with kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA
2023-10-18 10:42:37,017 oidcmsg.oidc INFO Verified id_token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMNXA4UnEwcklrWEo2WUhTcmxMa01WVDdjRy11c2dBYWQ1RlJlVHlwSzhxb2ZMOTBiMk5aVDVZQ2wxcTU4WkYxb2ZsYkFOUGo4R1ZHcTA2aS1PM3JDV2NmdVBpZUUxYk9zbTQzVmktQUhWdE1hZm83cHhEQWRsUHpUcEEzZVVpRmZpMnhLeTdXTXVoNzFNM2stSncwcmJDNk9NVHNrQzFMQldUUzg3RmNqcmZHMFl2ZDNuS1hSa2xNelR3ZG1JRUVfQjJQM1Axdk05c1hPdXl6YWdjdHJvVmFFeFZQdGpIRnpTT0ZYYTZWWlJTdGZDUnptcmdDeDZuQTN4Uk5pcmFoV0IxOQ==', 'auth_time': 1697618556, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '4a0c84fe6d9211eeb8100242ac170004', 'client_id': 'jwt_test', 'nonce': 'u37DsTaWnIRu8IX2Mah9MGJJ', 'iss': 'https://satosa.idem.it', 'iat': 1697618557, 'exp': 1697618857, 'aud': ['jwt_test']}
2023-10-18 10:42:37,017 oidcrp.rp_handler DEBUG ID Token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMNXA4UnEwcklrWEo2WUhTcmxMa01WVDdjRy11c2dBYWQ1RlJlVHlwSzhxb2ZMOTBiMk5aVDVZQ2wxcTU4WkYxb2ZsYkFOUGo4R1ZHcTA2aS1PM3JDV2NmdVBpZUUxYk9zbTQzVmktQUhWdE1hZm83cHhEQWRsUHpUcEEzZVVpRmZpMnhLeTdXTXVoNzFNM2stSncwcmJDNk9NVHNrQzFMQldUUzg3RmNqcmZHMFl2ZDNuS1hSa2xNelR3ZG1JRUVfQjJQM1Axdk05c1hPdXl6YWdjdHJvVmFFeFZQdGpIRnpTT0ZYYTZWWlJTdGZDUnptcmdDeDZuQTN4Uk5pcmFoV0IxOQ==', 'auth_time': 1697618556, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access'], 'jti': '4a0c84fe6d9211eeb8100242ac170004', 'client_id': 'jwt_test', 'nonce': 'u37DsTaWnIRu8IX2Mah9MGJJ', 'iss': 'https://satosa.idem.it', 'iat': 1697618557, 'exp': 1697618857, 'aud': ['jwt_test']}
2023-10-18 10:42:37,017 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-18 10:42:37,017 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiODQ3NTg4OTE4ODZhNGU5NDgwZGEyMWI0OWRhMTQzMjkiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OWEE0VW5Fd2NrbHJXRW8yV1VoVGNteE1hMDFXVkRkalJ5MTFjMmRCWVdRMVJsSmxWSGx3U3poeGIyWk1PVEJpTWs1YVZEVlpRMnd4Y1RVNFdrWXhiMlpzWWtGT1VHbzRSMVpIY1RBMmFTMVBNM0pEVjJObWRWQnBaVVV4WWs5emJUUXpWbWt0UVVoV2RFMWhabTgzY0hoRVFXUnNVSHBVY0VFelpWVnBSbVpwTW5oTGVUZFhUWFZvTnpGTk0yc3RTbmN3Y21KRE5rOU5WSE5yUXpGTVFsZFVVemczUm1OcWNtWkhNRmwyWkROdVMxaFNhMnhOZWxSM1pHMUpSVVZmUWpKUU0xQXhkazA1YzFoUGRYbDZZV2RqZEhKdlZtRkZlRlpRZEdwSVJucFRUMFpZWVRaV1dsSlRkR1pEVW5wdGNtZERlRFp1UVRONFVrNXBjbUZvVjBJeE9RPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MTg1NTcsICJleHAiOiAxNjk3NjIyMTU3fQ.vLDSo89zdKBC-oBmiDV2TioFSc6C9ns135RoduwA33Nzr7pxMLm_db7GGhTRhxL5p2tNKpep9bYH0UaxIUaVFA'}
2023-10-18 10:42:37,018 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-18 10:42:37,018 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7faad4552ad0>, 'url': 'https://satosa.idem.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiODQ3NTg4OTE4ODZhNGU5NDgwZGEyMWI0OWRhMTQzMjkiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OWEE0VW5Fd2NrbHJXRW8yV1VoVGNteE1hMDFXVkRkalJ5MTFjMmRCWVdRMVJsSmxWSGx3U3poeGIyWk1PVEJpTWs1YVZEVlpRMnd4Y1RVNFdrWXhiMlpzWWtGT1VHbzRSMVpIY1RBMmFTMVBNM0pEVjJObWRWQnBaVVV4WWs5emJUUXpWbWt0UVVoV2RFMWhabTgzY0hoRVFXUnNVSHBVY0VFelpWVnBSbVpwTW5oTGVUZFhUWFZvTnpGTk0yc3RTbmN3Y21KRE5rOU5WSE5yUXpGTVFsZFVVemczUm1OcWNtWkhNRmwyWkROdVMxaFNhMnhOZWxSM1pHMUpSVVZmUWpKUU0xQXhkazA1YzFoUGRYbDZZV2RqZEhKdlZtRkZlRlpRZEdwSVJucFRUMFpZWVRaV1dsSlRkR1pEVW5wdGNtZERlRFp1UVRONFVrNXBjbUZvVjBJeE9RPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MTg1NTcsICJleHAiOiAxNjk3NjIyMTU3fQ.vLDSo89zdKBC-oBmiDV2TioFSc6C9ns135RoduwA33Nzr7pxMLm_db7GGhTRhxL5p2tNKpep9bYH0UaxIUaVFA'}}
2023-10-18 10:42:37,018 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiODQ3NTg4OTE4ODZhNGU5NDgwZGEyMWI0OWRhMTQzMjkiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OWEE0VW5Fd2NrbHJXRW8yV1VoVGNteE1hMDFXVkRkalJ5MTFjMmRCWVdRMVJsSmxWSGx3U3poeGIyWk1PVEJpTWs1YVZEVlpRMnd4Y1RVNFdrWXhiMlpzWWtGT1VHbzRSMVpIY1RBMmFTMVBNM0pEVjJObWRWQnBaVVV4WWs5emJUUXpWbWt0UVVoV2RFMWhabTgzY0hoRVFXUnNVSHBVY0VFelpWVnBSbVpwTW5oTGVUZFhUWFZvTnpGTk0yc3RTbmN3Y21KRE5rOU5WSE5yUXpGTVFsZFVVemczUm1OcWNtWkhNRmwyWkROdVMxaFNhMnhOZWxSM1pHMUpSVVZmUWpKUU0xQXhkazA1YzFoUGRYbDZZV2RqZEhKdlZtRkZlRlpRZEdwSVJucFRUMFpZWVRaV1dsSlRkR1pEVW5wdGNtZERlRFp1UVRONFVrNXBjbUZvVjBJeE9RPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MTg1NTcsICJleHAiOiAxNjk3NjIyMTU3fQ.vLDSo89zdKBC-oBmiDV2TioFSc6C9ns135RoduwA33Nzr7pxMLm_db7GGhTRhxL5p2tNKpep9bYH0UaxIUaVFA'}
2023-10-18 10:42:37,018 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 10:42:37,177 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-18 10:42:37,178 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 10:42:37,178 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 10:42:37,178 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 08:42:37 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdAC0YRoVa2K5-Arm_BmL_1SQ5NFXnYsB-sfGeDObrL_Stqk8dKPeBrZD4Ph8hpO-lHTRzZgwiHlzS4IVToYp9StqdudikyHN_z0C7Q47yqoAhJCjxlr0sNiyF7gejTqDBK5wnp2JaDSpokzbMvBhJoKYPWZz6F6f8QSSmJ8Sx96HEEvzK809dgU8ACi0nYzeKDeW10CbpgA3C8z7WkP-51lBXn1cF9FJ1QJrRHVVBSbZUxjBWR0UrWZIA6fxfemUOKaQAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdAC0YRoVa2K5-Arm_BmL_1SQ5NFXnYsB-sfGeDObrL_Stqk8dKPeBrZD4Ph8hpO-lHTRzZgwiHlzS4IVToYp9StqdudikyHN_z0C7Q47yqoAhJCjxlr0sNiyF7gejTqDBK5wnp2JaDSpokzbMvBhJoKYPWZz6F6f8QSSmJ8Sx96HEEvzK809dgU8ACi0nYzeKDeW10CbpgA3C8z7WkP-51lBXn1cF9FJ1QJrRHVVBSbZUxjBWR0UrWZIA6fxfemUOKaQAAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 10:42:37,178 oidcrp.util DEBUG resp.txt: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-18 10:42:37,178 oidcrp.oauth2 DEBUG Successful response: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-18 10:42:37,178 oidcrp.service DEBUG response format: json
2023-10-18 10:42:37,178 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-18 10:42:37,178 oidcrp.service DEBUG Initial response parsing => "{'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}"
2023-10-18 10:42:37,178 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-18 10:42:37,179 oidcrp.rp_handler DEBUG UserInfo: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}
2023-10-18 10:42:37,181 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 10:42:37] "GET /authz_cb/satosa?state=6TI9yBwBCg6Ir30jKocZl4Xe9upxJnZS&scope=profile+openid+offline_access&code=Z0FBQUFBQmxMNXA4RjF6cW1TTnVORTEyQlg4Ynk2Z0FRM25NdzFkeThCWGVKZ1VhbWh0Z3kxbHRYRjJMcGJYMXY4ZlZrU2UwYnh4N0J3VW5LQ1NIYnV4S3FwZTZSaDUyNS1ranZrZFQxbVdidWFvd2E3WUhHMmZRSVpPb1VkRW9qS1luaWN0bjhkNEJBdHJrX0dzekZQbmo5RzhfLTlacE84VHhxd2ZiZnpGajNlZlJDV0dnSFFndVNabEVnbUFKWGhxekdMWkN0bVB2T1o1M0pIT0hxbEtKQ3MzclVMLVJNNDdQd1hvVTRwVEtHVFlIcE9HVFZZcDlQX2t6Z2tIS3pMbkZnRVB6NnZYMHctQjNQVVF6VE0xWmY1TmtmbDE4bE5sZ2NtM1p2dFZFNTJkRDFXenJZQ3dkQ3V4SG9FZW8zRUFNcHpXeWNfdkhzQlkxWFVOcEg2SFdpenhMbnRtTy1OODRKcjlrdjNYSnVGcEF5Nmp3cmdmYTZvVi1rWHBmeVoxU1pPSDF0UnlGSXJ0aGNmR1BsNnRMYUljeENxa1BSek1JS3pfa0hsRF8xTDg4ckdZbUl4MTdya3dtWl9pV3FtOE44ZUxZSHY1Zm1XRVNWSXR3Y1IwX21MTlh2WTNTM3U1U1pvYjZSLThmWm56a3I5UXlJQ2JTRHRWM2UzM2xuVHJhTGRFT19pRXl5MzA1ZzVRTGRvTW96U1VBX1JuZkRPNV9mRTJuTzRkRi1tTmg0S3BheVpmMWMzMm1JaHRFakhrN0ZiUGVscE51dWlEeEw4X0EydDJRdXVXOUx4eVFNMU5XQTc3N1lKUHNLN3QxeVp6dFg4ZW82cDEtRWcyc3ROZGhFcEJQRnpGV0gxdGVLdF9xOTdNODBaMDFtOFYwWGw3NU05cExxXzFIX3pxN3BlanF4b1U9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1" 200 -
2023-10-18 10:44:21,675 root DEBUG Configured logging using dictionary
2023-10-18 10:44:21,714 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-18 10:44:21,714 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-18 10:44:21,714 werkzeug INFO  * Restarting with stat
2023-10-18 10:44:21,894 root DEBUG Configured logging using dictionary
2023-10-18 10:44:21,932 werkzeug WARNING  * Debugger is active!
2023-10-18 10:44:21,932 werkzeug INFO  * Debugger PIN: 491-689-569
2023-10-18 11:38:14,656 root DEBUG Configured logging using dictionary
2023-10-18 11:38:14,695 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-18 11:38:14,695 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-18 11:38:14,696 werkzeug INFO  * Restarting with stat
2023-10-18 11:38:14,880 root DEBUG Configured logging using dictionary
2023-10-18 11:38:14,917 werkzeug WARNING  * Debugger is active!
2023-10-18 11:38:14,918 werkzeug INFO  * Debugger PIN: 491-689-569
2023-10-18 11:38:20,776 flask_rp.views ERROR Unkown issuer: None not among []
2023-10-18 11:38:20,776 flask_rp.views ERROR Unknown OP identifier: None
2023-10-18 11:38:20,777 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 11:38:20] "[31m[1mGET /authz_cb/satosa?state=6TI9yBwBCg6Ir30jKocZl4Xe9upxJnZS&scope=profile+openid+offline_access&code=Z0FBQUFBQmxMNXA4RjF6cW1TTnVORTEyQlg4Ynk2Z0FRM25NdzFkeThCWGVKZ1VhbWh0Z3kxbHRYRjJMcGJYMXY4ZlZrU2UwYnh4N0J3VW5LQ1NIYnV4S3FwZTZSaDUyNS1ranZrZFQxbVdidWFvd2E3WUhHMmZRSVpPb1VkRW9qS1luaWN0bjhkNEJBdHJrX0dzekZQbmo5RzhfLTlacE84VHhxd2ZiZnpGajNlZlJDV0dnSFFndVNabEVnbUFKWGhxekdMWkN0bVB2T1o1M0pIT0hxbEtKQ3MzclVMLVJNNDdQd1hvVTRwVEtHVFlIcE9HVFZZcDlQX2t6Z2tIS3pMbkZnRVB6NnZYMHctQjNQVVF6VE0xWmY1TmtmbDE4bE5sZ2NtM1p2dFZFNTJkRDFXenJZQ3dkQ3V4SG9FZW8zRUFNcHpXeWNfdkhzQlkxWFVOcEg2SFdpenhMbnRtTy1OODRKcjlrdjNYSnVGcEF5Nmp3cmdmYTZvVi1rWHBmeVoxU1pPSDF0UnlGSXJ0aGNmR1BsNnRMYUljeENxa1BSek1JS3pfa0hsRF8xTDg4ckdZbUl4MTdya3dtWl9pV3FtOE44ZUxZSHY1Zm1XRVNWSXR3Y1IwX21MTlh2WTNTM3U1U1pvYjZSLThmWm56a3I5UXlJQ2JTRHRWM2UzM2xuVHJhTGRFT19pRXl5MzA1ZzVRTGRvTW96U1VBX1JuZkRPNV9mRTJuTzRkRi1tTmg0S3BheVpmMWMzMm1JaHRFakhrN0ZiUGVscE51dWlEeEw4X0EydDJRdXVXOUx4eVFNMU5XQTc3N1lKUHNLN3QxeVp6dFg4ZW82cDEtRWcyc3ROZGhFcEJQRnpGV0gxdGVLdF9xOTdNODBaMDFtOFYwWGw3NU05cExxXzFIX3pxN3BlanF4b1U9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1[0m" 400 -
2023-10-18 11:38:26,908 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 11:38:26] "GET / HTTP/1.1" 200 -
2023-10-18 11:38:56,561 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-18 11:38:56,561 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-18 11:38:56,561 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-18 11:38:56,561 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-18 11:38:56,601 oidcrp.rp_handler DEBUG Get provider info
2023-10-18 11:38:56,601 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-18 11:38:56,601 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-18 11:38:56,601 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-18 11:38:56,602 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 11:38:56,620 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-18 11:38:56,620 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 11:38:56,621 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 11:38:56,621 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 09:38:56 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdADIWCMXGpGj1JCBNEDhJCmwPFEUBk9J8Akyrof1WP7Lz0xPGqXgUexrhwiBgEm85CcolEgUt4R_8cUlHq2XPAI2gWmQ9xYC_jVgxXqyiZvlP6VBt-yplk8G70G1C7AcjKU9SYTzxeU2G7e0_zyzloMrqIh9t05uBNh7XTncXOmLo7ltJcLg8iehbv0D28ldal36D9GtP-WJJ55-QBPJF9DeeJhQiUGXu-tUPpzwxM4rA8kftkjkWgbglsAAAAJR22dTh-x7OAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdADIWCMXGpGj1JCBNEDhJCmwPFEUBk9J8Akyrof1WP7Lz0xPGqXgUexrhwiBgEm85CcolEgUt4R_8cUlHq2XPAI2gWmQ9xYC_jVgxXqyiZvlP6VBt-yplk8G70G1C7AcjKU9SYTzxeU2G7e0_zyzloMrqIh9t05uBNh7XTncXOmLo7ltJcLg8iehbv0D28ldal36D9GtP-WJJ55-QBPJF9DeeJhQiUGXu-tUPpzwxM4rA8kftkjkWgbglsAAAAJR22dTh-x7OAAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 11:38:56,621 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-18 11:38:56,621 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-18 11:38:56,621 oidcrp.service DEBUG response format: json
2023-10-18 11:38:56,621 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-18 11:38:56,621 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-18 11:38:56,621 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-18 11:38:56,622 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-18 11:38:56,622 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-18 11:38:56,622 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 11:38:56,622 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-18 11:38:56,622 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 11:38:56,639 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-18 11:38:56,639 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 11:38:56,639 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow", "e": "AQAB"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 11:38:56,640 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access', 'email'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-18 11:38:56,640 oidcrp.rp_handler DEBUG Do client registration
2023-10-18 11:38:56,640 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-18 11:38:56,640 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-18 11:38:56,640 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access', 'email'], 'response_type': 'code', 'nonce': 'sWLr8iarV5jYf1N27gsMxhHH', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'ShMJJxXYvMqlRhdNqNpwWyFKmik1GwIi'}
2023-10-18 11:38:56,641 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access email', 'response_type': 'code', 'nonce': 'sWLr8iarV5jYf1N27gsMxhHH', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': 'ShMJJxXYvMqlRhdNqNpwWyFKmik1GwIi', 'code_challenge': 'uT6nJyk7ql8kAwaJ3lT0pdMy2NVq-udIc5FNnMGmOVM', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-18 11:38:56,641 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f1486852450>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access+email&response_type=code&nonce=sWLr8iarV5jYf1N27gsMxhHH&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=ShMJJxXYvMqlRhdNqNpwWyFKmik1GwIi&code_challenge=uT6nJyk7ql8kAwaJ3lT0pdMy2NVq-udIc5FNnMGmOVM&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-18 11:38:56,642 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 11:38:56] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-18 11:39:05,924 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-18 11:39:05,924 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-18 11:39:05,924 oidcrp.service DEBUG response format: dict
2023-10-18 11:39:05,924 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-18 11:39:05,924 oidcrp.service DEBUG Initial response parsing => "{'state': 'ShMJJxXYvMqlRhdNqNpwWyFKmik1GwIi', 'scope': 'profile openid offline_access email', 'code': 'Z0FBQUFBQmxMNmU1Sm52T3ZuakhKdGJlSDZpSWJiYTZFVmU3Y1BHbFhnYzdvZ05odnhrWEdYZzk4NHRTTnFwVVJRa05VUThnbG9EcUdreWJvLWJfT0w0RWNQbXFkaTBaVmV6aWxsQnlITzVCbmxieUw4WFBQZ1FmZ1pKaDk2ME0tc211YlBQT09ZaWVOU0VCYmtGbzJ4Wm5SczhMQm9ybXBHendxWjFsa1FpblBDZDZvWXNob1BOdElCck4yM3dJSFNySlhfS1NpeHB6dEJsVTd0b0tHbjBrQnFYTHVXN3g2anF4TmJQWFNoWW9iVm43bjZzbmRaS0ZaZ2RNaVg1MzVOcHRiZjBsc2tUaDBaNTVXZDRvM1NheUltdEpwWmNjZk5MMzJwcmpIZUlFRnZVLWVQeXFRWFl4ZGsxVERrR0NuSElwMnNhM3lLSmtoMjhKc2Q1eXM4ZFNTZDBSekpwNFEyNFlrRFA5WFl6Vmd1WjJMMG1sQ3l6b1YzYUVYZ0pkYzNkTXdSbmNaN0NXYUE1UDVkWHZJOTRDODJfRzQzT3E5YXVMbUgwS0tXUWdPRXF1OXU5dGd0VFFQank5d0x2eW5vdjJsanRNdGxDbTBNUTVSSmw4bEJmZ0xQYXZ6SnBjZkdZSlpCWXVkdlhNNTN4WTU5clpuQjI1NkY3Q2JtSHFnVmZzQzdvcG4zN0hwOUJDS3ptcmVpLUN5WDctRFE0b1F6LTdPTjJDZXItRmJvV2pvcjhjWWhpQmRqdWdhUmd4SmFxcTdHaWlqMWF6N2R2N3pndldxaGZEWGliYjVuU3JFbkRGem5Ra0lzNVVMV3RsbzN1b095eWVndmI2YnVkazNwc3NEenVLZlJQRmlkeUVoZHhmZHdwaUgzT3dRS1kzV3NLWnNjN3FlMlZjU0czMkZ5OXhURTQ9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-18 11:39:05,924 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-18 11:39:05,924 oidcrp.rp_handler DEBUG Authz response: {'state': 'ShMJJxXYvMqlRhdNqNpwWyFKmik1GwIi', 'scope': 'profile openid offline_access email', 'code': 'Z0FBQUFBQmxMNmU1Sm52T3ZuakhKdGJlSDZpSWJiYTZFVmU3Y1BHbFhnYzdvZ05odnhrWEdYZzk4NHRTTnFwVVJRa05VUThnbG9EcUdreWJvLWJfT0w0RWNQbXFkaTBaVmV6aWxsQnlITzVCbmxieUw4WFBQZ1FmZ1pKaDk2ME0tc211YlBQT09ZaWVOU0VCYmtGbzJ4Wm5SczhMQm9ybXBHendxWjFsa1FpblBDZDZvWXNob1BOdElCck4yM3dJSFNySlhfS1NpeHB6dEJsVTd0b0tHbjBrQnFYTHVXN3g2anF4TmJQWFNoWW9iVm43bjZzbmRaS0ZaZ2RNaVg1MzVOcHRiZjBsc2tUaDBaNTVXZDRvM1NheUltdEpwWmNjZk5MMzJwcmpIZUlFRnZVLWVQeXFRWFl4ZGsxVERrR0NuSElwMnNhM3lLSmtoMjhKc2Q1eXM4ZFNTZDBSekpwNFEyNFlrRFA5WFl6Vmd1WjJMMG1sQ3l6b1YzYUVYZ0pkYzNkTXdSbmNaN0NXYUE1UDVkWHZJOTRDODJfRzQzT3E5YXVMbUgwS0tXUWdPRXF1OXU5dGd0VFFQank5d0x2eW5vdjJsanRNdGxDbTBNUTVSSmw4bEJmZ0xQYXZ6SnBjZkdZSlpCWXVkdlhNNTN4WTU5clpuQjI1NkY3Q2JtSHFnVmZzQzdvcG4zN0hwOUJDS3ptcmVpLUN5WDctRFE0b1F6LTdPTjJDZXItRmJvV2pvcjhjWWhpQmRqdWdhUmd4SmFxcTdHaWlqMWF6N2R2N3pndldxaGZEWGliYjVuU3JFbkRGem5Ra0lzNVVMV3RsbzN1b095eWVndmI2YnVkazNwc3NEenVLZlJQRmlkeUVoZHhmZHdwaUgzT3dRS1kzV3NLWnNjN3FlMlZjU0czMkZ5OXhURTQ9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-18 11:39:05,924 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-18 11:39:05,924 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-18 11:39:05,925 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMNmU1Sm52T3ZuakhKdGJlSDZpSWJiYTZFVmU3Y1BHbFhnYzdvZ05odnhrWEdYZzk4NHRTTnFwVVJRa05VUThnbG9EcUdreWJvLWJfT0w0RWNQbXFkaTBaVmV6aWxsQnlITzVCbmxieUw4WFBQZ1FmZ1pKaDk2ME0tc211YlBQT09ZaWVOU0VCYmtGbzJ4Wm5SczhMQm9ybXBHendxWjFsa1FpblBDZDZvWXNob1BOdElCck4yM3dJSFNySlhfS1NpeHB6dEJsVTd0b0tHbjBrQnFYTHVXN3g2anF4TmJQWFNoWW9iVm43bjZzbmRaS0ZaZ2RNaVg1MzVOcHRiZjBsc2tUaDBaNTVXZDRvM1NheUltdEpwWmNjZk5MMzJwcmpIZUlFRnZVLWVQeXFRWFl4ZGsxVERrR0NuSElwMnNhM3lLSmtoMjhKc2Q1eXM4ZFNTZDBSekpwNFEyNFlrRFA5WFl6Vmd1WjJMMG1sQ3l6b1YzYUVYZ0pkYzNkTXdSbmNaN0NXYUE1UDVkWHZJOTRDODJfRzQzT3E5YXVMbUgwS0tXUWdPRXF1OXU5dGd0VFFQank5d0x2eW5vdjJsanRNdGxDbTBNUTVSSmw4bEJmZ0xQYXZ6SnBjZkdZSlpCWXVkdlhNNTN4WTU5clpuQjI1NkY3Q2JtSHFnVmZzQzdvcG4zN0hwOUJDS3ptcmVpLUN5WDctRFE0b1F6LTdPTjJDZXItRmJvV2pvcjhjWWhpQmRqdWdhUmd4SmFxcTdHaWlqMWF6N2R2N3pndldxaGZEWGliYjVuU3JFbkRGem5Ra0lzNVVMV3RsbzN1b095eWVndmI2YnVkazNwc3NEenVLZlJQRmlkeUVoZHhmZHdwaUgzT3dRS1kzV3NLWnNjN3FlMlZjU0czMkZ5OXhURTQ9', 'state': 'ShMJJxXYvMqlRhdNqNpwWyFKmik1GwIi', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-18 11:39:05,925 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': 'ShMJJxXYvMqlRhdNqNpwWyFKmik1GwIi', 'code': 'Z0FBQUFBQmxMNmU1Sm52T3ZuakhKdGJlSDZpSWJiYTZFVmU3Y1BHbFhnYzdvZ05odnhrWEdYZzk4NHRTTnFwVVJRa05VUThnbG9EcUdreWJvLWJfT0w0RWNQbXFkaTBaVmV6aWxsQnlITzVCbmxieUw4WFBQZ1FmZ1pKaDk2ME0tc211YlBQT09ZaWVOU0VCYmtGbzJ4Wm5SczhMQm9ybXBHendxWjFsa1FpblBDZDZvWXNob1BOdElCck4yM3dJSFNySlhfS1NpeHB6dEJsVTd0b0tHbjBrQnFYTHVXN3g2anF4TmJQWFNoWW9iVm43bjZzbmRaS0ZaZ2RNaVg1MzVOcHRiZjBsc2tUaDBaNTVXZDRvM1NheUltdEpwWmNjZk5MMzJwcmpIZUlFRnZVLWVQeXFRWFl4ZGsxVERrR0NuSElwMnNhM3lLSmtoMjhKc2Q1eXM4ZFNTZDBSekpwNFEyNFlrRFA5WFl6Vmd1WjJMMG1sQ3l6b1YzYUVYZ0pkYzNkTXdSbmNaN0NXYUE1UDVkWHZJOTRDODJfRzQzT3E5YXVMbUgwS0tXUWdPRXF1OXU5dGd0VFFQank5d0x2eW5vdjJsanRNdGxDbTBNUTVSSmw4bEJmZ0xQYXZ6SnBjZkdZSlpCWXVkdlhNNTN4WTU5clpuQjI1NkY3Q2JtSHFnVmZzQzdvcG4zN0hwOUJDS3ptcmVpLUN5WDctRFE0b1F6LTdPTjJDZXItRmJvV2pvcjhjWWhpQmRqdWdhUmd4SmFxcTdHaWlqMWF6N2R2N3pndldxaGZEWGliYjVuU3JFbkRGem5Ra0lzNVVMV3RsbzN1b095eWVndmI2YnVkazNwc3NEenVLZlJQRmlkeUVoZHhmZHdwaUgzT3dRS1kzV3NLWnNjN3FlMlZjU0czMkZ5OXhURTQ9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'Ol25u5MQC8QRoX8oTCGu2Wq1wSMRj0wcLdPsmUAPpVhRcsY6kQYzUPX02Me85it7'}
2023-10-18 11:39:05,925 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-18 11:39:05,925 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f14855d73d0>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=ShMJJxXYvMqlRhdNqNpwWyFKmik1GwIi&code=Z0FBQUFBQmxMNmU1Sm52T3ZuakhKdGJlSDZpSWJiYTZFVmU3Y1BHbFhnYzdvZ05odnhrWEdYZzk4NHRTTnFwVVJRa05VUThnbG9EcUdreWJvLWJfT0w0RWNQbXFkaTBaVmV6aWxsQnlITzVCbmxieUw4WFBQZ1FmZ1pKaDk2ME0tc211YlBQT09ZaWVOU0VCYmtGbzJ4Wm5SczhMQm9ybXBHendxWjFsa1FpblBDZDZvWXNob1BOdElCck4yM3dJSFNySlhfS1NpeHB6dEJsVTd0b0tHbjBrQnFYTHVXN3g2anF4TmJQWFNoWW9iVm43bjZzbmRaS0ZaZ2RNaVg1MzVOcHRiZjBsc2tUaDBaNTVXZDRvM1NheUltdEpwWmNjZk5MMzJwcmpIZUlFRnZVLWVQeXFRWFl4ZGsxVERrR0NuSElwMnNhM3lLSmtoMjhKc2Q1eXM4ZFNTZDBSekpwNFEyNFlrRFA5WFl6Vmd1WjJMMG1sQ3l6b1YzYUVYZ0pkYzNkTXdSbmNaN0NXYUE1UDVkWHZJOTRDODJfRzQzT3E5YXVMbUgwS0tXUWdPRXF1OXU5dGd0VFFQank5d0x2eW5vdjJsanRNdGxDbTBNUTVSSmw4bEJmZ0xQYXZ6SnBjZkdZSlpCWXVkdlhNNTN4WTU5clpuQjI1NkY3Q2JtSHFnVmZzQzdvcG4zN0hwOUJDS3ptcmVpLUN5WDctRFE0b1F6LTdPTjJDZXItRmJvV2pvcjhjWWhpQmRqdWdhUmd4SmFxcTdHaWlqMWF6N2R2N3pndldxaGZEWGliYjVuU3JFbkRGem5Ra0lzNVVMV3RsbzN1b095eWVndmI2YnVkazNwc3NEenVLZlJQRmlkeUVoZHhmZHdwaUgzT3dRS1kzV3NLWnNjN3FlMlZjU0czMkZ5OXhURTQ9&code_verifier=Ol25u5MQC8QRoX8oTCGu2Wq1wSMRj0wcLdPsmUAPpVhRcsY6kQYzUPX02Me85it7', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-18 11:39:05,925 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=ShMJJxXYvMqlRhdNqNpwWyFKmik1GwIi&code=Z0FBQUFBQmxMNmU1Sm52T3ZuakhKdGJlSDZpSWJiYTZFVmU3Y1BHbFhnYzdvZ05odnhrWEdYZzk4NHRTTnFwVVJRa05VUThnbG9EcUdreWJvLWJfT0w0RWNQbXFkaTBaVmV6aWxsQnlITzVCbmxieUw4WFBQZ1FmZ1pKaDk2ME0tc211YlBQT09ZaWVOU0VCYmtGbzJ4Wm5SczhMQm9ybXBHendxWjFsa1FpblBDZDZvWXNob1BOdElCck4yM3dJSFNySlhfS1NpeHB6dEJsVTd0b0tHbjBrQnFYTHVXN3g2anF4TmJQWFNoWW9iVm43bjZzbmRaS0ZaZ2RNaVg1MzVOcHRiZjBsc2tUaDBaNTVXZDRvM1NheUltdEpwWmNjZk5MMzJwcmpIZUlFRnZVLWVQeXFRWFl4ZGsxVERrR0NuSElwMnNhM3lLSmtoMjhKc2Q1eXM4ZFNTZDBSekpwNFEyNFlrRFA5WFl6Vmd1WjJMMG1sQ3l6b1YzYUVYZ0pkYzNkTXdSbmNaN0NXYUE1UDVkWHZJOTRDODJfRzQzT3E5YXVMbUgwS0tXUWdPRXF1OXU5dGd0VFFQank5d0x2eW5vdjJsanRNdGxDbTBNUTVSSmw4bEJmZ0xQYXZ6SnBjZkdZSlpCWXVkdlhNNTN4WTU5clpuQjI1NkY3Q2JtSHFnVmZzQzdvcG4zN0hwOUJDS3ptcmVpLUN5WDctRFE0b1F6LTdPTjJDZXItRmJvV2pvcjhjWWhpQmRqdWdhUmd4SmFxcTdHaWlqMWF6N2R2N3pndldxaGZEWGliYjVuU3JFbkRGem5Ra0lzNVVMV3RsbzN1b095eWVndmI2YnVkazNwc3NEenVLZlJQRmlkeUVoZHhmZHdwaUgzT3dRS1kzV3NLWnNjN3FlMlZjU0czMkZ5OXhURTQ9&code_verifier=Ol25u5MQC8QRoX8oTCGu2Wq1wSMRj0wcLdPsmUAPpVhRcsY6kQYzUPX02Me85it7, https_args:{'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-18 11:39:05,926 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 11:39:06,076 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-18 11:39:06,076 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 11:39:06,076 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 11:39:06,076 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 09:39:06 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALZdAD0RSGUTb4yApO-jJRM5-DNcbwej7lWMFdK--ZeBrGo0egSaxQayzVXDzGcCbS0JH5EkJ6gzxWwElKp7LyiAL0eMkQcUT2OMwpYOJwxIgV6ftXM7N2joLz6q3ErmcJE1D6W1kZqHHWBwgay_0krjyP_-DJ57i0v3kPg67YoKURk0s7EATJjDyz_fns34mLS_Pz-WnN2ggAdygjjS13eyyC7CDv_q67ymq3pWY3TmzPTxAcxCxKeJAAAARSXPFsXmnDoAAdIBwAEAAHjETNaxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALZdAD0RSGUTb4yApO-jJRM5-DNcbwej7lWMFdK--ZeBrGo0egSaxQayzVXDzGcCbS0JH5EkJ6gzxWwElKp7LyiAL0eMkQcUT2OMwpYOJwxIgV6ftXM7N2joLz6q3ErmcJE1D6W1kZqHHWBwgay_0krjyP_-DJ57i0v3kPg67YoKURk0s7EATJjDyz_fns34mLS_Pz-WnN2ggAdygjjS13eyyC7CDv_q67ymq3pWY3TmzPTxAcxCxKeJAAAARSXPFsXmnDoAAdIBwAEAAHjETNaxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 11:39:06,076 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access email", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTM5NTY2MDc5Y2Y4NDgyZTlhMjk4NDBmOWQ0ZjQyNTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1ObVUxU20xbE4zUXdaRmh1UjJOYWRUaEZkWE5EWWtKamFraFBaRFJVVkRrdFF6Qm1kM1pGWm1ObWRWSllXamMxYmt4Wk1YWnliRTlxTVcxWlJsVmphemhIZWt0NlRWWk1jWGh4VDJWTVRHVkpRa3BqYWtOTFFVOUJVbHBYWTB0R2EzWnpjM3BuYW5aMlNWQnFTbTlQVkV0eVFWTmtSbWg1UkdSUFRtZFlVMWxrZEhKeFYxcERaVkpGYldGZmQzQklWVmxqVG05dFNqSTFTRTVXWTFSellqQmpXSEJPYURWbGFtVmhSM054V1hSU1JVWjRVVlp2Vm05elRrczJSa2hvZUdGb1VqUTFXRlkzWkdsMlpIaGtZakYwU2s5a1ozSmhTV3hIV0VSTmNUZFpOR2RMYlUweGFUQk9ORGt6ZDNGUFRYcENhbWxwUVhObGNtNUZSVEpZVFVNelFRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjE5NDYsICJleHAiOiAxNjk3NjI1NTQ2fQ.R4yALlS2PJudKrpPmC9Eza_Gnic5kdGFONjv0-EDf1fvaoP6CCDAHJ1ICyBRJtMhT0iiVbUO0g9ZNqJ5o_qkQg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMNmU2dlB3ZXIxclkyQXdWdmpsV1J4NjE2aW4wSUpsVWU2dnl2M2txQUxrdTJjZnhvMk9mNGVCbFBTYnpuNVBrdWltUU1WMVVJMzh1RTlHRXVQcW5uLUNBSDdubWJGMGNiWV8zemhySVVNVVBReW43MDRWNWxfZFcxUE4tMjljVHA3MVhoNHVSTmZKczUwZ2dQZGtlS3hteUV4TEJXdHB0SF9ONlFha3Z5SjQwOUZvWWF5MmJ4YzFmanF5ODJwQWxSbUhac2lFVFRfd0xwZkhrU2NramVLZ1dYaGpwbjRQZjMwN2s4M2laN0NBRlMzaUpBUVg4eFV5VHZBNDgwQy1LV29YR1cyQUh1UGJMRUZIcjd1d21IX3NwZGRCbFYtX3pGb1MwQ1M5cW9tTUxaQS1uYnREVnU3UGxQTFByOXowUVhaalNGblJwZ3VkZzMyLXo4N0FQTkRQdFJ1WGUtdFlwM1BtR0VEZ3pXLVVVRDZadS1zdGxUejRWcGxYX3YzazRYQ3ZGcVpoUkZsbkVCVkNObW51Y1FBR0pWenlHbTBGc1BGdERqTDZUdFVzRUw3Sk5UbUhUWHNvTGRua2ctVzZwRmZqcFFQcFhlclpHN2Z0RUhBcHdtbGVGLVlMMnItVUF1MWVFbUpUanNwSjlDTjRJamJzWEpmSDFBZlVEYUh3ZTQ3X2p6VVM1MWlKMkNrZXhIS0dMMDEzVTRUZ2tQR0E4aWFWMUlOMkJ4ampTQlBDX3RNeGFyLU9BSnloa1JoUzQtTjVEcjc3S1hWUVotd1FlTHREbkpCaDBiQ1AyeU1pdHg0bGY4RHItWFU5YklKMkdReFlZSWtoWmdmSXNZcGdRZUJ5X3BOVzlwNjRVbHh4TDZkRThsaVp4SDhMT3E1RU91R3FzV2hkNHR6VWxuYzQ9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTm1VMVNtMWxOM1F3WkZodVIyTmFkVGhGZFhORFlrSmpha2hQWkRSVVZEa3RRekJtZDNaRlptTm1kVkpZV2pjMWJreFpNWFp5YkU5cU1XMVpSbFZqYXpoSGVrdDZUVlpNY1hoeFQyVk1UR1ZKUWtwamFrTkxRVTlCVWxwWFkwdEdhM1p6YzNwbmFuWjJTVkJxU205UFZFdHlRVk5rUm1oNVJHUlBUbWRZVTFsa2RISnhWMXBEWlZKRmJXRmZkM0JJVlZsalRtOXRTakkxU0U1V1kxUnpZakJqV0hCT2FEVmxhbVZoUjNOeFdYUlNSVVo0VVZadlZtOXpUa3MyUmtob2VHRm9ValExV0ZZM1pHbDJaSGhrWWpGMFNrOWtaM0poU1d4SFdFUk5jVGRaTkdkTGJVMHhhVEJPTkRremQzRlBUWHBDYW1scFFYTmxjbTVGUlRKWVRVTXpRUT09IiwgImF1dGhfdGltZSI6IDE2OTc2MjE5NDUsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIiwgImVtYWlsIl0sICJqdGkiOiAiMmUxNjNlY2I2ZDlhMTFlZWJlYjgwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogInNXTHI4aWFyVjVqWWYxTjI3Z3NNeGhISCIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjIxOTQ2LCAiZXhwIjogMTY5NzYyMjI0NiwgImF1ZCI6IFsiand0X3Rlc3QiXX0.kgwhBzUi1Gf2c8c2LlXsW8KJM1KcyrPsIq6f-meUIzSLpYoKwezuvL7BMyz6kGJf53b1GyO4jCylobXayizUuRsEUYEHn9kydLlwI6ITkHFxV8hjyMtzDM0OB9dlxbsZQiDkpPaGL1sCe3JmFw_mEAFQtQWswhy8ANAQkBkT00pebDg2WSChaRcRq4fO3iMehQG8G2Kaf0kCKiTGU-5MwmGVI1nV-gfC4raMU0nslM-A97qiXPb625KDX3QL_HacUd6FY79qlYFsj0oDQDm4vJkTc2a8o4MtdOdRlltE3pnBiARibtPnhijsBf8E0hS5vtvInXBCJ-te-kTXcDxzaQ"}
2023-10-18 11:39:06,076 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access email", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTM5NTY2MDc5Y2Y4NDgyZTlhMjk4NDBmOWQ0ZjQyNTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1ObVUxU20xbE4zUXdaRmh1UjJOYWRUaEZkWE5EWWtKamFraFBaRFJVVkRrdFF6Qm1kM1pGWm1ObWRWSllXamMxYmt4Wk1YWnliRTlxTVcxWlJsVmphemhIZWt0NlRWWk1jWGh4VDJWTVRHVkpRa3BqYWtOTFFVOUJVbHBYWTB0R2EzWnpjM3BuYW5aMlNWQnFTbTlQVkV0eVFWTmtSbWg1UkdSUFRtZFlVMWxrZEhKeFYxcERaVkpGYldGZmQzQklWVmxqVG05dFNqSTFTRTVXWTFSellqQmpXSEJPYURWbGFtVmhSM054V1hSU1JVWjRVVlp2Vm05elRrczJSa2hvZUdGb1VqUTFXRlkzWkdsMlpIaGtZakYwU2s5a1ozSmhTV3hIV0VSTmNUZFpOR2RMYlUweGFUQk9ORGt6ZDNGUFRYcENhbWxwUVhObGNtNUZSVEpZVFVNelFRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjE5NDYsICJleHAiOiAxNjk3NjI1NTQ2fQ.R4yALlS2PJudKrpPmC9Eza_Gnic5kdGFONjv0-EDf1fvaoP6CCDAHJ1ICyBRJtMhT0iiVbUO0g9ZNqJ5o_qkQg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMNmU2dlB3ZXIxclkyQXdWdmpsV1J4NjE2aW4wSUpsVWU2dnl2M2txQUxrdTJjZnhvMk9mNGVCbFBTYnpuNVBrdWltUU1WMVVJMzh1RTlHRXVQcW5uLUNBSDdubWJGMGNiWV8zemhySVVNVVBReW43MDRWNWxfZFcxUE4tMjljVHA3MVhoNHVSTmZKczUwZ2dQZGtlS3hteUV4TEJXdHB0SF9ONlFha3Z5SjQwOUZvWWF5MmJ4YzFmanF5ODJwQWxSbUhac2lFVFRfd0xwZkhrU2NramVLZ1dYaGpwbjRQZjMwN2s4M2laN0NBRlMzaUpBUVg4eFV5VHZBNDgwQy1LV29YR1cyQUh1UGJMRUZIcjd1d21IX3NwZGRCbFYtX3pGb1MwQ1M5cW9tTUxaQS1uYnREVnU3UGxQTFByOXowUVhaalNGblJwZ3VkZzMyLXo4N0FQTkRQdFJ1WGUtdFlwM1BtR0VEZ3pXLVVVRDZadS1zdGxUejRWcGxYX3YzazRYQ3ZGcVpoUkZsbkVCVkNObW51Y1FBR0pWenlHbTBGc1BGdERqTDZUdFVzRUw3Sk5UbUhUWHNvTGRua2ctVzZwRmZqcFFQcFhlclpHN2Z0RUhBcHdtbGVGLVlMMnItVUF1MWVFbUpUanNwSjlDTjRJamJzWEpmSDFBZlVEYUh3ZTQ3X2p6VVM1MWlKMkNrZXhIS0dMMDEzVTRUZ2tQR0E4aWFWMUlOMkJ4ampTQlBDX3RNeGFyLU9BSnloa1JoUzQtTjVEcjc3S1hWUVotd1FlTHREbkpCaDBiQ1AyeU1pdHg0bGY4RHItWFU5YklKMkdReFlZSWtoWmdmSXNZcGdRZUJ5X3BOVzlwNjRVbHh4TDZkRThsaVp4SDhMT3E1RU91R3FzV2hkNHR6VWxuYzQ9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTm1VMVNtMWxOM1F3WkZodVIyTmFkVGhGZFhORFlrSmpha2hQWkRSVVZEa3RRekJtZDNaRlptTm1kVkpZV2pjMWJreFpNWFp5YkU5cU1XMVpSbFZqYXpoSGVrdDZUVlpNY1hoeFQyVk1UR1ZKUWtwamFrTkxRVTlCVWxwWFkwdEdhM1p6YzNwbmFuWjJTVkJxU205UFZFdHlRVk5rUm1oNVJHUlBUbWRZVTFsa2RISnhWMXBEWlZKRmJXRmZkM0JJVlZsalRtOXRTakkxU0U1V1kxUnpZakJqV0hCT2FEVmxhbVZoUjNOeFdYUlNSVVo0VVZadlZtOXpUa3MyUmtob2VHRm9ValExV0ZZM1pHbDJaSGhrWWpGMFNrOWtaM0poU1d4SFdFUk5jVGRaTkdkTGJVMHhhVEJPTkRremQzRlBUWHBDYW1scFFYTmxjbTVGUlRKWVRVTXpRUT09IiwgImF1dGhfdGltZSI6IDE2OTc2MjE5NDUsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIiwgImVtYWlsIl0sICJqdGkiOiAiMmUxNjNlY2I2ZDlhMTFlZWJlYjgwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogInNXTHI4aWFyVjVqWWYxTjI3Z3NNeGhISCIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjIxOTQ2LCAiZXhwIjogMTY5NzYyMjI0NiwgImF1ZCI6IFsiand0X3Rlc3QiXX0.kgwhBzUi1Gf2c8c2LlXsW8KJM1KcyrPsIq6f-meUIzSLpYoKwezuvL7BMyz6kGJf53b1GyO4jCylobXayizUuRsEUYEHn9kydLlwI6ITkHFxV8hjyMtzDM0OB9dlxbsZQiDkpPaGL1sCe3JmFw_mEAFQtQWswhy8ANAQkBkT00pebDg2WSChaRcRq4fO3iMehQG8G2Kaf0kCKiTGU-5MwmGVI1nV-gfC4raMU0nslM-A97qiXPb625KDX3QL_HacUd6FY79qlYFsj0oDQDm4vJkTc2a8o4MtdOdRlltE3pnBiARibtPnhijsBf8E0hS5vtvInXBCJ-te-kTXcDxzaQ"}
2023-10-18 11:39:06,076 oidcrp.service DEBUG response format: json
2023-10-18 11:39:06,076 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-18 11:39:06,076 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access email', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTM5NTY2MDc5Y2Y4NDgyZTlhMjk4NDBmOWQ0ZjQyNTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1ObVUxU20xbE4zUXdaRmh1UjJOYWRUaEZkWE5EWWtKamFraFBaRFJVVkRrdFF6Qm1kM1pGWm1ObWRWSllXamMxYmt4Wk1YWnliRTlxTVcxWlJsVmphemhIZWt0NlRWWk1jWGh4VDJWTVRHVkpRa3BqYWtOTFFVOUJVbHBYWTB0R2EzWnpjM3BuYW5aMlNWQnFTbTlQVkV0eVFWTmtSbWg1UkdSUFRtZFlVMWxrZEhKeFYxcERaVkpGYldGZmQzQklWVmxqVG05dFNqSTFTRTVXWTFSellqQmpXSEJPYURWbGFtVmhSM054V1hSU1JVWjRVVlp2Vm05elRrczJSa2hvZUdGb1VqUTFXRlkzWkdsMlpIaGtZakYwU2s5a1ozSmhTV3hIV0VSTmNUZFpOR2RMYlUweGFUQk9ORGt6ZDNGUFRYcENhbWxwUVhObGNtNUZSVEpZVFVNelFRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjE5NDYsICJleHAiOiAxNjk3NjI1NTQ2fQ.R4yALlS2PJudKrpPmC9Eza_Gnic5kdGFONjv0-EDf1fvaoP6CCDAHJ1ICyBRJtMhT0iiVbUO0g9ZNqJ5o_qkQg', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxMNmU2dlB3ZXIxclkyQXdWdmpsV1J4NjE2aW4wSUpsVWU2dnl2M2txQUxrdTJjZnhvMk9mNGVCbFBTYnpuNVBrdWltUU1WMVVJMzh1RTlHRXVQcW5uLUNBSDdubWJGMGNiWV8zemhySVVNVVBReW43MDRWNWxfZFcxUE4tMjljVHA3MVhoNHVSTmZKczUwZ2dQZGtlS3hteUV4TEJXdHB0SF9ONlFha3Z5SjQwOUZvWWF5MmJ4YzFmanF5ODJwQWxSbUhac2lFVFRfd0xwZkhrU2NramVLZ1dYaGpwbjRQZjMwN2s4M2laN0NBRlMzaUpBUVg4eFV5VHZBNDgwQy1LV29YR1cyQUh1UGJMRUZIcjd1d21IX3NwZGRCbFYtX3pGb1MwQ1M5cW9tTUxaQS1uYnREVnU3UGxQTFByOXowUVhaalNGblJwZ3VkZzMyLXo4N0FQTkRQdFJ1WGUtdFlwM1BtR0VEZ3pXLVVVRDZadS1zdGxUejRWcGxYX3YzazRYQ3ZGcVpoUkZsbkVCVkNObW51Y1FBR0pWenlHbTBGc1BGdERqTDZUdFVzRUw3Sk5UbUhUWHNvTGRua2ctVzZwRmZqcFFQcFhlclpHN2Z0RUhBcHdtbGVGLVlMMnItVUF1MWVFbUpUanNwSjlDTjRJamJzWEpmSDFBZlVEYUh3ZTQ3X2p6VVM1MWlKMkNrZXhIS0dMMDEzVTRUZ2tQR0E4aWFWMUlOMkJ4ampTQlBDX3RNeGFyLU9BSnloa1JoUzQtTjVEcjc3S1hWUVotd1FlTHREbkpCaDBiQ1AyeU1pdHg0bGY4RHItWFU5YklKMkdReFlZSWtoWmdmSXNZcGdRZUJ5X3BOVzlwNjRVbHh4TDZkRThsaVp4SDhMT3E1RU91R3FzV2hkNHR6VWxuYzQ9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTm1VMVNtMWxOM1F3WkZodVIyTmFkVGhGZFhORFlrSmpha2hQWkRSVVZEa3RRekJtZDNaRlptTm1kVkpZV2pjMWJreFpNWFp5YkU5cU1XMVpSbFZqYXpoSGVrdDZUVlpNY1hoeFQyVk1UR1ZKUWtwamFrTkxRVTlCVWxwWFkwdEdhM1p6YzNwbmFuWjJTVkJxU205UFZFdHlRVk5rUm1oNVJHUlBUbWRZVTFsa2RISnhWMXBEWlZKRmJXRmZkM0JJVlZsalRtOXRTakkxU0U1V1kxUnpZakJqV0hCT2FEVmxhbVZoUjNOeFdYUlNSVVo0VVZadlZtOXpUa3MyUmtob2VHRm9ValExV0ZZM1pHbDJaSGhrWWpGMFNrOWtaM0poU1d4SFdFUk5jVGRaTkdkTGJVMHhhVEJPTkRremQzRlBUWHBDYW1scFFYTmxjbTVGUlRKWVRVTXpRUT09IiwgImF1dGhfdGltZSI6IDE2OTc2MjE5NDUsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIiwgImVtYWlsIl0sICJqdGkiOiAiMmUxNjNlY2I2ZDlhMTFlZWJlYjgwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogInNXTHI4aWFyVjVqWWYxTjI3Z3NNeGhISCIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjIxOTQ2LCAiZXhwIjogMTY5NzYyMjI0NiwgImF1ZCI6IFsiand0X3Rlc3QiXX0.kgwhBzUi1Gf2c8c2LlXsW8KJM1KcyrPsIq6f-meUIzSLpYoKwezuvL7BMyz6kGJf53b1GyO4jCylobXayizUuRsEUYEHn9kydLlwI6ITkHFxV8hjyMtzDM0OB9dlxbsZQiDkpPaGL1sCe3JmFw_mEAFQtQWswhy8ANAQkBkT00pebDg2WSChaRcRq4fO3iMehQG8G2Kaf0kCKiTGU-5MwmGVI1nV-gfC4raMU0nslM-A97qiXPb625KDX3QL_HacUd6FY79qlYFsj0oDQDm4vJkTc2a8o4MtdOdRlltE3pnBiARibtPnhijsBf8E0hS5vtvInXBCJ-te-kTXcDxzaQ'}"
2023-10-18 11:39:06,077 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-18 11:39:06,077 oidcmsg.message DEBUG Raw JSON: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMNmU1Sm1lN3QwZFhuR2NadThFdXNDYkJjakhPZDRUVDktQzBmd3ZFZmNmdVJYWjc1bkxZMXZybE9qMW1ZRlVjazhHekt6TVZMcXhxT2VMTGVJQkpjakNLQU9BUlpXY0tGa3Zzc3pnanZ2SVBqSm9PVEtyQVNkRmh5RGRPTmdYU1lkdHJxV1pDZVJFbWFfd3BIVVljTm9tSjI1SE5WY1RzYjBjWHBOaDVlamVhR3NxWXRSRUZ4UVZvVm9zTks2RkhoeGFoUjQ1WFY3ZGl2ZHhkYjF0Sk9kZ3JhSWxHWERNcTdZNGdLbU0xaTBONDkzd3FPTXpCamlpQXNlcm5FRTJYTUMzQQ==', 'auth_time': 1697621945, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access', 'email'], 'jti': '2e163ecb6d9a11eebeb80242ac170004', 'client_id': 'jwt_test', 'nonce': 'sWLr8iarV5jYf1N27gsMxhHH', 'iss': 'https://satosa.idem.it', 'iat': 1697621946, 'exp': 1697622246, 'aud': ['jwt_test']}
2023-10-18 11:39:06,077 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA'}
2023-10-18 11:39:06,077 cryptojwt.key_jar DEBUG Key summary for https://satosa.idem.it: RSA:sig:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, EC:sig:LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw
2023-10-18 11:39:06,077 oidcmsg.message DEBUG Found signing key.
2023-10-18 11:39:06,077 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-18 11:39:06,077 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA and use=
2023-10-18 11:39:06,077 cryptojwt.jwx DEBUG Picked: kid:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, use:sig, kty:RSA
2023-10-18 11:39:06,078 cryptojwt.jws.jws DEBUG Verified message using key with kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA
2023-10-18 11:39:06,078 oidcmsg.oidc INFO Verified id_token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMNmU1Sm1lN3QwZFhuR2NadThFdXNDYkJjakhPZDRUVDktQzBmd3ZFZmNmdVJYWjc1bkxZMXZybE9qMW1ZRlVjazhHekt6TVZMcXhxT2VMTGVJQkpjakNLQU9BUlpXY0tGa3Zzc3pnanZ2SVBqSm9PVEtyQVNkRmh5RGRPTmdYU1lkdHJxV1pDZVJFbWFfd3BIVVljTm9tSjI1SE5WY1RzYjBjWHBOaDVlamVhR3NxWXRSRUZ4UVZvVm9zTks2RkhoeGFoUjQ1WFY3ZGl2ZHhkYjF0Sk9kZ3JhSWxHWERNcTdZNGdLbU0xaTBONDkzd3FPTXpCamlpQXNlcm5FRTJYTUMzQQ==', 'auth_time': 1697621945, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access', 'email'], 'jti': '2e163ecb6d9a11eebeb80242ac170004', 'client_id': 'jwt_test', 'nonce': 'sWLr8iarV5jYf1N27gsMxhHH', 'iss': 'https://satosa.idem.it', 'iat': 1697621946, 'exp': 1697622246, 'aud': ['jwt_test']}
2023-10-18 11:39:06,079 oidcrp.rp_handler DEBUG ID Token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMNmU1Sm1lN3QwZFhuR2NadThFdXNDYkJjakhPZDRUVDktQzBmd3ZFZmNmdVJYWjc1bkxZMXZybE9qMW1ZRlVjazhHekt6TVZMcXhxT2VMTGVJQkpjakNLQU9BUlpXY0tGa3Zzc3pnanZ2SVBqSm9PVEtyQVNkRmh5RGRPTmdYU1lkdHJxV1pDZVJFbWFfd3BIVVljTm9tSjI1SE5WY1RzYjBjWHBOaDVlamVhR3NxWXRSRUZ4UVZvVm9zTks2RkhoeGFoUjQ1WFY3ZGl2ZHhkYjF0Sk9kZ3JhSWxHWERNcTdZNGdLbU0xaTBONDkzd3FPTXpCamlpQXNlcm5FRTJYTUMzQQ==', 'auth_time': 1697621945, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access', 'email'], 'jti': '2e163ecb6d9a11eebeb80242ac170004', 'client_id': 'jwt_test', 'nonce': 'sWLr8iarV5jYf1N27gsMxhHH', 'iss': 'https://satosa.idem.it', 'iat': 1697621946, 'exp': 1697622246, 'aud': ['jwt_test']}
2023-10-18 11:39:06,079 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-18 11:39:06,079 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTM5NTY2MDc5Y2Y4NDgyZTlhMjk4NDBmOWQ0ZjQyNTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1ObVUxU20xbE4zUXdaRmh1UjJOYWRUaEZkWE5EWWtKamFraFBaRFJVVkRrdFF6Qm1kM1pGWm1ObWRWSllXamMxYmt4Wk1YWnliRTlxTVcxWlJsVmphemhIZWt0NlRWWk1jWGh4VDJWTVRHVkpRa3BqYWtOTFFVOUJVbHBYWTB0R2EzWnpjM3BuYW5aMlNWQnFTbTlQVkV0eVFWTmtSbWg1UkdSUFRtZFlVMWxrZEhKeFYxcERaVkpGYldGZmQzQklWVmxqVG05dFNqSTFTRTVXWTFSellqQmpXSEJPYURWbGFtVmhSM054V1hSU1JVWjRVVlp2Vm05elRrczJSa2hvZUdGb1VqUTFXRlkzWkdsMlpIaGtZakYwU2s5a1ozSmhTV3hIV0VSTmNUZFpOR2RMYlUweGFUQk9ORGt6ZDNGUFRYcENhbWxwUVhObGNtNUZSVEpZVFVNelFRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjE5NDYsICJleHAiOiAxNjk3NjI1NTQ2fQ.R4yALlS2PJudKrpPmC9Eza_Gnic5kdGFONjv0-EDf1fvaoP6CCDAHJ1ICyBRJtMhT0iiVbUO0g9ZNqJ5o_qkQg'}
2023-10-18 11:39:06,079 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-18 11:39:06,079 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f14867e9910>, 'url': 'https://satosa.idem.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTM5NTY2MDc5Y2Y4NDgyZTlhMjk4NDBmOWQ0ZjQyNTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1ObVUxU20xbE4zUXdaRmh1UjJOYWRUaEZkWE5EWWtKamFraFBaRFJVVkRrdFF6Qm1kM1pGWm1ObWRWSllXamMxYmt4Wk1YWnliRTlxTVcxWlJsVmphemhIZWt0NlRWWk1jWGh4VDJWTVRHVkpRa3BqYWtOTFFVOUJVbHBYWTB0R2EzWnpjM3BuYW5aMlNWQnFTbTlQVkV0eVFWTmtSbWg1UkdSUFRtZFlVMWxrZEhKeFYxcERaVkpGYldGZmQzQklWVmxqVG05dFNqSTFTRTVXWTFSellqQmpXSEJPYURWbGFtVmhSM054V1hSU1JVWjRVVlp2Vm05elRrczJSa2hvZUdGb1VqUTFXRlkzWkdsMlpIaGtZakYwU2s5a1ozSmhTV3hIV0VSTmNUZFpOR2RMYlUweGFUQk9ORGt6ZDNGUFRYcENhbWxwUVhObGNtNUZSVEpZVFVNelFRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjE5NDYsICJleHAiOiAxNjk3NjI1NTQ2fQ.R4yALlS2PJudKrpPmC9Eza_Gnic5kdGFONjv0-EDf1fvaoP6CCDAHJ1ICyBRJtMhT0iiVbUO0g9ZNqJ5o_qkQg'}}
2023-10-18 11:39:06,079 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTM5NTY2MDc5Y2Y4NDgyZTlhMjk4NDBmOWQ0ZjQyNTciLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1ObVUxU20xbE4zUXdaRmh1UjJOYWRUaEZkWE5EWWtKamFraFBaRFJVVkRrdFF6Qm1kM1pGWm1ObWRWSllXamMxYmt4Wk1YWnliRTlxTVcxWlJsVmphemhIZWt0NlRWWk1jWGh4VDJWTVRHVkpRa3BqYWtOTFFVOUJVbHBYWTB0R2EzWnpjM3BuYW5aMlNWQnFTbTlQVkV0eVFWTmtSbWg1UkdSUFRtZFlVMWxrZEhKeFYxcERaVkpGYldGZmQzQklWVmxqVG05dFNqSTFTRTVXWTFSellqQmpXSEJPYURWbGFtVmhSM054V1hSU1JVWjRVVlp2Vm05elRrczJSa2hvZUdGb1VqUTFXRlkzWkdsMlpIaGtZakYwU2s5a1ozSmhTV3hIV0VSTmNUZFpOR2RMYlUweGFUQk9ORGt6ZDNGUFRYcENhbWxwUVhObGNtNUZSVEpZVFVNelFRPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjE5NDYsICJleHAiOiAxNjk3NjI1NTQ2fQ.R4yALlS2PJudKrpPmC9Eza_Gnic5kdGFONjv0-EDf1fvaoP6CCDAHJ1ICyBRJtMhT0iiVbUO0g9ZNqJ5o_qkQg'}
2023-10-18 11:39:06,079 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 11:39:06,220 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-18 11:39:06,220 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 11:39:06,220 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 11:39:06,220 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 09:39:06 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldABaMhaSKPcPR5eh1PgX0lFijPrfwdtHw62scmesUogV0RmwAw6yv1E6KGQPOPYpXZCaE2fcAMGuc9jvZ4QsauqRD9oAtfXBaujAgfDz5xHUS_Mtn3SRvyzknmds61Jvcevp0quRN8aYjbriIvaUIMpyjugwZn9kevp4PlnnaDvxy2pcwmThDtpe0XDnFoO6-jA1f2APNIeAK1SOU2fNa0imtinOumuPUzJkCNKcVQ6bRg28Y1nfXFerbAAAAAHmxGKgL9BizAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldABaMhaSKPcPR5eh1PgX0lFijPrfwdtHw62scmesUogV0RmwAw6yv1E6KGQPOPYpXZCaE2fcAMGuc9jvZ4QsauqRD9oAtfXBaujAgfDz5xHUS_Mtn3SRvyzknmds61Jvcevp0quRN8aYjbriIvaUIMpyjugwZn9kevp4PlnnaDvxy2pcwmThDtpe0XDnFoO6-jA1f2APNIeAK1SOU2fNa0imtinOumuPUzJkCNKcVQ6bRg28Y1nfXFerbAAAAAHmxGKgL9BizAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 11:39:06,220 oidcrp.util DEBUG resp.txt: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "email": "test1@gmail.com", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-18 11:39:06,220 oidcrp.oauth2 DEBUG Successful response: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "email": "test1@gmail.com", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-18 11:39:06,220 oidcrp.service DEBUG response format: json
2023-10-18 11:39:06,220 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-18 11:39:06,220 oidcrp.service DEBUG Initial response parsing => "{'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'email': 'test1@gmail.com', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}"
2023-10-18 11:39:06,220 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-18 11:39:06,221 oidcrp.rp_handler DEBUG UserInfo: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'email': 'test1@gmail.com', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}
2023-10-18 11:39:06,224 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 11:39:06] "GET /authz_cb/satosa?state=ShMJJxXYvMqlRhdNqNpwWyFKmik1GwIi&scope=profile+openid+offline_access+email&code=Z0FBQUFBQmxMNmU1Sm52T3ZuakhKdGJlSDZpSWJiYTZFVmU3Y1BHbFhnYzdvZ05odnhrWEdYZzk4NHRTTnFwVVJRa05VUThnbG9EcUdreWJvLWJfT0w0RWNQbXFkaTBaVmV6aWxsQnlITzVCbmxieUw4WFBQZ1FmZ1pKaDk2ME0tc211YlBQT09ZaWVOU0VCYmtGbzJ4Wm5SczhMQm9ybXBHendxWjFsa1FpblBDZDZvWXNob1BOdElCck4yM3dJSFNySlhfS1NpeHB6dEJsVTd0b0tHbjBrQnFYTHVXN3g2anF4TmJQWFNoWW9iVm43bjZzbmRaS0ZaZ2RNaVg1MzVOcHRiZjBsc2tUaDBaNTVXZDRvM1NheUltdEpwWmNjZk5MMzJwcmpIZUlFRnZVLWVQeXFRWFl4ZGsxVERrR0NuSElwMnNhM3lLSmtoMjhKc2Q1eXM4ZFNTZDBSekpwNFEyNFlrRFA5WFl6Vmd1WjJMMG1sQ3l6b1YzYUVYZ0pkYzNkTXdSbmNaN0NXYUE1UDVkWHZJOTRDODJfRzQzT3E5YXVMbUgwS0tXUWdPRXF1OXU5dGd0VFFQank5d0x2eW5vdjJsanRNdGxDbTBNUTVSSmw4bEJmZ0xQYXZ6SnBjZkdZSlpCWXVkdlhNNTN4WTU5clpuQjI1NkY3Q2JtSHFnVmZzQzdvcG4zN0hwOUJDS3ptcmVpLUN5WDctRFE0b1F6LTdPTjJDZXItRmJvV2pvcjhjWWhpQmRqdWdhUmd4SmFxcTdHaWlqMWF6N2R2N3pndldxaGZEWGliYjVuU3JFbkRGem5Ra0lzNVVMV3RsbzN1b095eWVndmI2YnVkazNwc3NEenVLZlJQRmlkeUVoZHhmZHdwaUgzT3dRS1kzV3NLWnNjN3FlMlZjU0czMkZ5OXhURTQ9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1" 200 -
2023-10-18 11:54:27,861 root DEBUG Configured logging using dictionary
2023-10-18 11:54:27,900 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-18 11:54:27,900 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-18 11:54:27,901 werkzeug INFO  * Restarting with stat
2023-10-18 11:54:28,084 root DEBUG Configured logging using dictionary
2023-10-18 11:54:28,122 werkzeug WARNING  * Debugger is active!
2023-10-18 11:54:28,122 werkzeug INFO  * Debugger PIN: 491-689-569
2023-10-18 11:54:33,543 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 11:54:33] "GET / HTTP/1.1" 200 -
2023-10-18 11:54:37,410 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-18 11:54:37,410 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-18 11:54:37,410 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-18 11:54:37,411 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-18 11:54:37,451 oidcrp.rp_handler DEBUG Get provider info
2023-10-18 11:54:37,451 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-18 11:54:37,451 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-18 11:54:37,451 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-18 11:54:37,453 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 11:54:37,476 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-18 11:54:37,477 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 11:54:37,477 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 11:54:37,477 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 09:54:37 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdABaZwyNhwAiKsEwYub4LpcSDFBTyFZJg78deRyb3LMKymjLl6pmtIZNACXXG4UsYagk0yRsnumTVXjh49DZGmr5wq59OpWBGzc9kqNwAKs-RVrjah6ftWjEZKQkYvl4h8NN2PUyGHnQboP8Le9oycUJTGe_u156BmB8Ui_kIlEgE6l7PlVviWTBCXVTkxWdmYf3mg4WyGQBiwJ_ZHg3XmNdifCsxM2wEVXmtGre_ocL3CIu6Rt4e45O_AAAAAAwKMTIx0b15AAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALpdABaZwyNhwAiKsEwYub4LpcSDFBTyFZJg78deRyb3LMKymjLl6pmtIZNACXXG4UsYagk0yRsnumTVXjh49DZGmr5wq59OpWBGzc9kqNwAKs-RVrjah6ftWjEZKQkYvl4h8NN2PUyGHnQboP8Le9oycUJTGe_u156BmB8Ui_kIlEgE6l7PlVviWTBCXVTkxWdmYf3mg4WyGQBiwJ_ZHg3XmNdifCsxM2wEVXmtGre_ocL3CIu6Rt4e45O_AAAAAAwKMTIx0b15AAHWAcABAABuht1NscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 11:54:37,477 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email", "urn:oid:1.2.840.113549.1.9.1.1"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-18 11:54:37,477 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email", "urn:oid:1.2.840.113549.1.9.1.1"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-18 11:54:37,477 oidcrp.service DEBUG response format: json
2023-10-18 11:54:37,477 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-18 11:54:37,477 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email', 'urn:oid:1.2.840.113549.1.9.1.1'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-18 11:54:37,477 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-18 11:54:37,478 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-18 11:54:37,478 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-18 11:54:37,478 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 11:54:37,478 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-18 11:54:37,479 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 11:54:37,500 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-18 11:54:37,501 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "e": "AQAB", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 11:54:37,501 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "e": "AQAB", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 11:54:37,502 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access', 'email', 'urn:oid:1.2.840.113549.1.9.1.1'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-18 11:54:37,502 oidcrp.rp_handler DEBUG Do client registration
2023-10-18 11:54:37,502 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-18 11:54:37,502 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-18 11:54:37,502 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access', 'email', 'urn:oid:1.2.840.113549.1.9.1.1'], 'response_type': 'code', 'nonce': 'p7eeFavjRdYebNYdciqcpWkg', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': '82ho0C5naIy7lYBm1lAAWCPrzru5ufIL'}
2023-10-18 11:54:37,502 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access email urn:oid:1.2.840.113549.1.9.1.1', 'response_type': 'code', 'nonce': 'p7eeFavjRdYebNYdciqcpWkg', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': '82ho0C5naIy7lYBm1lAAWCPrzru5ufIL', 'code_challenge': 'O1ITj-FCWowmYawOkHV2VjMfrZUU9NLcp_mOJ91oNw8', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-18 11:54:37,503 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f3281156f90>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access+email+urn%3Aoid%3A1.2.840.113549.1.9.1.1&response_type=code&nonce=p7eeFavjRdYebNYdciqcpWkg&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=82ho0C5naIy7lYBm1lAAWCPrzru5ufIL&code_challenge=O1ITj-FCWowmYawOkHV2VjMfrZUU9NLcp_mOJ91oNw8&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-18 11:54:37,503 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 11:54:37] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-18 11:54:45,575 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-18 11:54:45,575 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-18 11:54:45,575 oidcrp.service DEBUG response format: dict
2023-10-18 11:54:45,575 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-18 11:54:45,575 oidcrp.service DEBUG Initial response parsing => "{'state': '82ho0C5naIy7lYBm1lAAWCPrzru5ufIL', 'scope': 'email offline_access profile openid', 'code': 'Z0FBQUFBQmxMNnRsZjB5ZUZmdjhWb21IME1CVVlPamhRRGl0Vjk5OFktUXIzSDdxMHdGb2dOYWo0dndVZ0dPU3JjanR6OFgwUWxVdWlmTjZ5MGEyVmVYZ3E1d0QyaldtOXZhczFZdFRTbTJDT2M2aW50bV9nTEpjMmwzQ1gxY1g3Sk5KcWV5RG5nRmc5bHdDemItczdyNUQwcHlkRDNoZERDTUs1X1RxTk4zek1QWFZyTHZ2SUNjOHlkTGtDNllMb1VEQnBtNkFDZ3pQWWc0Rl9CSjV2ZHBjUUY0cDFrUGJnaVNPTWN4UnhxWUhpcGhvNU1JUy1JT0VOUE10clVKV2pwVGU2dTRFajVaWDhFVFRQNEd0UWUtREpCUVVxY09XaDNGMG9hZnd5RGJodW52X0FpNFJ3V2h6bzZldXRPNFpMMUJTUHhJMGJzazh6b2ppZmQtc3gtdjFsY1NrSS1YTlA2Nl8wdnJsT0x5U1dqczlfakN5dTN0Q0dJTVpsNjJZTXlKUThaU0RYU2k5cUNCLU4tLXZVN0tRS21kU0lLaHlBMlh2N0FlQ2wwdUwzRlpFaXh6N3F5QncxS2JqOHhSM19DZ1VtdXhDNXRNRFBTdkdFUGlPZVZFcUdDYVJmUWJYYmprM2dqSmd0VndBWFFZNzRvTVpwcGZyMVhHYkZjSm85ODVPZjY5M0Jib1dLRGJEWFg0NURpcnNYRkRtbXhaTWI4R2V2MS1uNjF2ZzN2RnB6NFlaOW5rLWlDQWN2eF9BenY2VW1zcDg4SlB2eWZyaXc1Q3JCYzdvbjZfcmItemJfNjVlSFFaRXkxZmp3NDJGcEpOcTl1UUgxQ3k4NW12UmtrcnN6bUZNS3JRbVN3UnJXaDlQbHlCSzR5SzJMU21JbnhaYXdMQkVHM09SR1BYUmdmeGI1WmM9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-18 11:54:45,575 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-18 11:54:45,575 oidcrp.rp_handler DEBUG Authz response: {'state': '82ho0C5naIy7lYBm1lAAWCPrzru5ufIL', 'scope': 'email offline_access profile openid', 'code': 'Z0FBQUFBQmxMNnRsZjB5ZUZmdjhWb21IME1CVVlPamhRRGl0Vjk5OFktUXIzSDdxMHdGb2dOYWo0dndVZ0dPU3JjanR6OFgwUWxVdWlmTjZ5MGEyVmVYZ3E1d0QyaldtOXZhczFZdFRTbTJDT2M2aW50bV9nTEpjMmwzQ1gxY1g3Sk5KcWV5RG5nRmc5bHdDemItczdyNUQwcHlkRDNoZERDTUs1X1RxTk4zek1QWFZyTHZ2SUNjOHlkTGtDNllMb1VEQnBtNkFDZ3pQWWc0Rl9CSjV2ZHBjUUY0cDFrUGJnaVNPTWN4UnhxWUhpcGhvNU1JUy1JT0VOUE10clVKV2pwVGU2dTRFajVaWDhFVFRQNEd0UWUtREpCUVVxY09XaDNGMG9hZnd5RGJodW52X0FpNFJ3V2h6bzZldXRPNFpMMUJTUHhJMGJzazh6b2ppZmQtc3gtdjFsY1NrSS1YTlA2Nl8wdnJsT0x5U1dqczlfakN5dTN0Q0dJTVpsNjJZTXlKUThaU0RYU2k5cUNCLU4tLXZVN0tRS21kU0lLaHlBMlh2N0FlQ2wwdUwzRlpFaXh6N3F5QncxS2JqOHhSM19DZ1VtdXhDNXRNRFBTdkdFUGlPZVZFcUdDYVJmUWJYYmprM2dqSmd0VndBWFFZNzRvTVpwcGZyMVhHYkZjSm85ODVPZjY5M0Jib1dLRGJEWFg0NURpcnNYRkRtbXhaTWI4R2V2MS1uNjF2ZzN2RnB6NFlaOW5rLWlDQWN2eF9BenY2VW1zcDg4SlB2eWZyaXc1Q3JCYzdvbjZfcmItemJfNjVlSFFaRXkxZmp3NDJGcEpOcTl1UUgxQ3k4NW12UmtrcnN6bUZNS3JRbVN3UnJXaDlQbHlCSzR5SzJMU21JbnhaYXdMQkVHM09SR1BYUmdmeGI1WmM9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-18 11:54:45,575 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-18 11:54:45,575 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-18 11:54:45,575 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMNnRsZjB5ZUZmdjhWb21IME1CVVlPamhRRGl0Vjk5OFktUXIzSDdxMHdGb2dOYWo0dndVZ0dPU3JjanR6OFgwUWxVdWlmTjZ5MGEyVmVYZ3E1d0QyaldtOXZhczFZdFRTbTJDT2M2aW50bV9nTEpjMmwzQ1gxY1g3Sk5KcWV5RG5nRmc5bHdDemItczdyNUQwcHlkRDNoZERDTUs1X1RxTk4zek1QWFZyTHZ2SUNjOHlkTGtDNllMb1VEQnBtNkFDZ3pQWWc0Rl9CSjV2ZHBjUUY0cDFrUGJnaVNPTWN4UnhxWUhpcGhvNU1JUy1JT0VOUE10clVKV2pwVGU2dTRFajVaWDhFVFRQNEd0UWUtREpCUVVxY09XaDNGMG9hZnd5RGJodW52X0FpNFJ3V2h6bzZldXRPNFpMMUJTUHhJMGJzazh6b2ppZmQtc3gtdjFsY1NrSS1YTlA2Nl8wdnJsT0x5U1dqczlfakN5dTN0Q0dJTVpsNjJZTXlKUThaU0RYU2k5cUNCLU4tLXZVN0tRS21kU0lLaHlBMlh2N0FlQ2wwdUwzRlpFaXh6N3F5QncxS2JqOHhSM19DZ1VtdXhDNXRNRFBTdkdFUGlPZVZFcUdDYVJmUWJYYmprM2dqSmd0VndBWFFZNzRvTVpwcGZyMVhHYkZjSm85ODVPZjY5M0Jib1dLRGJEWFg0NURpcnNYRkRtbXhaTWI4R2V2MS1uNjF2ZzN2RnB6NFlaOW5rLWlDQWN2eF9BenY2VW1zcDg4SlB2eWZyaXc1Q3JCYzdvbjZfcmItemJfNjVlSFFaRXkxZmp3NDJGcEpOcTl1UUgxQ3k4NW12UmtrcnN6bUZNS3JRbVN3UnJXaDlQbHlCSzR5SzJMU21JbnhaYXdMQkVHM09SR1BYUmdmeGI1WmM9', 'state': '82ho0C5naIy7lYBm1lAAWCPrzru5ufIL', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-18 11:54:45,576 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': '82ho0C5naIy7lYBm1lAAWCPrzru5ufIL', 'code': 'Z0FBQUFBQmxMNnRsZjB5ZUZmdjhWb21IME1CVVlPamhRRGl0Vjk5OFktUXIzSDdxMHdGb2dOYWo0dndVZ0dPU3JjanR6OFgwUWxVdWlmTjZ5MGEyVmVYZ3E1d0QyaldtOXZhczFZdFRTbTJDT2M2aW50bV9nTEpjMmwzQ1gxY1g3Sk5KcWV5RG5nRmc5bHdDemItczdyNUQwcHlkRDNoZERDTUs1X1RxTk4zek1QWFZyTHZ2SUNjOHlkTGtDNllMb1VEQnBtNkFDZ3pQWWc0Rl9CSjV2ZHBjUUY0cDFrUGJnaVNPTWN4UnhxWUhpcGhvNU1JUy1JT0VOUE10clVKV2pwVGU2dTRFajVaWDhFVFRQNEd0UWUtREpCUVVxY09XaDNGMG9hZnd5RGJodW52X0FpNFJ3V2h6bzZldXRPNFpMMUJTUHhJMGJzazh6b2ppZmQtc3gtdjFsY1NrSS1YTlA2Nl8wdnJsT0x5U1dqczlfakN5dTN0Q0dJTVpsNjJZTXlKUThaU0RYU2k5cUNCLU4tLXZVN0tRS21kU0lLaHlBMlh2N0FlQ2wwdUwzRlpFaXh6N3F5QncxS2JqOHhSM19DZ1VtdXhDNXRNRFBTdkdFUGlPZVZFcUdDYVJmUWJYYmprM2dqSmd0VndBWFFZNzRvTVpwcGZyMVhHYkZjSm85ODVPZjY5M0Jib1dLRGJEWFg0NURpcnNYRkRtbXhaTWI4R2V2MS1uNjF2ZzN2RnB6NFlaOW5rLWlDQWN2eF9BenY2VW1zcDg4SlB2eWZyaXc1Q3JCYzdvbjZfcmItemJfNjVlSFFaRXkxZmp3NDJGcEpOcTl1UUgxQ3k4NW12UmtrcnN6bUZNS3JRbVN3UnJXaDlQbHlCSzR5SzJMU21JbnhaYXdMQkVHM09SR1BYUmdmeGI1WmM9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': '5cocECCqcoskmdqrB6ATAHbdOd4qT6J3MdkZ8DtKLHHaw4cVi9XVN8zNLgxABaSW'}
2023-10-18 11:54:45,576 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-18 11:54:45,576 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f328219cd10>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=82ho0C5naIy7lYBm1lAAWCPrzru5ufIL&code=Z0FBQUFBQmxMNnRsZjB5ZUZmdjhWb21IME1CVVlPamhRRGl0Vjk5OFktUXIzSDdxMHdGb2dOYWo0dndVZ0dPU3JjanR6OFgwUWxVdWlmTjZ5MGEyVmVYZ3E1d0QyaldtOXZhczFZdFRTbTJDT2M2aW50bV9nTEpjMmwzQ1gxY1g3Sk5KcWV5RG5nRmc5bHdDemItczdyNUQwcHlkRDNoZERDTUs1X1RxTk4zek1QWFZyTHZ2SUNjOHlkTGtDNllMb1VEQnBtNkFDZ3pQWWc0Rl9CSjV2ZHBjUUY0cDFrUGJnaVNPTWN4UnhxWUhpcGhvNU1JUy1JT0VOUE10clVKV2pwVGU2dTRFajVaWDhFVFRQNEd0UWUtREpCUVVxY09XaDNGMG9hZnd5RGJodW52X0FpNFJ3V2h6bzZldXRPNFpMMUJTUHhJMGJzazh6b2ppZmQtc3gtdjFsY1NrSS1YTlA2Nl8wdnJsT0x5U1dqczlfakN5dTN0Q0dJTVpsNjJZTXlKUThaU0RYU2k5cUNCLU4tLXZVN0tRS21kU0lLaHlBMlh2N0FlQ2wwdUwzRlpFaXh6N3F5QncxS2JqOHhSM19DZ1VtdXhDNXRNRFBTdkdFUGlPZVZFcUdDYVJmUWJYYmprM2dqSmd0VndBWFFZNzRvTVpwcGZyMVhHYkZjSm85ODVPZjY5M0Jib1dLRGJEWFg0NURpcnNYRkRtbXhaTWI4R2V2MS1uNjF2ZzN2RnB6NFlaOW5rLWlDQWN2eF9BenY2VW1zcDg4SlB2eWZyaXc1Q3JCYzdvbjZfcmItemJfNjVlSFFaRXkxZmp3NDJGcEpOcTl1UUgxQ3k4NW12UmtrcnN6bUZNS3JRbVN3UnJXaDlQbHlCSzR5SzJMU21JbnhaYXdMQkVHM09SR1BYUmdmeGI1WmM9&code_verifier=5cocECCqcoskmdqrB6ATAHbdOd4qT6J3MdkZ8DtKLHHaw4cVi9XVN8zNLgxABaSW', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-18 11:54:45,576 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=82ho0C5naIy7lYBm1lAAWCPrzru5ufIL&code=Z0FBQUFBQmxMNnRsZjB5ZUZmdjhWb21IME1CVVlPamhRRGl0Vjk5OFktUXIzSDdxMHdGb2dOYWo0dndVZ0dPU3JjanR6OFgwUWxVdWlmTjZ5MGEyVmVYZ3E1d0QyaldtOXZhczFZdFRTbTJDT2M2aW50bV9nTEpjMmwzQ1gxY1g3Sk5KcWV5RG5nRmc5bHdDemItczdyNUQwcHlkRDNoZERDTUs1X1RxTk4zek1QWFZyTHZ2SUNjOHlkTGtDNllMb1VEQnBtNkFDZ3pQWWc0Rl9CSjV2ZHBjUUY0cDFrUGJnaVNPTWN4UnhxWUhpcGhvNU1JUy1JT0VOUE10clVKV2pwVGU2dTRFajVaWDhFVFRQNEd0UWUtREpCUVVxY09XaDNGMG9hZnd5RGJodW52X0FpNFJ3V2h6bzZldXRPNFpMMUJTUHhJMGJzazh6b2ppZmQtc3gtdjFsY1NrSS1YTlA2Nl8wdnJsT0x5U1dqczlfakN5dTN0Q0dJTVpsNjJZTXlKUThaU0RYU2k5cUNCLU4tLXZVN0tRS21kU0lLaHlBMlh2N0FlQ2wwdUwzRlpFaXh6N3F5QncxS2JqOHhSM19DZ1VtdXhDNXRNRFBTdkdFUGlPZVZFcUdDYVJmUWJYYmprM2dqSmd0VndBWFFZNzRvTVpwcGZyMVhHYkZjSm85ODVPZjY5M0Jib1dLRGJEWFg0NURpcnNYRkRtbXhaTWI4R2V2MS1uNjF2ZzN2RnB6NFlaOW5rLWlDQWN2eF9BenY2VW1zcDg4SlB2eWZyaXc1Q3JCYzdvbjZfcmItemJfNjVlSFFaRXkxZmp3NDJGcEpOcTl1UUgxQ3k4NW12UmtrcnN6bUZNS3JRbVN3UnJXaDlQbHlCSzR5SzJMU21JbnhaYXdMQkVHM09SR1BYUmdmeGI1WmM9&code_verifier=5cocECCqcoskmdqrB6ATAHbdOd4qT6J3MdkZ8DtKLHHaw4cVi9XVN8zNLgxABaSW, https_args:{'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-18 11:54:45,576 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 11:54:45,727 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-18 11:54:45,727 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 11:54:45,727 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 11:54:45,727 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 09:54:45 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACicyyYzSXwLDxwLI1PeDgNJYNzWNBWzrK96tAfKgNVK3f3FdhDUJl-218dV17VnrtIWlltRjDNkWaHtSBB3G1g_sChuRom__uNTcj44MCMxDhABrxZd2PcMaVhe8pQ1uXcvrkhNIJLdmnvjzA3LF0atQIJNlVBQx6D2CuB6FGV2q2eGjpueJLY3d0Xcaa6pbIctey-D6NEbM0MvlVX46vzNY4Y6LNKEvngrGNraWDEkZAKos-i00qsAzggrTud60m4AAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALhdACicyyYzSXwLDxwLI1PeDgNJYNzWNBWzrK96tAfKgNVK3f3FdhDUJl-218dV17VnrtIWlltRjDNkWaHtSBB3G1g_sChuRom__uNTcj44MCMxDhABrxZd2PcMaVhe8pQ1uXcvrkhNIJLdmnvjzA3LF0atQIJNlVBQx6D2CuB6FGV2q2eGjpueJLY3d0Xcaa6pbIctey-D6NEbM0MvlVX46vzNY4Y6LNKEvngrGNraWDEkZAKos-i00qsAzggrTud60m4AAdQBwAEAAGUnFQCxxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 11:54:45,727 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access email", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNGViYzgxZWI4NDhiNDVmZDhkMjA4N2NjZjJmOTkxYTYiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OblJzVWtndGQyWjJWbTVCYW1zd2VWSkZNSE5MWkhGaFdURTJhWFpaTkRsb1kxWmtWRGN6V25KclJqWlRVMGR1UmpGYVdVNVliVmRhWlRCM1oySnZUVnBrYTNCT01qQXhaV3QyYUdkWGRrTkZabmd6VW5GU1NGZDJMVkJPVkcxdFpVMVpTQzFtUWs5cmIxaEtNelpQVFVGVlNsTmlSbEpEU2t0RVRtWjNNMVpwVVVsU1FtWkJUMHRzUWxoWVZXWlZZMDl6Y1UxblkyOHRUVTFoVUcxUlozaHZjRWhGVjJSa1NrSlVibU56Wm10QlpFSmllVWwyTFVwaVkzQlplV054YmtadGFHOVJYMGRFVkVaSWJUQkdkMnhOTFhrM2JISlRNbUZMVWxCc2JuVlpUamxRUmtvMldVZ3pPRGgxTmpRNGJrTlJaVGx6UzJGa1RtUTBTa0ZRT1ZCMWFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjI4ODUsICJleHAiOiAxNjk3NjI2NDg1fQ.IwxXpn6r5cTyvMzR9b2cAeuDEbqb9qpQVMJBEhE9tN_NUCnrMo_xp7c4uszhxzAf5crjqWKnMr8tNdc7D2orwg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMNnRsWTZNWVBucUxhbGt4dzcweGh6b1VibEhjUG01a0xSUzY3TUtiVDFfWlhlR2V1NDI1Nk1WajNCY0ZwNDNnSGxVX2RQeWR6NjRoVWRlRlNFRldWS0VCVVFSazI1U2FrOFg1Smx5M1djemF2ZDB0T01HVDdld19NbFhLM2owWjVrcUVuVDlMUHdHd3RBMEd1dENPQkZoMFZxbU50amZsM1l6TnpvSFE0Ni1qTUVGOTZ6clYwWnVwU052ZHVCN0pWTHVGdTFLQUZzZHdLNXRsV1hkNEVpNURxb1VidGdRTVRoaHRCd3hNR2Z6eGpNeDk0SEluSEkyRXh6YkRheVB0dk9xX2p4SDJONVZhMkU3YzlBSlN1ZEQycWxYNDV4M1B4VlFmTXMzNGJXUG9XU3R0N2xPU2RYSGNRTjFqTVF6MXl0RE5NNlYwZmlvWXdIWHdCX1Z3VWR0bnNxR2pfeEQyVjBhMjVsUkxIWkRESmdoZGlpM1FnODVWb1FsSU9GSjBqckdPZHpnbmJOWW1lMkpNZTJZclpaVm4tYTVuSGcyWHJLZm5ueEVrd05wcUI0MGR0a2NnWV9LY2dscnpMSHZkY2RoSWhhaG1BdFUzNkZjdnE5U21PbGdIVEVRX2RHcTdRYkNramZyWnRNU1E1MFRnTzhMVHkzMEJULWt1RExWby1ZRXlTNk5oQkZ3d2l1RjRza1RGRkhTVll4VVl0V01ZS1REODlIbnU1WnNoOExUMjBqMXdJbjJHZWI2ZEpkWnd5NUtYcXQ1NVJYUk5GMWhoXzVST1o0MG5Rc3ZVZUxKdnJYSEptMmxkUkVnT1RGRGl6RmtLZEFhRC1jYmpMdld4MVpkYWRXT0REcExQQWNYSXZRSTMxRWNzVl9pc000NHVlSzc4WDBmYjZQdVJmbVE9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTm5Sc1VrZ3RkMloyVm01QmFtc3dlVkpGTUhOTFpIRmhXVEUyYVhaWk5EbG9ZMVprVkRjelduSnJSalpUVTBkdVJqRmFXVTVZYlZkYVpUQjNaMkp2VFZwa2EzQk9NakF4Wld0MmFHZFhka05GWm5nelVuRlNTRmQyTFZCT1ZHMXRaVTFaU0MxbVFrOXJiMWhLTXpaUFRVRlZTbE5pUmxKRFNrdEVUbVozTTFacFVVbFNRbVpCVDB0c1FsaFlWV1pWWTA5emNVMW5ZMjh0VFUxaFVHMVJaM2h2Y0VoRlYyUmtTa0pVYm1OelptdEJaRUppZVVsMkxVcGlZM0JaZVdOeGJrWnRhRzlSWDBkRVZFWkliVEJHZDJ4TkxYazNiSEpUTW1GTFVsQnNiblZaVGpsUVJrbzJXVWd6T0RoMU5qUTRia05SWlRselMyRmtUbVEwU2tGUU9WQjFhQT09IiwgImF1dGhfdGltZSI6IDE2OTc2MjI4ODUsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIiwgImVtYWlsIl0sICJqdGkiOiAiNWUyOTg3ZjM2ZDljMTFlZWE3MTQwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogInA3ZWVGYXZqUmRZZWJOWWRjaXFjcFdrZyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjIyODg1LCAiZXhwIjogMTY5NzYyMzE4NSwgImF1ZCI6IFsiand0X3Rlc3QiXX0.MQGuEitcBDcNwmwdFVudVKgkgQeuzhdVg3Ppr_Fj4ZaFR9b3WcW2pdzqy2lalWpA8wqFDJVajfPZlHfF4zH4h6oCwT0cXbzUo1aVzxKUEPth95A-bFsr6LLl8ywPSNsfrAEY8k3gqfTEyw1GS5X30WQEQj5if8DkS_cOPS23WH7275u16JGXXXCkgX5vX_DWZH_UMzxi1QFxNEcj415SyQMdmJWGiN84_Kk2GHJ5Lk7jLIGLKD4Efk-LSOqJ7z355Vw53fjTj20nBDkZ4Po-l3JWfHnWvnNDDJRjSF0xtSKsLRTMm0NhSgF4vMlCgEAQZiPzINXAE6SaqIxP409ZFw"}
2023-10-18 11:54:45,727 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access email", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNGViYzgxZWI4NDhiNDVmZDhkMjA4N2NjZjJmOTkxYTYiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OblJzVWtndGQyWjJWbTVCYW1zd2VWSkZNSE5MWkhGaFdURTJhWFpaTkRsb1kxWmtWRGN6V25KclJqWlRVMGR1UmpGYVdVNVliVmRhWlRCM1oySnZUVnBrYTNCT01qQXhaV3QyYUdkWGRrTkZabmd6VW5GU1NGZDJMVkJPVkcxdFpVMVpTQzFtUWs5cmIxaEtNelpQVFVGVlNsTmlSbEpEU2t0RVRtWjNNMVpwVVVsU1FtWkJUMHRzUWxoWVZXWlZZMDl6Y1UxblkyOHRUVTFoVUcxUlozaHZjRWhGVjJSa1NrSlVibU56Wm10QlpFSmllVWwyTFVwaVkzQlplV054YmtadGFHOVJYMGRFVkVaSWJUQkdkMnhOTFhrM2JISlRNbUZMVWxCc2JuVlpUamxRUmtvMldVZ3pPRGgxTmpRNGJrTlJaVGx6UzJGa1RtUTBTa0ZRT1ZCMWFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjI4ODUsICJleHAiOiAxNjk3NjI2NDg1fQ.IwxXpn6r5cTyvMzR9b2cAeuDEbqb9qpQVMJBEhE9tN_NUCnrMo_xp7c4uszhxzAf5crjqWKnMr8tNdc7D2orwg", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMNnRsWTZNWVBucUxhbGt4dzcweGh6b1VibEhjUG01a0xSUzY3TUtiVDFfWlhlR2V1NDI1Nk1WajNCY0ZwNDNnSGxVX2RQeWR6NjRoVWRlRlNFRldWS0VCVVFSazI1U2FrOFg1Smx5M1djemF2ZDB0T01HVDdld19NbFhLM2owWjVrcUVuVDlMUHdHd3RBMEd1dENPQkZoMFZxbU50amZsM1l6TnpvSFE0Ni1qTUVGOTZ6clYwWnVwU052ZHVCN0pWTHVGdTFLQUZzZHdLNXRsV1hkNEVpNURxb1VidGdRTVRoaHRCd3hNR2Z6eGpNeDk0SEluSEkyRXh6YkRheVB0dk9xX2p4SDJONVZhMkU3YzlBSlN1ZEQycWxYNDV4M1B4VlFmTXMzNGJXUG9XU3R0N2xPU2RYSGNRTjFqTVF6MXl0RE5NNlYwZmlvWXdIWHdCX1Z3VWR0bnNxR2pfeEQyVjBhMjVsUkxIWkRESmdoZGlpM1FnODVWb1FsSU9GSjBqckdPZHpnbmJOWW1lMkpNZTJZclpaVm4tYTVuSGcyWHJLZm5ueEVrd05wcUI0MGR0a2NnWV9LY2dscnpMSHZkY2RoSWhhaG1BdFUzNkZjdnE5U21PbGdIVEVRX2RHcTdRYkNramZyWnRNU1E1MFRnTzhMVHkzMEJULWt1RExWby1ZRXlTNk5oQkZ3d2l1RjRza1RGRkhTVll4VVl0V01ZS1REODlIbnU1WnNoOExUMjBqMXdJbjJHZWI2ZEpkWnd5NUtYcXQ1NVJYUk5GMWhoXzVST1o0MG5Rc3ZVZUxKdnJYSEptMmxkUkVnT1RGRGl6RmtLZEFhRC1jYmpMdld4MVpkYWRXT0REcExQQWNYSXZRSTMxRWNzVl9pc000NHVlSzc4WDBmYjZQdVJmbVE9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTm5Sc1VrZ3RkMloyVm01QmFtc3dlVkpGTUhOTFpIRmhXVEUyYVhaWk5EbG9ZMVprVkRjelduSnJSalpUVTBkdVJqRmFXVTVZYlZkYVpUQjNaMkp2VFZwa2EzQk9NakF4Wld0MmFHZFhka05GWm5nelVuRlNTRmQyTFZCT1ZHMXRaVTFaU0MxbVFrOXJiMWhLTXpaUFRVRlZTbE5pUmxKRFNrdEVUbVozTTFacFVVbFNRbVpCVDB0c1FsaFlWV1pWWTA5emNVMW5ZMjh0VFUxaFVHMVJaM2h2Y0VoRlYyUmtTa0pVYm1OelptdEJaRUppZVVsMkxVcGlZM0JaZVdOeGJrWnRhRzlSWDBkRVZFWkliVEJHZDJ4TkxYazNiSEpUTW1GTFVsQnNiblZaVGpsUVJrbzJXVWd6T0RoMU5qUTRia05SWlRselMyRmtUbVEwU2tGUU9WQjFhQT09IiwgImF1dGhfdGltZSI6IDE2OTc2MjI4ODUsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIiwgImVtYWlsIl0sICJqdGkiOiAiNWUyOTg3ZjM2ZDljMTFlZWE3MTQwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogInA3ZWVGYXZqUmRZZWJOWWRjaXFjcFdrZyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjIyODg1LCAiZXhwIjogMTY5NzYyMzE4NSwgImF1ZCI6IFsiand0X3Rlc3QiXX0.MQGuEitcBDcNwmwdFVudVKgkgQeuzhdVg3Ppr_Fj4ZaFR9b3WcW2pdzqy2lalWpA8wqFDJVajfPZlHfF4zH4h6oCwT0cXbzUo1aVzxKUEPth95A-bFsr6LLl8ywPSNsfrAEY8k3gqfTEyw1GS5X30WQEQj5if8DkS_cOPS23WH7275u16JGXXXCkgX5vX_DWZH_UMzxi1QFxNEcj415SyQMdmJWGiN84_Kk2GHJ5Lk7jLIGLKD4Efk-LSOqJ7z355Vw53fjTj20nBDkZ4Po-l3JWfHnWvnNDDJRjSF0xtSKsLRTMm0NhSgF4vMlCgEAQZiPzINXAE6SaqIxP409ZFw"}
2023-10-18 11:54:45,728 oidcrp.service DEBUG response format: json
2023-10-18 11:54:45,728 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-18 11:54:45,728 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access email', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNGViYzgxZWI4NDhiNDVmZDhkMjA4N2NjZjJmOTkxYTYiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OblJzVWtndGQyWjJWbTVCYW1zd2VWSkZNSE5MWkhGaFdURTJhWFpaTkRsb1kxWmtWRGN6V25KclJqWlRVMGR1UmpGYVdVNVliVmRhWlRCM1oySnZUVnBrYTNCT01qQXhaV3QyYUdkWGRrTkZabmd6VW5GU1NGZDJMVkJPVkcxdFpVMVpTQzFtUWs5cmIxaEtNelpQVFVGVlNsTmlSbEpEU2t0RVRtWjNNMVpwVVVsU1FtWkJUMHRzUWxoWVZXWlZZMDl6Y1UxblkyOHRUVTFoVUcxUlozaHZjRWhGVjJSa1NrSlVibU56Wm10QlpFSmllVWwyTFVwaVkzQlplV054YmtadGFHOVJYMGRFVkVaSWJUQkdkMnhOTFhrM2JISlRNbUZMVWxCc2JuVlpUamxRUmtvMldVZ3pPRGgxTmpRNGJrTlJaVGx6UzJGa1RtUTBTa0ZRT1ZCMWFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjI4ODUsICJleHAiOiAxNjk3NjI2NDg1fQ.IwxXpn6r5cTyvMzR9b2cAeuDEbqb9qpQVMJBEhE9tN_NUCnrMo_xp7c4uszhxzAf5crjqWKnMr8tNdc7D2orwg', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxMNnRsWTZNWVBucUxhbGt4dzcweGh6b1VibEhjUG01a0xSUzY3TUtiVDFfWlhlR2V1NDI1Nk1WajNCY0ZwNDNnSGxVX2RQeWR6NjRoVWRlRlNFRldWS0VCVVFSazI1U2FrOFg1Smx5M1djemF2ZDB0T01HVDdld19NbFhLM2owWjVrcUVuVDlMUHdHd3RBMEd1dENPQkZoMFZxbU50amZsM1l6TnpvSFE0Ni1qTUVGOTZ6clYwWnVwU052ZHVCN0pWTHVGdTFLQUZzZHdLNXRsV1hkNEVpNURxb1VidGdRTVRoaHRCd3hNR2Z6eGpNeDk0SEluSEkyRXh6YkRheVB0dk9xX2p4SDJONVZhMkU3YzlBSlN1ZEQycWxYNDV4M1B4VlFmTXMzNGJXUG9XU3R0N2xPU2RYSGNRTjFqTVF6MXl0RE5NNlYwZmlvWXdIWHdCX1Z3VWR0bnNxR2pfeEQyVjBhMjVsUkxIWkRESmdoZGlpM1FnODVWb1FsSU9GSjBqckdPZHpnbmJOWW1lMkpNZTJZclpaVm4tYTVuSGcyWHJLZm5ueEVrd05wcUI0MGR0a2NnWV9LY2dscnpMSHZkY2RoSWhhaG1BdFUzNkZjdnE5U21PbGdIVEVRX2RHcTdRYkNramZyWnRNU1E1MFRnTzhMVHkzMEJULWt1RExWby1ZRXlTNk5oQkZ3d2l1RjRza1RGRkhTVll4VVl0V01ZS1REODlIbnU1WnNoOExUMjBqMXdJbjJHZWI2ZEpkWnd5NUtYcXQ1NVJYUk5GMWhoXzVST1o0MG5Rc3ZVZUxKdnJYSEptMmxkUkVnT1RGRGl6RmtLZEFhRC1jYmpMdld4MVpkYWRXT0REcExQQWNYSXZRSTMxRWNzVl9pc000NHVlSzc4WDBmYjZQdVJmbVE9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTm5Sc1VrZ3RkMloyVm01QmFtc3dlVkpGTUhOTFpIRmhXVEUyYVhaWk5EbG9ZMVprVkRjelduSnJSalpUVTBkdVJqRmFXVTVZYlZkYVpUQjNaMkp2VFZwa2EzQk9NakF4Wld0MmFHZFhka05GWm5nelVuRlNTRmQyTFZCT1ZHMXRaVTFaU0MxbVFrOXJiMWhLTXpaUFRVRlZTbE5pUmxKRFNrdEVUbVozTTFacFVVbFNRbVpCVDB0c1FsaFlWV1pWWTA5emNVMW5ZMjh0VFUxaFVHMVJaM2h2Y0VoRlYyUmtTa0pVYm1OelptdEJaRUppZVVsMkxVcGlZM0JaZVdOeGJrWnRhRzlSWDBkRVZFWkliVEJHZDJ4TkxYazNiSEpUTW1GTFVsQnNiblZaVGpsUVJrbzJXVWd6T0RoMU5qUTRia05SWlRselMyRmtUbVEwU2tGUU9WQjFhQT09IiwgImF1dGhfdGltZSI6IDE2OTc2MjI4ODUsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIiwgImVtYWlsIl0sICJqdGkiOiAiNWUyOTg3ZjM2ZDljMTFlZWE3MTQwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogInA3ZWVGYXZqUmRZZWJOWWRjaXFjcFdrZyIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjIyODg1LCAiZXhwIjogMTY5NzYyMzE4NSwgImF1ZCI6IFsiand0X3Rlc3QiXX0.MQGuEitcBDcNwmwdFVudVKgkgQeuzhdVg3Ppr_Fj4ZaFR9b3WcW2pdzqy2lalWpA8wqFDJVajfPZlHfF4zH4h6oCwT0cXbzUo1aVzxKUEPth95A-bFsr6LLl8ywPSNsfrAEY8k3gqfTEyw1GS5X30WQEQj5if8DkS_cOPS23WH7275u16JGXXXCkgX5vX_DWZH_UMzxi1QFxNEcj415SyQMdmJWGiN84_Kk2GHJ5Lk7jLIGLKD4Efk-LSOqJ7z355Vw53fjTj20nBDkZ4Po-l3JWfHnWvnNDDJRjSF0xtSKsLRTMm0NhSgF4vMlCgEAQZiPzINXAE6SaqIxP409ZFw'}"
2023-10-18 11:54:45,728 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-18 11:54:45,728 oidcmsg.message DEBUG Raw JSON: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMNnRsUkgtd2Z2Vm5BamsweVJFMHNLZHFhWTE2aXZZNDloY1ZkVDczWnJrRjZTU0duRjFaWU5YbVdaZTB3Z2JvTVpka3BOMjAxZWt2aGdXdkNFZngzUnFSSFd2LVBOVG1tZU1ZSC1mQk9rb1hKMzZPTUFVSlNiRlJDSktETmZ3M1ZpUUlSQmZBT0tsQlhYVWZVY09zcU1nY28tTU1hUG1RZ3hvcEhFV2RkSkJUbmNzZmtBZEJieUl2LUpiY3BZeWNxbkZtaG9RX0dEVEZIbTBGd2xNLXk3bHJTMmFLUlBsbnVZTjlQRko2WUgzODh1NjQ4bkNRZTlzS2FkTmQ0SkFQOVB1aA==', 'auth_time': 1697622885, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access', 'email'], 'jti': '5e2987f36d9c11eea7140242ac170004', 'client_id': 'jwt_test', 'nonce': 'p7eeFavjRdYebNYdciqcpWkg', 'iss': 'https://satosa.idem.it', 'iat': 1697622885, 'exp': 1697623185, 'aud': ['jwt_test']}
2023-10-18 11:54:45,728 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA'}
2023-10-18 11:54:45,728 cryptojwt.key_jar DEBUG Key summary for https://satosa.idem.it: RSA:sig:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, EC:sig:LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw
2023-10-18 11:54:45,728 oidcmsg.message DEBUG Found signing key.
2023-10-18 11:54:45,728 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-18 11:54:45,728 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA and use=
2023-10-18 11:54:45,728 cryptojwt.jwx DEBUG Picked: kid:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, use:sig, kty:RSA
2023-10-18 11:54:45,729 cryptojwt.jws.jws DEBUG Verified message using key with kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA
2023-10-18 11:54:45,729 oidcmsg.oidc INFO Verified id_token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMNnRsUkgtd2Z2Vm5BamsweVJFMHNLZHFhWTE2aXZZNDloY1ZkVDczWnJrRjZTU0duRjFaWU5YbVdaZTB3Z2JvTVpka3BOMjAxZWt2aGdXdkNFZngzUnFSSFd2LVBOVG1tZU1ZSC1mQk9rb1hKMzZPTUFVSlNiRlJDSktETmZ3M1ZpUUlSQmZBT0tsQlhYVWZVY09zcU1nY28tTU1hUG1RZ3hvcEhFV2RkSkJUbmNzZmtBZEJieUl2LUpiY3BZeWNxbkZtaG9RX0dEVEZIbTBGd2xNLXk3bHJTMmFLUlBsbnVZTjlQRko2WUgzODh1NjQ4bkNRZTlzS2FkTmQ0SkFQOVB1aA==', 'auth_time': 1697622885, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access', 'email'], 'jti': '5e2987f36d9c11eea7140242ac170004', 'client_id': 'jwt_test', 'nonce': 'p7eeFavjRdYebNYdciqcpWkg', 'iss': 'https://satosa.idem.it', 'iat': 1697622885, 'exp': 1697623185, 'aud': ['jwt_test']}
2023-10-18 11:54:45,730 oidcrp.rp_handler DEBUG ID Token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMNnRsUkgtd2Z2Vm5BamsweVJFMHNLZHFhWTE2aXZZNDloY1ZkVDczWnJrRjZTU0duRjFaWU5YbVdaZTB3Z2JvTVpka3BOMjAxZWt2aGdXdkNFZngzUnFSSFd2LVBOVG1tZU1ZSC1mQk9rb1hKMzZPTUFVSlNiRlJDSktETmZ3M1ZpUUlSQmZBT0tsQlhYVWZVY09zcU1nY28tTU1hUG1RZ3hvcEhFV2RkSkJUbmNzZmtBZEJieUl2LUpiY3BZeWNxbkZtaG9RX0dEVEZIbTBGd2xNLXk3bHJTMmFLUlBsbnVZTjlQRko2WUgzODh1NjQ4bkNRZTlzS2FkTmQ0SkFQOVB1aA==', 'auth_time': 1697622885, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access', 'email'], 'jti': '5e2987f36d9c11eea7140242ac170004', 'client_id': 'jwt_test', 'nonce': 'p7eeFavjRdYebNYdciqcpWkg', 'iss': 'https://satosa.idem.it', 'iat': 1697622885, 'exp': 1697623185, 'aud': ['jwt_test']}
2023-10-18 11:54:45,730 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-18 11:54:45,730 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNGViYzgxZWI4NDhiNDVmZDhkMjA4N2NjZjJmOTkxYTYiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OblJzVWtndGQyWjJWbTVCYW1zd2VWSkZNSE5MWkhGaFdURTJhWFpaTkRsb1kxWmtWRGN6V25KclJqWlRVMGR1UmpGYVdVNVliVmRhWlRCM1oySnZUVnBrYTNCT01qQXhaV3QyYUdkWGRrTkZabmd6VW5GU1NGZDJMVkJPVkcxdFpVMVpTQzFtUWs5cmIxaEtNelpQVFVGVlNsTmlSbEpEU2t0RVRtWjNNMVpwVVVsU1FtWkJUMHRzUWxoWVZXWlZZMDl6Y1UxblkyOHRUVTFoVUcxUlozaHZjRWhGVjJSa1NrSlVibU56Wm10QlpFSmllVWwyTFVwaVkzQlplV054YmtadGFHOVJYMGRFVkVaSWJUQkdkMnhOTFhrM2JISlRNbUZMVWxCc2JuVlpUamxRUmtvMldVZ3pPRGgxTmpRNGJrTlJaVGx6UzJGa1RtUTBTa0ZRT1ZCMWFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjI4ODUsICJleHAiOiAxNjk3NjI2NDg1fQ.IwxXpn6r5cTyvMzR9b2cAeuDEbqb9qpQVMJBEhE9tN_NUCnrMo_xp7c4uszhxzAf5crjqWKnMr8tNdc7D2orwg'}
2023-10-18 11:54:45,730 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-18 11:54:45,730 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f327faed490>, 'url': 'https://satosa.idem.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNGViYzgxZWI4NDhiNDVmZDhkMjA4N2NjZjJmOTkxYTYiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OblJzVWtndGQyWjJWbTVCYW1zd2VWSkZNSE5MWkhGaFdURTJhWFpaTkRsb1kxWmtWRGN6V25KclJqWlRVMGR1UmpGYVdVNVliVmRhWlRCM1oySnZUVnBrYTNCT01qQXhaV3QyYUdkWGRrTkZabmd6VW5GU1NGZDJMVkJPVkcxdFpVMVpTQzFtUWs5cmIxaEtNelpQVFVGVlNsTmlSbEpEU2t0RVRtWjNNMVpwVVVsU1FtWkJUMHRzUWxoWVZXWlZZMDl6Y1UxblkyOHRUVTFoVUcxUlozaHZjRWhGVjJSa1NrSlVibU56Wm10QlpFSmllVWwyTFVwaVkzQlplV054YmtadGFHOVJYMGRFVkVaSWJUQkdkMnhOTFhrM2JISlRNbUZMVWxCc2JuVlpUamxRUmtvMldVZ3pPRGgxTmpRNGJrTlJaVGx6UzJGa1RtUTBTa0ZRT1ZCMWFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjI4ODUsICJleHAiOiAxNjk3NjI2NDg1fQ.IwxXpn6r5cTyvMzR9b2cAeuDEbqb9qpQVMJBEhE9tN_NUCnrMo_xp7c4uszhxzAf5crjqWKnMr8tNdc7D2orwg'}}
2023-10-18 11:54:45,730 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiNGViYzgxZWI4NDhiNDVmZDhkMjA4N2NjZjJmOTkxYTYiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OblJzVWtndGQyWjJWbTVCYW1zd2VWSkZNSE5MWkhGaFdURTJhWFpaTkRsb1kxWmtWRGN6V25KclJqWlRVMGR1UmpGYVdVNVliVmRhWlRCM1oySnZUVnBrYTNCT01qQXhaV3QyYUdkWGRrTkZabmd6VW5GU1NGZDJMVkJPVkcxdFpVMVpTQzFtUWs5cmIxaEtNelpQVFVGVlNsTmlSbEpEU2t0RVRtWjNNMVpwVVVsU1FtWkJUMHRzUWxoWVZXWlZZMDl6Y1UxblkyOHRUVTFoVUcxUlozaHZjRWhGVjJSa1NrSlVibU56Wm10QlpFSmllVWwyTFVwaVkzQlplV054YmtadGFHOVJYMGRFVkVaSWJUQkdkMnhOTFhrM2JISlRNbUZMVWxCc2JuVlpUamxRUmtvMldVZ3pPRGgxTmpRNGJrTlJaVGx6UzJGa1RtUTBTa0ZRT1ZCMWFBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjI4ODUsICJleHAiOiAxNjk3NjI2NDg1fQ.IwxXpn6r5cTyvMzR9b2cAeuDEbqb9qpQVMJBEhE9tN_NUCnrMo_xp7c4uszhxzAf5crjqWKnMr8tNdc7D2orwg'}
2023-10-18 11:54:45,730 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 11:54:45,898 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-18 11:54:45,899 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 11:54:45,899 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 11:54:45,899 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 09:54:45 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACuRxLcub_6ly0tOj68jeT0BWT7T3momPE4Q8H93FB21Ex1X-iEc9xJDZx0yxR_2TGOZwnIBU4Fsr_tNb5Fz__TcDekjYQYxhbjocDIki964v9xXhRpiFNYY6NCTlvXcBKb25_z2rUq3KPcS_WsKPzvte1d5c3-lBEShRKqFax4aKhtEVu9RB8zhfdumZtQ9CqN3w1CfHQ-3RnDpxL2WR4EampdFbbYJ3WVrx_-oCi2y1S4DWFdXNE60AAAAAESPLp_ILIVaAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACuRxLcub_6ly0tOj68jeT0BWT7T3momPE4Q8H93FB21Ex1X-iEc9xJDZx0yxR_2TGOZwnIBU4Fsr_tNb5Fz__TcDekjYQYxhbjocDIki964v9xXhRpiFNYY6NCTlvXcBKb25_z2rUq3KPcS_WsKPzvte1d5c3-lBEShRKqFax4aKhtEVu9RB8zhfdumZtQ9CqN3w1CfHQ-3RnDpxL2WR4EampdFbbYJ3WVrx_-oCi2y1S4DWFdXNE60AAAAAESPLp_ILIVaAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 11:54:45,899 oidcrp.util DEBUG resp.txt: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "email": "test1@gmail.com", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-18 11:54:45,899 oidcrp.oauth2 DEBUG Successful response: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "email": "test1@gmail.com", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-18 11:54:45,899 oidcrp.service DEBUG response format: json
2023-10-18 11:54:45,899 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-18 11:54:45,899 oidcrp.service DEBUG Initial response parsing => "{'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'email': 'test1@gmail.com', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}"
2023-10-18 11:54:45,899 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-18 11:54:45,900 oidcrp.rp_handler DEBUG UserInfo: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'email': 'test1@gmail.com', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}
2023-10-18 11:54:45,902 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 11:54:45] "GET /authz_cb/satosa?state=82ho0C5naIy7lYBm1lAAWCPrzru5ufIL&scope=email+offline_access+profile+openid&code=Z0FBQUFBQmxMNnRsZjB5ZUZmdjhWb21IME1CVVlPamhRRGl0Vjk5OFktUXIzSDdxMHdGb2dOYWo0dndVZ0dPU3JjanR6OFgwUWxVdWlmTjZ5MGEyVmVYZ3E1d0QyaldtOXZhczFZdFRTbTJDT2M2aW50bV9nTEpjMmwzQ1gxY1g3Sk5KcWV5RG5nRmc5bHdDemItczdyNUQwcHlkRDNoZERDTUs1X1RxTk4zek1QWFZyTHZ2SUNjOHlkTGtDNllMb1VEQnBtNkFDZ3pQWWc0Rl9CSjV2ZHBjUUY0cDFrUGJnaVNPTWN4UnhxWUhpcGhvNU1JUy1JT0VOUE10clVKV2pwVGU2dTRFajVaWDhFVFRQNEd0UWUtREpCUVVxY09XaDNGMG9hZnd5RGJodW52X0FpNFJ3V2h6bzZldXRPNFpMMUJTUHhJMGJzazh6b2ppZmQtc3gtdjFsY1NrSS1YTlA2Nl8wdnJsT0x5U1dqczlfakN5dTN0Q0dJTVpsNjJZTXlKUThaU0RYU2k5cUNCLU4tLXZVN0tRS21kU0lLaHlBMlh2N0FlQ2wwdUwzRlpFaXh6N3F5QncxS2JqOHhSM19DZ1VtdXhDNXRNRFBTdkdFUGlPZVZFcUdDYVJmUWJYYmprM2dqSmd0VndBWFFZNzRvTVpwcGZyMVhHYkZjSm85ODVPZjY5M0Jib1dLRGJEWFg0NURpcnNYRkRtbXhaTWI4R2V2MS1uNjF2ZzN2RnB6NFlaOW5rLWlDQWN2eF9BenY2VW1zcDg4SlB2eWZyaXc1Q3JCYzdvbjZfcmItemJfNjVlSFFaRXkxZmp3NDJGcEpOcTl1UUgxQ3k4NW12UmtrcnN6bUZNS3JRbVN3UnJXaDlQbHlCSzR5SzJMU21JbnhaYXdMQkVHM09SR1BYUmdmeGI1WmM9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1" 200 -
2023-10-18 12:24:31,773 root DEBUG Configured logging using dictionary
2023-10-18 12:24:31,812 werkzeug INFO [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on https://localhost:8090
2023-10-18 12:24:31,812 werkzeug INFO [33mPress CTRL+C to quit[0m
2023-10-18 12:24:31,812 werkzeug INFO  * Restarting with stat
2023-10-18 12:24:31,993 root DEBUG Configured logging using dictionary
2023-10-18 12:24:32,030 werkzeug WARNING  * Debugger is active!
2023-10-18 12:24:32,031 werkzeug INFO  * Debugger PIN: 491-689-569
2023-10-18 12:24:37,266 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 12:24:37] "GET / HTTP/1.1" 200 -
2023-10-18 12:24:40,193 oidcrp.rp_handler DEBUG ******************** client_setup ********************
2023-10-18 12:24:40,194 oidcrp.rp_handler INFO client_setup: iss_id=satosa, user=
2023-10-18 12:24:40,194 oidcrp.rp_handler DEBUG Creating new client: satosa
2023-10-18 12:24:40,194 oidcrp.rp_handler DEBUG ******************** init_client ********************
2023-10-18 12:24:40,233 oidcrp.rp_handler DEBUG Get provider info
2023-10-18 12:24:40,233 oidcrp.rp_handler DEBUG ******************** do_provider_info ********************
2023-10-18 12:24:40,233 oidcrp.oauth2 DEBUG do_request info: {'url': 'https://satosa.idem.it/.well-known/openid-configuration', 'method': 'GET'}
2023-10-18 12:24:40,233 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/.well-known/openid-configuration, method:GET, data:None, https_args:{}
2023-10-18 12:24:40,235 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 12:24:40,254 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /.well-known/openid-configuration HTTP/1.1" 200 None
2023-10-18 12:24:40,255 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 12:24:40,255 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 12:24:40,255 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 10:24:40 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddACoVReDSrDRvTDnHuGubPCV0gFVpacPPqR447A75aR6q063BQ7G6I4gIJgmRfilKobZ6dA3ytbR9RQ9wyqPjp6Xn3HezwoVYe2xjtnlQpT0baLJWp4YaWFFgAlI4M9eQMoGWK0Dy4TIs2psF_tCImlCg_kRgFVP2h1gbwQwnYTOzQqweQgBuqXSowQ7EtdYxqIZZnD6A4tyE0-0t48fFQPLU82SQ815dqn9qp8o904evYet1-wtV-AAALw2mN_AecH4AAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY="_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALddACoVReDSrDRvTDnHuGubPCV0gFVpacPPqR447A75aR6q063BQ7G6I4gIJgmRfilKobZ6dA3ytbR9RQ9wyqPjp6Xn3HezwoVYe2xjtnlQpT0baLJWp4YaWFFgAlI4M9eQMoGWK0Dy4TIs2psF_tCImlCg_kRgFVP2h1gbwQwnYTOzQqweQgBuqXSowQ7EtdYxqIZZnD6A4tyE0-0t48fFQPLU82SQ815dqn9qp8o904evYet1-wtV-AAALw2mN_AecH4AAdMBwAEAAN0XEB2xxGf7AgAAAAAEWVo="; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 12:24:40,255 oidcrp.util DEBUG resp.txt: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email", "urn:oid:1.2.840.113549.1.9.1.1"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email", "mail", "urn:oid:1.2.840.113549.1.9.1.1"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-18 12:24:40,255 oidcrp.oauth2 DEBUG Successful response: {"version": "3.0", "token_endpoint_auth_methods_supported": ["client_secret_basic"], "claims_parameter_supported": true, "request_parameter_supported": true, "request_uri_parameter_supported": true, "require_request_uri_registration": false, "grant_types_supported": ["authorization_code", "urn:ietf:params:oauth:grant-type:jwt-bearer", "refresh_token"], "jwks_uri": "https://satosa.idem.it/OIDC/jwks.json", "scopes_supported": ["openid", "profile", "offline_access", "email", "urn:oid:1.2.840.113549.1.9.1.1"], "response_types_supported": ["code", "id_token", "code id_token"], "response_modes_supported": ["query", "fragment", "form_post"], "subject_types_supported": ["public", "pairwise"], "id_token_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "userinfo_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "request_object_signing_alg_values_supported": ["RS256", "RS384", "RS512", "ES256", "ES384", "ES512", "PS256", "PS384", "PS512", "HS256", "HS384", "HS512"], "claims_supported": ["sub", "given_name", "birthdate", "email", "mail", "urn:oid:1.2.840.113549.1.9.1.1"], "code_challenge_methods_supported": ["S256"], "issuer": "https://satosa.idem.it", "authorization_endpoint": "https://satosa.idem.it/OIDC/authorization", "token_endpoint": "https://satosa.idem.it/OIDC/token", "userinfo_endpoint": "https://satosa.idem.it/OIDC/userinfo", "introspection_endpoint": "https://satosa.idem.it/OIDC/introspection"}
2023-10-18 12:24:40,255 oidcrp.service DEBUG response format: json
2023-10-18 12:24:40,255 oidcrp.service DEBUG response_cls: ProviderConfigurationResponse
2023-10-18 12:24:40,255 oidcrp.service DEBUG Initial response parsing => "{'version': '3.0', 'token_endpoint_auth_methods_supported': ['client_secret_basic'], 'claims_parameter_supported': True, 'request_parameter_supported': True, 'request_uri_parameter_supported': True, 'require_request_uri_registration': False, 'grant_types_supported': ['authorization_code', 'urn:ietf:params:oauth:grant-type:jwt-bearer', 'refresh_token'], 'jwks_uri': 'https://satosa.idem.it/OIDC/jwks.json', 'scopes_supported': ['openid', 'profile', 'offline_access', 'email', 'urn:oid:1.2.840.113549.1.9.1.1'], 'response_types_supported': ['code', 'id_token', 'code id_token'], 'response_modes_supported': ['query', 'fragment', 'form_post'], 'subject_types_supported': ['public', 'pairwise'], 'id_token_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'userinfo_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'request_object_signing_alg_values_supported': ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'PS256', 'PS384', 'PS512', 'HS256', 'HS384', 'HS512'], 'claims_supported': ['sub', 'given_name', 'birthdate', 'email', 'mail', 'urn:oid:1.2.840.113549.1.9.1.1'], 'code_challenge_methods_supported': ['S256'], 'issuer': 'https://satosa.idem.it', 'authorization_endpoint': 'https://satosa.idem.it/OIDC/authorization', 'token_endpoint': 'https://satosa.idem.it/OIDC/token', 'userinfo_endpoint': 'https://satosa.idem.it/OIDC/userinfo', 'introspection_endpoint': 'https://satosa.idem.it/OIDC/introspection'}"
2023-10-18 12:24:40,255 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=[''])>, 'verify': True, 'client_id': 'jwt_test'}
2023-10-18 12:24:40,256 cryptojwt.key_jar DEBUG Initiating key bundle for issuer: https://satosa.idem.it
2023-10-18 12:24:40,256 cryptojwt.key_issuer DEBUG httpc_params: {'verify': False, 'timeout': 10}
2023-10-18 12:24:40,256 cryptojwt.key_bundle INFO Reading remote JWKS from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 12:24:40,256 cryptojwt.key_bundle DEBUG KeyBundle fetch keys from: https://satosa.idem.it/OIDC/jwks.json
2023-10-18 12:24:40,257 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 12:24:40,273 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/jwks.json HTTP/1.1" 200 None
2023-10-18 12:24:40,274 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "e": "AQAB", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 12:24:40,274 cryptojwt.key_bundle DEBUG Loaded JWKS: {"keys": [{"kty": "RSA", "use": "sig", "kid": "MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA", "e": "AQAB", "n": "nC_epcBk83IF2WntVYJzWj8149R3KHHtDkbyUzeO3W48NgKXssj3XLPwkaaHnOQo4y_wN0WZt_hydOeCwfG_k35iVN3UXO6-ADYfb-6hoCe9wjrgdJF2WcsgiZ1JS61pzXeSRqRZZQCxxFF5kirR02xq9kLPbIYjIG6eL_jKwbnjLOhkznVY_H7lpcGeJCq9bYdlHCFZPofNSRyBWHJR_K4xL9m0riwGWGbRPif8RejKL1q7Z8qKcHnBQRUTxoTgmwu9ruYX9DLimRYvLdizpSpsgxuzfZHVVi-TIUl8kiBWyK6YBsGUyjjhRhwxed2nTf0oDybCzEjAY5VNEQOVow"}, {"kty": "EC", "use": "sig", "kid": "LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw", "crv": "P-256", "x": "LnRY1xWM0KSQjKqbPM7sfKy8duUQh4b0k797xRr2B-o", "y": "zu_uLX5EcmjKgq6eQZVJDlUqb-udbR_MKhjoCU6au8k"}]} from https://satosa.idem.it/OIDC/jwks.json
2023-10-18 12:24:40,274 oidcrp.oidc.provider_info_discovery DEBUG service_context behaviour: {'token_endpoint_auth_method': 'client_secret_basic', 'response_types': ['code'], 'scope': ['openid', 'profile', 'offline_access', 'email'], 'application_name': 'rphandler', 'application_type': 'web', 'contacts': ['ops@example.com'], 'claims': ['sub', 'given_name', 'email'], 'prompt': 'consent'}
2023-10-18 12:24:40,275 oidcrp.rp_handler DEBUG Do client registration
2023-10-18 12:24:40,275 oidcrp.rp_handler DEBUG ******************** do_client_registration ********************
2023-10-18 12:24:40,275 oidcrp.rp_handler DEBUG ******************** init_authorization ********************
2023-10-18 12:24:40,275 oidcrp.rp_handler DEBUG Authorization request args: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': ['openid', 'profile', 'offline_access', 'email'], 'response_type': 'code', 'nonce': 'PkZVmdT0qJcvMPdKQvMFSkEq', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': '7OM1s3DdqLeT5U0Wex9LfcXJtpvQUttJ'}
2023-10-18 12:24:40,275 oidcrp.service DEBUG Request: {'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'scope': 'openid profile offline_access email', 'response_type': 'code', 'nonce': 'PkZVmdT0qJcvMPdKQvMFSkEq', 'claims': {'id_token': {'acr': {'value': 'https://refeds.org/profile/mfa'}}}, 'state': '7OM1s3DdqLeT5U0Wex9LfcXJtpvQUttJ', 'code_challenge': 'APu8uCbbEdiv9EIueIhOC-G93WtWLY96kWsve1tJIN4', 'code_challenge_method': 'S256', 'client_id': 'jwt_test', 'prompt': 'consent'}
2023-10-18 12:24:40,275 oidcrp.rp_handler DEBUG Authorization info: {'method': 'GET', 'request': <oidcmsg.oidc.AuthorizationRequest object at 0x7f421a3b2f50>, 'url': 'https://satosa.idem.it/OIDC/authorization?redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&scope=openid+profile+offline_access+email&response_type=code&nonce=PkZVmdT0qJcvMPdKQvMFSkEq&claims=%7B%22id_token%22%3A+%7B%22acr%22%3A+%7B%22value%22%3A+%22https%3A%2F%2Frefeds.org%2Fprofile%2Fmfa%22%7D%7D%7D&state=7OM1s3DdqLeT5U0Wex9LfcXJtpvQUttJ&code_challenge=APu8uCbbEdiv9EIueIhOC-G93WtWLY96kWsve1tJIN4&code_challenge_method=S256&client_id=jwt_test&prompt=consent'}
2023-10-18 12:24:40,276 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 12:24:40] "[32mGET /rp?uid=&dyn_iss=&static_iss=satosa HTTP/1.1[0m" 303 -
2023-10-18 12:24:46,690 flask_rp.views DEBUG Issuer: https://satosa.idem.it
2023-10-18 12:24:46,690 oidcrp.rp_handler DEBUG ******************** finalize_auth ********************
2023-10-18 12:24:46,690 oidcrp.service DEBUG response format: dict
2023-10-18 12:24:46,690 oidcrp.service DEBUG response_cls: AuthorizationResponse
2023-10-18 12:24:46,690 oidcrp.service DEBUG Initial response parsing => "{'state': '7OM1s3DdqLeT5U0Wex9LfcXJtpvQUttJ', 'scope': 'profile openid offline_access email', 'code': 'Z0FBQUFBQmxMN0p1QURtXzNUa2hNVTJvMFlxeEpxc0plMklRSk5ITXJ2LW45RUZuNnk5VmtLSk1Oc2NNblRSZF8xSk5XNzhfeUMxam14eVQyZUktcGlZMW16ZU9JTWEtQ2JmbU9tcVRDcXJMS01MQUZ5ZVNFSkcwWEE3SWxlVEFXOGREaW9aa3JIanNYbXlGR2t6bFpVNTBSMWRTMG5SU00zRmlFOWpGNmw5TEtkTnExTWpjUC0zQVI5TFU3U1M0aXhNcURzV1ZYalFzQ0hnLWFvLTFNejFxQ2FybVhseVVnMWI5aEk5M3c4endFUFd3djFnWndIeU0tbUtNNE0yVDhUTnhaOE10Q2tyajB6cktfXzJzZ1UwbHh4S0RQQnh4c1V4X3o2aTRNTktZOGw1VFVQcWwwOUxROWN2YVhxcjlxcXBNZm9ncTlGVG1kZEh5WTlUem00R2tvbWJrTmJYOW1OSXI5TnFfd0tuWjVTdFdjaDhPVzB0VFlnVE1vRzFfYWlwMWJqemhOQUlFMWJkLW56LUtFNG0wZUxnUEs2c0NudkFra1pDYm96V3VqalpNT0F1NVhUT3lyaWZ4dEhmUEx3TVRncUUzT1NmbTQxbk5lV09nODVFekI3WDE2V1hnc3ZLbmE2ZlI5QmxtaDBQMUI5MHJEWEdvenk4dERkWElId3NHMUZkb01GZVVPdW9NcXVYeUlwNXhBNGJCT3lIZW5kX2E2cFY5RmRXVmF6bDhyUlB5VWZjOThqcW5Wdk9waHFySEV2TzRVR3VzVXpoSW9ZUEZQYjRKUERsSjhzeEtBYnpDa1hVVTdiWkU1RUhPd2l4RmFzSW9SUmpEZzlYX2FJaWdZa2Z6c3hfTV9iMmJYWEtqWEFQNkJYdF9tOFRjRXRaT1lBTlR1Sm0yVjZKeWJHVmNFMnM9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}"
2023-10-18 12:24:46,690 oidcrp.service DEBUG Verify response with {'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15, 'client_id': 'jwt_test'}
2023-10-18 12:24:46,690 oidcrp.rp_handler DEBUG Authz response: {'state': '7OM1s3DdqLeT5U0Wex9LfcXJtpvQUttJ', 'scope': 'profile openid offline_access email', 'code': 'Z0FBQUFBQmxMN0p1QURtXzNUa2hNVTJvMFlxeEpxc0plMklRSk5ITXJ2LW45RUZuNnk5VmtLSk1Oc2NNblRSZF8xSk5XNzhfeUMxam14eVQyZUktcGlZMW16ZU9JTWEtQ2JmbU9tcVRDcXJMS01MQUZ5ZVNFSkcwWEE3SWxlVEFXOGREaW9aa3JIanNYbXlGR2t6bFpVNTBSMWRTMG5SU00zRmlFOWpGNmw5TEtkTnExTWpjUC0zQVI5TFU3U1M0aXhNcURzV1ZYalFzQ0hnLWFvLTFNejFxQ2FybVhseVVnMWI5aEk5M3c4endFUFd3djFnWndIeU0tbUtNNE0yVDhUTnhaOE10Q2tyajB6cktfXzJzZ1UwbHh4S0RQQnh4c1V4X3o2aTRNTktZOGw1VFVQcWwwOUxROWN2YVhxcjlxcXBNZm9ncTlGVG1kZEh5WTlUem00R2tvbWJrTmJYOW1OSXI5TnFfd0tuWjVTdFdjaDhPVzB0VFlnVE1vRzFfYWlwMWJqemhOQUlFMWJkLW56LUtFNG0wZUxnUEs2c0NudkFra1pDYm96V3VqalpNT0F1NVhUT3lyaWZ4dEhmUEx3TVRncUUzT1NmbTQxbk5lV09nODVFekI3WDE2V1hnc3ZLbmE2ZlI5QmxtaDBQMUI5MHJEWEdvenk4dERkWElId3NHMUZkb01GZVVPdW9NcXVYeUlwNXhBNGJCT3lIZW5kX2E2cFY5RmRXVmF6bDhyUlB5VWZjOThqcW5Wdk9waHFySEV2TzRVR3VzVXpoSW9ZUEZQYjRKUERsSjhzeEtBYnpDa1hVVTdiWkU1RUhPd2l4RmFzSW9SUmpEZzlYX2FJaWdZa2Z6c3hfTV9iMmJYWEtqWEFQNkJYdF9tOFRjRXRaT1lBTlR1Sm0yVjZKeWJHVmNFMnM9', 'iss': 'https://satosa.idem.it', 'client_id': 'jwt_test'}
2023-10-18 12:24:46,690 oidcrp.rp_handler DEBUG ******************** get_access_and_id_token ********************
2023-10-18 12:24:46,690 oidcrp.rp_handler DEBUG ******************** get_tokens ********************
2023-10-18 12:24:46,690 oidcrp.rp_handler DEBUG request_args: {'code': 'Z0FBQUFBQmxMN0p1QURtXzNUa2hNVTJvMFlxeEpxc0plMklRSk5ITXJ2LW45RUZuNnk5VmtLSk1Oc2NNblRSZF8xSk5XNzhfeUMxam14eVQyZUktcGlZMW16ZU9JTWEtQ2JmbU9tcVRDcXJMS01MQUZ5ZVNFSkcwWEE3SWxlVEFXOGREaW9aa3JIanNYbXlGR2t6bFpVNTBSMWRTMG5SU00zRmlFOWpGNmw5TEtkTnExTWpjUC0zQVI5TFU3U1M0aXhNcURzV1ZYalFzQ0hnLWFvLTFNejFxQ2FybVhseVVnMWI5aEk5M3c4endFUFd3djFnWndIeU0tbUtNNE0yVDhUTnhaOE10Q2tyajB6cktfXzJzZ1UwbHh4S0RQQnh4c1V4X3o2aTRNTktZOGw1VFVQcWwwOUxROWN2YVhxcjlxcXBNZm9ncTlGVG1kZEh5WTlUem00R2tvbWJrTmJYOW1OSXI5TnFfd0tuWjVTdFdjaDhPVzB0VFlnVE1vRzFfYWlwMWJqemhOQUlFMWJkLW56LUtFNG0wZUxnUEs2c0NudkFra1pDYm96V3VqalpNT0F1NVhUT3lyaWZ4dEhmUEx3TVRncUUzT1NmbTQxbk5lV09nODVFekI3WDE2V1hnc3ZLbmE2ZlI5QmxtaDBQMUI5MHJEWEdvenk4dERkWElId3NHMUZkb01GZVVPdW9NcXVYeUlwNXhBNGJCT3lIZW5kX2E2cFY5RmRXVmF6bDhyUlB5VWZjOThqcW5Wdk9waHFySEV2TzRVR3VzVXpoSW9ZUEZQYjRKUERsSjhzeEtBYnpDa1hVVTdiWkU1RUhPd2l4RmFzSW9SUmpEZzlYX2FJaWdZa2Z6c3hfTV9iMmJYWEtqWEFQNkJYdF9tOFRjRXRaT1lBTlR1Sm0yVjZKeWJHVmNFMnM9', 'state': '7OM1s3DdqLeT5U0Wex9LfcXJtpvQUttJ', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'grant_type': 'authorization_code', 'client_id': 'jwt_test', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1'}
2023-10-18 12:24:46,691 oidcrp.service DEBUG Request: {'grant_type': 'authorization_code', 'redirect_uri': 'https://localhost:8090/authz_cb/satosa', 'client_id': 'jwt_test', 'state': '7OM1s3DdqLeT5U0Wex9LfcXJtpvQUttJ', 'code': 'Z0FBQUFBQmxMN0p1QURtXzNUa2hNVTJvMFlxeEpxc0plMklRSk5ITXJ2LW45RUZuNnk5VmtLSk1Oc2NNblRSZF8xSk5XNzhfeUMxam14eVQyZUktcGlZMW16ZU9JTWEtQ2JmbU9tcVRDcXJMS01MQUZ5ZVNFSkcwWEE3SWxlVEFXOGREaW9aa3JIanNYbXlGR2t6bFpVNTBSMWRTMG5SU00zRmlFOWpGNmw5TEtkTnExTWpjUC0zQVI5TFU3U1M0aXhNcURzV1ZYalFzQ0hnLWFvLTFNejFxQ2FybVhseVVnMWI5aEk5M3c4endFUFd3djFnWndIeU0tbUtNNE0yVDhUTnhaOE10Q2tyajB6cktfXzJzZ1UwbHh4S0RQQnh4c1V4X3o2aTRNTktZOGw1VFVQcWwwOUxROWN2YVhxcjlxcXBNZm9ncTlGVG1kZEh5WTlUem00R2tvbWJrTmJYOW1OSXI5TnFfd0tuWjVTdFdjaDhPVzB0VFlnVE1vRzFfYWlwMWJqemhOQUlFMWJkLW56LUtFNG0wZUxnUEs2c0NudkFra1pDYm96V3VqalpNT0F1NVhUT3lyaWZ4dEhmUEx3TVRncUUzT1NmbTQxbk5lV09nODVFekI3WDE2V1hnc3ZLbmE2ZlI5QmxtaDBQMUI5MHJEWEdvenk4dERkWElId3NHMUZkb01GZVVPdW9NcXVYeUlwNXhBNGJCT3lIZW5kX2E2cFY5RmRXVmF6bDhyUlB5VWZjOThqcW5Wdk9waHFySEV2TzRVR3VzVXpoSW9ZUEZQYjRKUERsSjhzeEtBYnpDa1hVVTdiWkU1RUhPd2l4RmFzSW9SUmpEZzlYX2FJaWdZa2Z6c3hfTV9iMmJYWEtqWEFQNkJYdF9tOFRjRXRaT1lBTlR1Sm0yVjZKeWJHVmNFMnM9', 'client_secret': '19cc69b70d0108f630e52f72f7a3bd37ba4e11678ad1a7434e9818e1', 'code_verifier': 'JItPobgkimYJk4v4cGg3Igib4kDpFXNP4ARJMOSOVQwe27LsdJxbWUaPL9VHdNEP'}
2023-10-18 12:24:46,691 oidcrp.service DEBUG Client authn method: client_secret_basic
2023-10-18 12:24:46,691 oidcrp.oauth2 DEBUG do_request info: {'method': 'POST', 'request': <oidcmsg.oidc.AccessTokenRequest object at 0x7f421a3516d0>, 'url': 'https://satosa.idem.it/OIDC/token', 'body': 'grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=7OM1s3DdqLeT5U0Wex9LfcXJtpvQUttJ&code=Z0FBQUFBQmxMN0p1QURtXzNUa2hNVTJvMFlxeEpxc0plMklRSk5ITXJ2LW45RUZuNnk5VmtLSk1Oc2NNblRSZF8xSk5XNzhfeUMxam14eVQyZUktcGlZMW16ZU9JTWEtQ2JmbU9tcVRDcXJMS01MQUZ5ZVNFSkcwWEE3SWxlVEFXOGREaW9aa3JIanNYbXlGR2t6bFpVNTBSMWRTMG5SU00zRmlFOWpGNmw5TEtkTnExTWpjUC0zQVI5TFU3U1M0aXhNcURzV1ZYalFzQ0hnLWFvLTFNejFxQ2FybVhseVVnMWI5aEk5M3c4endFUFd3djFnWndIeU0tbUtNNE0yVDhUTnhaOE10Q2tyajB6cktfXzJzZ1UwbHh4S0RQQnh4c1V4X3o2aTRNTktZOGw1VFVQcWwwOUxROWN2YVhxcjlxcXBNZm9ncTlGVG1kZEh5WTlUem00R2tvbWJrTmJYOW1OSXI5TnFfd0tuWjVTdFdjaDhPVzB0VFlnVE1vRzFfYWlwMWJqemhOQUlFMWJkLW56LUtFNG0wZUxnUEs2c0NudkFra1pDYm96V3VqalpNT0F1NVhUT3lyaWZ4dEhmUEx3TVRncUUzT1NmbTQxbk5lV09nODVFekI3WDE2V1hnc3ZLbmE2ZlI5QmxtaDBQMUI5MHJEWEdvenk4dERkWElId3NHMUZkb01GZVVPdW9NcXVYeUlwNXhBNGJCT3lIZW5kX2E2cFY5RmRXVmF6bDhyUlB5VWZjOThqcW5Wdk9waHFySEV2TzRVR3VzVXpoSW9ZUEZQYjRKUERsSjhzeEtBYnpDa1hVVTdiWkU1RUhPd2l4RmFzSW9SUmpEZzlYX2FJaWdZa2Z6c3hfTV9iMmJYWEtqWEFQNkJYdF9tOFRjRXRaT1lBTlR1Sm0yVjZKeWJHVmNFMnM9&code_verifier=JItPobgkimYJk4v4cGg3Igib4kDpFXNP4ARJMOSOVQwe27LsdJxbWUaPL9VHdNEP', 'headers': {'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}}
2023-10-18 12:24:46,691 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/token, method:POST, data:grant_type=authorization_code&redirect_uri=https%3A%2F%2Flocalhost%3A8090%2Fauthz_cb%2Fsatosa&client_id=jwt_test&state=7OM1s3DdqLeT5U0Wex9LfcXJtpvQUttJ&code=Z0FBQUFBQmxMN0p1QURtXzNUa2hNVTJvMFlxeEpxc0plMklRSk5ITXJ2LW45RUZuNnk5VmtLSk1Oc2NNblRSZF8xSk5XNzhfeUMxam14eVQyZUktcGlZMW16ZU9JTWEtQ2JmbU9tcVRDcXJMS01MQUZ5ZVNFSkcwWEE3SWxlVEFXOGREaW9aa3JIanNYbXlGR2t6bFpVNTBSMWRTMG5SU00zRmlFOWpGNmw5TEtkTnExTWpjUC0zQVI5TFU3U1M0aXhNcURzV1ZYalFzQ0hnLWFvLTFNejFxQ2FybVhseVVnMWI5aEk5M3c4endFUFd3djFnWndIeU0tbUtNNE0yVDhUTnhaOE10Q2tyajB6cktfXzJzZ1UwbHh4S0RQQnh4c1V4X3o2aTRNTktZOGw1VFVQcWwwOUxROWN2YVhxcjlxcXBNZm9ncTlGVG1kZEh5WTlUem00R2tvbWJrTmJYOW1OSXI5TnFfd0tuWjVTdFdjaDhPVzB0VFlnVE1vRzFfYWlwMWJqemhOQUlFMWJkLW56LUtFNG0wZUxnUEs2c0NudkFra1pDYm96V3VqalpNT0F1NVhUT3lyaWZ4dEhmUEx3TVRncUUzT1NmbTQxbk5lV09nODVFekI3WDE2V1hnc3ZLbmE2ZlI5QmxtaDBQMUI5MHJEWEdvenk4dERkWElId3NHMUZkb01GZVVPdW9NcXVYeUlwNXhBNGJCT3lIZW5kX2E2cFY5RmRXVmF6bDhyUlB5VWZjOThqcW5Wdk9waHFySEV2TzRVR3VzVXpoSW9ZUEZQYjRKUERsSjhzeEtBYnpDa1hVVTdiWkU1RUhPd2l4RmFzSW9SUmpEZzlYX2FJaWdZa2Z6c3hfTV9iMmJYWEtqWEFQNkJYdF9tOFRjRXRaT1lBTlR1Sm0yVjZKeWJHVmNFMnM9&code_verifier=JItPobgkimYJk4v4cGg3Igib4kDpFXNP4ARJMOSOVQwe27LsdJxbWUaPL9VHdNEP, https_args:{'Authorization': 'Basic and0X3Rlc3Q6MTljYzY5YjcwZDAxMDhmNjMwZTUyZjcyZjdhM2JkMzdiYTRlMTE2NzhhZDFhNzQzNGU5ODE4ZTE=', 'Content-Type': 'application/x-www-form-urlencoded'}
2023-10-18 12:24:46,691 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 12:24:46,837 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "POST /OIDC/token HTTP/1.1" 200 None
2023-10-18 12:24:46,837 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 12:24:46,837 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 12:24:46,837 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 10:24:46 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACYTRatfYQVrjHFftv0EAQlL3lHZbsHoWMOpmWIreNJxA6jft0Z7clMa7-S5u8tzJd9lA4LhTF5STh6Un5FA9PFWi71-A1fAn9eM7FkjGndMMeSPM4oiU7kCQcM4x-Y_82NwOwwsJbK89Lw23_rgufBDERxp51yoaDMe1mBr8De7Do72Rai4K94qnzCTzXmVQCDzngmaoqDUN5TxgEPCZttSSyL3CuEhVhucpYkEP8AW7sw7fPP7V5ysAAAAABP78shqXf5FAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACYTRatfYQVrjHFftv0EAQlL3lHZbsHoWMOpmWIreNJxA6jft0Z7clMa7-S5u8tzJd9lA4LhTF5STh6Un5FA9PFWi71-A1fAn9eM7FkjGndMMeSPM4oiU7kCQcM4x-Y_82NwOwwsJbK89Lw23_rgufBDERxp51yoaDMe1mBr8De7Do72Rai4K94qnzCTzXmVQCDzngmaoqDUN5TxgEPCZttSSyL3CuEhVhucpYkEP8AW7sw7fPP7V5ysAAAAABP78shqXf5FAAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 12:24:46,837 oidcrp.util DEBUG resp.txt: {"token_type": "Bearer", "scope": "openid profile offline_access email", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTg1NzcxYTY5ZGVkNGEyY2JjMDMzMDZiZjA1MDUyZGEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OMHAxYVRSalRUYzRSSFpTVjJ4WVdEaHFTRTFpVmpsaE5WUlJjemRsVURKc09XNVNTbTVsVTJscmNWcGpiMlJUVWtSUlpqQjRUM3A2VVdWblJsaFBWbFJQY1ZNNU1FSlhObVJPUmxWdFVtUmthSGhWTnpkbGFrZGpaRk5UY0ZCbE4ydEpjSFJwVmpZd1oxcGtaamh2U1RKQmJteG5WRGxwVkdKWVZHRkpSbFJuTWtwM1JWZFBlVlZzYUU5eGMwTm5VRUp2VjBWc1MxQk1PVXBaYlU5WGJGbEpZblU0Y205eVpYbEJTRmt3VTBGVWJGQkZRbVJ3ZG5vNVpsQTVWMUJFV200NFYyVjFUSHBHTVdsRmQwUnlOMjU0YUROR1JHdFpYMGgwWTBWTE1uY3RhREU1ZW05cUxXcDNabWRGZW5aVU9UaGlOVzk2WmxneVIzWlJiVTF5YjJwMWVBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjQ2ODYsICJleHAiOiAxNjk3NjI4Mjg2fQ.xW8beh_ovtsIndt2pJOPT5stoec0kApoWwAtFFdxymYOmS1pixgCrniBfz-DbDPCwzwYl7RY_VNvi-xOdlSzeA", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMN0p1d2NiVXlrc3hkWkYySFA3eVpWTnNZUElrOWVwaVlqMUlvTGJaSHc4Tm9zclQ3akIycjBzR214Zmx1ZkpYejV0c3liZEx4OFg4SGZjaFY4YVRyYURXQXlPYnd3b2dCaWdZam15ZEtCbEd5Rkh0d05SblNFV21NVThvc1RJaFNvYlBScUhxS2NsZVBiYTBBS1BLLWkyLTZZRUFOLWFIaGRjd0NCckFqdTBLSkF2NlB6RE5YS0JkRndiZFZhNnNlNnJGVjQzekVkYVFzbVFJWFVRQWJTZ3RLZEtNZkdUUDhoM29NeHlUOGhWNTNlOUdybzllYUt0MDdyQzhUTm4zSDIzVGs0M1djTWJwdmpXSHI2bDZKaW9VRzEwdm9jOWNnUEc2cksyTlkzZ2tmQ056UGlXeUJiRFZmMS1GRnR1YlV5ci02bEk2YXROWmkzSEhBdTRJSThkUlJEMHBKZ2FQT0gzWVhyd1k1Snpja2ZlT004UDNoTDBYQU1tbUliRXJNcnEzNHJ0MmV0UHhPR0dncTBDMGFnS0lxUXZidXVMelA5d3lDTjRDVXJ5V3ZfS0RRbHZSWnZwOWs2MGQxYkVPcmdyNTRBbEdOVkIwU0hXczYzOUUzWjFENzVScG5nSGxCYk5OeXFsY2szUEtQRDJhT19VWG1SV0RvWC1tSTJDckRaVWh4WGVKSjlxc295TU1tZHBHb0xTTnJWODVUMWdKb2dWbUN2d3hPY05zWVBjUkdVeVl5RHg0U2RwdjJCMmVhemhkQjZsaE03LWtCclo4TjVNYUYtemljNzZzWFVVaUE2bk56YkNwR2pPVE5uYXNZaVYxdEFnRGhhTTk5RkxuWWItYnBtSS1qZGh4Y19VNWNfRWxQcDVzNU1oN3R5eWdjZnN6a2xMWl9ZVGJKMjQ9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTjBwMWFUUmpUVGM0UkhaU1YyeFlXRGhxU0UxaVZqbGhOVlJSY3pkbFVESnNPVzVTU201bFUybHJjVnBqYjJSVFVrUlJaakI0VDNwNlVXVm5SbGhQVmxSUGNWTTVNRUpYTm1ST1JsVnRVbVJrYUhoVk56ZGxha2RqWkZOVGNGQmxOMnRKY0hScFZqWXdaMXBrWmpodlNUSkJibXhuVkRscFZHSllWR0ZKUmxSbk1rcDNSVmRQZVZWc2FFOXhjME5uVUVKdlYwVnNTMUJNT1VwWmJVOVhiRmxKWW5VNGNtOXlaWGxCU0Zrd1UwRlViRkJGUW1Sd2RubzVabEE1VjFCRVdtNDRWMlYxVEhwR01XbEZkMFJ5TjI1NGFETkdSR3RaWDBoMFkwVkxNbmN0YURFNWVtOXFMV3AzWm1kRmVuWlVPVGhpTlc5NlpsZ3lSM1pSYlUxeWIycDFlQT09IiwgImF1dGhfdGltZSI6IDE2OTc2MjQ2ODYsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIiwgImVtYWlsIl0sICJqdGkiOiAiOGZiNTE2YTI2ZGEwMTFlZWJhMzUwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIlBrWlZtZFQwcUpjdk1QZEtRdk1GU2tFcSIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjI0Njg2LCAiZXhwIjogMTY5NzYyNDk4NiwgImF1ZCI6IFsiand0X3Rlc3QiXX0.mrVmM7hg9KCBhQP57W0AtLTwRREmNavdqM3di1xBSYD6F9lTQIvesxEDitbO6Y_oD0esfpt80tCpRQoYmVHX6PCO7WBKmHmiczCkJlZBnl-3Fq0PNJT8TVAMevaF7pQ-9RhQ--VP6L3HevQTb2Rhho83Mb_kp8p4jmPpXOEGjQaiTdcB-6DSnSuak7n7gEOO620F9Fepe1swaya6Hh09dBg2iOf4FT3azAwo-3RbRATSQ3jfWSCSsaw5X31IUqvXIztPYxhd_-tMgSbSIMWVINQbZTkdZsZbqoX5m8AXTCM68F44YHOr63qX-JO9oWadu0W5OCaehhixUz189DpO-w"}
2023-10-18 12:24:46,837 oidcrp.oauth2 DEBUG Successful response: {"token_type": "Bearer", "scope": "openid profile offline_access email", "access_token": "eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTg1NzcxYTY5ZGVkNGEyY2JjMDMzMDZiZjA1MDUyZGEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OMHAxYVRSalRUYzRSSFpTVjJ4WVdEaHFTRTFpVmpsaE5WUlJjemRsVURKc09XNVNTbTVsVTJscmNWcGpiMlJUVWtSUlpqQjRUM3A2VVdWblJsaFBWbFJQY1ZNNU1FSlhObVJPUmxWdFVtUmthSGhWTnpkbGFrZGpaRk5UY0ZCbE4ydEpjSFJwVmpZd1oxcGtaamh2U1RKQmJteG5WRGxwVkdKWVZHRkpSbFJuTWtwM1JWZFBlVlZzYUU5eGMwTm5VRUp2VjBWc1MxQk1PVXBaYlU5WGJGbEpZblU0Y205eVpYbEJTRmt3VTBGVWJGQkZRbVJ3ZG5vNVpsQTVWMUJFV200NFYyVjFUSHBHTVdsRmQwUnlOMjU0YUROR1JHdFpYMGgwWTBWTE1uY3RhREU1ZW05cUxXcDNabWRGZW5aVU9UaGlOVzk2WmxneVIzWlJiVTF5YjJwMWVBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjQ2ODYsICJleHAiOiAxNjk3NjI4Mjg2fQ.xW8beh_ovtsIndt2pJOPT5stoec0kApoWwAtFFdxymYOmS1pixgCrniBfz-DbDPCwzwYl7RY_VNvi-xOdlSzeA", "expires_in": 3600, "refresh_token": "Z0FBQUFBQmxMN0p1d2NiVXlrc3hkWkYySFA3eVpWTnNZUElrOWVwaVlqMUlvTGJaSHc4Tm9zclQ3akIycjBzR214Zmx1ZkpYejV0c3liZEx4OFg4SGZjaFY4YVRyYURXQXlPYnd3b2dCaWdZam15ZEtCbEd5Rkh0d05SblNFV21NVThvc1RJaFNvYlBScUhxS2NsZVBiYTBBS1BLLWkyLTZZRUFOLWFIaGRjd0NCckFqdTBLSkF2NlB6RE5YS0JkRndiZFZhNnNlNnJGVjQzekVkYVFzbVFJWFVRQWJTZ3RLZEtNZkdUUDhoM29NeHlUOGhWNTNlOUdybzllYUt0MDdyQzhUTm4zSDIzVGs0M1djTWJwdmpXSHI2bDZKaW9VRzEwdm9jOWNnUEc2cksyTlkzZ2tmQ056UGlXeUJiRFZmMS1GRnR1YlV5ci02bEk2YXROWmkzSEhBdTRJSThkUlJEMHBKZ2FQT0gzWVhyd1k1Snpja2ZlT004UDNoTDBYQU1tbUliRXJNcnEzNHJ0MmV0UHhPR0dncTBDMGFnS0lxUXZidXVMelA5d3lDTjRDVXJ5V3ZfS0RRbHZSWnZwOWs2MGQxYkVPcmdyNTRBbEdOVkIwU0hXczYzOUUzWjFENzVScG5nSGxCYk5OeXFsY2szUEtQRDJhT19VWG1SV0RvWC1tSTJDckRaVWh4WGVKSjlxc295TU1tZHBHb0xTTnJWODVUMWdKb2dWbUN2d3hPY05zWVBjUkdVeVl5RHg0U2RwdjJCMmVhemhkQjZsaE03LWtCclo4TjVNYUYtemljNzZzWFVVaUE2bk56YkNwR2pPVE5uYXNZaVYxdEFnRGhhTTk5RkxuWWItYnBtSS1qZGh4Y19VNWNfRWxQcDVzNU1oN3R5eWdjZnN6a2xMWl9ZVGJKMjQ9", "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTjBwMWFUUmpUVGM0UkhaU1YyeFlXRGhxU0UxaVZqbGhOVlJSY3pkbFVESnNPVzVTU201bFUybHJjVnBqYjJSVFVrUlJaakI0VDNwNlVXVm5SbGhQVmxSUGNWTTVNRUpYTm1ST1JsVnRVbVJrYUhoVk56ZGxha2RqWkZOVGNGQmxOMnRKY0hScFZqWXdaMXBrWmpodlNUSkJibXhuVkRscFZHSllWR0ZKUmxSbk1rcDNSVmRQZVZWc2FFOXhjME5uVUVKdlYwVnNTMUJNT1VwWmJVOVhiRmxKWW5VNGNtOXlaWGxCU0Zrd1UwRlViRkJGUW1Sd2RubzVabEE1VjFCRVdtNDRWMlYxVEhwR01XbEZkMFJ5TjI1NGFETkdSR3RaWDBoMFkwVkxNbmN0YURFNWVtOXFMV3AzWm1kRmVuWlVPVGhpTlc5NlpsZ3lSM1pSYlUxeWIycDFlQT09IiwgImF1dGhfdGltZSI6IDE2OTc2MjQ2ODYsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIiwgImVtYWlsIl0sICJqdGkiOiAiOGZiNTE2YTI2ZGEwMTFlZWJhMzUwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIlBrWlZtZFQwcUpjdk1QZEtRdk1GU2tFcSIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjI0Njg2LCAiZXhwIjogMTY5NzYyNDk4NiwgImF1ZCI6IFsiand0X3Rlc3QiXX0.mrVmM7hg9KCBhQP57W0AtLTwRREmNavdqM3di1xBSYD6F9lTQIvesxEDitbO6Y_oD0esfpt80tCpRQoYmVHX6PCO7WBKmHmiczCkJlZBnl-3Fq0PNJT8TVAMevaF7pQ-9RhQ--VP6L3HevQTb2Rhho83Mb_kp8p4jmPpXOEGjQaiTdcB-6DSnSuak7n7gEOO620F9Fepe1swaya6Hh09dBg2iOf4FT3azAwo-3RbRATSQ3jfWSCSsaw5X31IUqvXIztPYxhd_-tMgSbSIMWVINQbZTkdZsZbqoX5m8AXTCM68F44YHOr63qX-JO9oWadu0W5OCaehhixUz189DpO-w"}
2023-10-18 12:24:46,837 oidcrp.service DEBUG response format: json
2023-10-18 12:24:46,837 oidcrp.service DEBUG response_cls: AccessTokenResponse
2023-10-18 12:24:46,838 oidcrp.service DEBUG Initial response parsing => "{'token_type': 'Bearer', 'scope': 'openid profile offline_access email', 'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTg1NzcxYTY5ZGVkNGEyY2JjMDMzMDZiZjA1MDUyZGEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OMHAxYVRSalRUYzRSSFpTVjJ4WVdEaHFTRTFpVmpsaE5WUlJjemRsVURKc09XNVNTbTVsVTJscmNWcGpiMlJUVWtSUlpqQjRUM3A2VVdWblJsaFBWbFJQY1ZNNU1FSlhObVJPUmxWdFVtUmthSGhWTnpkbGFrZGpaRk5UY0ZCbE4ydEpjSFJwVmpZd1oxcGtaamh2U1RKQmJteG5WRGxwVkdKWVZHRkpSbFJuTWtwM1JWZFBlVlZzYUU5eGMwTm5VRUp2VjBWc1MxQk1PVXBaYlU5WGJGbEpZblU0Y205eVpYbEJTRmt3VTBGVWJGQkZRbVJ3ZG5vNVpsQTVWMUJFV200NFYyVjFUSHBHTVdsRmQwUnlOMjU0YUROR1JHdFpYMGgwWTBWTE1uY3RhREU1ZW05cUxXcDNabWRGZW5aVU9UaGlOVzk2WmxneVIzWlJiVTF5YjJwMWVBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjQ2ODYsICJleHAiOiAxNjk3NjI4Mjg2fQ.xW8beh_ovtsIndt2pJOPT5stoec0kApoWwAtFFdxymYOmS1pixgCrniBfz-DbDPCwzwYl7RY_VNvi-xOdlSzeA', 'expires_in': 3600, 'refresh_token': 'Z0FBQUFBQmxMN0p1d2NiVXlrc3hkWkYySFA3eVpWTnNZUElrOWVwaVlqMUlvTGJaSHc4Tm9zclQ3akIycjBzR214Zmx1ZkpYejV0c3liZEx4OFg4SGZjaFY4YVRyYURXQXlPYnd3b2dCaWdZam15ZEtCbEd5Rkh0d05SblNFV21NVThvc1RJaFNvYlBScUhxS2NsZVBiYTBBS1BLLWkyLTZZRUFOLWFIaGRjd0NCckFqdTBLSkF2NlB6RE5YS0JkRndiZFZhNnNlNnJGVjQzekVkYVFzbVFJWFVRQWJTZ3RLZEtNZkdUUDhoM29NeHlUOGhWNTNlOUdybzllYUt0MDdyQzhUTm4zSDIzVGs0M1djTWJwdmpXSHI2bDZKaW9VRzEwdm9jOWNnUEc2cksyTlkzZ2tmQ056UGlXeUJiRFZmMS1GRnR1YlV5ci02bEk2YXROWmkzSEhBdTRJSThkUlJEMHBKZ2FQT0gzWVhyd1k1Snpja2ZlT004UDNoTDBYQU1tbUliRXJNcnEzNHJ0MmV0UHhPR0dncTBDMGFnS0lxUXZidXVMelA5d3lDTjRDVXJ5V3ZfS0RRbHZSWnZwOWs2MGQxYkVPcmdyNTRBbEdOVkIwU0hXczYzOUUzWjFENzVScG5nSGxCYk5OeXFsY2szUEtQRDJhT19VWG1SV0RvWC1tSTJDckRaVWh4WGVKSjlxc295TU1tZHBHb0xTTnJWODVUMWdKb2dWbUN2d3hPY05zWVBjUkdVeVl5RHg0U2RwdjJCMmVhemhkQjZsaE03LWtCclo4TjVNYUYtemljNzZzWFVVaUE2bk56YkNwR2pPVE5uYXNZaVYxdEFnRGhhTTk5RkxuWWItYnBtSS1qZGh4Y19VNWNfRWxQcDVzNU1oN3R5eWdjZnN6a2xMWl9ZVGJKMjQ9', 'id_token': 'eyJhbGciOiJSUzI1NiIsImtpZCI6Ik1qbG5ZVE5FVjAxWldESmZWbGRZYmpoS2VrOTZYM2xEV21zdE4yTk9UbGN3WmpGaldtNTZNbnB1TkEifQ.eyJzdWIiOiAiMzk4YTQ1ZTY4MjM3ZTRlZThmMTczMjY3ZTQzZjZhNTY5MjMxMTBmNzhjNTBhNzJiZjExZDNkMWQ3MTRlYmRiYyIsICJzaWQiOiAiWjBGQlFVRkJRbXhNTjBwMWFUUmpUVGM0UkhaU1YyeFlXRGhxU0UxaVZqbGhOVlJSY3pkbFVESnNPVzVTU201bFUybHJjVnBqYjJSVFVrUlJaakI0VDNwNlVXVm5SbGhQVmxSUGNWTTVNRUpYTm1ST1JsVnRVbVJrYUhoVk56ZGxha2RqWkZOVGNGQmxOMnRKY0hScFZqWXdaMXBrWmpodlNUSkJibXhuVkRscFZHSllWR0ZKUmxSbk1rcDNSVmRQZVZWc2FFOXhjME5uVUVKdlYwVnNTMUJNT1VwWmJVOVhiRmxKWW5VNGNtOXlaWGxCU0Zrd1UwRlViRkJGUW1Sd2RubzVabEE1VjFCRVdtNDRWMlYxVEhwR01XbEZkMFJ5TjI1NGFETkdSR3RaWDBoMFkwVkxNbmN0YURFNWVtOXFMV3AzWm1kRmVuWlVPVGhpTlc5NlpsZ3lSM1pSYlUxeWIycDFlQT09IiwgImF1dGhfdGltZSI6IDE2OTc2MjQ2ODYsICJhY3IiOiAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQiLCAic2NvcGUiOiBbIm9wZW5pZCIsICJwcm9maWxlIiwgIm9mZmxpbmVfYWNjZXNzIiwgImVtYWlsIl0sICJqdGkiOiAiOGZiNTE2YTI2ZGEwMTFlZWJhMzUwMjQyYWMxNzAwMDQiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgIm5vbmNlIjogIlBrWlZtZFQwcUpjdk1QZEtRdk1GU2tFcSIsICJpc3MiOiAiaHR0cHM6Ly9zYXRvc2EuaWRlbS5pdCIsICJpYXQiOiAxNjk3NjI0Njg2LCAiZXhwIjogMTY5NzYyNDk4NiwgImF1ZCI6IFsiand0X3Rlc3QiXX0.mrVmM7hg9KCBhQP57W0AtLTwRREmNavdqM3di1xBSYD6F9lTQIvesxEDitbO6Y_oD0esfpt80tCpRQoYmVHX6PCO7WBKmHmiczCkJlZBnl-3Fq0PNJT8TVAMevaF7pQ-9RhQ--VP6L3HevQTb2Rhho83Mb_kp8p4jmPpXOEGjQaiTdcB-6DSnSuak7n7gEOO620F9Fepe1swaya6Hh09dBg2iOf4FT3azAwo-3RbRATSQ3jfWSCSsaw5X31IUqvXIztPYxhd_-tMgSbSIMWVINQbZTkdZsZbqoX5m8AXTCM68F44YHOr63qX-JO9oWadu0W5OCaehhixUz189DpO-w'}"
2023-10-18 12:24:46,838 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-18 12:24:46,838 oidcmsg.message DEBUG Raw JSON: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMN0p1aTRjTTc4RHZSV2xYWDhqSE1iVjlhNVRRczdlUDJsOW5SSm5lU2lrcVpjb2RTUkRRZjB4T3p6UWVnRlhPVlRPcVM5MEJXNmRORlVtUmRkaHhVNzdlakdjZFNTcFBlN2tJcHRpVjYwZ1pkZjhvSTJBbmxnVDlpVGJYVGFJRlRnMkp3RVdPeVVsaE9xc0NnUEJvV0VsS1BMOUpZbU9XbFlJYnU4cm9yZXlBSFkwU0FUbFBFQmRwdno5ZlA5V1BEWm44V2V1THpGMWlFd0RyN254aDNGRGtZX0h0Y0VLMnctaDE5em9qLWp3ZmdFenZUOThiNW96ZlgyR3ZRbU1yb2p1eA==', 'auth_time': 1697624686, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access', 'email'], 'jti': '8fb516a26da011eeba350242ac170004', 'client_id': 'jwt_test', 'nonce': 'PkZVmdT0qJcvMPdKQvMFSkEq', 'iss': 'https://satosa.idem.it', 'iat': 1697624686, 'exp': 1697624986, 'aud': ['jwt_test']}
2023-10-18 12:24:46,838 oidcmsg.message DEBUG JWS header: {'alg': 'RS256', 'kid': 'MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA'}
2023-10-18 12:24:46,838 cryptojwt.key_jar DEBUG Key summary for https://satosa.idem.it: RSA:sig:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, EC:sig:LTBrVGdOSFdocmtjdERaNHNhSG9vcGZxcnctVzVCZ3R6Skw0a3g4eWVnYw
2023-10-18 12:24:46,838 oidcmsg.message DEBUG Found signing key.
2023-10-18 12:24:46,838 cryptojwt.jwx DEBUG Picking key by key type=RSA
2023-10-18 12:24:46,838 cryptojwt.jwx DEBUG Picking key based on alg=RS256, kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA and use=
2023-10-18 12:24:46,838 cryptojwt.jwx DEBUG Picked: kid:MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA, use:sig, kty:RSA
2023-10-18 12:24:46,839 cryptojwt.jws.jws DEBUG Verified message using key with kid=MjlnYTNEV01ZWDJfVldYbjhKek96X3lDWmstN2NOTlcwZjFjWm56MnpuNA
2023-10-18 12:24:46,839 oidcmsg.oidc INFO Verified id_token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMN0p1aTRjTTc4RHZSV2xYWDhqSE1iVjlhNVRRczdlUDJsOW5SSm5lU2lrcVpjb2RTUkRRZjB4T3p6UWVnRlhPVlRPcVM5MEJXNmRORlVtUmRkaHhVNzdlakdjZFNTcFBlN2tJcHRpVjYwZ1pkZjhvSTJBbmxnVDlpVGJYVGFJRlRnMkp3RVdPeVVsaE9xc0NnUEJvV0VsS1BMOUpZbU9XbFlJYnU4cm9yZXlBSFkwU0FUbFBFQmRwdno5ZlA5V1BEWm44V2V1THpGMWlFd0RyN254aDNGRGtZX0h0Y0VLMnctaDE5em9qLWp3ZmdFenZUOThiNW96ZlgyR3ZRbU1yb2p1eA==', 'auth_time': 1697624686, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access', 'email'], 'jti': '8fb516a26da011eeba350242ac170004', 'client_id': 'jwt_test', 'nonce': 'PkZVmdT0qJcvMPdKQvMFSkEq', 'iss': 'https://satosa.idem.it', 'iat': 1697624686, 'exp': 1697624986, 'aud': ['jwt_test']}
2023-10-18 12:24:46,839 oidcrp.rp_handler DEBUG ID Token: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'sid': 'Z0FBQUFBQmxMN0p1aTRjTTc4RHZSV2xYWDhqSE1iVjlhNVRRczdlUDJsOW5SSm5lU2lrcVpjb2RTUkRRZjB4T3p6UWVnRlhPVlRPcVM5MEJXNmRORlVtUmRkaHhVNzdlakdjZFNTcFBlN2tJcHRpVjYwZ1pkZjhvSTJBbmxnVDlpVGJYVGFJRlRnMkp3RVdPeVVsaE9xc0NnUEJvV0VsS1BMOUpZbU9XbFlJYnU4cm9yZXlBSFkwU0FUbFBFQmRwdno5ZlA5V1BEWm44V2V1THpGMWlFd0RyN254aDNGRGtZX0h0Y0VLMnctaDE5em9qLWp3ZmdFenZUOThiNW96ZlgyR3ZRbU1yb2p1eA==', 'auth_time': 1697624686, 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport', 'scope': ['openid', 'profile', 'offline_access', 'email'], 'jti': '8fb516a26da011eeba350242ac170004', 'client_id': 'jwt_test', 'nonce': 'PkZVmdT0qJcvMPdKQvMFSkEq', 'iss': 'https://satosa.idem.it', 'iat': 1697624686, 'exp': 1697624986, 'aud': ['jwt_test']}
2023-10-18 12:24:46,840 oidcrp.rp_handler DEBUG ******************** get_user_info ********************
2023-10-18 12:24:46,840 oidcrp.service DEBUG Request: {'access_token': 'eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTg1NzcxYTY5ZGVkNGEyY2JjMDMzMDZiZjA1MDUyZGEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OMHAxYVRSalRUYzRSSFpTVjJ4WVdEaHFTRTFpVmpsaE5WUlJjemRsVURKc09XNVNTbTVsVTJscmNWcGpiMlJUVWtSUlpqQjRUM3A2VVdWblJsaFBWbFJQY1ZNNU1FSlhObVJPUmxWdFVtUmthSGhWTnpkbGFrZGpaRk5UY0ZCbE4ydEpjSFJwVmpZd1oxcGtaamh2U1RKQmJteG5WRGxwVkdKWVZHRkpSbFJuTWtwM1JWZFBlVlZzYUU5eGMwTm5VRUp2VjBWc1MxQk1PVXBaYlU5WGJGbEpZblU0Y205eVpYbEJTRmt3VTBGVWJGQkZRbVJ3ZG5vNVpsQTVWMUJFV200NFYyVjFUSHBHTVdsRmQwUnlOMjU0YUROR1JHdFpYMGgwWTBWTE1uY3RhREU1ZW05cUxXcDNabWRGZW5aVU9UaGlOVzk2WmxneVIzWlJiVTF5YjJwMWVBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjQ2ODYsICJleHAiOiAxNjk3NjI4Mjg2fQ.xW8beh_ovtsIndt2pJOPT5stoec0kApoWwAtFFdxymYOmS1pixgCrniBfz-DbDPCwzwYl7RY_VNvi-xOdlSzeA'}
2023-10-18 12:24:46,840 oidcrp.service DEBUG Client authn method: bearer_header
2023-10-18 12:24:46,840 oidcrp.oauth2 DEBUG do_request info: {'method': 'GET', 'request': <oidcmsg.message.Message object at 0x7f421acc8e50>, 'url': 'https://satosa.idem.it/OIDC/userinfo', 'headers': {'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTg1NzcxYTY5ZGVkNGEyY2JjMDMzMDZiZjA1MDUyZGEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OMHAxYVRSalRUYzRSSFpTVjJ4WVdEaHFTRTFpVmpsaE5WUlJjemRsVURKc09XNVNTbTVsVTJscmNWcGpiMlJUVWtSUlpqQjRUM3A2VVdWblJsaFBWbFJQY1ZNNU1FSlhObVJPUmxWdFVtUmthSGhWTnpkbGFrZGpaRk5UY0ZCbE4ydEpjSFJwVmpZd1oxcGtaamh2U1RKQmJteG5WRGxwVkdKWVZHRkpSbFJuTWtwM1JWZFBlVlZzYUU5eGMwTm5VRUp2VjBWc1MxQk1PVXBaYlU5WGJGbEpZblU0Y205eVpYbEJTRmt3VTBGVWJGQkZRbVJ3ZG5vNVpsQTVWMUJFV200NFYyVjFUSHBHTVdsRmQwUnlOMjU0YUROR1JHdFpYMGgwWTBWTE1uY3RhREU1ZW05cUxXcDNabWRGZW5aVU9UaGlOVzk2WmxneVIzWlJiVTF5YjJwMWVBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjQ2ODYsICJleHAiOiAxNjk3NjI4Mjg2fQ.xW8beh_ovtsIndt2pJOPT5stoec0kApoWwAtFFdxymYOmS1pixgCrniBfz-DbDPCwzwYl7RY_VNvi-xOdlSzeA'}}
2023-10-18 12:24:46,840 oidcrp.oauth2 DEBUG Doing request with: URL:https://satosa.idem.it/OIDC/userinfo, method:GET, data:None, https_args:{'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsImtpZCI6IkxUQnJWR2RPU0Zkb2NtdGpkRVJhTkhOaFNHOXZjR1p4Y25jdFZ6VkNaM1I2U2t3MGEzZzRlV1ZuWXcifQ.eyJzY29wZSI6ICJvcGVuaWQgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyBlbWFpbCIsICJhdWQiOiBbImp3dF90ZXN0Il0sICJqdGkiOiAiOTg1NzcxYTY5ZGVkNGEyY2JjMDMzMDZiZjA1MDUyZGEiLCAiY2xpZW50X2lkIjogImp3dF90ZXN0IiwgInN1YiI6ICIzOThhNDVlNjgyMzdlNGVlOGYxNzMyNjdlNDNmNmE1NjkyMzExMGY3OGM1MGE3MmJmMTFkM2QxZDcxNGViZGJjIiwgInNpZCI6ICJaMEZCUVVGQlFteE1OMHAxYVRSalRUYzRSSFpTVjJ4WVdEaHFTRTFpVmpsaE5WUlJjemRsVURKc09XNVNTbTVsVTJscmNWcGpiMlJUVWtSUlpqQjRUM3A2VVdWblJsaFBWbFJQY1ZNNU1FSlhObVJPUmxWdFVtUmthSGhWTnpkbGFrZGpaRk5UY0ZCbE4ydEpjSFJwVmpZd1oxcGtaamh2U1RKQmJteG5WRGxwVkdKWVZHRkpSbFJuTWtwM1JWZFBlVlZzYUU5eGMwTm5VRUp2VjBWc1MxQk1PVXBaYlU5WGJGbEpZblU0Y205eVpYbEJTRmt3VTBGVWJGQkZRbVJ3ZG5vNVpsQTVWMUJFV200NFYyVjFUSHBHTVdsRmQwUnlOMjU0YUROR1JHdFpYMGgwWTBWTE1uY3RhREU1ZW05cUxXcDNabWRGZW5aVU9UaGlOVzk2WmxneVIzWlJiVTF5YjJwMWVBPT0iLCAidG9rZW5fY2xhc3MiOiAiYWNjZXNzX3Rva2VuIiwgImlzcyI6ICJodHRwczovL3NhdG9zYS5pZGVtLml0IiwgImlhdCI6IDE2OTc2MjQ2ODYsICJleHAiOiAxNjk3NjI4Mjg2fQ.xW8beh_ovtsIndt2pJOPT5stoec0kApoWwAtFFdxymYOmS1pixgCrniBfz-DbDPCwzwYl7RY_VNvi-xOdlSzeA'}
2023-10-18 12:24:46,840 urllib3.connectionpool DEBUG Starting new HTTPS connection (1): satosa.idem.it:443
2023-10-18 12:24:46,979 urllib3.connectionpool DEBUG https://satosa.idem.it:443 "GET /OIDC/userinfo HTTP/1.1" 200 None
2023-10-18 12:24:46,980 oidcrp.http DEBUG RECEIVED COOKIE
2023-10-18 12:24:46,980 oidcrp.oauth2 DEBUG response_body_type: "json"
2023-10-18 12:24:46,980 oidcrp.util DEBUG resp.headers: {'Server': 'nginx/1.25.2', 'Date': 'Wed, 18 Oct 2023 10:24:46 GMT', 'Content-Type': 'application/json', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Set-Cookie': 'SATOSA_STATE=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACwaCUT4A8zHW4BbPsC4hHHlF7B6gpvIkZu_4OG-JMOXmhmmxVJOvoHCUKLN3Md1Q_5vo-8NH8vdXrw9gJoNxQf1Gtvf6bFcIW7CLEyDGKEyIIeZFGXiQurW2jZu7rfJT45BF39aZ5qhOXLHxwX0KDXqSsoSTz7tPLc7V9_9otfQXUzB7XVZx1PWzkHddDUtFyOFm3bepIiNAjhHvi5HcXdQKOV5zEzDUza-mgexI6GEBT5dkyka3ZUAAAAAAOMSlAPS2OC2AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; SameSite=None; Secure, SATOSA_STATE_LEGACY=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4AC_ALldACwaCUT4A8zHW4BbPsC4hHHlF7B6gpvIkZu_4OG-JMOXmhmmxVJOvoHCUKLN3Md1Q_5vo-8NH8vdXrw9gJoNxQf1Gtvf6bFcIW7CLEyDGKEyIIeZFGXiQurW2jZu7rfJT45BF39aZ5qhOXLHxwX0KDXqSsoSTz7tPLc7V9_9otfQXUzB7XVZx1PWzkHddDUtFyOFm3bepIiNAjhHvi5HcXdQKOV5zEzDUza-mgexI6GEBT5dkyka3ZUAAAAAAOMSlAPS2OC2AAHVAcABAADA9EnLscRn-wIAAAAABFla; Max-Age=600; Path=/; Secure', 'X-Frame-Options': 'DENY, DENY', 'X-Content-Type-Options': 'nosniff', 'X-XSS-Protection': '1; mode=block', 'X-Robots-Tag': 'none'}
2023-10-18 12:24:46,980 oidcrp.util DEBUG resp.txt: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "email": "test1@gmail.com", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-18 12:24:46,980 oidcrp.oauth2 DEBUG Successful response: {"sub": "398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc", "email": "test1@gmail.com", "acr": "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"}
2023-10-18 12:24:46,980 oidcrp.service DEBUG response format: json
2023-10-18 12:24:46,980 oidcrp.service DEBUG response_cls: OpenIDSchema
2023-10-18 12:24:46,980 oidcrp.service DEBUG Initial response parsing => "{'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'email': 'test1@gmail.com', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}"
2023-10-18 12:24:46,980 oidcrp.service DEBUG Verify response with {'client_id': 'jwt_test', 'iss': 'https://satosa.idem.it', 'keyjar': <KeyJar(issuers=['', 'https://satosa.idem.it'])>, 'verify': True, 'skew': 15}
2023-10-18 12:24:46,981 oidcrp.rp_handler DEBUG UserInfo: {'sub': '398a45e68237e4ee8f173267e43f6a56923110f78c50a72bf11d3d1d714ebdbc', 'email': 'test1@gmail.com', 'acr': 'urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport'}
2023-10-18 12:24:46,983 werkzeug INFO 127.0.0.1 - - [18/Oct/2023 12:24:46] "GET /authz_cb/satosa?state=7OM1s3DdqLeT5U0Wex9LfcXJtpvQUttJ&scope=profile+openid+offline_access+email&code=Z0FBQUFBQmxMN0p1QURtXzNUa2hNVTJvMFlxeEpxc0plMklRSk5ITXJ2LW45RUZuNnk5VmtLSk1Oc2NNblRSZF8xSk5XNzhfeUMxam14eVQyZUktcGlZMW16ZU9JTWEtQ2JmbU9tcVRDcXJMS01MQUZ5ZVNFSkcwWEE3SWxlVEFXOGREaW9aa3JIanNYbXlGR2t6bFpVNTBSMWRTMG5SU00zRmlFOWpGNmw5TEtkTnExTWpjUC0zQVI5TFU3U1M0aXhNcURzV1ZYalFzQ0hnLWFvLTFNejFxQ2FybVhseVVnMWI5aEk5M3c4endFUFd3djFnWndIeU0tbUtNNE0yVDhUTnhaOE10Q2tyajB6cktfXzJzZ1UwbHh4S0RQQnh4c1V4X3o2aTRNTktZOGw1VFVQcWwwOUxROWN2YVhxcjlxcXBNZm9ncTlGVG1kZEh5WTlUem00R2tvbWJrTmJYOW1OSXI5TnFfd0tuWjVTdFdjaDhPVzB0VFlnVE1vRzFfYWlwMWJqemhOQUlFMWJkLW56LUtFNG0wZUxnUEs2c0NudkFra1pDYm96V3VqalpNT0F1NVhUT3lyaWZ4dEhmUEx3TVRncUUzT1NmbTQxbk5lV09nODVFekI3WDE2V1hnc3ZLbmE2ZlI5QmxtaDBQMUI5MHJEWEdvenk4dERkWElId3NHMUZkb01GZVVPdW9NcXVYeUlwNXhBNGJCT3lIZW5kX2E2cFY5RmRXVmF6bDhyUlB5VWZjOThqcW5Wdk9waHFySEV2TzRVR3VzVXpoSW9ZUEZQYjRKUERsSjhzeEtBYnpDa1hVVTdiWkU1RUhPd2l4RmFzSW9SUmpEZzlYX2FJaWdZa2Z6c3hfTV9iMmJYWEtqWEFQNkJYdF9tOFRjRXRaT1lBTlR1Sm0yVjZKeWJHVmNFMnM9&iss=https://satosa.idem.it&client_id=jwt_test HTTP/1.1" 200 -
